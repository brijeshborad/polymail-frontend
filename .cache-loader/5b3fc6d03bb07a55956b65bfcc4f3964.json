{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/ducks/accounts.ts","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/ducks/accounts.ts","mtime":1675280254046},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF9fYXNzaWduID0gKHRoaXMgJiYgdGhpcy5fX2Fzc2lnbikgfHwgZnVuY3Rpb24gKCkgewogICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uKHQpIHsKICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHsKICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTsKICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKQogICAgICAgICAgICAgICAgdFtwXSA9IHNbcF07CiAgICAgICAgfQogICAgICAgIHJldHVybiB0OwogICAgfTsKICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9Owp2YXIgX2EsIF9iLCBfYywgX2QsIF9lLCBfZiwgX2csIF9oOwppbXBvcnQgdXBkYXRlIGZyb20gJ2ltbXV0YWJpbGl0eS1oZWxwZXInOwppbXBvcnQgeyBmaW5kSW5kZXggfSBmcm9tICdsb2Rhc2gnOwppbXBvcnQgeyBjcmVhdGUgfSBmcm9tICdAc3JjL2xpYi9yZWR1eCc7CmltcG9ydCB7IEFjY291bnRTdGF0dXMsIEFjY291bnRUeXBlLCB9IGZyb20gJ0BzcmMvdHlwZXMnOwppbXBvcnQgeyBjcmVhdGVTZWxlY3RvciB9IGZyb20gJ0BzcmMvbGliL3NlbGVjdG9yJzsKaW1wb3J0IHsgcmVzb3VyY2VPayB9IGZyb20gJ0BzcmMvbGliL3Jlc291cmNlJzsKaW1wb3J0IHsgaXNDb21wYW55RG9tYWluIH0gZnJvbSAnQHNyYy9saWIvZW1haWwnOwppbXBvcnQgeyBmaW5kUGFyZW50QWNjb3VudCB9IGZyb20gJ0BzcmMvbGliL2FjY291bnQnOwppbXBvcnQgeyBpbml0aWFsU3RhdGVXaXRoQ2FjaGVkRGF0YSB9IGZyb20gJ0BzcmMvbGliL3N0YXRlJzsKZnVuY3Rpb24gY3JlYXRlTWV0YU5lc3Rpbmcoc3RhdGUsIHJlc291cmNlKSB7CiAgICB2YXIgX2E7CiAgICBpZiAoc3RhdGUuYXR0YWNobWVudE1ldGFzW3Jlc291cmNlXSkgewogICAgICAgIHJldHVybiBzdGF0ZTsKICAgIH0KICAgIHJldHVybiB1cGRhdGUoc3RhdGUsIHsKICAgICAgICBhdHRhY2htZW50TWV0YXM6IChfYSA9IHt9LAogICAgICAgICAgICBfYVtyZXNvdXJjZV0gPSB7CiAgICAgICAgICAgICAgICAkc2V0OiB7fSwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgX2EpLAogICAgfSk7Cn0KZXhwb3J0IHZhciBBQ0NPVU5UX1BST1ZJREVSX1NFTEVDVCA9IChfYSA9IGNyZWF0ZSgnQUNDT1VOVF9QUk9WSURFUl9TRUxFQ1QnLCB7fSksIF9hLnR5cGUpLCBhY2NvdW50UHJvdmlkZXJTZWxlY3QgPSBfYS5hY3Rpb24sIGFjY291bnRQcm92aWRlclNlbGVjdFJlZHVjZXIgPSBfYS5yZWR1Y2VyOwpleHBvcnQgdmFyIEFDQ09VTlRfREVMRVRFID0gKF9iID0gY3JlYXRlKCdBQ0NPVU5UX0RFTEVURScsIHsKICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChzdGF0ZSwgbWV0YSwgcGF5bG9hZCkgewogICAgICAgIHZhciBfYTsKICAgICAgICB2YXIgYWNjb3VudEluZGV4ID0gZmluZEluZGV4KHN0YXRlLmFjY291bnRzLCBbJ2lkJywgbWV0YS5pZF0pOwogICAgICAgIGlmIChhY2NvdW50SW5kZXggPT09IC0xKSB7CiAgICAgICAgICAgIHJldHVybiBzdGF0ZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHVwZGF0ZShzdGF0ZSwgewogICAgICAgICAgICBhY2NvdW50czogKF9hID0ge30sIF9hW2FjY291bnRJbmRleF0gPSB7IHN0YXR1czogeyAkc2V0OiBBY2NvdW50U3RhdHVzLkRlbGV0aW5nIH0gfSwgX2EpLAogICAgICAgIH0pOwogICAgfSwKfSksIF9iLnR5cGUpLCBhY2NvdW50RGVsZXRlID0gX2IuYWN0aW9uLCBhY2NvdW50RGVsZXRlUmVkdWNlciA9IF9iLnJlZHVjZXI7CmV4cG9ydCB2YXIgQUNDT1VOVF9ERUxFVEVfTUUgPSAoX2MgPSBjcmVhdGUoJ0FDQ09VTlRfREVMRVRFX01FJywgewogICAgc3VjY2VzczogZnVuY3Rpb24gKHN0YXRlKSB7CiAgICAgICAgcmV0dXJuIF9fYXNzaWduKF9fYXNzaWduKF9fYXNzaWduKHt9LCBzdGF0ZSksIGluaXRpYWxTdGF0ZVdpdGhDYWNoZWREYXRhKCkpLCB7IHNlc3Npb25JZDogc3RhdGUuc2Vzc2lvbklkIH0pOwogICAgfSwKfSksIF9jLnR5cGUpLCBhY2NvdW50RGVsZXRlTWUgPSBfYy5hY3Rpb24sIGFjY291bnREZWxldGVNZVJlZHVjZXIgPSBfYy5yZWR1Y2VyOwpleHBvcnQgdmFyIEFDQ09VTlRfQ1JFQVRFID0gKF9kID0gY3JlYXRlKCdBQ0NPVU5UX0NSRUFURScsIHsKICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChzdGF0ZSwgbWV0YSwgcGF5bG9hZCkgewogICAgICAgIHJldHVybiB1cGRhdGUoc3RhdGUsIHsKICAgICAgICAgICAgYWNjb3VudHM6IHsgJHB1c2g6IFtwYXlsb2FkXSB9LAogICAgICAgIH0pOwogICAgfSwKfSksIF9kLnR5cGUpLCBhY2NvdW50Q3JlYXRlID0gX2QuYWN0aW9uLCBhY2NvdW50Q3JlYXRlUmVkdWNlciA9IF9kLnJlZHVjZXI7CmV4cG9ydCB2YXIgQUNDT1VOVF9VUERBVEUgPSAoX2UgPSBjcmVhdGUoJ0FDQ09VTlRfVVBEQVRFJywgewogICAgc3RhcnQ6IGZ1bmN0aW9uIChzdGF0ZSwgbWV0YSkgewogICAgICAgIHZhciBfYTsKICAgICAgICB2YXIgYWNjb3VudElkID0gbWV0YS5pZDsKICAgICAgICB2YXIgaW5kZXggPSBmaW5kSW5kZXgoc3RhdGUuYWNjb3VudHMsIFsnaWQnLCBhY2NvdW50SWRdKTsKICAgICAgICByZXR1cm4gdXBkYXRlKHN0YXRlLCB7CiAgICAgICAgICAgIGFjY291bnRzOiAoX2EgPSB7fSwKICAgICAgICAgICAgICAgIF9hW2luZGV4XSA9IHsgJHNldDogbWV0YSB9LAogICAgICAgICAgICAgICAgX2EpLAogICAgICAgIH0pOwogICAgfSwKfSksIF9lLnR5cGUpLCBhY2NvdW50VXBkYXRlID0gX2UuYWN0aW9uLCBhY2NvdW50VXBkYXRlUmVkdWNlciA9IF9lLnJlZHVjZXI7Ci8vIFRPRE8oU0hBSEFOKTogSWRlYWxseSB3b3VsZCBsaWtlIHRvIHdvcmsgd2l0aCBwYXRjaGVzLCBidXQgY3VycmVudGx5Ci8vIGRvIG5vdCBoYXZlIGEgZ29vZCBvcHRpbWlzdGljIG1ldGhvZApleHBvcnQgdmFyIGFjY291bnRVcGRhdGVQYXNzd29yZCA9IGZ1bmN0aW9uIChhY2NvdW50LCBuZXdQYXNzd29yZCkgewogICAgdmFyIHVwZGF0ZXMgPSBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgYWNjb3VudCksIHsgaWQ6IGFjY291bnQuaWQgfSk7CiAgICBzd2l0Y2ggKGFjY291bnQudHlwZSkgewogICAgICAgIGNhc2UgQWNjb3VudFR5cGUuaUNsb3VkOgogICAgICAgICAgICB1cGRhdGVzLnBhc3N3b3JkID0gbmV3UGFzc3dvcmQ7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgQWNjb3VudFR5cGUuSU1BUDoKICAgICAgICAgICAgaWYgKGFjY291bnQucHJlc2V0KSB7CiAgICAgICAgICAgICAgICB1cGRhdGVzLnBhc3N3b3JkID0gbmV3UGFzc3dvcmQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICB1cGRhdGVzLmltYXAgPSBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgdXBkYXRlcy5pbWFwKSwgeyBwYXNzd29yZDogbmV3UGFzc3dvcmQgfSk7CiAgICAgICAgICAgICAgICB1cGRhdGVzLnNtdHAgPSBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgdXBkYXRlcy5zbXRwKSwgeyBwYXNzd29yZDogbmV3UGFzc3dvcmQgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgYnJlYWs7CiAgICB9CiAgICByZXR1cm4gYWNjb3VudFVwZGF0ZSh1cGRhdGVzKTsKfTsKZXhwb3J0IHZhciBBQ0NPVU5UX1JFQVVUSE9SSVpFID0gKF9mID0gY3JlYXRlKCdBQ0NPVU5UX1JFQVVUSE9SSVpFJywge30pLCBfZi50eXBlKSwgYWNjb3VudFJlYXV0aG9yaXplID0gX2YuYWN0aW9uLCBhY2NvdW50UmVhdXRob3JpemVSZWR1Y2VyID0gX2YucmVkdWNlcjsKZXhwb3J0IHZhciBTSUdOQVRVUkVfSU1BR0VfQUREID0gKF9nID0gY3JlYXRlKCdTSUdOQVRVUkVfSU1BR0VfQUREJywgewogICAgc3RhcnQ6IGZ1bmN0aW9uIChzdGF0ZSwgbWV0YSkgewogICAgICAgIHZhciBfYSwgX2I7CiAgICAgICAgcmV0dXJuIHVwZGF0ZShjcmVhdGVNZXRhTmVzdGluZyhzdGF0ZSwgbWV0YS5yZXNvdXJjZUlkKSwgewogICAgICAgICAgICBhdHRhY2htZW50TWV0YXM6IChfYSA9IHt9LAogICAgICAgICAgICAgICAgX2FbbWV0YS5yZXNvdXJjZUlkXSA9IHsKICAgICAgICAgICAgICAgICAgICAkbWVyZ2U6IChfYiA9IHt9LAogICAgICAgICAgICAgICAgICAgICAgICBfYlttZXRhLmF0dGFjaG1lbnRdID0gcmVzb3VyY2VPayhtZXRhKSwKICAgICAgICAgICAgICAgICAgICAgICAgX2IpLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIF9hKSwKICAgICAgICB9KTsKICAgIH0sCiAgICBzdWNjZXNzOiBmdW5jdGlvbiAoc3RhdGUsIG1ldGEsIHBheWxvYWQpIHsKICAgICAgICB2YXIgX2EsIF9iOwogICAgICAgIHZhciBhY2NvdW50SW5kZXggPSBmaW5kSW5kZXgoc3RhdGUuYWNjb3VudHMsIFsnaWQnLCBtZXRhLnJlc291cmNlSWRdKTsKICAgICAgICB2YXIgYWNjb3VudCA9IHN0YXRlLmFjY291bnRzW2FjY291bnRJbmRleF07CiAgICAgICAgdmFyIHVwZGF0ZWRBY2NvdW50ID0gYWNjb3VudCAmJiB7CiAgICAgICAgICAgIGFjY291bnRzOiAoX2EgPSB7fSwKICAgICAgICAgICAgICAgIF9hW2FjY291bnRJbmRleF0gPSB7CiAgICAgICAgICAgICAgICAgICAgc2lnbmF0dXJlSW1hZ2VzOiB7ICRwdXNoOiBbcGF5bG9hZF0gfSwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBfYSksCiAgICAgICAgfTsKICAgICAgICByZXR1cm4gdXBkYXRlKGNyZWF0ZU1ldGFOZXN0aW5nKHN0YXRlLCBtZXRhLnJlc291cmNlSWQpLCBfX2Fzc2lnbih7IGF0dGFjaG1lbnRNZXRhczogKF9iID0ge30sIF9iW21ldGEucmVzb3VyY2VJZF0gPSB7ICR1bnNldDogW21ldGEuYXR0YWNobWVudF0gfSwgX2IpIH0sIHVwZGF0ZWRBY2NvdW50KSk7CiAgICB9LAp9KSwgX2cudHlwZSksIHNpZ25hdHVyZUltYWdlQWRkID0gX2cuYWN0aW9uLCBzaWduYXR1cmVJbWFnZUFkZFJlZHVjZXIgPSBfZy5yZWR1Y2VyOwpleHBvcnQgdmFyIFNJR05BVFVSRV9JTUFHRV9SRU1PVkUgPSAoX2ggPSBjcmVhdGUoJ1NJR05BVFVSRV9JTUFHRV9SRU1PVkUnLCB7CiAgICBzdWNjZXNzOiBmdW5jdGlvbiAoc3RhdGUsIG1ldGEsIHBheWxvYWQpIHsKICAgICAgICB2YXIgX2EsIF9iOwogICAgICAgIHZhciBhY2NvdW50SW5kZXggPSBmaW5kSW5kZXgoc3RhdGUuYWNjb3VudHMsIFsnaWQnLCBtZXRhLnJlc291cmNlSWRdKTsKICAgICAgICB2YXIgYWNjb3VudCA9IHN0YXRlLmFjY291bnRzW2FjY291bnRJbmRleF07CiAgICAgICAgdmFyIHVwZGF0ZWRBY2NvdW50ID0gYWNjb3VudCAmJiB7CiAgICAgICAgICAgIGFjY291bnRzOiAoX2EgPSB7fSwKICAgICAgICAgICAgICAgIF9hW2FjY291bnRJbmRleF0gPSB7CiAgICAgICAgICAgICAgICAgICAgc2lnbmF0dXJlSW1hZ2VzOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICRzZXQ6IGFjY291bnQuc2lnbmF0dXJlSW1hZ2VzLmZpbHRlcihmdW5jdGlvbiAoaW1hZ2UpIHsgcmV0dXJuIGltYWdlLmlkICE9PSBtZXRhLmF0dGFjaG1lbnQ7IH0pLAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgX2EpLAogICAgICAgIH07CiAgICAgICAgcmV0dXJuIHVwZGF0ZShjcmVhdGVNZXRhTmVzdGluZyhzdGF0ZSwgbWV0YS5yZXNvdXJjZUlkKSwgX19hc3NpZ24oeyBhdHRhY2htZW50TWV0YXM6IChfYiA9IHt9LCBfYlttZXRhLnJlc291cmNlSWRdID0geyAkdW5zZXQ6IFttZXRhLmF0dGFjaG1lbnRdIH0sIF9iKSB9LCB1cGRhdGVkQWNjb3VudCkpOwogICAgfSwKfSksIF9oLnR5cGUpLCBzaWduYXR1cmVJbWFnZVJlbW92ZSA9IF9oLmFjdGlvbiwgc2lnbmF0dXJlSW1hZ2VSZW1vdmVSZWR1Y2VyID0gX2gucmVkdWNlcjsKLy8gU2VsZWN0cyBQYXJlbnQgYWNjb3VudCBmb3IgYW4gYWxpYXMKZXhwb3J0IHZhciBzZWxlY3RQYXJlbnRBY2NvdW50ID0gY3JlYXRlU2VsZWN0b3IoWwogICAgZnVuY3Rpb24gKHN0YXRlLCBhY2NvdW50KSB7IHJldHVybiBzdGF0ZS5hY2NvdW50czsgfSwKICAgIGZ1bmN0aW9uIChzdGF0ZSwgYWNjb3VudCkgeyByZXR1cm4gYWNjb3VudDsgfSwKXSwgZnVuY3Rpb24gKGFjY291bnRzLCBhY2NvdW50KSB7IHJldHVybiBmaW5kUGFyZW50QWNjb3VudChhY2NvdW50cywgYWNjb3VudCk7IH0sIGZ1bmN0aW9uIChhY2NvdW50cywgYWNjb3VudCkgeyByZXR1cm4gYWNjb3VudDsgfSwgWydhY2NvdW50cyddKTsKZXhwb3J0IHZhciBzZWxlY3RBY2NvdW50ID0gY3JlYXRlU2VsZWN0b3IoWwogICAgZnVuY3Rpb24gKHN0YXRlLCBpZCkgewogICAgICAgIHZhciBpbmRleCA9IGZpbmRJbmRleChzdGF0ZS5hY2NvdW50cywgeyBpZDogaWQgfSk7CiAgICAgICAgcmV0dXJuIHN0YXRlLmFjY291bnRzW2luZGV4XTsKICAgIH0sCl0sIGZ1bmN0aW9uIChhY2NvdW50KSB7IHJldHVybiBhY2NvdW50OyB9KTsKZXhwb3J0IHZhciBzZWxlY3RJbnZhbGlkQWNjb3VudCA9IGNyZWF0ZVNlbGVjdG9yKFsKICAgIGZ1bmN0aW9uIChzdGF0ZSkgewogICAgICAgIHZhciBhY2NvdW50cyA9IHN0YXRlLmFjY291bnRzLmZpbHRlcihmdW5jdGlvbiAoYWNjb3VudCkgeyByZXR1cm4gYWNjb3VudC5zdGF0dXMgPT09IEFjY291bnRTdGF0dXMuSW52YWxpZDsgfSk7CiAgICAgICAgcmV0dXJuIGFjY291bnRzLmxlbmd0aCA+IDAgPyBhY2NvdW50c1swXSA6IHVuZGVmaW5lZDsKICAgIH0sCl0sIGZ1bmN0aW9uIChhY2NvdW50KSB7IHJldHVybiBhY2NvdW50OyB9KTsKZXhwb3J0IHZhciBzZWxlY3RBY2NvdW50cyA9IGNyZWF0ZVNlbGVjdG9yKFsKICAgIGZ1bmN0aW9uIChzdGF0ZSkgeyByZXR1cm4gc3RhdGUuYWNjb3VudHMKICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChlYWNoKSB7IHJldHVybiBlYWNoLnR5cGUgIT09ICdhbGlhcyc7IH0pCiAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoZWFjaCkgeyByZXR1cm4gZWFjaC5zdGF0dXMgIT09IEFjY291bnRTdGF0dXMuRGVsZXRpbmc7IH0pOyB9LApdLCBmdW5jdGlvbiAoYWNjb3VudHMpIHsgcmV0dXJuIGFjY291bnRzOyB9LCB1bmRlZmluZWQsIFsnYWNjb3VudHMnXSk7CmV4cG9ydCB2YXIgc2VsZWN0QWxsQWN0aXZlQWNjb3VudHMgPSBjcmVhdGVTZWxlY3RvcihbCiAgICBmdW5jdGlvbiAoc3RhdGUpIHsgcmV0dXJuIHN0YXRlLmFjY291bnRzCiAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoZWFjaCkgeyByZXR1cm4gZWFjaC5zdGF0dXMgIT09IEFjY291bnRTdGF0dXMuRGVsZXRpbmc7IH0pOyB9LApdLCBmdW5jdGlvbiAoYWNjb3VudHMpIHsgcmV0dXJuIGFjY291bnRzOyB9LCB1bmRlZmluZWQsIFsnYWNjb3VudHMnXSk7CmV4cG9ydCB2YXIgc2VsZWN0QWxpYXNlcyA9IGNyZWF0ZVNlbGVjdG9yKFsKICAgIGZ1bmN0aW9uIChzdGF0ZSwgYWNjb3VudCkgeyByZXR1cm4gc3RhdGUuYWNjb3VudHMuZmlsdGVyKGZ1bmN0aW9uIChlYWNoKSB7IHJldHVybiBlYWNoLmFjY291bnQgPT09IGFjY291bnQuaWQ7IH0pOyB9LApdLCBmdW5jdGlvbiAoYWNjb3VudHMpIHsgcmV0dXJuIGFjY291bnRzOyB9LCB1bmRlZmluZWQsIFsnYWNjb3VudHMnXSk7CmV4cG9ydCB2YXIgc2VsZWN0RG9tYWlucyA9IGNyZWF0ZVNlbGVjdG9yKFsKICAgIGZ1bmN0aW9uIChzdGF0ZSkgeyByZXR1cm4gc3RhdGUuYWNjb3VudHM7IH0sCl0sIGZ1bmN0aW9uIChhY2NvdW50cykgeyByZXR1cm4gYWNjb3VudHMKICAgIC5maWx0ZXIoZnVuY3Rpb24gKGVhY2gpIHsgcmV0dXJuIGlzQ29tcGFueURvbWFpbihlYWNoLmVtYWlsKTsgfSkKICAgIC5tYXAoZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGEuZW1haWwuc3BsaXQoJ0AnKVsxXTsgfSk7IH0sIGZ1bmN0aW9uIChhY2NvdW50cykgeyByZXR1cm4gYWNjb3VudHMubWFwKGZ1bmN0aW9uIChhY2NvdW50KSB7IHJldHVybiBhY2NvdW50LmVtYWlsOyB9KS5qb2luKCcnKTsgfSwgWydhY2NvdW50cyddKTsKZXhwb3J0IGRlZmF1bHQgWwogICAgYWNjb3VudFVwZGF0ZVJlZHVjZXIsCiAgICBhY2NvdW50RGVsZXRlUmVkdWNlciwKICAgIGFjY291bnREZWxldGVNZVJlZHVjZXIsCiAgICBhY2NvdW50UmVhdXRob3JpemVSZWR1Y2VyLAogICAgYWNjb3VudENyZWF0ZVJlZHVjZXIsCiAgICBzaWduYXR1cmVJbWFnZUFkZFJlZHVjZXIsCiAgICBzaWduYXR1cmVJbWFnZVJlbW92ZVJlZHVjZXIsCiAgICBhY2NvdW50UHJvdmlkZXJTZWxlY3RSZWR1Y2VyLApdOwo="},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/ducks/accounts.ts","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/ducks/accounts.ts"],"names":[],"mappings":"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","sourcesContent":["import update from 'immutability-helper';\nimport { findIndex } from 'lodash';\n\nimport { create } from '@src/lib/redux';\n\nimport {\n  Account,\n  AttachmentMeta,\n  Attachment,\n  StoreState,\n  AccountStatus,\n  AccountType,\n  Action,\n} from '@src/types';\n\nimport { createSelector } from '@src/lib/selector';\nimport { resourceOk } from '@src/lib/resource';\nimport { isCompanyDomain } from '@src/lib/email';\nimport { findParentAccount } from '@src/lib/account';\nimport { initialStateWithCachedData } from '@src/lib/state';\n\nfunction createMetaNesting(state: StoreState, resource: string): StoreState {\n  if (state.attachmentMetas[resource]) {\n    return state;\n  }\n\n  return update(state, {\n    attachmentMetas: {\n      [resource]: {\n        $set: {},\n      },\n    },\n  });\n}\n\nexport const {\n  type: ACCOUNT_PROVIDER_SELECT,\n  action: accountProviderSelect,\n  reducer: accountProviderSelectReducer,\n} = create<AccountType, string>('ACCOUNT_PROVIDER_SELECT', {});\n\nexport const {\n  type: ACCOUNT_DELETE,\n  action: accountDelete,\n  reducer: accountDeleteReducer,\n} = create<Account, null>('ACCOUNT_DELETE', {\n  success: (state, meta, payload) => {\n    const accountIndex = findIndex(state.accounts, ['id', meta.id]);\n    if (accountIndex === -1) {\n      return state;\n    }\n    return update(state, {\n      accounts: { [accountIndex]: { status: { $set: AccountStatus.Deleting } } },\n    });\n  },\n});\n\nexport const {\n  type: ACCOUNT_DELETE_ME,\n  action: accountDeleteMe,\n  reducer: accountDeleteMeReducer,\n} = create<null, null>('ACCOUNT_DELETE_ME', {\n  success: (state) => {\n    return {\n      ...state,\n      ...initialStateWithCachedData(),\n      sessionId: state.sessionId,\n    };\n  },\n});\n\nexport const {\n  type: ACCOUNT_CREATE,\n  action: accountCreate,\n  reducer: accountCreateReducer,\n} = create<Partial<Account>, Account>('ACCOUNT_CREATE', {\n  success: (state, meta, payload) => {\n    return update(state, {\n      accounts: { $push: [payload] },\n    });\n  },\n});\n\nexport const {\n  type: ACCOUNT_UPDATE,\n  action: accountUpdate,\n  reducer: accountUpdateReducer,\n} = create<Account, Account>('ACCOUNT_UPDATE', {\n  start: (state, meta) => {\n    const accountId = meta.id;\n    const index = findIndex(state.accounts, ['id', accountId]);\n    return update(state, {\n      accounts: {\n        [index]: { $set: meta },\n      },\n    });\n  },\n});\n\n// TODO(SHAHAN): Ideally would like to work with patches, but currently\n// do not have a good optimistic method\nexport const accountUpdatePassword =\n  (account: Account, newPassword: string): Action<Account, Account> => {\n    const updates: Account = {\n      ...account,\n      id: account.id,\n    };\n\n    switch (account.type) {\n      case AccountType.iCloud:\n        updates.password = newPassword;\n        break;\n      case AccountType.IMAP:\n        if (account.preset) {\n          updates.password = newPassword;\n        } else {\n          updates.imap = {\n            ...updates.imap!,\n            password: newPassword,\n          };\n\n          updates.smtp = {\n            ...updates.smtp!,\n            password: newPassword,\n          };\n        }\n        break;\n      default:\n        break;\n    }\n\n    return accountUpdate(updates);\n  };\n\nexport const {\n  type: ACCOUNT_REAUTHORIZE,\n  action: accountReauthorize,\n  reducer: accountReauthorizeReducer,\n} = create<string, null>('ACCOUNT_REAUTHORIZE', {});\n\nexport const {\n  type: SIGNATURE_IMAGE_ADD,\n  action: signatureImageAdd,\n  reducer: signatureImageAddReducer,\n} = create<AttachmentMeta, Attachment>('SIGNATURE_IMAGE_ADD', {\n  start: (state, meta) => {\n    return update(createMetaNesting(state, meta.resourceId), {\n      attachmentMetas: {\n        [meta.resourceId]: {\n          $merge: {\n            [meta.attachment]: resourceOk(meta),\n          },\n        },\n      },\n    });\n  },\n  success: (state, meta, payload) => {\n    const accountIndex = findIndex(state.accounts, ['id', meta.resourceId]);\n    const account = state.accounts[accountIndex];\n    const updatedAccount = account && {\n      accounts: {\n        [accountIndex]: {\n          signatureImages: { $push: [payload] },\n        },\n      },\n    };\n    return update(createMetaNesting(state, meta.resourceId), {\n      attachmentMetas: { [meta.resourceId]: { $unset: [meta.attachment] } },\n      ...updatedAccount,\n    });\n  },\n});\n\nexport const {\n  type: SIGNATURE_IMAGE_REMOVE,\n  action: signatureImageRemove,\n  reducer: signatureImageRemoveReducer,\n} = create<AttachmentMeta, null>('SIGNATURE_IMAGE_REMOVE', {\n  success: (state, meta, payload) => {\n    const accountIndex = findIndex(state.accounts, ['id', meta.resourceId]);\n    const account = state.accounts[accountIndex];\n    const updatedAccount = account && {\n      accounts: {\n        [accountIndex]: {\n          signatureImages: {\n            $set: account.signatureImages.filter(image => image.id !== meta.attachment),\n          },\n        },\n      },\n    };\n    return update(createMetaNesting(state, meta.resourceId), {\n      attachmentMetas: { [meta.resourceId]: { $unset: [meta.attachment] } },\n      ...updatedAccount,\n    });\n  },\n});\n\n// Selects Parent account for an alias\nexport const selectParentAccount = createSelector<string, Account[]|string, Account|undefined>(\n  [\n    (state: StoreState, account: string) => state.accounts,\n    (state: StoreState, account: string) => account,\n  ],\n  (accounts: Account[], account: string) => findParentAccount(accounts, account),\n  (accounts: Account[], account: string) => account,\n  ['accounts'],\n);\n\nexport const selectAccount = createSelector<string, Account|undefined, Account>(\n  [\n    (state, id) => {\n      const index = findIndex(state.accounts, { id });\n      return state.accounts[index];\n    },\n  ],\n  (account: Account) => account,\n);\n\nexport const selectInvalidAccount = createSelector<undefined, Account|undefined, Account|undefined>(\n  [\n    (state) => {\n      const accounts = state.accounts.filter(account => account.status === AccountStatus.Invalid);\n      return accounts.length > 0 ? accounts[0] : undefined;\n    },\n  ],\n  (account?: Account) => account,\n);\n\nexport const selectAccounts = createSelector<undefined, Account[], Account[]>(\n  [\n    state => state.accounts\n      .filter(each => each.type !== 'alias')\n      .filter(each => each.status !== AccountStatus.Deleting),\n  ],\n  (accounts: Account[]) => accounts,\n  undefined,\n  ['accounts'],\n);\n\nexport const selectAllActiveAccounts = createSelector<undefined, Account[], Account[]>(\n  [\n    state => state.accounts\n      .filter(each => each.status !== AccountStatus.Deleting),\n  ],\n  (accounts: Account[]) => accounts,\n  undefined,\n  ['accounts'],\n);\n\nexport const selectAliases = createSelector<Account, Account[], Account[]>(\n  [\n    (state, account) => state.accounts.filter(each => each.account === account.id),\n  ],\n  (accounts: Account[]) => accounts,\n  undefined,\n  ['accounts'],\n);\n\nexport const selectDomains = createSelector<undefined, Account[], string[]>(\n  [\n    state => state.accounts,\n  ],\n  (accounts: Account[]) => accounts\n    .filter(each => isCompanyDomain(each.email))\n    .map(a => a.email.split('@')[1]),\n  (accounts: Account[]) => accounts.map(account => account.email).join(''),\n  ['accounts'],\n);\n\nexport default [\n  accountUpdateReducer,\n  accountDeleteReducer,\n  accountDeleteMeReducer,\n  accountReauthorizeReducer,\n  accountCreateReducer,\n  signatureImageAddReducer,\n  signatureImageRemoveReducer,\n  accountProviderSelectReducer,\n];\n"]}]}