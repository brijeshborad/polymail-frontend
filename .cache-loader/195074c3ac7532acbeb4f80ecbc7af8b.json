{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/ThreadDetail/components/Cell/ExpandedCell/components/RecipientsView.tsx","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/ThreadDetail/components/Cell/ExpandedCell/components/RecipientsView.tsx","mtime":1675280254038},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewogICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewogICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAogICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKICAgIH07CiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwogICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQogICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKICAgIH07Cn0pKCk7CmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7CmltcG9ydCBjbGFzc25hbWVzIGZyb20gJ2NsYXNzbmFtZXMnOwppbXBvcnQgeyBjb21wYWN0IH0gZnJvbSAnbG9kYXNoJzsKaW1wb3J0IHsgcGFyc2VBZGRyZXNzLCBwYXJ0aWNpcGFudHNUb1N0cmluZywgZ2V0RGlzcGxheU5hbWUgfSBmcm9tICdAc3JjL2xpYi9hZGRyZXNzJzsKaW1wb3J0ICcuL1JlY2lwaWVudHNWaWV3LnNjc3MnOwp2YXIgUmVjaXBpZW50c1ZpZXcgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoUmVjaXBpZW50c1ZpZXcsIF9zdXBlcik7CiAgICBmdW5jdGlvbiBSZWNpcGllbnRzVmlldygpIHsKICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzOwogICAgICAgIF90aGlzLmhhbmRsZUNsaWNrT3V0c2lkZSA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIHZhciBfYSA9IF90aGlzLnByb3BzLCBjbGVhclNlbGVjdGVkRW1haWxzID0gX2EuY2xlYXJTZWxlY3RlZEVtYWlscywgc2VsZWN0ZWRFbWFpbHMgPSBfYS5zZWxlY3RlZEVtYWlsczsKICAgICAgICAgICAgaWYgKF90aGlzLmV4cGFuZGVkVmlldyAmJiBlLnRhcmdldCAmJiAhX3RoaXMuZXhwYW5kZWRWaWV3LmNvbnRhaW5zKGUudGFyZ2V0KQogICAgICAgICAgICAgICAgJiYgc2VsZWN0ZWRFbWFpbHMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgY2xlYXJTZWxlY3RlZEVtYWlscygpOwogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5oYW5kbGVQYXJ0aWNpcGFudHNFeHBhbnNpb25Ub2dnbGUgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICB2YXIgc2VsZWN0ZWRFbWFpbHMgPSBfdGhpcy5wcm9wcy5zZWxlY3RlZEVtYWlsczsKICAgICAgICAgICAgaWYgKCFzZWxlY3RlZEVtYWlscyB8fCAhc2VsZWN0ZWRFbWFpbHMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBleHBhbmRlZDogIV90aGlzLnN0YXRlLmV4cGFuZGVkIH0pOwogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICAvLyBNYXBzIGFsbCByZWNpcGllbnRzIGludG8gc3RyaW5nCiAgICAgICAgX3RoaXMuY29sbGFwc2VkUmVjaXBpZW50cyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIG1lID0gX3RoaXMucHJvcHMubWU7CiAgICAgICAgICAgIHZhciBfYSA9IF90aGlzLnByb3BzLm1lc3NhZ2UsIHRvID0gX2EudG8sIGNjID0gX2EuY2MsIGJjYyA9IF9hLmJjYzsKICAgICAgICAgICAgdmFyIGFkZHJlc3NlcyA9IGNvbXBhY3QodG8uY29uY2F0KGNjKS5jb25jYXQoYmNjKSkubWFwKGZ1bmN0aW9uIChzdHIpIHsgcmV0dXJuIHBhcnNlQWRkcmVzcyhzdHIpOyB9KTsKICAgICAgICAgICAgcmV0dXJuIChSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImNvbGxhcHNlZCIgfSwKICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAiY29udGVudCIgfSwgcGFydGljaXBhbnRzVG9TdHJpbmcoYWRkcmVzc2VzLCBtZSkpKSk7CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5oYW5kbGVFeHBhbmRlZFJlZiA9IGZ1bmN0aW9uIChyZWYpIHsKICAgICAgICAgICAgX3RoaXMuZXhwYW5kZWRWaWV3ID0gcmVmOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlTW91c2VFbnRlciA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIHZhciB0YXJnZXQgPSBlLmN1cnJlbnRUYXJnZXQ7CiAgICAgICAgICAgIHZhciBlbWFpbCA9IHRhcmdldC5kYXRhc2V0LmVtYWlsOwogICAgICAgICAgICB2YXIgb25SZWNpcGllbnRIb3ZlciA9IF90aGlzLnByb3BzLm9uUmVjaXBpZW50SG92ZXI7CiAgICAgICAgICAgIGlmIChfdGhpcy5zdGF0ZS5leHBhbmRlZCAmJiBlbWFpbCkgewogICAgICAgICAgICAgICAgb25SZWNpcGllbnRIb3ZlcihlbWFpbCk7CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIC8vIEV4dHJhY3RzIGFsbCByZWNpcGllbnRzIGludG8gb2JqZWN0LCBhbmQgbWFwIGludG8gZXhwYW5kZWQgcGFuZXMKICAgICAgICBfdGhpcy5leHBhbmRlZFJlY2lwaWVudHMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBfYSA9IF90aGlzLnByb3BzLm1lc3NhZ2UsIFRvID0gX2EudG8sIENjID0gX2EuY2MsIEJjYyA9IF9hLmJjYzsKICAgICAgICAgICAgdmFyIF9iID0gX3RoaXMucHJvcHMsIG9uUmVjaXBpZW50Q2xpY2sgPSBfYi5vblJlY2lwaWVudENsaWNrLCBzZWxlY3RlZEVtYWlscyA9IF9iLnNlbGVjdGVkRW1haWxzOwogICAgICAgICAgICB2YXIgcmVjaXBpZW50cyA9IHsKICAgICAgICAgICAgICAgIFRvOiBUbywKICAgICAgICAgICAgICAgIENjOiBDYywKICAgICAgICAgICAgICAgIEJjYzogQmNjLAogICAgICAgICAgICB9OwogICAgICAgICAgICByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAiZXhwYW5kZWQtdmlldyIsIHJlZjogX3RoaXMuaGFuZGxlRXhwYW5kZWRSZWYgfSwgT2JqZWN0LmtleXMocmVjaXBpZW50cykKICAgICAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKGtleSkgeyByZXR1cm4gcmVjaXBpZW50c1trZXldLmxlbmd0aCAhPT0gMDsgfSkKICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGtleSkgewogICAgICAgICAgICAgICAgcmV0dXJuIHJlY2lwaWVudHNba2V5XSAmJgogICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsga2V5OiBrZXksIGNsYXNzTmFtZTogInJlY2lwaWVudC1wYW5lIiB9LAogICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogInJlY2lwaWVudC10eXBlIiB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIjogIiksCiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHNba2V5XQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAocmVjaXBpZW50LCBpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZW1haWwgPSBwYXJzZUFkZHJlc3MocmVjaXBpZW50KS5lbWFpbDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnV0dG9uIiwgeyBrZXk6IHJlY2lwaWVudCwgY2xhc3NOYW1lOiBjbGFzc25hbWVzKCdyZWNpcGllbnQnLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZDogc2VsZWN0ZWRFbWFpbHMuaW5kZXhPZihlbWFpbCkgIT09IC0xLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSwgImRhdGEtZW1haWwiOiBlbWFpbCwgb25DbGljazogb25SZWNpcGllbnRDbGljaywgb25Nb3VzZUVudGVyOiBfdGhpcy5oYW5kbGVNb3VzZUVudGVyIH0sIGdldERpc3BsYXlOYW1lKHJlY2lwaWVudCkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCB7IGtleTogImNvbW1hIiB9LCBpICsgMSA9PT0gcmVjaXBpZW50c1trZXldLmxlbmd0aCA/ICcnIDogJywnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF07CiAgICAgICAgICAgICAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgfSkpKTsKICAgICAgICB9OwogICAgICAgIF90aGlzLnN0YXRlID0gewogICAgICAgICAgICBleHBhbmRlZDogZmFsc2UsCiAgICAgICAgfTsKICAgICAgICByZXR1cm4gX3RoaXM7CiAgICB9CiAgICBSZWNpcGllbnRzVmlldy5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmhhbmRsZUNsaWNrT3V0c2lkZSk7CiAgICB9OwogICAgUmVjaXBpZW50c1ZpZXcucHJvdG90eXBlLmNvbXBvbmVudFdpbGxVbm1vdW50ID0gZnVuY3Rpb24gKCkgewogICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oYW5kbGVDbGlja091dHNpZGUpOwogICAgfTsKICAgIFJlY2lwaWVudHNWaWV3LnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIGV4cGFuZGVkID0gdGhpcy5zdGF0ZS5leHBhbmRlZDsKICAgICAgICByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgb25DbGljazogdGhpcy5oYW5kbGVQYXJ0aWNpcGFudHNFeHBhbnNpb25Ub2dnbGUsIGNsYXNzTmFtZTogInRocmVhZC1kZXRhaWwtY2VsbC1yZWNpcGllbnRzLXZpZXciIH0sIGV4cGFuZGVkID8gdGhpcy5leHBhbmRlZFJlY2lwaWVudHMoKSA6IHRoaXMuY29sbGFwc2VkUmVjaXBpZW50cygpKSk7CiAgICB9OwogICAgcmV0dXJuIFJlY2lwaWVudHNWaWV3Owp9KFJlYWN0LlB1cmVDb21wb25lbnQpKTsKZXhwb3J0IGRlZmF1bHQgUmVjaXBpZW50c1ZpZXc7Cg=="},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/ThreadDetail/components/Cell/ExpandedCell/components/RecipientsView.tsx","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/ThreadDetail/components/Cell/ExpandedCell/components/RecipientsView.tsx"],"names":[],"mappings":"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","sourcesContent":["import React from 'react';\nimport classnames from 'classnames';\nimport { compact } from 'lodash';\nimport { parseAddress, participantsToString, getDisplayName } from '@src/lib/address';\nimport { Message, Me } from '@src/types';\n\nimport './RecipientsView.scss';\n\ninterface State {\n  expanded: boolean;\n}\n\ninterface Props {\n  message: Message;\n  onRecipientClick: (e: React.SyntheticEvent<HTMLButtonElement>) => void;\n  onRecipientHover: (email: string) => void;\n  me?: Me;\n  selectedEmails: string[];\n  clearSelectedEmails: () => void;\n}\n\nclass RecipientsView extends React.PureComponent<Props, State> {\n  private expandedView: HTMLDivElement;\n\n  constructor() {\n    super();\n\n    this.state = {\n      expanded: false,\n    };\n  }\n\n  componentDidMount() {\n    document.addEventListener('click', this.handleClickOutside);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('click', this.handleClickOutside);\n  }\n\n  handleClickOutside = (e: MouseEvent) => {\n    const { clearSelectedEmails, selectedEmails } = this.props;\n    if (this.expandedView && e.target && !this.expandedView.contains(e.target as HTMLElement)\n      && selectedEmails.length) {\n      e.stopPropagation();\n      e.preventDefault();\n      clearSelectedEmails();\n    }\n  }\n\n  handleParticipantsExpansionToggle = (e: React.MouseEvent<HTMLDivElement>) => {\n    const { selectedEmails } = this.props;\n\n    if (!selectedEmails || !selectedEmails.length) {\n      e.stopPropagation();\n      this.setState({ expanded: !this.state.expanded });\n    }\n  }\n\n  // Maps all recipients into string\n  collapsedRecipients = () => {\n    const { me } = this.props;\n    const { to, cc, bcc } = this.props.message;\n    const addresses = compact(to.concat(cc).concat(bcc)).map(str => parseAddress(str));\n\n    return (\n      <div className=\"collapsed\">\n        <div className=\"content\">\n          {participantsToString(addresses, me)}\n        </div>\n      </div>\n    );\n  }\n\n  handleExpandedRef = (ref: HTMLDivElement) => {\n    this.expandedView = ref;\n  }\n\n  handleMouseEnter = (e: React.SyntheticEvent<HTMLButtonElement>) => {\n    const target = e.currentTarget;\n    const email = target.dataset.email;\n    const { onRecipientHover } = this.props;\n\n    if (this.state.expanded && email) {\n      onRecipientHover(email);\n    }\n  }\n\n  // Extracts all recipients into object, and map into expanded panes\n  expandedRecipients = () => {\n    const { to: To, cc: Cc, bcc: Bcc } = this.props.message;\n    const { onRecipientClick, selectedEmails } = this.props;\n    const recipients = {\n      To,\n      Cc,\n      Bcc,\n    };\n\n    return (\n      <div className=\"expanded-view\" ref={this.handleExpandedRef}>\n        {Object.keys(recipients)\n          .filter(key => recipients[key].length !== 0)\n          .map(key =>\n          recipients[key] &&\n            <div key={key} className=\"recipient-pane\">\n              <div className=\"recipient-type\">{key}: </div>\n              {recipients[key]\n                .map((recipient: string, i: number) => {\n                  const email = parseAddress(recipient).email;\n                  return [\n                    <button\n                      key={recipient}\n                      className={classnames('recipient', {\n                        selected: selectedEmails.indexOf(email) !== -1,\n                      })}\n                      data-email={email}\n                      onClick={onRecipientClick}\n                      onMouseEnter={this.handleMouseEnter}\n                    >\n                      {getDisplayName(recipient)}\n                    </button>,\n                    <span key=\"comma\">\n                      {i + 1 === recipients[key].length ? '' : ','}\n                    </span>,\n                  ];\n                })}\n          </div>,\n        )}\n      </div>\n    );\n  }\n\n  render() {\n    const { expanded } = this.state;\n\n    return (\n      <div\n        onClick={this.handleParticipantsExpansionToggle}\n        className=\"thread-detail-cell-recipients-view\"\n      >\n        {expanded ? this.expandedRecipients() : this.collapsedRecipients()}\n      </div>\n    );\n  }\n}\n\nexport default RecipientsView;\n"]}]}