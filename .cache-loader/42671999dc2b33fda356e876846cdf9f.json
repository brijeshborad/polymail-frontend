{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/ThreadDetail/components/ShareThreadPopover/components/ShareToSlack/components/SlackShareDropdown/SlackShareDropdown.tsx","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/ThreadDetail/components/ShareThreadPopover/components/ShareToSlack/components/SlackShareDropdown/SlackShareDropdown.tsx","mtime":1675280254044},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewogICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewogICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAogICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKICAgIH07CiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwogICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQogICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKICAgIH07Cn0pKCk7CmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7CmltcG9ydCB7IGZpbmRJbmRleCB9IGZyb20gJ2xvZGFzaCc7CmltcG9ydCBjbGFzc25hbWVzIGZyb20gJ2NsYXNzbmFtZXMnOwppbXBvcnQgRGlzY2xvc3VyZSBmcm9tICdAc3JjL2NvbXBvbmVudHMvSWNvbnMvRGlzY2xvc3VyZS5zdmcnOwppbXBvcnQgUG9wb3ZlciBmcm9tICdAc3JjL2NvbXBvbmVudHMvUG9wb3Zlci9Qb3BvdmVyJzsKaW1wb3J0IFNlYXJjaCBmcm9tICdAc3JjL2NvbXBvbmVudHMvSWNvbnMvU2VhcmNoLnN2Zyc7CmltcG9ydCAnLi9TbGFja1NoYXJlRHJvcGRvd24uc2Nzcyc7CmltcG9ydCBEcm9wZG93bkl0ZW0gZnJvbSAnQHNyYy9jb21wb25lbnRzL0Zvcm0vRHJvcGRvd25JdGVtJzsKaW1wb3J0IHsgS2V5Q29kZSB9IGZyb20gJ0BzcmMvdHlwZXMnOwpleHBvcnQgdmFyIFNlbGVjdGlvblR5cGU7CihmdW5jdGlvbiAoU2VsZWN0aW9uVHlwZSkgewogICAgU2VsZWN0aW9uVHlwZVsiQ2hhbm5lbCJdID0gImNoYW5uZWwiOwogICAgU2VsZWN0aW9uVHlwZVsiTWVtYmVyIl0gPSAibWVtYmVyIjsKfSkoU2VsZWN0aW9uVHlwZSB8fCAoU2VsZWN0aW9uVHlwZSA9IHt9KSk7CnZhciBTbGFja1NoYXJlRHJvcGRvd24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoU2xhY2tTaGFyZURyb3Bkb3duLCBfc3VwZXIpOwogICAgZnVuY3Rpb24gU2xhY2tTaGFyZURyb3Bkb3duKHByb3BzKSB7CiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpczsKICAgICAgICBfdGhpcy5oYW5kbGVDbGlja091dHNpZGUgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICB2YXIgcG9wb3ZlclNob3duID0gX3RoaXMuc3RhdGUucG9wb3ZlclNob3duOwogICAgICAgICAgICBpZiAoX3RoaXMucmVmICYmIF90aGlzLnBvcG92ZXIgJiYgIV90aGlzLnJlZi5jb250YWlucyhlLnRhcmdldCkgJiYgcG9wb3ZlclNob3duKSB7CiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgX3RoaXMucG9wb3Zlci5oaWRlKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIF90aGlzLmhhbmRsZVBvcG92ZXJSZWYgPSBmdW5jdGlvbiAocmVmKSB7CiAgICAgICAgICAgIF90aGlzLnBvcG92ZXIgPSByZWY7CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5zaG93UG9wb3ZlciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgaWYgKF90aGlzLnBvcG92ZXIpIHsKICAgICAgICAgICAgICAgIF90aGlzLnBvcG92ZXIuc2hvdygpOwogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5oYW5kbGVPcGVuID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgdmFyIHBvcG92ZXJTaG93biA9IF90aGlzLnN0YXRlLnBvcG92ZXJTaG93bjsKICAgICAgICAgICAgaWYgKCFwb3BvdmVyU2hvd24pIHsKICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgICAgIF90aGlzLnNob3dQb3BvdmVyKCk7CiAgICAgICAgICAgICAgICBfdGhpcy5mb2N1c0lucHV0KCk7CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIF90aGlzLm9uU2VsZWN0ID0gZnVuY3Rpb24gKHZhbHVlLCBpbmRleCkgewogICAgICAgICAgICB2YXIgY2hhbm5lbHMgPSBfdGhpcy5wcm9wcy5jaGFubmVsczsKICAgICAgICAgICAgaWYgKCFjaGFubmVscy5kYXRhKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdmFyIG9yaWdpbmFsSW5kZXggPSBjaGFubmVscy5kYXRhLm1hcChmdW5jdGlvbiAoY2hhbm5lbCkgeyByZXR1cm4gY2hhbm5lbC5uYW1lOyB9KS5pbmRleE9mKHZhbHVlKTsKICAgICAgICAgICAgaWYgKF90aGlzLnBvcG92ZXIpIHsKICAgICAgICAgICAgICAgIF90aGlzLnBvcG92ZXIuaGlkZSgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIHJlc2V0IHZhbHVlcyBvbiBzZWxlY3QKICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgc2VsZWN0ZWQ6IHsgaW5kZXg6IG9yaWdpbmFsSW5kZXgsIHR5cGU6IFNlbGVjdGlvblR5cGUuQ2hhbm5lbCB9LAogICAgICAgICAgICAgICAgY2hhbm5lbHM6IGNoYW5uZWxzLmRhdGEsCiAgICAgICAgICAgICAgICBxdWVyeTogJycsCiAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIF90aGlzLmZvY3VzSW5wdXQodHJ1ZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBfdGhpcy5wcm9wcy5vblNlbGVjdChjaGFubmVscy5kYXRhW29yaWdpbmFsSW5kZXhdLmlkLCBvcmlnaW5hbEluZGV4LCBTZWxlY3Rpb25UeXBlLkNoYW5uZWwpOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlSW5wdXRSZWYgPSBmdW5jdGlvbiAocmVmKSB7CiAgICAgICAgICAgIF90aGlzLmlucHV0ID0gcmVmOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuZm9jdXNJbnB1dCA9IGZ1bmN0aW9uICh0aHJvd0ZvY3VzVG9FbmQpIHsKICAgICAgICAgICAgX3RoaXMudGltZW91dCA9IGdsb2JhbC5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIF90aGlzLmlucHV0LmZvY3VzKCk7CiAgICAgICAgICAgICAgICAvLyBzZXQgY3Vyc29yIHRvIGVuZAogICAgICAgICAgICAgICAgaWYgKHRocm93Rm9jdXNUb0VuZCkgewogICAgICAgICAgICAgICAgICAgIHZhciBsZW5ndGggPSBfdGhpcy5pbnB1dC52YWx1ZS5sZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMuaW5wdXQuc2V0U2VsZWN0aW9uUmFuZ2UobGVuZ3RoLCBsZW5ndGgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCAwKTsKICAgICAgICB9OwogICAgICAgIF90aGlzLmhhbmRsZUlucHV0Rm9jdXMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBwb3BvdmVyU2hvd24gPSBfdGhpcy5zdGF0ZS5wb3BvdmVyU2hvd247CiAgICAgICAgICAgIGlmICghcG9wb3ZlclNob3duICYmIF90aGlzLmlucHV0ICYmICFfdGhpcy5pbnB1dC52YWx1ZSkgewogICAgICAgICAgICAgICAgX3RoaXMuc2hvd1BvcG92ZXIoKTsKICAgICAgICAgICAgICAgIF90aGlzLmZvY3VzSW5wdXQoKTsKICAgICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlSW5wdXRDaGFuZ2UgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICB2YXIgX2EgPSBfdGhpcy5wcm9wcywgY2hhbm5lbHMgPSBfYS5jaGFubmVscywgbWVtYmVycyA9IF9hLm1lbWJlcnM7CiAgICAgICAgICAgIHZhciBxdWVyeSA9IF90aGlzLmlucHV0LnZhbHVlOwogICAgICAgICAgICB2YXIgc3RhcnQgPSBfdGhpcy5pbnB1dC5zZWxlY3Rpb25TdGFydDsKICAgICAgICAgICAgdmFyIGVuZCA9IF90aGlzLmlucHV0LnNlbGVjdGlvbkVuZDsKICAgICAgICAgICAgdmFyIG1hdGNoZWRDaGFubmVsczsKICAgICAgICAgICAgdmFyIG1hdGNoZWRNZW1iZXJzOwogICAgICAgICAgICBpZiAoIWNoYW5uZWxzLmRhdGEgfHwgcXVlcnkuc3RhcnRzV2l0aCgnQCcpKSB7CiAgICAgICAgICAgICAgICBtYXRjaGVkQ2hhbm5lbHMgPSBbXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoIW1lbWJlcnMuZGF0YSB8fCBxdWVyeS5zdGFydHNXaXRoKCcjJykpIHsKICAgICAgICAgICAgICAgIG1hdGNoZWRNZW1iZXJzID0gW107CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdmFyIG1hdGNoID0gJyc7CiAgICAgICAgICAgIGlmICghbWF0Y2hlZENoYW5uZWxzICYmIGNoYW5uZWxzLmRhdGEpIHsKICAgICAgICAgICAgICAgIG1hdGNoID0gcXVlcnkuc3RhcnRzV2l0aCgnIycpID8gcXVlcnkuc2xpY2UoMSkudG9Mb3dlckNhc2UoKSA6IHF1ZXJ5LnRvTG93ZXJDYXNlKCk7CiAgICAgICAgICAgICAgICBtYXRjaGVkQ2hhbm5lbHMgPSBjaGFubmVscy5kYXRhCiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAodmFsKSB7IHJldHVybiAhIXZhbC5uYW1lLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aChtYXRjaCk7IH0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghbWF0Y2hlZE1lbWJlcnMgJiYgbWVtYmVycy5kYXRhKSB7CiAgICAgICAgICAgICAgICBtYXRjaCA9IHF1ZXJ5LnN0YXJ0c1dpdGgoJ0AnKSA/IHF1ZXJ5LnNsaWNlKDEpLnRvTG93ZXJDYXNlKCkgOiBxdWVyeS50b0xvd2VyQ2FzZSgpOwogICAgICAgICAgICAgICAgbWF0Y2hlZE1lbWJlcnMgPSBtZW1iZXJzLmRhdGEKICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uICh2YWwpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gISF2YWwucmVhbE5hbWUudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKG1hdGNoKSB8fAogICAgICAgICAgICAgICAgICAgICAgICAhIXZhbC5kaXNwbGF5TmFtZS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgobWF0Y2gpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gY2xlYXIgc2VsZWN0aW9uIGluZGV4IG9uIHNlYXJjaAogICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICBxdWVyeTogcXVlcnksCiAgICAgICAgICAgICAgICBjaGFubmVsczogbWF0Y2hlZENoYW5uZWxzIHx8IFtdLAogICAgICAgICAgICAgICAgbWVtYmVyczogbWF0Y2hlZE1lbWJlcnMgfHwgW10sCiAgICAgICAgICAgICAgICBzZWxlY3RlZDogdW5kZWZpbmVkLAogICAgICAgICAgICAgICAgc2VsZWN0ZWRJbmRleDogX3RoaXMuc3RhdGUubW91c2VJblBvcG92ZXIgPyBfdGhpcy5zdGF0ZS5zZWxlY3RlZEluZGV4IDogMCwKICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgaWYgKCFfdGhpcy5zdGF0ZS5wb3BvdmVyU2hvd24pIHsKICAgICAgICAgICAgICAgICAgICBfdGhpcy5zaG93UG9wb3ZlcigpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKHN0YXJ0ICYmIGVuZCkgewogICAgICAgICAgICAgICAgICAgIF90aGlzLmlucHV0LnNldFNlbGVjdGlvblJhbmdlKHN0YXJ0LCBlbmQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgX3RoaXMuZm9jdXNJbnB1dCgpOwogICAgICAgICAgICB9KTsKICAgICAgICB9OwogICAgICAgIF90aGlzLmhhbmRsZUVudGVyID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgX2EgPSBfdGhpcy5zdGF0ZSwgc2VsZWN0ZWRJbmRleCA9IF9hLnNlbGVjdGVkSW5kZXgsIHBvcG92ZXJTaG93biA9IF9hLnBvcG92ZXJTaG93biwgY2hhbm5lbHMgPSBfYS5jaGFubmVscywgbWVtYmVycyA9IF9hLm1lbWJlcnM7CiAgICAgICAgICAgIHZhciBvcmlnaW5hbENoYW5uZWxzID0gX3RoaXMucHJvcHMuY2hhbm5lbHM7CiAgICAgICAgICAgIHZhciBvcmlnaW5hbE1lbWJlcnMgPSBfdGhpcy5wcm9wcy5tZW1iZXJzOwogICAgICAgICAgICBpZiAocG9wb3ZlclNob3duKSB7CiAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWRJbmRleCA8IGNoYW5uZWxzLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIHZhciBjaGFubmVsSXRlbSA9IGNoYW5uZWxzW3NlbGVjdGVkSW5kZXhdOwogICAgICAgICAgICAgICAgICAgIGlmIChjaGFubmVsSXRlbSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW9yaWdpbmFsQ2hhbm5lbHMuZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvcmlnaW5hbEluZGV4ID0gZmluZEluZGV4KG9yaWdpbmFsQ2hhbm5lbHMuZGF0YSwgeyBpZDogY2hhbm5lbEl0ZW0uaWQgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvcmlnaW5hbEl0ZW0gPSBvcmlnaW5hbENoYW5uZWxzLmRhdGFbb3JpZ2luYWxJbmRleF07CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcmlnaW5hbEl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnBvcG92ZXIuaGlkZSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOiB7IGluZGV4OiBvcmlnaW5hbEluZGV4LCB0eXBlOiBTZWxlY3Rpb25UeXBlLkNoYW5uZWwgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeTogJycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbm5lbHM6IG9yaWdpbmFsQ2hhbm5lbHMuZGF0YSB8fCBbXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZW1iZXJzOiBvcmlnaW5hbE1lbWJlcnMuZGF0YSB8fCBbXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5mb2N1c0lucHV0KHRydWUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5wcm9wcy5vblNlbGVjdChvcmlnaW5hbEl0ZW0uaWQsIG9yaWdpbmFsSW5kZXgsIFNlbGVjdGlvblR5cGUuQ2hhbm5lbCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB2YXIgbWVtYmVySXRlbSA9IG1lbWJlcnNbc2VsZWN0ZWRJbmRleCAtIGNoYW5uZWxzLmxlbmd0aF07CiAgICAgICAgICAgICAgICAgICAgaWYgKG1lbWJlckl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFvcmlnaW5hbE1lbWJlcnMuZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvcmlnaW5hbEluZGV4ID0gZmluZEluZGV4KG9yaWdpbmFsTWVtYmVycy5kYXRhLCB7IGlkOiBtZW1iZXJJdGVtLmlkIH0pOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3JpZ2luYWxJdGVtID0gb3JpZ2luYWxNZW1iZXJzLmRhdGFbb3JpZ2luYWxJbmRleF07CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcmlnaW5hbEl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnBvcG92ZXIuaGlkZSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOiB7IGluZGV4OiBvcmlnaW5hbEluZGV4LCB0eXBlOiBTZWxlY3Rpb25UeXBlLk1lbWJlciB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5OiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFubmVsczogb3JpZ2luYWxDaGFubmVscy5kYXRhIHx8IFtdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lbWJlcnM6IG9yaWdpbmFsTWVtYmVycy5kYXRhIHx8IFtdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmZvY3VzSW5wdXQodHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnByb3BzLm9uU2VsZWN0KG9yaWdpbmFsSXRlbS5pZCwgb3JpZ2luYWxJbmRleCwgU2VsZWN0aW9uVHlwZS5NZW1iZXIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucG9wb3Zlci5oaWRlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIF90aGlzLmhhbmRsZUtleURvd24gPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICB2YXIgX2EgPSBfdGhpcy5zdGF0ZSwgY2hhbm5lbHMgPSBfYS5jaGFubmVscywgbWVtYmVycyA9IF9hLm1lbWJlcnMsIHBvcG92ZXJTaG93biA9IF9hLnBvcG92ZXJTaG93bjsKICAgICAgICAgICAgdmFyIGhhbmRsZWQgPSBmYWxzZTsKICAgICAgICAgICAgc3dpdGNoIChlLmtleUNvZGUpIHsKICAgICAgICAgICAgICAgIGNhc2UgS2V5Q29kZS5VcDoKICAgICAgICAgICAgICAgICAgICB2YXIgcHJldmlvdXNJbmRleCA9IF90aGlzLnN0YXRlLnNlbGVjdGVkSW5kZXggLSAxOwogICAgICAgICAgICAgICAgICAgIGhhbmRsZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIGlmIChwcmV2aW91c0luZGV4IDwgMCkgewogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBzZWxlY3RlZEluZGV4OiBwcmV2aW91c0luZGV4IH0pOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBLZXlDb2RlLkRvd246CiAgICAgICAgICAgICAgICAgICAgaGFuZGxlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgdmFyIG5leHRJbmRleCA9IF90aGlzLnN0YXRlLnNlbGVjdGVkSW5kZXggKyAxOwogICAgICAgICAgICAgICAgICAgIGlmIChuZXh0SW5kZXggPj0gKGNoYW5uZWxzLmxlbmd0aCArIG1lbWJlcnMubGVuZ3RoKSkgewogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBzZWxlY3RlZEluZGV4OiBuZXh0SW5kZXggfSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIEtleUNvZGUuRW50ZXI6CiAgICAgICAgICAgICAgICAgICAgaGFuZGxlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMuaGFuZGxlRW50ZXIoKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgS2V5Q29kZS5UYWI6CiAgICAgICAgICAgICAgICAgICAgaWYgKHBvcG92ZXJTaG93bikgewogICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5wb3BvdmVyLmhpZGUoKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIEtleUNvZGUuRXNjOgogICAgICAgICAgICAgICAgICAgIGhhbmRsZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIF90aGlzLnBvcG92ZXIuaGlkZSgpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgZGVmYXVsdDogYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGhhbmRsZWQpIHsKICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIF90aGlzLmhhbmRsZVBvcG92ZXJTaG93ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IHBvcG92ZXJTaG93bjogdHJ1ZSB9KTsKICAgICAgICB9OwogICAgICAgIF90aGlzLmhhbmRsZVBvcG92ZXJIaWRlID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IHBvcG92ZXJTaG93bjogZmFsc2UgfSk7CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5oYW5kbGVSZWYgPSBmdW5jdGlvbiAocmVmKSB7CiAgICAgICAgICAgIF90aGlzLnJlZiA9IHJlZjsKICAgICAgICB9OwogICAgICAgIF90aGlzLmhhbmRsZU1lbWJlclNlbGVjdCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIHZhciBfYSA9IF90aGlzLnByb3BzLCBtZW1iZXJzID0gX2EubWVtYmVycywgY2hhbm5lbHMgPSBfYS5jaGFubmVsczsKICAgICAgICAgICAgaWYgKCFtZW1iZXJzLmRhdGEpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICB2YXIgaWQgPSBlLmN1cnJlbnRUYXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLW1lbWJlcicpOwogICAgICAgICAgICBpZiAoX3RoaXMucG9wb3ZlcikgewogICAgICAgICAgICAgICAgX3RoaXMucG9wb3Zlci5oaWRlKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGlkKSB7CiAgICAgICAgICAgICAgICB2YXIgb3JpZ2luYWxJbmRleCA9IG1lbWJlcnMuZGF0YS5maW5kSW5kZXgoZnVuY3Rpb24gKG0pIHsgcmV0dXJuIG0uaWQgPT09IGlkOyB9KTsKICAgICAgICAgICAgICAgIC8vIHJlc2V0IHZhbHVlcyBvbiBzZWxlY3QKICAgICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZDogeyBpbmRleDogb3JpZ2luYWxJbmRleCwgdHlwZTogU2VsZWN0aW9uVHlwZS5NZW1iZXIgfSwKICAgICAgICAgICAgICAgICAgICBtZW1iZXJzOiBtZW1iZXJzLmRhdGEsCiAgICAgICAgICAgICAgICAgICAgY2hhbm5lbHM6IGNoYW5uZWxzLmRhdGEgfHwgW10sCiAgICAgICAgICAgICAgICAgICAgcXVlcnk6ICcnLAogICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIF90aGlzLmZvY3VzSW5wdXQodHJ1ZSk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIF90aGlzLnByb3BzLm9uU2VsZWN0KGlkLCBvcmlnaW5hbEluZGV4LCBTZWxlY3Rpb25UeXBlLk1lbWJlcik7CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIF90aGlzLmhhbmRsZU1vdXNlRW50ZXIgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICB2YXIgX2EgPSBfdGhpcy5zdGF0ZSwgY2hhbm5lbHMgPSBfYS5jaGFubmVscywgbWVtYmVycyA9IF9hLm1lbWJlcnM7CiAgICAgICAgICAgIHZhciBtZW1iZXJJZCA9IGUuY3VycmVudFRhcmdldC5kYXRhc2V0Lm1lbWJlcjsKICAgICAgICAgICAgdmFyIGNoYW5uZWxJZCA9IGUuY3VycmVudFRhcmdldC5kYXRhc2V0Lmxvb2t1cDsKICAgICAgICAgICAgaWYgKGNoYW5uZWxJZCkgewogICAgICAgICAgICAgICAgdmFyIGNoYW5uZWxJbmRleCA9IGZpbmRJbmRleChjaGFubmVscywgeyBpZDogY2hhbm5lbElkIH0pOwogICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBzZWxlY3RlZEluZGV4OiBjaGFubmVsSW5kZXgsIG1vdXNlSW5Qb3BvdmVyOiB0cnVlIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChtZW1iZXJJZCkgewogICAgICAgICAgICAgICAgdmFyIG1lbWJlckluZGV4ID0gZmluZEluZGV4KG1lbWJlcnMsIHsgaWQ6IG1lbWJlcklkIH0pOwogICAgICAgICAgICAgICAgdmFyIHVwZGF0ZWRJbmRleCA9IG1lbWJlckluZGV4ICsgY2hhbm5lbHMubGVuZ3RoOwogICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBzZWxlY3RlZEluZGV4OiB1cGRhdGVkSW5kZXgsIG1vdXNlSW5Qb3BvdmVyOiB0cnVlIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5oYW5kbGVNb3VzZUxlYXZlID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICBtb3VzZUluUG9wb3ZlcjogZmFsc2UsCiAgICAgICAgICAgIH0pOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuc3RhdGUgPSB7CiAgICAgICAgICAgIHF1ZXJ5OiAnJywKICAgICAgICAgICAgY2hhbm5lbHM6IHByb3BzLmNoYW5uZWxzLmRhdGEgfHwgW10sCiAgICAgICAgICAgIG1lbWJlcnM6IHByb3BzLm1lbWJlcnMuZGF0YSB8fCBbXSwKICAgICAgICAgICAgcG9wb3ZlclNob3duOiBmYWxzZSwKICAgICAgICAgICAgc2VsZWN0ZWRJbmRleDogMCwKICAgICAgICAgICAgbW91c2VJblBvcG92ZXI6IGZhbHNlLAogICAgICAgIH07CiAgICAgICAgcmV0dXJuIF90aGlzOwogICAgfQogICAgU2xhY2tTaGFyZURyb3Bkb3duLnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLmhhbmRsZUNsaWNrT3V0c2lkZSk7CiAgICAgICAgdGhpcy5oYW5kbGVJbnB1dEZvY3VzKCk7CiAgICB9OwogICAgU2xhY2tTaGFyZURyb3Bkb3duLnByb3RvdHlwZS5jb21wb25lbnRXaWxsVW5tb3VudCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLmhhbmRsZUNsaWNrT3V0c2lkZSk7CiAgICB9OwogICAgU2xhY2tTaGFyZURyb3Bkb3duLnByb3RvdHlwZS5VTlNBRkVfY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyA9IGZ1bmN0aW9uIChuZXh0UHJvcHMpIHsKICAgICAgICBpZiAobmV4dFByb3BzLmNoYW5uZWxzICE9PSB0aGlzLnByb3BzLmNoYW5uZWxzIHx8IG5leHRQcm9wcy5tZW1iZXJzICE9PSB0aGlzLnByb3BzLm1lbWJlcnMpIHsKICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICBjaGFubmVsczogbmV4dFByb3BzLmNoYW5uZWxzLmRhdGEgfHwgW10sCiAgICAgICAgICAgICAgICBtZW1iZXJzOiBuZXh0UHJvcHMubWVtYmVycy5kYXRhIHx8IFtdLAogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9OwogICAgU2xhY2tTaGFyZURyb3Bkb3duLnByb3RvdHlwZS5jb21wb25lbnREaWRVcGRhdGUgPSBmdW5jdGlvbiAob2xkUHJvcHMsIG9sZFN0YXRlKSB7CiAgICAgICAgdmFyIG9sZFNlbGVjdGVkSW5kZXggPSBvbGRTdGF0ZS5zZWxlY3RlZEluZGV4OwogICAgICAgIHZhciBfYSA9IHRoaXMuc3RhdGUsIHNlbGVjdGVkSW5kZXggPSBfYS5zZWxlY3RlZEluZGV4LCBjaGFubmVscyA9IF9hLmNoYW5uZWxzOwogICAgICAgIHZhciBjZWxsSGVpZ2h0ID0gMzU7CiAgICAgICAgaWYgKG9sZFNlbGVjdGVkSW5kZXggIT09IHNlbGVjdGVkSW5kZXgpIHsKICAgICAgICAgICAgdmFyIGxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZm9ybS1kcm9wZG93bi1wb3BvdmVyJyk7CiAgICAgICAgICAgIGlmIChsaXN0ICYmIGxpc3QgaW5zdGFuY2VvZiBIVE1MRGl2RWxlbWVudCkgewogICAgICAgICAgICAgICAgdmFyIGxpc3RIZWlnaHQgPSBsaXN0Lm9mZnNldEhlaWdodDsKICAgICAgICAgICAgICAgIHZhciBoZWFkZXJIZWlnaHQgPSBzZWxlY3RlZEluZGV4ID4gY2hhbm5lbHMubGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgPyA3MAogICAgICAgICAgICAgICAgICAgIDogMzU7CiAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgY2VsbCBhbmQgbGlzdCBwb3NpdGlvbnMKICAgICAgICAgICAgICAgIHZhciBjZWxsVG9wID0gY2VsbEhlaWdodCAqIChzZWxlY3RlZEluZGV4KSArIGhlYWRlckhlaWdodDsKICAgICAgICAgICAgICAgIHZhciBjZWxsQm90dG9tID0gaGVhZGVySGVpZ2h0ICsgY2VsbEhlaWdodCArIChjZWxsSGVpZ2h0KSAqIHNlbGVjdGVkSW5kZXg7CiAgICAgICAgICAgICAgICB2YXIgbGlzdFRvcCA9IGxpc3Quc2Nyb2xsVG9wOwogICAgICAgICAgICAgICAgdmFyIGxpc3RCb3R0b20gPSBsaXN0LnNjcm9sbFRvcCArIGxpc3RIZWlnaHQ7CiAgICAgICAgICAgICAgICAvLyBJZiBvdXRzaWRlIG9mIHRvcCByYW5nZSwgdGhlbiBzZXQgc2Nyb2xsVG9wIHRvIGNlbGwgdG9wCiAgICAgICAgICAgICAgICBpZiAoY2VsbFRvcCA8IGxpc3RUb3ApIHsKICAgICAgICAgICAgICAgICAgICBsaXN0LnNjcm9sbFRvcCA9IGNlbGxUb3A7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gSWYgYm90dG9tIG91dHNpZGUgb2YgbGlzdCBib3R0b20gcmFuZ2UgdGhlbiByZXNldCBzY3JvbGxUb3AKICAgICAgICAgICAgICAgIGlmIChjZWxsQm90dG9tID4gbGlzdEJvdHRvbSkgewogICAgICAgICAgICAgICAgICAgIGxpc3Quc2Nyb2xsVG9wID0gY2VsbEJvdHRvbSAtIGxpc3RIZWlnaHQ7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfTsKICAgIFNsYWNrU2hhcmVEcm9wZG93bi5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgICAgdmFyIHBsYWNlaG9sZGVyID0gdGhpcy5wcm9wcy5wbGFjZWhvbGRlcjsKICAgICAgICB2YXIgX2EgPSB0aGlzLnN0YXRlLCBxdWVyeSA9IF9hLnF1ZXJ5LCBjaGFubmVscyA9IF9hLmNoYW5uZWxzLCBzZWxlY3RlZCA9IF9hLnNlbGVjdGVkLCBtZW1iZXJzID0gX2EubWVtYmVyczsKICAgICAgICByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAic2xhY2stc2hhcmUtZHJvcGRvd24iLCByZWY6IHRoaXMuaGFuZGxlUmVmIH0sCiAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgb25DbGljazogdGhpcy5oYW5kbGVPcGVuLCBjbGFzc05hbWU6ICJzZWxlY3QiIH0sCiAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KFNlYXJjaCwgeyBjbGFzc05hbWU6ICJzZWFyY2giIH0pLAogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiaW5wdXQiLCB7IGRpcjogImF1dG8iLCBjbGFzc05hbWU6ICJpbnB1dCIsIGtleTogIiIgKyB0aGlzLnN0YXRlLnNlbGVjdGVkLCB2YWx1ZTogIXF1ZXJ5ICYmIHNlbGVjdGVkID8KICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQudHlwZSA9PT0gU2VsZWN0aW9uVHlwZS5DaGFubmVsID8KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5uZWxzW3NlbGVjdGVkLmluZGV4XS5uYW1lIDogbWVtYmVyc1tzZWxlY3RlZC5pbmRleF0ucmVhbE5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgOiB1bmRlZmluZWQsIAogICAgICAgICAgICAgICAgICAgIC8vIGRlZmF1bHRWYWx1ZT17cXVlcnl9CiAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U6IHRoaXMuaGFuZGxlSW5wdXRDaGFuZ2UsIHBsYWNlaG9sZGVyOiBwbGFjZWhvbGRlciwgcmVmOiB0aGlzLmhhbmRsZUlucHV0UmVmLCBvbktleURvd246IHRoaXMuaGFuZGxlS2V5RG93biwgb25Gb2N1czogdGhpcy5oYW5kbGVJbnB1dEZvY3VzLCB0YWJJbmRleDogMCwgYXV0b0ZvY3VzOiB0cnVlIH0pLAogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChEaXNjbG9zdXJlLCB7IGNsYXNzTmFtZTogImRpc2Nsb3N1cmUiIH0pKSwKICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChQb3BvdmVyLCB7IGNsYXNzTmFtZTogImZvcm0tZHJvcGRvd24tcG9wb3ZlciIsIHJlZjogdGhpcy5oYW5kbGVQb3BvdmVyUmVmLCBvblNob3c6IHRoaXMuaGFuZGxlUG9wb3ZlclNob3csIG9uSGlkZTogdGhpcy5oYW5kbGVQb3BvdmVySGlkZSwgb25LZXlEb3duOiB0aGlzLmhhbmRsZUtleURvd24sIG9uTW91c2VMZWF2ZTogdGhpcy5oYW5kbGVNb3VzZUxlYXZlLCBwZXJzaXN0ZW50OiB0cnVlIH0sCiAgICAgICAgICAgICAgICAhIWNoYW5uZWxzLmxlbmd0aCAmJiBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImNoYW5uZWwgdGl0bGUiIH0sICJDaGFubmVscyIpLAogICAgICAgICAgICAgICAgY2hhbm5lbHMubWFwKGZ1bmN0aW9uICh2YWwsIGkpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gUmVhY3QuY3JlYXRlRWxlbWVudChEcm9wZG93bkl0ZW0sIHsga2V5OiB2YWwuaWQsIGxvb2t1cDogdmFsLmlkLCBpbmRleDogaSwgdmFsdWU6IHZhbC5uYW1lLCBvbkNsaWNrOiBfdGhpcy5vblNlbGVjdCwgY2xhc3NOYW1lOiBfdGhpcy5zdGF0ZS5zZWxlY3RlZEluZGV4ID09PSBpICYmICdzZWxlY3RlZCcgfHwgdW5kZWZpbmVkLCBvbk1vdXNlRW50ZXI6IF90aGlzLmhhbmRsZU1vdXNlRW50ZXIgfSk7CiAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgICEhbWVtYmVycy5sZW5ndGggJiYgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJwZW9wbGUgdGl0bGUiIH0sICJQZW9wbGUiKSwKICAgICAgICAgICAgICAgIG1lbWJlcnMubWFwKGZ1bmN0aW9uIChtZW1iZXIsIGkpIHsgcmV0dXJuIChSZWFjdC5jcmVhdGVFbGVtZW50KCJidXR0b24iLCB7IGNsYXNzTmFtZTogY2xhc3NuYW1lcygnbWVtYmVyJywgeyBzZWxlY3RlZDogX3RoaXMuc3RhdGUuc2VsZWN0ZWRJbmRleCAtIGNoYW5uZWxzLmxlbmd0aCA9PT0gaSB9KSwgImRhdGEtbWVtYmVyIjogbWVtYmVyLmlkLCBrZXk6IGksIG9uQ2xpY2s6IF90aGlzLmhhbmRsZU1lbWJlclNlbGVjdCwgb25Nb3VzZUVudGVyOiBfdGhpcy5oYW5kbGVNb3VzZUVudGVyLCB0YWJJbmRleDogLTEgfSwKICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgeyBjbGFzc05hbWU6ICJhdmF0YXIiIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImltZyIsIHsgc3JjOiBtZW1iZXIucGhvdG9VcmwgfSkpLAogICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCB7IGNsYXNzTmFtZTogInJlYWwtbmFtZSIgfSwgbWVtYmVyLnJlYWxOYW1lKSwKICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgeyBjbGFzc05hbWU6ICJkaXNwbGF5LW5hbWUiIH0sIG1lbWJlci5kaXNwbGF5TmFtZSkpKTsgfSkpKSk7CiAgICB9OwogICAgcmV0dXJuIFNsYWNrU2hhcmVEcm9wZG93bjsKfShSZWFjdC5QdXJlQ29tcG9uZW50KSk7CmV4cG9ydCBkZWZhdWx0IFNsYWNrU2hhcmVEcm9wZG93bjsK"},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/ThreadDetail/components/ShareThreadPopover/components/ShareToSlack/components/SlackShareDropdown/SlackShareDropdown.tsx","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/ThreadDetail/components/ShareThreadPopover/components/ShareToSlack/components/SlackShareDropdown/SlackShareDropdown.tsx"],"names":[],"mappings":"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","sourcesContent":["import React from 'react';\nimport { findIndex } from 'lodash';\nimport classnames from 'classnames';\n\nimport Disclosure from '@src/components/Icons/Disclosure.svg';\nimport Popover from '@src/components/Popover/Popover';\nimport Search from '@src/components/Icons/Search.svg';\n\nimport './SlackShareDropdown.scss';\nimport DropdownItem from '@src/components/Form/DropdownItem';\nimport { SlackChannel, SlackMember } from '@src/types/slack';\nimport { Resource, KeyCode } from '@src/types';\n\nexport interface Props {\n  placeholder?: string;\n  onSelect: (value: string, index: number, id?: string) => void;\n  channels: Resource<SlackChannel[]>;\n  members: Resource<SlackMember[]>;\n}\n\ninterface State {\n  selected?: { type: SelectionType, index: number };\n  query: string;\n  channels: SlackChannel[];\n  members: SlackMember[];\n  popoverShown: boolean;\n  selectedIndex: number;\n  mouseInPopover: boolean;\n}\n\nexport const enum SelectionType {\n  Channel = 'channel',\n  Member = 'member',\n}\n\nclass SlackShareDropdown extends React.PureComponent<Props, State> {\n  popover: Popover;\n  input: HTMLInputElement;\n  timeout: NodeJS.Timer;\n  ref: HTMLElement;\n\n  constructor(props: Props) {\n    super();\n\n    this.state = {\n      query: '',\n      channels: props.channels.data || [],\n      members: props.members.data || [],\n      popoverShown: false,\n      selectedIndex: 0,\n      mouseInPopover: false,\n    };\n  }\n\n  componentDidMount() {\n    document.addEventListener('mousedown', this.handleClickOutside);\n    this.handleInputFocus();\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('mousedown', this.handleClickOutside);\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps: Props) {\n    if (nextProps.channels !== this.props.channels || nextProps.members !== this.props.members) {\n      this.setState({\n        channels: nextProps.channels.data || [],\n        members: nextProps.members.data || [],\n      });\n    }\n  }\n\n  componentDidUpdate(oldProps: Props, oldState: State) {\n    const oldSelectedIndex = oldState.selectedIndex;\n    const { selectedIndex, channels } = this.state;\n    const cellHeight = 35;\n    if (oldSelectedIndex !== selectedIndex) {\n\n      const list = document.querySelector('.form-dropdown-popover');\n      if (list && list instanceof HTMLDivElement) {\n        const listHeight = list.offsetHeight;\n        const headerHeight = selectedIndex > channels.length\n          ? 70\n          : 35;\n\n        // Calculate cell and list positions\n        const cellTop = cellHeight * (selectedIndex) + headerHeight;\n        const cellBottom = headerHeight + cellHeight + (cellHeight) * selectedIndex;\n        const listTop = list.scrollTop;\n        const listBottom = list.scrollTop + listHeight;\n\n        // If outside of top range, then set scrollTop to cell top\n        if (cellTop < listTop) {\n          list.scrollTop = cellTop;\n          return;\n        }\n\n        // If bottom outside of list bottom range then reset scrollTop\n        if (cellBottom > listBottom) {\n          list.scrollTop = cellBottom - listHeight;\n          return;\n        }\n      }\n    }\n  }\n\n  handleClickOutside = (e: KeyboardEvent) => {\n    const { popoverShown } = this.state;\n\n    if (this.ref && this.popover && !this.ref.contains(e.target as Node) && popoverShown) {\n      e.stopPropagation();\n      e.preventDefault();\n      this.popover.hide();\n    }\n  }\n\n  handlePopoverRef = (ref: Popover) => {\n    this.popover = ref;\n  }\n\n  showPopover = () => {\n    if (this.popover) {\n      this.popover.show();\n    }\n  }\n\n  handleOpen = (e: React.MouseEvent<HTMLElement>) => {\n    const { popoverShown } = this.state;\n\n    if (!popoverShown) {\n      e.preventDefault();\n      this.showPopover();\n      this.focusInput();\n    }\n  }\n\n  onSelect = (value: string, index: number) => {\n    const { channels } = this.props;\n    if (!channels.data) {\n      return;\n    }\n\n    const originalIndex = channels.data.map(channel => channel.name).indexOf(value);\n\n    if (this.popover) {\n      this.popover.hide();\n    }\n\n    // reset values on select\n    this.setState(\n      {\n        selected: { index: originalIndex, type: SelectionType.Channel },\n        channels: channels.data,\n        query: '',\n      },\n      () => {\n        this.focusInput(true);\n      },\n    );\n\n    this.props.onSelect(channels.data[originalIndex].id, originalIndex, SelectionType.Channel);\n  }\n\n  handleInputRef = (ref: HTMLInputElement) => {\n    this.input = ref;\n  }\n\n  focusInput = (throwFocusToEnd?: boolean) => {\n    this.timeout = global.setTimeout(\n      () => {\n        this.input.focus();\n\n        // set cursor to end\n        if (throwFocusToEnd) {\n          const length = this.input.value.length;\n          this.input.setSelectionRange(length, length);\n        }\n      },\n      0,\n    );\n  }\n\n  handleInputFocus = () => {\n    const { popoverShown } = this.state;\n\n    if (!popoverShown && this.input && !this.input.value) {\n      this.showPopover();\n      this.focusInput();\n    }\n  }\n\n  handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const { channels, members } = this.props;\n    const query = this.input.value;\n    const start = this.input.selectionStart;\n    const end = this.input.selectionEnd;\n\n    let matchedChannels;\n    let matchedMembers;\n\n    if (!channels.data || query.startsWith('@')) {\n      matchedChannels = [];\n    }\n    if (!members.data || query.startsWith('#')) {\n      matchedMembers = [];\n    }\n\n    let match = '';\n    if (!matchedChannels && channels.data) {\n      match = query.startsWith('#') ? query.slice(1).toLowerCase() : query.toLowerCase();\n      matchedChannels = channels.data\n        .filter(val => !!val.name.toLowerCase().startsWith(match));\n    }\n    if (!matchedMembers && members.data) {\n      match = query.startsWith('@') ? query.slice(1).toLowerCase() : query.toLowerCase();\n      matchedMembers = members.data\n        .filter(val =>\n          !!val.realName.toLowerCase().startsWith(match) ||\n          !!val.displayName.toLowerCase().startsWith(match));\n    }\n\n    // clear selection index on search\n    this.setState(\n      {\n        query,\n        channels: matchedChannels || [],\n        members: matchedMembers || [],\n        selected: undefined,\n        selectedIndex: this.state.mouseInPopover ? this.state.selectedIndex : 0,\n      },\n      () => {\n        if (!this.state.popoverShown) {\n          this.showPopover();\n        }\n        if (start && end) {\n          this.input.setSelectionRange(start, end);\n        }\n        this.focusInput();\n      },\n    );\n  }\n\n  handleEnter = () => {\n    const { selectedIndex, popoverShown, channels, members } = this.state;\n    const originalChannels = this.props.channels;\n    const originalMembers = this.props.members;\n    if (popoverShown) {\n      if (selectedIndex < channels.length) {\n        const channelItem = channels[selectedIndex];\n        if (channelItem) {\n          if (!originalChannels.data) {\n            return;\n          }\n          const originalIndex = findIndex(originalChannels.data, { id: channelItem.id });\n          const originalItem = originalChannels.data[originalIndex];\n          if (originalItem) {\n            this.popover.hide();\n            this.setState(\n              {\n                selected: { index: originalIndex, type: SelectionType.Channel },\n                query: '',\n                channels: originalChannels.data || [],\n                members: originalMembers.data || [],\n              },\n              () => {\n                this.focusInput(true);\n              },\n            );\n            this.props.onSelect(originalItem.id, originalIndex, SelectionType.Channel);\n            return;\n          }\n        }\n      } else {\n        const memberItem = members[selectedIndex - channels.length];\n        if (memberItem) {\n          if (!originalMembers.data) {\n            return;\n          }\n\n          const originalIndex = findIndex(originalMembers.data, { id: memberItem.id });\n          const originalItem = originalMembers.data[originalIndex];\n          if (originalItem) {\n            this.popover.hide();\n            this.setState(\n              {\n                selected: { index: originalIndex, type: SelectionType.Member },\n                query: '',\n                channels: originalChannels.data || [],\n                members: originalMembers.data || [],\n              },\n              () => {\n                this.focusInput(true);\n              },\n            );\n            this.props.onSelect(originalItem.id, originalIndex, SelectionType.Member);\n            this.popover.hide();\n            return;\n          }\n        }\n      }\n    }\n  }\n\n  handleKeyDown = (e: React.KeyboardEvent<HTMLElement>) => {\n    const { channels, members, popoverShown } = this.state;\n    let handled = false;\n    switch (e.keyCode) {\n      case KeyCode.Up:\n        const previousIndex = this.state.selectedIndex - 1;\n        handled = true;\n        if (previousIndex < 0) {\n          break;\n        }\n        this.setState({ selectedIndex: previousIndex });\n        break;\n      case KeyCode.Down:\n        handled = true;\n        const nextIndex = this.state.selectedIndex + 1;\n        if (nextIndex >= (channels.length + members.length)) {\n          break;\n        }\n\n        this.setState({ selectedIndex: nextIndex });\n        break;\n      case KeyCode.Enter:\n        handled = true;\n        this.handleEnter();\n        break;\n      case KeyCode.Tab:\n        if (popoverShown) {\n          this.popover.hide();\n        }\n        break;\n      case KeyCode.Esc:\n        handled = true;\n        this.popover.hide();\n        break;\n      default: break;\n    }\n\n    if (handled) {\n      e.stopPropagation();\n      e.preventDefault();\n    }\n  }\n\n  handlePopoverShow = () => {\n    this.setState({ popoverShown: true });\n  }\n\n  handlePopoverHide = () => {\n    this.setState({ popoverShown: false });\n  }\n\n  handleRef = (ref: HTMLDivElement) => {\n    this.ref = ref;\n  }\n\n  handleMemberSelect = (e: React.MouseEvent<HTMLButtonElement>) => {\n    const { members, channels } = this.props;\n    if (!members.data) {\n      return;\n    }\n\n    const id = e.currentTarget.getAttribute('data-member');\n\n    if (this.popover) {\n      this.popover.hide();\n    }\n\n    if (id) {\n      const originalIndex = members.data.findIndex(m => m.id === id);\n\n      // reset values on select\n      this.setState(\n        {\n          selected: { index: originalIndex, type: SelectionType.Member },\n          members: members.data,\n          channels: channels.data || [],\n          query: '',\n        },\n        () => {\n          this.focusInput(true);\n        },\n      );\n\n      this.props.onSelect(id, originalIndex, SelectionType.Member);\n    }\n  }\n\n  handleMouseEnter = (e: React.MouseEvent<HTMLElement>) => {\n    const { channels, members } = this.state;\n    const memberId = e.currentTarget.dataset.member;\n    const channelId = e.currentTarget.dataset.lookup;\n    if (channelId) {\n      const channelIndex = findIndex(channels, { id: channelId });\n      this.setState({ selectedIndex: channelIndex, mouseInPopover: true });\n      return;\n    }\n\n    if (memberId) {\n      const memberIndex = findIndex(members, { id: memberId });\n      const updatedIndex = memberIndex + channels.length;\n      this.setState({ selectedIndex: updatedIndex, mouseInPopover: true });\n      return;\n    }\n  }\n\n  handleMouseLeave = () => {\n    this.setState({\n      mouseInPopover: false,\n    });\n  }\n\n  render() {\n    const {\n      placeholder,\n    } = this.props;\n    const { query, channels, selected, members } = this.state;\n    return (\n      <div className=\"slack-share-dropdown\" ref={this.handleRef}>\n        <div\n          onClick={this.handleOpen}\n          className=\"select\"\n        >\n          <Search className=\"search\" />\n          <input\n            dir=\"auto\"\n            className=\"input\"\n            key={`${this.state.selected}`}\n            value={!query && selected ?\n              selected.type === SelectionType.Channel ?\n                channels[selected.index].name : members[selected.index].realName\n              : undefined}\n            // defaultValue={query}\n            onChange={this.handleInputChange}\n            placeholder={placeholder}\n            ref={this.handleInputRef}\n            onKeyDown={this.handleKeyDown}\n            onFocus={this.handleInputFocus}\n            tabIndex={0}\n            autoFocus\n          />\n          <Disclosure className=\"disclosure\" />\n        </div>\n        <Popover\n          className=\"form-dropdown-popover\"\n          ref={this.handlePopoverRef}\n          onShow={this.handlePopoverShow}\n          onHide={this.handlePopoverHide}\n          onKeyDown={this.handleKeyDown}\n          onMouseLeave={this.handleMouseLeave}\n          persistent\n        >\n          {!!channels.length && <div className=\"channel title\">\n            Channels\n          </div>}\n          {channels.map((val, i) =>\n            <DropdownItem\n              key={val.id}\n              lookup={val.id}\n              index={i}\n              value={val.name}\n              onClick={this.onSelect}\n              className={this.state.selectedIndex === i && 'selected' || undefined}\n              onMouseEnter={this.handleMouseEnter}\n            />,\n          )}\n          {!!members.length && <div className=\"people title\">\n            People\n          </div>}\n          {members.map((member, i) => (\n            <button\n              className={classnames(\n                'member',\n                { selected: this.state.selectedIndex - channels.length === i },\n              )}\n              data-member={member.id}\n              key={i}\n              onClick={this.handleMemberSelect}\n              onMouseEnter={this.handleMouseEnter}\n              tabIndex={-1}\n            >\n              <span className=\"avatar\"><img src={member.photoUrl} /></span>\n              <span className=\"real-name\">{member.realName}</span>\n              <span className=\"display-name\">{member.displayName}</span>\n            </button>\n          ))}\n        </Popover>\n      </div>\n    );\n  }\n}\n\nexport default SlackShareDropdown;\n"]}]}