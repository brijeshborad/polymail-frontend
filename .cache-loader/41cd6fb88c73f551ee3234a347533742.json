{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Sequences/routes/SequenceDetail/SequenceDetail.tsx","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Sequences/routes/SequenceDetail/SequenceDetail.tsx","mtime":1675280254087},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewogICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewogICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAogICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKICAgIH07CiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwogICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQogICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKICAgIH07Cn0pKCk7CnZhciBfX2Fzc2lnbiA9ICh0aGlzICYmIHRoaXMuX19hc3NpZ24pIHx8IGZ1bmN0aW9uICgpIHsKICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbih0KSB7CiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7CiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07CiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkKICAgICAgICAgICAgICAgIHRbcF0gPSBzW3BdOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdDsKICAgIH07CiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfTsKaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JzsKaW1wb3J0IGNsYXNzbmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7CmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JzsKaW1wb3J0IHsgVmljdG9yeVBpZSB9IGZyb20gJ3ZpY3RvcnknOwppbXBvcnQgeyBTZXF1ZW5jZVRhYiwgfSBmcm9tICdAc3JjL3R5cGVzL3NlcXVlbmNlcyc7CmltcG9ydCBoaXN0b3J5IGZyb20gJ0BzcmMvbGliL2Jyb3dzZXJIaXN0b3J5JzsKaW1wb3J0IENlbnRlcmVkTG9hZGVyIGZyb20gJ0BzcmMvY29tcG9uZW50cy9Mb2FkZXIvQ2VudGVyZWRMb2FkZXInOwppbXBvcnQgJy4vU2VxdWVuY2VEZXRhaWwuc2Nzcyc7CmltcG9ydCBEcm9wZG93biBmcm9tICdAc3JjL2NvbXBvbmVudHMvRm9ybS9Ecm9wZG93bic7CmltcG9ydCBFZGl0YWJsZUlucHV0IGZyb20gJ0BzcmMvY29tcG9uZW50cy9Gb3JtL0VkaXRhYmxlSW5wdXQvRWRpdGFibGVJbnB1dCc7CmltcG9ydCBTdGFnZUxpc3QgZnJvbSAnLi9TdGFnZUxpc3QnOwppbXBvcnQgeyBMaW5rIH0gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSc7CmltcG9ydCBTZXF1ZW5jZVJlY2lwaWVudHNMaXN0IGZyb20gJy4vU2VxdWVuY2VSZWNpcGllbnRzTGlzdCc7CmltcG9ydCBTZXF1ZW5jZVNldHRpbmdzIGZyb20gJy4vU2VxdWVuY2VTZXR0aW5ncyc7CmltcG9ydCBPdmVybGF5IGZyb20gJ0BzcmMvY29tcG9uZW50cy9CYXNlL092ZXJsYXknOwppbXBvcnQgVXBsb2FkUmVjaXBpZW50IGZyb20gJy4vVXBsb2FkUmVjaXBpZW50JzsKaW1wb3J0IENTVkhlYWRlck1hcHBpbmcgZnJvbSAnLi9DU1ZIZWFkZXJNYXBwaW5nL0NTVkhlYWRlck1hcHBpbmcnOwppbXBvcnQgUGxheSBmcm9tICdAc3JjL2NvbXBvbmVudHMvSWNvbnMvUGxheS5zdmcnOwppbXBvcnQgUGF1c2UgZnJvbSAnQHNyYy9jb21wb25lbnRzL0ljb25zL1BhdXNlLnN2Zyc7CmltcG9ydCBDb25maXJtIGZyb20gJ0BzcmMvY29tcG9uZW50cy9CYXNlL0NvbmZpcm0nOwppbXBvcnQgeyBQdWxzZUdlbSB9IGZyb20gJ0BzcmMvY29tcG9uZW50cy9CYXNlL1B1bHNlR2VtJzsKaW1wb3J0IE9uYm9hcmRpbmdGb290ZXIgZnJvbSAnQHNyYy9jb21wb25lbnRzL0Jhbm5lci9PbmJvYXJkaW5nRm9vdGVyL09uYm9hcmRpbmdGb290ZXInOwppbXBvcnQgeyBjcmVhdGVTZXF1ZW5jZVN0YWdlIH0gZnJvbSAnQHNyYy9tb2Nrcy9zZXF1ZW5jZXMnOwovLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bWF4LWxpbmUtbGVuZ3RoCmltcG9ydCBVcGxvYWRSZWNpcGllbnRzQ29uZmlybWF0aW9uIGZyb20gJy4vVXBsb2FkUmVjaXBpZW50c0NvbmZpcm1hdGlvbi9VcGxvYWRSZWNpcGllbnRzQ29uZmlybWF0aW9uJzsKaW1wb3J0IHsgREFSS01PREVfVklDVE9SWV9CQUNLR1JPVU5EX0NPTE9SLCBERUZBVUxUX1ZJQ1RPUllfQkFDS0dST1VORF9DT0xPUiB9IGZyb20gJ0BzcmMvbGliL2NvbG9ycyc7CmltcG9ydCB7IEFtcGxpdHVkZUV2ZW50cywgbG9nQW1wbGl0dWRlRXZlbnQgfSBmcm9tICdAc3JjL2xpYi9hbXBsaXR1ZGUtYW5hbHl0aWNzJzsKdmFyIFNlcXVlbmNlRGV0YWlsID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewogICAgX19leHRlbmRzKFNlcXVlbmNlRGV0YWlsLCBfc3VwZXIpOwogICAgZnVuY3Rpb24gU2VxdWVuY2VEZXRhaWwocHJvcHMpIHsKICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpczsKICAgICAgICBfdGhpcy5oYW5kbGVNb3JlU2VsZWN0ID0gZnVuY3Rpb24gKHZhbHVlLCBpbmRleCkgewogICAgICAgICAgICB2YXIgX2EgPSBfdGhpcy5wcm9wcywgc2VxdWVuY2UgPSBfYS5zZXF1ZW5jZSwgdXBkYXRlU2VxdWVuY2UgPSBfYS51cGRhdGVTZXF1ZW5jZSwgZHVwbGljYXRlU2VxdWVuY2UgPSBfYS5kdXBsaWNhdGVTZXF1ZW5jZSwgZGVsZXRlU2VxdWVuY2UgPSBfYS5kZWxldGVTZXF1ZW5jZSwgZXhwb3J0U2VxdWVuY2UgPSBfYS5leHBvcnRTZXF1ZW5jZTsKICAgICAgICAgICAgaWYgKCFzZXF1ZW5jZSB8fCAhc2VxdWVuY2UuZGF0YSkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHN3aXRjaCAodmFsdWUpIHsKICAgICAgICAgICAgICAgIGNhc2UgJ0FyY2hpdmUnOgogICAgICAgICAgICAgICAgICAgIHVwZGF0ZVNlcXVlbmNlKF9fYXNzaWduKF9fYXNzaWduKHt9LCBzZXF1ZW5jZS5kYXRhKSwgeyBhcmNoaXZlZDogdHJ1ZSwgcGF1c2VkOiB0cnVlIH0pKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgJ1VuYXJjaGl2ZSc6CiAgICAgICAgICAgICAgICAgICAgdXBkYXRlU2VxdWVuY2UoX19hc3NpZ24oX19hc3NpZ24oe30sIHNlcXVlbmNlLmRhdGEpLCB7IGFyY2hpdmVkOiBmYWxzZSB9KSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlICdEdXBsaWNhdGUnOgogICAgICAgICAgICAgICAgICAgIGR1cGxpY2F0ZVNlcXVlbmNlKHNlcXVlbmNlLmRhdGEuaWQpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAnRXhwb3J0JzoKICAgICAgICAgICAgICAgICAgICBleHBvcnRTZXF1ZW5jZShzZXF1ZW5jZS5kYXRhKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgJ0RlbGV0ZSc6CiAgICAgICAgICAgICAgICAgICAgdmFyIGRlbGV0ZUhhbmRsZXJfMSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlcXVlbmNlLmRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZVNlcXVlbmNlKHNlcXVlbmNlLmRhdGEpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGhpc3RvcnkucHVzaCgnL3NlcXVlbmNlcycpOwogICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IGNvbmZpcm1Qcm9wczogdW5kZWZpbmVkIH0pOwogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgLy8gU2hvdyBjb25maXJtIGRpYWxvZ3VlIHdpdGggY2FsbGJhY2sgdG8gZGVsZXRlCiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbmZpcm1Qcm9wcyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdEZWxldGUgdGhpcyBTZXF1ZW5jZT8nLAogICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGlzIFNlcXVlbmNlPycKICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgJyBBbnkgYW5hbHl0aWNzIGFuZCByZWNpcGllbnRzIGRhdGEgd2lsbCBiZSBsb3N0IGZvcmV2ZXIuJywKICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlybUNvcHk6ICdEZWxldGUnLAogICAgICAgICAgICAgICAgICAgICAgICBjYW5jZWxDb3B5OiAnQ2FuY2VsJywKICAgICAgICAgICAgICAgICAgICAgICAgb25Db25maXJtOiBmdW5jdGlvbiAoKSB7IHJldHVybiBkZWxldGVIYW5kbGVyXzEoKTsgfSwKICAgICAgICAgICAgICAgICAgICAgICAgb25DYW5jZWw6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnNldFN0YXRlKHsgY29uZmlybVByb3BzOiB1bmRlZmluZWQgfSk7IH0sCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpcm1Qcm9wczogY29uZmlybVByb3BzLAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgX3RoaXMuc2V0TmV4dE9uYm9hcmRpbmcgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBfYSA9IF90aGlzLnByb3BzLCBvbmJvYXJkaW5nID0gX2Eub25ib2FyZGluZywgdXBkYXRlT25ib2FyZGluZyA9IF9hLnVwZGF0ZU9uYm9hcmRpbmcsIGNyZWF0ZVN0YWdlID0gX2EuY3JlYXRlU3RhZ2UsIHNlcXVlbmNlID0gX2Euc2VxdWVuY2U7CiAgICAgICAgICAgIHZhciBvbmJvYXJkaW5nUHJvcHM7CiAgICAgICAgICAgIGlmICghb25ib2FyZGluZy5hZGRTZXF1ZW5jZVJlY2lwaWVudHMgJiYgIV90aGlzLnN0YXRlLm9uYm9hcmRpbmdQcm9wcykgewogICAgICAgICAgICAgICAgb25ib2FyZGluZ1Byb3BzID0gewogICAgICAgICAgICAgICAgICAgIGlkOiAnYWRkU2VxdWVuY2VSZWNpcGllbnRzJywKICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ0FkZCBSZWNpcGllbnRzJywKICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAnR2V0IHN0YXJ0ZWQgYnkgYWRkaW5nIHJlY2lwaWVudHMgdG8geW91ciBTZXF1ZW5jZS4gJwogICAgICAgICAgICAgICAgICAgICAgICArICdZb3VcJ2xsIGFsc28gYmUgYWJsZSB0byBhZGQgbW9yZSByZWNpcGllbnRzIGxhdGVyLicsCiAgICAgICAgICAgICAgICAgICAgYnV0dG9uQ29weTogJ0FkZCBSZWNpcGllbnRzJywKICAgICAgICAgICAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmhhbmRsZUFkZFJlY2lwaWVudENsaWNrKCk7CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBvblNraXA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFvbmJvYXJkaW5nLmFkZFNlcXVlbmNlUmVjaXBpZW50cykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlT25ib2FyZGluZyh7IHNraXBwZWQ6IHRydWUsIHR5cGU6IHsgYWRkU2VxdWVuY2VSZWNpcGllbnRzOiB0cnVlIH0gfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IG9uYm9hcmRpbmdQcm9wczogdW5kZWZpbmVkIH0pOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IG9uYm9hcmRpbmdQcm9wczogb25ib2FyZGluZ1Byb3BzIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgaWYgKCFvbmJvYXJkaW5nLmVkaXRTZXF1ZW5jZVN0YWdlICYmICFfdGhpcy5zdGF0ZS5vbmJvYXJkaW5nUHJvcHMpIHsKICAgICAgICAgICAgICAgIG9uYm9hcmRpbmdQcm9wcyA9IHsKICAgICAgICAgICAgICAgICAgICBpZDogJ2VkaXRTZXF1ZW5jZVN0YWdlJywKICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ0VkaXQgU2VxdWVuY2UgU3RhZ2VzJywKICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAnRWFjaCBzdGFnZSByZXByZXNlbnRzIGEgbWVzc2FnZSBpbiB5b3VyIFNlcXVlbmNlLiAnCiAgICAgICAgICAgICAgICAgICAgICAgICsgJ0VkaXQgeW91ciBmaXJzdCBzdGFnZSB0byBjb250aW51ZScsCiAgICAgICAgICAgICAgICAgICAgYnV0dG9uQ29weTogJ0VkaXQgU3RhZ2UnLAogICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gSGFuZGxlIHJlZGlyZWN0IHRvIGZpcnN0IHNlcXVlbmNlIHdoZW4gY2xpY2tlZCBvbgogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RhZ2VzID0gX3RoaXMucHJvcHMuc3RhZ2VzOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RhZ2UgPSBzdGFnZXNbMF07CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZXF1ZW5jZUlkID0gc2VxdWVuY2UgJiYgc2VxdWVuY2UuZGF0YSAmJiBzZXF1ZW5jZS5kYXRhLmlkOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RhZ2VJZCA9IHN0YWdlICYmIHN0YWdlLmRhdGEgJiYgc3RhZ2UuZGF0YS5pZDsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlcXVlbmNlSWQgJiYgc3RhZ2VJZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlzdG9yeS5wdXNoKCIvc2VxdWVuY2VzLyIgKyBzZXF1ZW5jZUlkICsgIi9zdGFnZXMvIiArIHN0YWdlSWQpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBvblNraXA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFvbmJvYXJkaW5nLmVkaXRTZXF1ZW5jZVN0YWdlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVPbmJvYXJkaW5nKHsgc2tpcHBlZDogdHJ1ZSwgdHlwZTogeyBlZGl0U2VxdWVuY2VTdGFnZTogdHJ1ZSB9IH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBvbmJvYXJkaW5nUHJvcHM6IHVuZGVmaW5lZCB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBvbmJvYXJkaW5nUHJvcHM6IG9uYm9hcmRpbmdQcm9wcyB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIGlmICghb25ib2FyZGluZy5jcmVhdGVBZGRpdGlvbmFsU3RhZ2UgJiYgIV90aGlzLnN0YXRlLm9uYm9hcmRpbmdQcm9wcykgewogICAgICAgICAgICAgICAgb25ib2FyZGluZ1Byb3BzID0gewogICAgICAgICAgICAgICAgICAgIGlkOiAnY3JlYXRlQWRkaXRpb25hbFN0YWdlJywKICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ0NyZWF0ZSBBZGRpdGlvbmFsIFN0YWdlcycsCiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJ1JlY2lwaWVudHMgd2lsbCBiZSBhdXRvbWF0aWNhbGx5IHNlbnQgdGhlIG5leHQgc3RhZ2UuICcKICAgICAgICAgICAgICAgICAgICAgICAgKyAnYWZ0ZXIgYSBjZXJ0YWluIG51bWJlciBvZiBkYXlzIGlmIHRoZXkgaGF2ZW5cJ3QgcmVzcG9uZGVkLicsCiAgICAgICAgICAgICAgICAgICAgYnV0dG9uQ29weTogJ0FkZCBTdGFnZScsCiAgICAgICAgICAgICAgICAgICAgb25DbGljazogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAvLyBDcmVhdGVzIHNlcXVlbmNlCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZXF1ZW5jZSAmJiBzZXF1ZW5jZS5kYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW9ja1N0YWdlID0gY3JlYXRlU2VxdWVuY2VTdGFnZSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VxdWVuY2U6IHNlcXVlbmNlICYmIHNlcXVlbmNlLmRhdGEgJiYgc2VxdWVuY2UuZGF0YS5pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlU3RhZ2UoeyBzdGFnZTogbW9ja1N0YWdlLCBuYXZpZ2F0ZVRvOiB0cnVlIH0pOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBvblNraXA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFvbmJvYXJkaW5nLmNyZWF0ZUFkZGl0aW9uYWxTdGFnZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlT25ib2FyZGluZyh7IHNraXBwZWQ6IHRydWUsIHR5cGU6IHsgY3JlYXRlQWRkaXRpb25hbFN0YWdlOiB0cnVlIH0gfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IG9uYm9hcmRpbmdQcm9wczogdW5kZWZpbmVkIH0pOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IG9uYm9hcmRpbmdQcm9wczogb25ib2FyZGluZ1Byb3BzIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgaWYgKCFvbmJvYXJkaW5nLmFjdGl2YXRlU2VxdWVuY2UgJiYgIV90aGlzLnN0YXRlLm9uYm9hcmRpbmdQcm9wcykgewogICAgICAgICAgICAgICAgb25ib2FyZGluZ1Byb3BzID0gewogICAgICAgICAgICAgICAgICAgIGlkOiAnYWN0aXZhdGVTZXF1ZW5jZScsCiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdZb3VcJ3JlIHJlYWR5IHRvIHN0YXJ0IHNlbmRpbmchJywKICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAnWW91IGNhbiBjaGVjayB5b3VyIFNldHRpbmdzIGZpcnN0IHRvIHVwZGF0ZSB3aGljaCBkYXlzIGFuZCB0aW1lcyAnCiAgICAgICAgICAgICAgICAgICAgICAgICsgJ3lvdXIgU2VxdWVuY2Ugd2lsbCBzZW5kLicsCiAgICAgICAgICAgICAgICAgICAgYnV0dG9uQ29weTogJ0FjdGl2YXRlIFNlcXVlbmNlJywKICAgICAgICAgICAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhhbmRsZXMgdW5wYXVzaW5nCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZXF1ZW5jZSAmJiBzZXF1ZW5jZS5kYXRhICYmIHNlcXVlbmNlLmRhdGEucGF1c2VkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5oYW5kbGVQYXVzZWRUb2dnbGUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IG9uYm9hcmRpbmdQcm9wczogdW5kZWZpbmVkIH0pOwogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgb25Ta2lwOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghb25ib2FyZGluZy5hY3RpdmF0ZVNlcXVlbmNlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVPbmJvYXJkaW5nKHsgc2tpcHBlZDogdHJ1ZSwgdHlwZTogeyBhY3RpdmF0ZVNlcXVlbmNlOiB0cnVlIH0gfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IG9uYm9hcmRpbmdQcm9wczogdW5kZWZpbmVkIH0pOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IG9uYm9hcmRpbmdQcm9wczogb25ib2FyZGluZ1Byb3BzIH0pOwogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICAvLyBCbG9ja3MgYWN0aXZhdGluZyBzZXF1ZW5jZSB3aXRoIGNvbmZpcm0gcHJvbXB0IGlmIGFueSB1bmVkaXRlZCBzdGFnZXMgb3Igbm8gcmVjaXBpZW50cwogICAgICAgIF90aGlzLnBhc3Nlc0FjdGl2YXRlUmVxdWlyZW1lbnRzID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgX2EgPSBfdGhpcy5wcm9wcywgaW5zdGFuY2VzID0gX2EuaW5zdGFuY2VzLCBzZXF1ZW5jZVJlY2lwaWVudHNDb3VudCA9IF9hLnNlcXVlbmNlUmVjaXBpZW50c0NvdW50OwogICAgICAgICAgICB2YXIgdW5lZGl0ZWRTdGFnZXMgPSBpbnN0YW5jZXMuZmlsdGVyKGZ1bmN0aW9uIChpbnN0YW5jZSkgeyByZXR1cm4gIWluc3RhbmNlLnVzZXJFZGl0ZWQ7IH0pOwogICAgICAgICAgICBpZiAodW5lZGl0ZWRTdGFnZXMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgdmFyIGZpcnN0U3RhZ2UgPSB1bmVkaXRlZFN0YWdlc1swXTsKICAgICAgICAgICAgICAgIHZhciBzZXF1ZW5jZUlkXzEgPSBmaXJzdFN0YWdlLnNlcXVlbmNlOwogICAgICAgICAgICAgICAgdmFyIHN0YWdlSWRfMSA9IGZpcnN0U3RhZ2Uuc3RhZ2U7CiAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSB1bmVkaXRlZFN0YWdlcy5sZW5ndGggPiAxCiAgICAgICAgICAgICAgICAgICAgPyAnRWRpdCBTdGFnZXMnCiAgICAgICAgICAgICAgICAgICAgOiAnRWRpdCBTdGFnZSc7CiAgICAgICAgICAgICAgICB2YXIgc3RhZ2VEZXNjcmlwdG9yID0gdW5lZGl0ZWRTdGFnZXMubGVuZ3RoID4gMQogICAgICAgICAgICAgICAgICAgID8gdW5lZGl0ZWRTdGFnZXMubGVuZ3RoICsgIiBzdGFnZXMiCiAgICAgICAgICAgICAgICAgICAgOiAnYW4gdW5lZGl0ZWQgc3RhZ2UnOwogICAgICAgICAgICAgICAgdmFyIGNvbmZpcm1Qcm9wcyA9IHsKICAgICAgICAgICAgICAgICAgICB0aXRsZTogdGl0bGUsCiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogIllvdSBoYXZlICIgKyBzdGFnZURlc2NyaXB0b3IgKyAiIHRoYXQgbmVlZCAiCiAgICAgICAgICAgICAgICAgICAgICAgICsgJ3RvIGJlIHVwZGF0ZWQgYmVmb3JlIGFjdGl2YXRpbmcgdGhpcyBzZXF1ZW5jZS4nLAogICAgICAgICAgICAgICAgICAgIGNvbmZpcm1Db3B5OiAnRWRpdCBTdGFnZScsCiAgICAgICAgICAgICAgICAgICAgb25Db25maXJtOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsgY29uZmlybVByb3BzOiB1bmRlZmluZWQgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGhpc3RvcnkucHVzaCgiL3NlcXVlbmNlcy8iICsgc2VxdWVuY2VJZF8xICsgIi9zdGFnZXMvIiArIHN0YWdlSWRfMSk7CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IGNvbmZpcm1Qcm9wczogY29uZmlybVByb3BzIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChzZXF1ZW5jZVJlY2lwaWVudHNDb3VudCA9PT0gMCkgewogICAgICAgICAgICAgICAgdmFyIHRpdGxlID0gJ0FkZCBSZWNpcGllbnRzJzsKICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gJ1lvdSBuZWVkIHRvIGFkZCByZWNpcGllbnRzIGJlZm9yZSBhY3RpdmF0aW5nIHRoaXMgU2VxdWVuY2UnOwogICAgICAgICAgICAgICAgdmFyIGNvbmZpcm1Qcm9wcyA9IHsKICAgICAgICAgICAgICAgICAgICB0aXRsZTogdGl0bGUsCiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogbWVzc2FnZSwKICAgICAgICAgICAgICAgICAgICBjb25maXJtQ29weTogJ0FkZCcsCiAgICAgICAgICAgICAgICAgICAgY2FuY2VsQ29weTogJ0NhbmNlbCcsCiAgICAgICAgICAgICAgICAgICAgb25Db25maXJtOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmhhbmRsZUFkZFJlY2lwaWVudENsaWNrKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsgY29uZmlybVByb3BzOiB1bmRlZmluZWQgfSk7CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBvbkNhbmNlbDogZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuc2V0U3RhdGUoeyBjb25maXJtUHJvcHM6IHVuZGVmaW5lZCB9KTsgfSwKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IGNvbmZpcm1Qcm9wczogY29uZmlybVByb3BzIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlUGF1c2VkVG9nZ2xlID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgX2EgPSBfdGhpcy5wcm9wcywgc2VxdWVuY2UgPSBfYS5zZXF1ZW5jZSwgdXBkYXRlU2VxdWVuY2UgPSBfYS51cGRhdGVTZXF1ZW5jZSwgdXBkYXRlT25ib2FyZGluZyA9IF9hLnVwZGF0ZU9uYm9hcmRpbmcsIG9uYm9hcmRpbmcgPSBfYS5vbmJvYXJkaW5nOwogICAgICAgICAgICAvLyBUb2dnbGUgb25ib2FyZGluZyBpZiBhY3RpdmF0ZSBzZXF1ZW5jZSBpcyBvbgogICAgICAgICAgICBpZiAoIW9uYm9hcmRpbmcuYWN0aXZhdGVTZXF1ZW5jZSkgewogICAgICAgICAgICAgICAgdXBkYXRlT25ib2FyZGluZyh7IHNraXBwZWQ6IGZhbHNlLCB0eXBlOiB7IGFjdGl2YXRlU2VxdWVuY2U6IHRydWUgfSB9KTsKICAgICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsgb25ib2FyZGluZ1Byb3BzOiB1bmRlZmluZWQgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gRG8gbm90IGFsbG93IHNldHRpbmcgbGl2ZSBpZiBzdGFnZSBoYXMgbm90IGJlZW4gdXBkYXRlZAogICAgICAgICAgICBpZiAoIV90aGlzLnBhc3Nlc0FjdGl2YXRlUmVxdWlyZW1lbnRzKCkpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoc2VxdWVuY2UgJiYgc2VxdWVuY2UuZGF0YSkgewogICAgICAgICAgICAgICAgdmFyIHRvZ2dsZVBhdXNlXzEgPSBmdW5jdGlvbiAoKSB7IHJldHVybiB1cGRhdGVTZXF1ZW5jZShfX2Fzc2lnbihfX2Fzc2lnbih7fSwgc2VxdWVuY2UuZGF0YSksIHsgcGF1c2VkOiAhc2VxdWVuY2UuZGF0YS5wYXVzZWQgfSkpOyB9OwogICAgICAgICAgICAgICAgLy8gSWYgYWN0aXZlLCBpbW1lZGlhdGVseSBwYXVzZQogICAgICAgICAgICAgICAgaWYgKCFzZXF1ZW5jZS5kYXRhLnBhdXNlZCkgewogICAgICAgICAgICAgICAgICAgIHRvZ2dsZVBhdXNlXzEoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vIFNob3cgY29uZmlybSBwcm9tcHQgaWYgbm90IGFjdGl2ZSB5ZXQKICAgICAgICAgICAgICAgIGlmIChzZXF1ZW5jZS5kYXRhLnBhdXNlZCkgewogICAgICAgICAgICAgICAgICAgIHZhciBjb25maXJtUHJvcHMgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAiQWN0aXZhdGUgIiArIHNlcXVlbmNlLmRhdGEubmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogIldoZW4gYWN0aXZhdGVkLCB0aGlzIHNlcXVlbmNlIHdpbGwgZ28gIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAoImxpdmUgdG8gIiArIHNlcXVlbmNlLmRhdGEucmVjaXBpZW50cy5hY3RpdmUgKyAiIHJlY2lwaWVudHMuIiksCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbmNlbENvcHk6ICdDYW5jZWwnLAogICAgICAgICAgICAgICAgICAgICAgICBjb25maXJtQ29weTogJ1NldCBMaXZlJywKICAgICAgICAgICAgICAgICAgICAgICAgb25Db25maXJtOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2dnbGVQYXVzZV8xKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dBbXBsaXR1ZGVFdmVudChBbXBsaXR1ZGVFdmVudHMuU3RhcnROZXdTZXF1ZW5jZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IGNvbmZpcm1Qcm9wczogdW5kZWZpbmVkIH0pOwogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBvbkNhbmNlbDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBjb25maXJtUHJvcHM6IHVuZGVmaW5lZCB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlybVByb3BzOiBjb25maXJtUHJvcHMsCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIF90aGlzLmhhbmRsZUVkaXROYW1lID0gZnVuY3Rpb24gKHByb3BlcnR5LCBuYW1lKSB7CiAgICAgICAgICAgIHZhciBfYSA9IF90aGlzLnByb3BzLCBzZXF1ZW5jZSA9IF9hLnNlcXVlbmNlLCB1cGRhdGVTZXF1ZW5jZSA9IF9hLnVwZGF0ZVNlcXVlbmNlOwogICAgICAgICAgICBpZiAoc2VxdWVuY2UgJiYgc2VxdWVuY2UuZGF0YSkgewogICAgICAgICAgICAgICAgdXBkYXRlU2VxdWVuY2UoX19hc3NpZ24oX19hc3NpZ24oe30sIHNlcXVlbmNlLmRhdGEpLCB7IG5hbWU6IG5hbWUgfSkpOwogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5oYW5kbGVTaGFyZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIF9hID0gX3RoaXMucHJvcHMsIHNlcXVlbmNlID0gX2Euc2VxdWVuY2UsIHRlYW0gPSBfYS50ZWFtLCBzaGFyZVNlcXVlbmNlID0gX2Euc2hhcmVTZXF1ZW5jZTsKICAgICAgICAgICAgaWYgKHNlcXVlbmNlICYmIHNlcXVlbmNlLmRhdGEgJiYgdGVhbSkgewogICAgICAgICAgICAgICAgc2hhcmVTZXF1ZW5jZShfX2Fzc2lnbihfX2Fzc2lnbih7fSwgc2VxdWVuY2UuZGF0YSksIHsgdGVhbTogdGVhbS5pZCB9KSk7CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIF90aGlzLmhhbmRsZUZpbGVzID0gZnVuY3Rpb24gKGZpbGVzKSB7CiAgICAgICAgICAgIHZhciB1cGxvYWRDc3YgPSBfdGhpcy5wcm9wcy51cGxvYWRDc3Y7CiAgICAgICAgICAgIHZhciBmaWxlID0gZmlsZXNbMF07CiAgICAgICAgICAgIGlmICh1cGxvYWRDc3YgJiYgZmlsZSkgewogICAgICAgICAgICAgICAgdXBsb2FkQ3N2KGZpbGUpOwogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5yZW5kZXJMb2FkaW5nU3RhdGUgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiAoUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJzZXF1ZW5jZS1kZXRhaWwiIH0sCiAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KENlbnRlcmVkTG9hZGVyLCBudWxsKSkpOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlQWRkUmVjaXBpZW50Q2xpY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBfYSA9IF90aGlzLnByb3BzLCBvbmJvYXJkaW5nID0gX2Eub25ib2FyZGluZywgdXBkYXRlT25ib2FyZGluZyA9IF9hLnVwZGF0ZU9uYm9hcmRpbmcsIHNob3dTZXF1ZW5jZVJlY2lwaWVudEFkZCA9IF9hLnNob3dTZXF1ZW5jZVJlY2lwaWVudEFkZDsKICAgICAgICAgICAgLy8gSGFuZGxlIHJlbW92aW5nIG9uYm9hcmRpbmcgcHJvcHMKICAgICAgICAgICAgaWYgKCFvbmJvYXJkaW5nLmFkZFNlcXVlbmNlUmVjaXBpZW50cykgewogICAgICAgICAgICAgICAgdXBkYXRlT25ib2FyZGluZyh7IHNraXBwZWQ6IGZhbHNlLCB0eXBlOiB7IGFkZFNlcXVlbmNlUmVjaXBpZW50czogdHJ1ZSB9IH0pOwogICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBvbmJvYXJkaW5nUHJvcHM6IHVuZGVmaW5lZCB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgICBzaG93U2VxdWVuY2VSZWNpcGllbnRBZGQodHJ1ZSk7CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5oYW5kbGVBZGRSZWNpcGllbnRDbG9zZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgX3RoaXMucHJvcHMuc2hvd1NlcXVlbmNlUmVjaXBpZW50QWRkKGZhbHNlKTsKICAgICAgICB9OwogICAgICAgIF90aGlzLmhhbmRsZUFkZFJlY2lwaWVudHMgPSBmdW5jdGlvbiAoYWRkQXNQYXVzZWQpIHsKICAgICAgICAgICAgdmFyIF9hID0gX3RoaXMucHJvcHMsIGFkZFJlY2lwaWVudHMgPSBfYS5hZGRSZWNpcGllbnRzLCBzZXF1ZW5jZSA9IF9hLnNlcXVlbmNlOwogICAgICAgICAgICBpZiAoc2VxdWVuY2UgJiYgc2VxdWVuY2UuZGF0YSkgewogICAgICAgICAgICAgICAgYWRkUmVjaXBpZW50cyh7CiAgICAgICAgICAgICAgICAgICAgc2VxdWVuY2U6IHNlcXVlbmNlLmRhdGEuaWQsCiAgICAgICAgICAgICAgICAgICAgYWRkQXNQYXVzZWQ6IGFkZEFzUGF1c2VkLAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIF90aGlzLmhhbmRsZURvbmUgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBfYSA9IF90aGlzLnByb3BzLCBzZXF1ZW5jZSA9IF9hLnNlcXVlbmNlLCBzaG93U2VxdWVuY2VSZWNpcGllbnRBZGQgPSBfYS5zaG93U2VxdWVuY2VSZWNpcGllbnRBZGQ7CiAgICAgICAgICAgIGlmIChzZXF1ZW5jZSAmJiBzZXF1ZW5jZS5kYXRhKSB7CiAgICAgICAgICAgICAgICBzaG93U2VxdWVuY2VSZWNpcGllbnRBZGQoZmFsc2UpOwogICAgICAgICAgICAgICAgaGlzdG9yeS5wdXNoKCIvc2VxdWVuY2VzLyIgKyBzZXF1ZW5jZS5kYXRhLmlkICsgIi9yZWNpcGllbnRzIik7CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIF90aGlzLmhhbmRsZUludmFsaWRDbGljayA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIGNsZWFyU2VxdWVuY2VSZWNpcGllbnRTdWNjZXNzQ291bnQgPSBfdGhpcy5wcm9wcy5jbGVhclNlcXVlbmNlUmVjaXBpZW50U3VjY2Vzc0NvdW50OwogICAgICAgICAgICBjbGVhclNlcXVlbmNlUmVjaXBpZW50U3VjY2Vzc0NvdW50KCk7CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5zdGF0ZSA9IHt9OwogICAgICAgIHJldHVybiBfdGhpczsKICAgIH0KICAgIFNlcXVlbmNlRGV0YWlsLnByb3RvdHlwZS5jb21wb25lbnREaWRVcGRhdGUgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdGhpcy5zZXROZXh0T25ib2FyZGluZygpOwogICAgfTsKICAgIFNlcXVlbmNlRGV0YWlsLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIF9hID0gdGhpcy5wcm9wcywgc2VxdWVuY2UgPSBfYS5zZXF1ZW5jZSwgdXNlciA9IF9hLnVzZXIsIHRlYW0gPSBfYS50ZWFtLCBzdGFnZXMgPSBfYS5zdGFnZXMsIAogICAgICAgIC8vIHVwbG9hZGVkU2VxdWVuY2VSZWNpcGllbnRzLAogICAgICAgIG9uYm9hcmRpbmcgPSBfYS5vbmJvYXJkaW5nLCBzZXF1ZW5jZVJlY2lwaWVudHNBZGRTdGF0ZSA9IF9hLnNlcXVlbmNlUmVjaXBpZW50c0FkZFN0YXRlLCBhZGRTZXF1ZW5jZVJlY2lwaWVudEhlYWRlcnMgPSBfYS5hZGRTZXF1ZW5jZVJlY2lwaWVudEhlYWRlcnM7CiAgICAgICAgdmFyIF9iID0gdGhpcy5zdGF0ZSwgY29uZmlybVByb3BzID0gX2IuY29uZmlybVByb3BzLCBvbmJvYXJkaW5nUHJvcHMgPSBfYi5vbmJvYXJkaW5nUHJvcHM7CiAgICAgICAgdmFyIHNlbGVjdGVkVGFiID0gdGhpcy5wcm9wcy5zZWxlY3RlZFRhYiB8fCBTZXF1ZW5jZVRhYi5TdGFnZXM7CiAgICAgICAgdmFyIHNob3dBY3RpdmF0ZUdlbSA9IG9uYm9hcmRpbmcuY3JlYXRlQWRkaXRpb25hbFN0YWdlICYmIG9uYm9hcmRpbmcuZWRpdFNlcXVlbmNlU3RhZ2UgJiYKICAgICAgICAgICAgb25ib2FyZGluZy5hZGRTZXF1ZW5jZVJlY2lwaWVudHMgJiYgIW9uYm9hcmRpbmcuYWN0aXZhdGVTZXF1ZW5jZTsKICAgICAgICBpZiAoIXNlcXVlbmNlIHx8ICFzZXF1ZW5jZS5kYXRhIHx8ICFzdGFnZXMgfHwgIXN0YWdlcy5sZW5ndGggfHwgIXN0YWdlc1swXS5kYXRhKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbmRlckxvYWRpbmdTdGF0ZSgpOwogICAgICAgIH0KICAgICAgICB2YXIgX2MgPSBzZXF1ZW5jZS5kYXRhLCByZWNpcGllbnRzID0gX2MucmVjaXBpZW50cywgYW5hbHl0aWNzID0gX2MuYW5hbHl0aWNzOwogICAgICAgIHZhciByZWNpcGllbnRzTnVtID0gcmVjaXBpZW50cy5hY3RpdmUgKyByZWNpcGllbnRzLmNvbXBsZXRlZCArCiAgICAgICAgICAgIHJlY2lwaWVudHMucGF1c2VkICsgcmVjaXBpZW50cy5ib3VuY2VkICsgcmVjaXBpZW50cy5mYWlsZWQ7CiAgICAgICAgdmFyIHJlY2lwaWVudHNBbmFseXRpY3MgPSBbCiAgICAgICAgICAgIHsgbmFtZTogJ0FjdGl2ZScsIHZhbHVlOiAnYWN0aXZlJyB9LAogICAgICAgICAgICB7IG5hbWU6ICdDb21wbGV0ZWQnLCB2YWx1ZTogJ2NvbXBsZXRlZCcgfSwKICAgICAgICAgICAgeyBuYW1lOiAnUGF1c2VkJywgdmFsdWU6ICdwYXVzZWQnIH0sCiAgICAgICAgICAgIHsgbmFtZTogJ0JvdW5jZWQnLCB2YWx1ZTogJ2JvdW5jZWQnIH0sCiAgICAgICAgXTsKICAgICAgICB2YXIgc2VxdWVuY2VBbmFseXRpY3MgPSBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIG5hbWU6ICdEZWxpdmVyZWQnLAogICAgICAgICAgICAgICAgdmFsdWU6ICdkZWxpdmVyZWQnLAogICAgICAgICAgICAgICAgY29sb3I6ICcjNDQ0JywKICAgICAgICAgICAgICAgIHRvdGFsOiBhbmFseXRpY3MuZGVsaXZlcmVkICsgcmVjaXBpZW50cy5ib3VuY2VkLAogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBuYW1lOiAnT3BlbmVkJywKICAgICAgICAgICAgICAgIHZhbHVlOiAnb3BlbmVkJywKICAgICAgICAgICAgICAgIGNvbG9yOiAnIzAwYWFmZicsCiAgICAgICAgICAgICAgICB0b3RhbDogc2VxdWVuY2UuZGF0YS5hbmFseXRpY3MuZGVsaXZlcmVkIC0gcmVjaXBpZW50cy5ib3VuY2VkLAogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBuYW1lOiAnQ2xpY2tlZCcsCiAgICAgICAgICAgICAgICB2YWx1ZTogJ2NsaWNrZWQnLAogICAgICAgICAgICAgICAgY29sb3I6ICcjZmZhMDU3JywKICAgICAgICAgICAgICAgIHRvdGFsOiBzZXF1ZW5jZS5kYXRhLmFuYWx5dGljcy5kZWxpdmVyZWQgLSByZWNpcGllbnRzLmJvdW5jZWQsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIG5hbWU6ICdEb3dubG9hZGVkJywKICAgICAgICAgICAgICAgIHZhbHVlOiAnZG93bmxvYWRlZCcsCiAgICAgICAgICAgICAgICBjb2xvcjogJyNkMzQ3YWUnLAogICAgICAgICAgICAgICAgdG90YWw6IHNlcXVlbmNlLmRhdGEuYW5hbHl0aWNzLmRlbGl2ZXJlZCAtIHJlY2lwaWVudHMuYm91bmNlZCwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgbmFtZTogJ1JlcGxpZWQnLAogICAgICAgICAgICAgICAgdmFsdWU6ICdyZXBsaWVkJywKICAgICAgICAgICAgICAgIGNvbG9yOiAnIzBlYzM2YicsCiAgICAgICAgICAgICAgICB0b3RhbDogc2VxdWVuY2UuZGF0YS5hbmFseXRpY3MuZGVsaXZlcmVkVW5pcXVlLAogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBuYW1lOiAnVW5zdWJzY3JpYmVkJywKICAgICAgICAgICAgICAgIHZhbHVlOiAndW5zdWJzY3JpYmVkJywKICAgICAgICAgICAgICAgIGNvbG9yOiAnIzQ0NCcsCiAgICAgICAgICAgICAgICB0b3RhbDogc2VxdWVuY2UuZGF0YS5hbmFseXRpY3MuZGVsaXZlcmVkVW5pcXVlLAogICAgICAgICAgICB9LAogICAgICAgIF07CiAgICAgICAgdmFyIGNyZWF0ZWRTdHJpbmcgPSBtb21lbnQoc2VxdWVuY2UuZGF0YS5jcmVhdGVkKS5mb3JtYXQoJ01NTSBERCwgWVlZWScpOwogICAgICAgIHZhciB0b3RhbCA9IHNlcXVlbmNlLmRhdGEuYW5hbHl0aWNzLmRlbGl2ZXJlZCAtIHJlY2lwaWVudHMuYm91bmNlZDsKICAgICAgICB2YXIgZHJvcGRvd25WYWx1ZXMgPSBbJ0FyY2hpdmUnLCAnRHVwbGljYXRlJywgJ0V4cG9ydCcsICdEZWxldGUnXTsKICAgICAgICBpZiAoc2VxdWVuY2UuZGF0YS5hcmNoaXZlZCkgewogICAgICAgICAgICBkcm9wZG93blZhbHVlc1swXSA9ICdVbmFyY2hpdmUnOwogICAgICAgIH0KICAgICAgICAvLyBUT0RPKFNISU4pOiBBYnN0cmFjdCB0byBub3QgcmVseSBvbiBkb2N1bWVudC5ib2R5IChwcmVmZXJhYmx5IHVzaW5nIGNvbnN0YW50cykKICAgICAgICB2YXIgdmljdG9yeUNvbG9yQmFja2dyb3VuZCA9IGRvY3VtZW50LmJvZHkuZ2V0QXR0cmlidXRlKCd0aGVtZScpID09PSAndGhlbWUtZGFyaycKICAgICAgICAgICAgPyBEQVJLTU9ERV9WSUNUT1JZX0JBQ0tHUk9VTkRfQ09MT1IgOiBERUZBVUxUX1ZJQ1RPUllfQkFDS0dST1VORF9DT0xPUjsKICAgICAgICByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAic2VxdWVuY2UtZGV0YWlsIiB9LAogICAgICAgICAgICBjb25maXJtUHJvcHMgJiYKICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoQ29uZmlybSwgX19hc3NpZ24oe30sIGNvbmZpcm1Qcm9wcykpLAogICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogIm5hdmlnYXRpb24tYmFyIiB9LAogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJuYXZpZ2F0aW9uIiB9LAogICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoTGluaywgeyBjbGFzc05hbWU6ICJzZXF1ZW5jZXMtYnJlYWRjcnVtYiIsIHRvOiAhc2VxdWVuY2UuZGF0YS5hcmNoaXZlZCA/ICIvc2VxdWVuY2VzIiA6ICIvc2VxdWVuY2VzL2FyY2hpdmUiIH0sICFzZXF1ZW5jZS5kYXRhLmFyY2hpdmVkID8gJ1NlcXVlbmNlcycgOiAnQXJjaGl2ZScpLAogICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCB7IGNsYXNzTmFtZTogImFycm93IiB9LCAiPiIpLAogICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoTGluaywgeyB0bzogIi9zZXF1ZW5jZXMvIiArIHNlcXVlbmNlLmRhdGEuaWQsIGNsYXNzTmFtZTogInNlcXVlbmNlLWJyZWFkY3J1bWIiIH0sIHNlcXVlbmNlLmRhdGEubmFtZSksCiAgICAgICAgICAgICAgICAgICAgIXNlcXVlbmNlLmRhdGEucGF1c2VkICYmIFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCB7IGNsYXNzTmFtZTogImxpdmUtYmFkZ2UiIH0sICJMaXZlIikpLAogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJhY3Rpb25zIiB9LAogICAgICAgICAgICAgICAgICAgIG9uYm9hcmRpbmcgJiYgIW9uYm9hcmRpbmcuYWRkU2VxdWVuY2VSZWNpcGllbnRzICYmCiAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoUHVsc2VHZW0sIHsgdG9wOiAiLTE1cHgiLCBsZWZ0OiAiLTMwcHgiIH0pLAogICAgICAgICAgICAgICAgICAgICFzZXF1ZW5jZS5kYXRhLmFyY2hpdmVkICYmIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIsIHsgY2xhc3NOYW1lOiAiYWRkLXJlY2lwaWVudHMiLCBvbkNsaWNrOiB0aGlzLmhhbmRsZUFkZFJlY2lwaWVudENsaWNrIH0sICIrIEFkZCBSZWNpcGllbnRzIiksCiAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChEcm9wZG93biwgeyBwbGFjZWhvbGRlcjogIk1vcmUiLCB2YWx1ZXM6IGRyb3Bkb3duVmFsdWVzLCBvblNlbGVjdDogdGhpcy5oYW5kbGVNb3JlU2VsZWN0LCB2YWx1ZTogIiIgfSksCiAgICAgICAgICAgICAgICAgICAgc2hvd0FjdGl2YXRlR2VtICYmCiAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoUHVsc2VHZW0sIHsgdG9wOiAiLTE2cHgiLCBsZWZ0OiAiLTIwcHgiIH0pLAogICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIsIHsgY2xhc3NOYW1lOiBjbGFzc25hbWVzKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdzZXQtbGl2ZSc6IHNlcXVlbmNlLmRhdGEucGF1c2VkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF1c2U6ICFzZXF1ZW5jZS5kYXRhLnBhdXNlZCwKICAgICAgICAgICAgICAgICAgICAgICAgfSksIG9uQ2xpY2s6IHRoaXMuaGFuZGxlUGF1c2VkVG9nZ2xlIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHNlcXVlbmNlLmRhdGEucGF1c2VkID8gUmVhY3QuY3JlYXRlRWxlbWVudChQbGF5LCB7IGNsYXNzTmFtZTogImljb24iIH0pIDogUmVhY3QuY3JlYXRlRWxlbWVudChQYXVzZSwgeyBjbGFzc05hbWU6ICJpY29uIiB9KSwKICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIG51bGwsIHNlcXVlbmNlLmRhdGEucGF1c2VkID8gJ1NldCBMaXZlJyA6ICdQYXVzZScpKSkpLAogICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogIm1haW4iIH0sCiAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogInNlcXVlbmNlLWFuYWx5dGljcyIgfSwKICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogInRvcC1yb3ciIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAidGl0bGUiIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KEVkaXRhYmxlSW5wdXQsIHsgY2xhc3NOYW1lOiAibmFtZSIsIHRleHQ6IHNlcXVlbmNlLmRhdGEubmFtZSwgb25TZXQ6IHRoaXMuaGFuZGxlRWRpdE5hbWUsIHByb3BlcnR5OiAibmFtZSIgfSkpLAogICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogInJlY2lwaWVudHMtYW5hbHl0aWNzIiB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgISFyZWNpcGllbnRzTnVtICYmIFJlYWN0LmNyZWF0ZUVsZW1lbnQoTGluaywgeyBjbGFzc05hbWU6ICJsaW5rIiwgdG86ICIvc2VxdWVuY2VzLyIgKyBzZXF1ZW5jZS5kYXRhLmlkICsgIi9yZWNpcGllbnRzP2ZpbHRlcj1BbGxSZWNpcGllbnRzIiB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAicmVjaXBpZW50cy1hbmFseXRpYyIgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIHsgY2xhc3NOYW1lOiAibnVtYmVyIiB9LCByZWNpcGllbnRzTnVtKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIG51bGwsICJSZWNpcGllbnRzIikpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHNBbmFseXRpY3MuZmlsdGVyKGZ1bmN0aW9uIChyKSB7IHJldHVybiAhIXJlY2lwaWVudHNbci52YWx1ZV07IH0pLm1hcChmdW5jdGlvbiAocikgeyByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoTGluaywgeyBjbGFzc05hbWU6ICJsaW5rIiwgdG86ICIvc2VxdWVuY2VzLyIgKyBzZXF1ZW5jZS5kYXRhLmlkICsgIi9yZWNpcGllbnRzP2ZpbHRlcj0iICsgci5uYW1lLCBrZXk6IHIudmFsdWUgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogY2xhc3NuYW1lcygncmVjaXBpZW50cy1hbmFseXRpYycsIHIudmFsdWUpIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCB7IGNsYXNzTmFtZTogIm51bWJlciIgfSwgcmVjaXBpZW50c1tyLnZhbHVlXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCBudWxsLCByLm5hbWUpKSkpOyB9KSkpLAogICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAiZGV0YWlscyIgfSwKICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJudW1iZXJzIiB9LCBzZXF1ZW5jZS5kYXRhLnN0YWdlcyArICIgc3RhZ2VzIFx1MDBCNyAiICsgc2VxdWVuY2UuZGF0YS5kdXJhdGlvbkRheXMgKyAiIGRheXMgaW4gc2VxdWVuY2UiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgISFyZWNpcGllbnRzLmZhaWxlZCAmJiBSZWFjdC5jcmVhdGVFbGVtZW50KExpbmssIHsgY2xhc3NOYW1lOiAiZXJyb3IiLCB0bzogIi9zZXF1ZW5jZXMvIiArIHNlcXVlbmNlLmRhdGEuaWQgKyAiL3JlY2lwaWVudHM/ZmlsdGVyPUZhaWxlZCIgfSwgIlx1MjZBMFx1RkUwRiAiICsgcmVjaXBpZW50cy5mYWlsZWQgKyAiIHJlY2lwaWVudHMgZmFpbGVkIikpLAogICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImNyZWF0ZWQiIH0sICJDcmVhdGVkIGJ5ICIgKyAodXNlciAmJiB1c2VyLmZpcnN0TmFtZSArICIgIiArIHVzZXIubGFzdE5hbWUpICsgIiBcdTAwQjcgIiArIGNyZWF0ZWRTdHJpbmcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgeyBjbGFzc05hbWU6IGNsYXNzbmFtZXMoJ3RhZycsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVkOiAhIXNlcXVlbmNlLmRhdGEudGVhbSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpdmF0ZTogIXNlcXVlbmNlLmRhdGEudGVhbSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSB9LCBzZXF1ZW5jZS5kYXRhLnRlYW0gPyAnU2hhcmVkJyA6ICdQcml2YXRlJykpKSwKICAgICAgICAgICAgICAgICAgICAhIXRvdGFsICYmIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAiY2hhcnRzIiB9LCBzZXF1ZW5jZUFuYWx5dGljcy5tYXAoZnVuY3Rpb24gKGEpIHsgcmV0dXJuIChSZWFjdC5jcmVhdGVFbGVtZW50KExpbmssIHsgY2xhc3NOYW1lOiAibGluayIsIHRvOiAiL3NlcXVlbmNlcy8iICsgc2VxdWVuY2UuZGF0YS5pZCArICIvcmVjaXBpZW50cz9maWx0ZXI9IiArIGEubmFtZSwga2V5OiBhLm5hbWUgfSwKICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJjaGFydC13cmFwcGVyIiB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJjaGFydCIgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KFZpY3RvcnlQaWUsIHsga2V5OiBhLm5hbWUsIGRhdGE6IFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgeDogMSwgeTogYW5hbHl0aWNzW2EudmFsdWVdIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHg6IDIsIHk6IHRvdGFsIC0gYW5hbHl0aWNzW2EudmFsdWVdIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sIGNvbG9yU2NhbGU6IFthLmNvbG9yLCB2aWN0b3J5Q29sb3JCYWNrZ3JvdW5kXSwgaW5uZXJSYWRpdXM6IDEzMCwgYW5pbWF0ZTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IDUwMDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gfSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJudW1iZXJzIiB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJoMSIsIHsgc3R5bGU6IHsgY29sb3I6IGEuY29sb3IgfSB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS50b3RhbCA/CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5yb3VuZCgoYW5hbHl0aWNzW2EudmFsdWVdIC8gYS50b3RhbCkgKiAxMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiUiKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiaDQiLCBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5hbHl0aWNzW2EudmFsdWVdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiBvZiAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS50b3RhbCkpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAibGFiZWwiIH0sIGEubmFtZSkpKSk7IH0pKSksCiAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImRyaWxsZG93bnMiIH0sCiAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0YWJzIiB9LAogICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KExpbmssIHsgdG86ICIvc2VxdWVuY2VzLyIgKyBzZXF1ZW5jZS5kYXRhLmlkLCBjbGFzc05hbWU6ICJsaW5rIiB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6IGNsYXNzbmFtZXMoJ3RhYicsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQ6IHNlbGVjdGVkVGFiID09PSBTZXF1ZW5jZVRhYi5TdGFnZXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkgfSwgIlN0YWdlcyIpKSwKICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChMaW5rLCB7IHRvOiAiL3NlcXVlbmNlcy8iICsgc2VxdWVuY2UuZGF0YS5pZCArICIvcmVjaXBpZW50cyIsIGNsYXNzTmFtZTogImxpbmsiIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogY2xhc3NuYW1lcygndGFiJywgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZDogc2VsZWN0ZWRUYWIgPT09IFNlcXVlbmNlVGFiLlJlY2lwaWVudHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkgfSwgIlJlY2lwaWVudHMiKSksCiAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoTGluaywgeyB0bzogIi9zZXF1ZW5jZXMvIiArIHNlcXVlbmNlLmRhdGEuaWQgKyAiL3NldHRpbmdzIiwgY2xhc3NOYW1lOiAibGluayIgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiBjbGFzc25hbWVzKCd0YWInLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOiBzZWxlY3RlZFRhYiA9PT0gU2VxdWVuY2VUYWIuU2V0dGluZ3MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkgfSwgIlNldHRpbmdzIikpLAogICAgICAgICAgICAgICAgICAgICAgICAhc2VxdWVuY2UuZGF0YS5hcmNoaXZlZCAmJiBSZWFjdC5jcmVhdGVFbGVtZW50KCJidXR0b24iLCB7IGNsYXNzTmFtZTogInByaXZhdGUiLCBvbkNsaWNrOiB0aGlzLmhhbmRsZVNoYXJlIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZWFtICYmICFzZXF1ZW5jZS5kYXRhLnRlYW0gJiYgUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIG51bGwsICJUaGlzIHNlcXVlbmNlIGlzIHByaXZhdGUgdG8geW91LiIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVhbSAmJiAhc2VxdWVuY2UuZGF0YS50ZWFtICYmIFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCB7IGNsYXNzTmFtZTogInVuZGVybGluZSIgfSwgIlNoYXJlIHdpdGggdGVhbSIpKSwKICAgICAgICAgICAgICAgICAgICAgICAgISFzZXF1ZW5jZS5kYXRhLmFyY2hpdmVkICYmIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAicHJpdmF0ZSIgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCBudWxsLCAiVGhpcyBzZXF1ZW5jZSBpcyBhcmNoaXZlZC4iKSkpLAogICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkVGFiID09PSBTZXF1ZW5jZVRhYi5TdGFnZXMgJiYgUmVhY3QuY3JlYXRlRWxlbWVudChTdGFnZUxpc3QsIG51bGwpLAogICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkVGFiID09PSBTZXF1ZW5jZVRhYi5SZWNpcGllbnRzICYmIFJlYWN0LmNyZWF0ZUVsZW1lbnQoU2VxdWVuY2VSZWNpcGllbnRzTGlzdCwgeyBvbkFkZFJlY2lwaWVudHM6IHRoaXMuaGFuZGxlQWRkUmVjaXBpZW50Q2xpY2sgfSksCiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRUYWIgPT09IFNlcXVlbmNlVGFiLlNldHRpbmdzICYmIFJlYWN0LmNyZWF0ZUVsZW1lbnQoU2VxdWVuY2VTZXR0aW5ncywgbnVsbCkpKSwKICAgICAgICAgICAgc2VxdWVuY2VSZWNpcGllbnRzQWRkU3RhdGUgJiYgUmVhY3QuY3JlYXRlRWxlbWVudChPdmVybGF5LCBudWxsLAogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ1cGxvYWQtcHJvY2VzcyIgfSwKICAgICAgICAgICAgICAgICAgICAhc2VxdWVuY2VSZWNpcGllbnRzQWRkU3RhdGUuaGVhZGVyc1RvQWRkICYmCiAgICAgICAgICAgICAgICAgICAgICAgIHNlcXVlbmNlUmVjaXBpZW50c0FkZFN0YXRlLnN1Y2Nlc3NDb3VudCA9PT0gdW5kZWZpbmVkICYmIFJlYWN0LmNyZWF0ZUVsZW1lbnQoVXBsb2FkUmVjaXBpZW50LCB7IGhhbmRsZUZpbGVzOiB0aGlzLmhhbmRsZUZpbGVzLCBzZXF1ZW5jZU5hbWU6IHNlcXVlbmNlLmRhdGEubmFtZSwgb25DbG9zZTogdGhpcy5oYW5kbGVBZGRSZWNpcGllbnRDbG9zZSwgb25BZGRSZWNpcGllbnRzOiB0aGlzLmhhbmRsZUFkZFJlY2lwaWVudHMgfSksCiAgICAgICAgICAgICAgICAgICAgc2VxdWVuY2VSZWNpcGllbnRzQWRkU3RhdGUuaGVhZGVyc1RvQWRkICYmCiAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoQ1NWSGVhZGVyTWFwcGluZywgeyBoZWFkZXJzOiBzZXF1ZW5jZVJlY2lwaWVudHNBZGRTdGF0ZS5oZWFkZXJzVG9BZGQsIGRlZmF1bHRFbWFpbEhlYWRlcjogc2VxdWVuY2VSZWNpcGllbnRzQWRkU3RhdGUuZW1haWxIZWFkZXIsIGRlZmF1bHRGYW1pbHlOYW1lSGVhZGVyOiBzZXF1ZW5jZVJlY2lwaWVudHNBZGRTdGF0ZS5mYW1pbHlOYW1lSGVhZGVyLCBkZWZhdWx0R2l2ZW5OYW1lSGVhZGVyOiBzZXF1ZW5jZVJlY2lwaWVudHNBZGRTdGF0ZS5naXZlbk5hbWVIZWFkZXIsIG9uQ2xvc2U6IHRoaXMuaGFuZGxlQWRkUmVjaXBpZW50Q2xvc2UsIGFkZEhlYWRlcnM6IGFkZFNlcXVlbmNlUmVjaXBpZW50SGVhZGVycyB9KSwKICAgICAgICAgICAgICAgICAgICBzZXF1ZW5jZVJlY2lwaWVudHNBZGRTdGF0ZS5zdWNjZXNzQ291bnQgIT09IHVuZGVmaW5lZCAmJgogICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KFVwbG9hZFJlY2lwaWVudHNDb25maXJtYXRpb24sIHsgc3VjY2Vzc0NvdW50OiBzZXF1ZW5jZVJlY2lwaWVudHNBZGRTdGF0ZS5zdWNjZXNzQ291bnQsIHJlY2lwaWVudHM6IHNlcXVlbmNlUmVjaXBpZW50c0FkZFN0YXRlLnJlY2lwaWVudHMsIHNlcXVlbmNlTmFtZTogc2VxdWVuY2UuZGF0YS5uYW1lLCBvbkRvbmU6IHRoaXMuaGFuZGxlRG9uZSwgb25JbnZhbGlkQ2xpY2s6IHRoaXMuaGFuZGxlSW52YWxpZENsaWNrIH0pKSksCiAgICAgICAgICAgIG9uYm9hcmRpbmdQcm9wcyAmJiAhc2VxdWVuY2VSZWNpcGllbnRzQWRkU3RhdGUgJiYKICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoT25ib2FyZGluZ0Zvb3RlciwgX19hc3NpZ24oe30sIG9uYm9hcmRpbmdQcm9wcykpKSk7CiAgICB9OwogICAgcmV0dXJuIFNlcXVlbmNlRGV0YWlsOwp9KFJlYWN0LlB1cmVDb21wb25lbnQpKTsKZXhwb3J0IGRlZmF1bHQgU2VxdWVuY2VEZXRhaWw7Cg=="},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Sequences/routes/SequenceDetail/SequenceDetail.tsx","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Sequences/routes/SequenceDetail/SequenceDetail.tsx"],"names":[],"mappings":"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","sourcesContent":["import React from 'react';\nimport classnames from 'classnames';\nimport moment from 'moment';\nimport { VictoryPie } from 'victory';\nimport { Resource, Team, TeamMember, Onboarding } from '@src/types';\nimport {\n  Sequence,\n  SequenceTab,\n  SequenceStage,\n  SequenceStageInstance,\n  SequenceRecipientsAddState,\n} from '@src/types/sequences';\nimport history from '@src/lib/browserHistory';\nimport CenteredLoader from '@src/components/Loader/CenteredLoader';\n\nimport './SequenceDetail.scss';\nimport Dropdown from '@src/components/Form/Dropdown';\nimport EditableInput from '@src/components/Form/EditableInput/EditableInput';\nimport StageList from './StageList';\nimport { Link, RouteComponentProps } from 'react-router-dom';\nimport SequenceRecipientsList from './SequenceRecipientsList';\nimport SequenceSettings from './SequenceSettings';\nimport {\n  SequenceRecipientCreateMeta,\n  SequenceRecipientHeadersAddMeta,\n} from '@src/ducks/sequenceRecipients';\nimport Overlay from '@src/components/Base/Overlay';\nimport UploadRecipient from './UploadRecipient';\nimport CSVHeaderMapping from './CSVHeaderMapping/CSVHeaderMapping';\nimport Play from '@src/components/Icons/Play.svg';\nimport Pause from '@src/components/Icons/Pause.svg';\nimport Confirm, { Props as ConfirmProps } from '@src/components/Base/Confirm';\nimport { PulseGem } from '@src/components/Base/PulseGem';\nimport OnboardingFooter, {\n  Props as OnboardProps,\n} from '@src/components/Banner/OnboardingFooter/OnboardingFooter';\nimport { SequenceStageCreateMeta } from '@src/ducks/sequenceStages';\nimport { createSequenceStage } from '@src/mocks/sequences';\n// tslint:disable-next-line:max-line-length\nimport UploadRecipientsConfirmation from './UploadRecipientsConfirmation/UploadRecipientsConfirmation';\nimport { DARKMODE_VICTORY_BACKGROUND_COLOR, DEFAULT_VICTORY_BACKGROUND_COLOR } from '@src/lib/colors';\nimport { OnboardingPatchMeta } from '@src/ducks/me';\nimport { AmplitudeEvents, logAmplitudeEvent } from '@src/lib/amplitude-analytics';\n\nexport interface StateProps {\n  sequence?: Resource<Sequence>;\n  user?: TeamMember;\n  selectedTab?: SequenceTab;\n  team?: Team;\n  onboarding: Onboarding;\n  stages: Array<Resource<SequenceStage>>;\n  instances: SequenceStageInstance[];\n  sequenceRecipientsAddState?: SequenceRecipientsAddState;\n  sequenceRecipientsCount: number;\n}\n\nexport interface DispatchProps {\n  updateSequence: (sequence: Sequence) => void;\n  shareSequence: (sequence: Sequence) => void;\n  uploadCsv: (meta: File) => void;\n  duplicateSequence: (sequence: string) => void;\n  deleteSequence: (sequence: Sequence) => void;\n  exportSequence: (sequence: Sequence) => void;\n  addRecipients: (recipient: SequenceRecipientCreateMeta) => void;\n  updateOnboarding: (type: OnboardingPatchMeta) => void;\n  createStage: (meta: SequenceStageCreateMeta) => void;\n  showSequenceRecipientAdd: (shouldShow: boolean) => void;\n  addSequenceRecipientHeaders: (meta: SequenceRecipientHeadersAddMeta) => void;\n  clearSequenceRecipientSuccessCount: () => void;\n}\n\ninterface State {\n  confirmProps?: ConfirmProps;\n  onboardingProps?: OnboardProps;\n}\n\nclass SequenceDetail extends React.PureComponent<\n  StateProps & DispatchProps & RouteComponentProps<any>, State\n> {\n  constructor(props: StateProps & DispatchProps & RouteComponentProps<any>) {\n    super(props);\n\n    this.state = {};\n  }\n\n  handleMoreSelect = (value: string, index: number) => {\n    const {\n      sequence,\n      updateSequence,\n      duplicateSequence,\n      deleteSequence,\n      exportSequence,\n    } = this.props;\n\n    if (!sequence || !sequence.data) {\n      return;\n    }\n\n    switch (value) {\n      case 'Archive':\n        updateSequence({\n          ...sequence.data,\n          archived: true,\n          paused: true,\n        });\n        break;\n      case 'Unarchive':\n        updateSequence({\n          ...sequence.data,\n          archived: false,\n        });\n        break;\n      case 'Duplicate':\n        duplicateSequence(sequence.data.id);\n        break;\n      case 'Export':\n        exportSequence(sequence.data);\n        break;\n      case 'Delete':\n        const deleteHandler = () => {\n          if (sequence.data) {\n            deleteSequence(sequence.data);\n          }\n          history.push('/sequences');\n          this.setState({ confirmProps: undefined });\n        };\n\n        // Show confirm dialogue with callback to delete\n        const confirmProps: ConfirmProps = {\n          title: 'Delete this Sequence?',\n          message: 'Are you sure you want to delete this Sequence?'\n            + ' Any analytics and recipients data will be lost forever.',\n          confirmCopy: 'Delete',\n          cancelCopy: 'Cancel',\n          onConfirm: () => deleteHandler(),\n          onCancel: () => this.setState({ confirmProps: undefined }),\n        };\n\n        this.setState({\n          confirmProps,\n        });\n        break;\n      default:\n        break;\n    }\n  }\n\n  componentDidUpdate() {\n    this.setNextOnboarding();\n  }\n\n  setNextOnboarding = () => {\n    const { onboarding, updateOnboarding, createStage, sequence } = this.props;\n    let onboardingProps: OnboardProps | undefined;\n    if (!onboarding.addSequenceRecipients && !this.state.onboardingProps) {\n      onboardingProps = {\n        id: 'addSequenceRecipients',\n        title: 'Add Recipients',\n        message: 'Get started by adding recipients to your Sequence. '\n        + 'You\\'ll also be able to add more recipients later.',\n        buttonCopy: 'Add Recipients',\n        onClick: () => {\n          this.handleAddRecipientClick();\n        },\n        onSkip: () => {\n          if (!onboarding.addSequenceRecipients) {\n            updateOnboarding({ skipped: true, type: { addSequenceRecipients: true } });\n            this.setState({ onboardingProps: undefined });\n          }\n        },\n      };\n      this.setState({ onboardingProps });\n\n    } else if (!onboarding.editSequenceStage && !this.state.onboardingProps) {\n      onboardingProps = {\n        id: 'editSequenceStage',\n        title: 'Edit Sequence Stages',\n        message: 'Each stage represents a message in your Sequence. '\n          + 'Edit your first stage to continue',\n        buttonCopy: 'Edit Stage',\n        onClick: () => {\n          // Handle redirect to first sequence when clicked on\n          const { stages } = this.props;\n          const stage = stages[0];\n          const sequenceId = sequence && sequence.data && sequence.data.id;\n          const stageId = stage && stage.data && stage.data.id;\n          if (sequenceId && stageId) {\n            history.push(`/sequences/${sequenceId}/stages/${stageId}`);\n          }\n        },\n        onSkip: () => {\n          if (!onboarding.editSequenceStage) {\n            updateOnboarding({ skipped: true, type: { editSequenceStage: true } });\n            this.setState({ onboardingProps: undefined });\n          }\n        },\n      };\n      this.setState({ onboardingProps });\n\n    } else if (!onboarding.createAdditionalStage && !this.state.onboardingProps) {\n      onboardingProps = {\n        id: 'createAdditionalStage',\n        title: 'Create Additional Stages',\n        message: 'Recipients will be automatically sent the next stage. '\n          + 'after a certain number of days if they haven\\'t responded.',\n        buttonCopy: 'Add Stage',\n        onClick: () => {\n          // Creates sequence\n          if (sequence && sequence.data) {\n            const mockStage = createSequenceStage({\n              sequence: sequence && sequence.data && sequence.data.id,\n            });\n            createStage({ stage: mockStage, navigateTo: true });\n          }\n        },\n        onSkip: () => {\n          if (!onboarding.createAdditionalStage) {\n            updateOnboarding({ skipped: true, type: { createAdditionalStage: true } });\n            this.setState({ onboardingProps: undefined });\n          }\n        },\n      };\n      this.setState({ onboardingProps });\n\n    } else if (!onboarding.activateSequence && !this.state.onboardingProps) {\n\n      onboardingProps = {\n        id: 'activateSequence',\n        title: 'You\\'re ready to start sending!',\n        message: 'You can check your Settings first to update which days and times '\n        + 'your Sequence will send.',\n        buttonCopy: 'Activate Sequence',\n        onClick: () => {\n          // Handles unpausing\n          if (sequence && sequence.data && sequence.data.paused) {\n            this.handlePausedToggle();\n          }\n          this.setState({ onboardingProps: undefined });\n        },\n        onSkip: () => {\n          if (!onboarding.activateSequence) {\n            updateOnboarding({ skipped: true, type: { activateSequence: true } });\n            this.setState({ onboardingProps: undefined });\n          }\n        },\n      };\n      this.setState({ onboardingProps });\n    }\n  }\n\n  // Blocks activating sequence with confirm prompt if any unedited stages or no recipients\n  passesActivateRequirements = (): boolean => {\n    const { instances, sequenceRecipientsCount } = this.props;\n    const uneditedStages = instances.filter(instance => !instance.userEdited);\n\n    if (uneditedStages.length > 0) {\n      const firstStage = uneditedStages[0];\n      const sequenceId = firstStage.sequence;\n      const stageId = firstStage.stage;\n      const title = uneditedStages.length > 1\n        ? 'Edit Stages'\n        : 'Edit Stage';\n      const stageDescriptor = uneditedStages.length > 1\n        ? `${uneditedStages.length} stages`\n        : 'an unedited stage';\n      const confirmProps: ConfirmProps = {\n        title,\n        message: `You have ${stageDescriptor} that need `\n        + 'to be updated before activating this sequence.',\n        confirmCopy: 'Edit Stage',\n        onConfirm: () => {\n          this.setState({ confirmProps: undefined });\n          history.push(`/sequences/${sequenceId}/stages/${stageId}`);\n        },\n      };\n\n      this.setState({ confirmProps });\n      return false;\n    }\n\n    if (sequenceRecipientsCount === 0) {\n      const title = 'Add Recipients';\n      const message = 'You need to add recipients before activating this Sequence';\n      const confirmProps: ConfirmProps = {\n        title,\n        message,\n        confirmCopy: 'Add',\n        cancelCopy: 'Cancel',\n        onConfirm: () => {\n          this.handleAddRecipientClick();\n          this.setState({ confirmProps: undefined });\n        },\n        onCancel: () => this.setState({ confirmProps: undefined }),\n      };\n\n      this.setState({ confirmProps });\n      return false;\n    }\n\n    return true;\n  }\n\n  handlePausedToggle = () => {\n    const { sequence, updateSequence, updateOnboarding, onboarding } = this.props;\n    // Toggle onboarding if activate sequence is on\n    if (!onboarding.activateSequence) {\n      updateOnboarding({ skipped: false, type: { activateSequence: true } });\n      this.setState({ onboardingProps: undefined });\n    }\n\n    // Do not allow setting live if stage has not been updated\n    if (!this.passesActivateRequirements()) {\n      return;\n    }\n\n    if (sequence && sequence.data) {\n      const togglePause = () => updateSequence({\n        ...sequence.data!,\n        paused: !sequence.data!.paused,\n      });\n\n      // If active, immediately pause\n      if (!sequence.data.paused) {\n        togglePause();\n      }\n\n      // Show confirm prompt if not active yet\n      if (sequence.data.paused) {\n        const confirmProps: ConfirmProps = {\n          title: `Activate ${sequence.data.name}`,\n          message: `When activated, this sequence will go `\n            + `live to ${sequence.data.recipients.active} recipients.`,\n          cancelCopy: 'Cancel',\n          confirmCopy: 'Set Live',\n          onConfirm: () => {\n            togglePause();\n            logAmplitudeEvent(AmplitudeEvents.StartNewSequence);\n            this.setState({ confirmProps: undefined });\n          },\n          onCancel: () => {\n            this.setState({ confirmProps: undefined });\n          },\n        };\n        this.setState({\n          confirmProps,\n        });\n      }\n    }\n  }\n\n  handleEditName = (property: string, name: string) => {\n    const { sequence, updateSequence } = this.props;\n\n    if (sequence && sequence.data) {\n      updateSequence({\n        ...sequence.data,\n        name,\n      });\n    }\n  }\n\n  handleShare = () => {\n    const { sequence, team, shareSequence } = this.props;\n\n    if (sequence && sequence.data && team) {\n      shareSequence({\n        ...sequence.data,\n        team: team.id,\n      });\n    }\n  }\n\n  handleFiles = (files: File[]) => {\n    const { uploadCsv } = this.props;\n    const file = files[0];\n\n    if (uploadCsv && file) {\n      uploadCsv(file);\n    }\n  }\n\n  renderLoadingState = () => {\n    return (\n      <div className=\"sequence-detail\">\n        <CenteredLoader />\n      </div>\n    );\n  }\n\n  handleAddRecipientClick = () => {\n    const { onboarding, updateOnboarding, showSequenceRecipientAdd } = this.props;\n\n    // Handle removing onboarding props\n    if (!onboarding.addSequenceRecipients) {\n      updateOnboarding({ skipped: false, type: { addSequenceRecipients: true } });\n      this.setState({ onboardingProps: undefined });\n    }\n\n    showSequenceRecipientAdd(true);\n  }\n\n  handleAddRecipientClose = () => {\n    this.props.showSequenceRecipientAdd(false);\n  }\n\n  handleAddRecipients = (\n    addAsPaused: boolean,\n  ) => {\n    const { addRecipients, sequence } = this.props;\n\n    if (sequence && sequence.data) {\n      addRecipients({\n        sequence: sequence.data.id,\n        addAsPaused,\n      });\n    }\n  }\n\n  handleDone = () => {\n    const { sequence, showSequenceRecipientAdd } = this.props;\n\n    if (sequence && sequence.data) {\n      showSequenceRecipientAdd(false);\n      history.push(`/sequences/${sequence.data.id}/recipients`);\n    }\n  }\n\n  handleInvalidClick = () => {\n    const { clearSequenceRecipientSuccessCount } = this.props;\n\n    clearSequenceRecipientSuccessCount();\n  }\n\n  render() {\n    const {\n      sequence,\n      user,\n      team,\n      stages,\n      // uploadedSequenceRecipients,\n      onboarding,\n      sequenceRecipientsAddState,\n      addSequenceRecipientHeaders,\n    } = this.props;\n    const { confirmProps, onboardingProps } = this.state;\n    const selectedTab = this.props.selectedTab || SequenceTab.Stages;\n    const showActivateGem = onboarding.createAdditionalStage && onboarding.editSequenceStage &&\n      onboarding.addSequenceRecipients && !onboarding.activateSequence;\n\n    if (!sequence || !sequence.data || !stages || !stages.length || !stages[0].data) {\n      return this.renderLoadingState();\n    }\n\n    const { recipients, analytics } = sequence.data;\n    const recipientsNum = recipients.active + recipients.completed +\n      recipients.paused + recipients.bounced + recipients.failed;\n    const recipientsAnalytics = [\n      { name: 'Active', value: 'active' },\n      { name: 'Completed', value: 'completed' },\n      { name: 'Paused', value: 'paused' },\n      { name: 'Bounced', value: 'bounced' },\n    ];\n    const sequenceAnalytics = [\n      {\n        name: 'Delivered',\n        value: 'delivered',\n        color: '#444',\n        total: analytics.delivered + recipients.bounced,\n      },\n      {\n        name: 'Opened',\n        value: 'opened',\n        color: '#00aaff',\n        total: sequence.data.analytics.delivered - recipients.bounced,\n      },\n      {\n        name: 'Clicked',\n        value: 'clicked',\n        color: '#ffa057',\n        total: sequence.data.analytics.delivered - recipients.bounced,\n      },\n      {\n        name: 'Downloaded',\n        value: 'downloaded',\n        color: '#d347ae',\n        total: sequence.data.analytics.delivered - recipients.bounced,\n      },\n      {\n        name: 'Replied',\n        value: 'replied',\n        color: '#0ec36b',\n        total: sequence.data.analytics.deliveredUnique,\n      },\n      {\n        name: 'Unsubscribed',\n        value: 'unsubscribed',\n        color: '#444',\n        total: sequence.data.analytics.deliveredUnique,\n      },\n    ];\n    const createdString = moment(sequence.data.created).format('MMM DD, YYYY');\n    const total = sequence.data.analytics.delivered - recipients.bounced;\n    const dropdownValues = ['Archive', 'Duplicate', 'Export', 'Delete'];\n\n    if (sequence.data.archived) {\n      dropdownValues[0] = 'Unarchive';\n    }\n\n    // TODO(SHIN): Abstract to not rely on document.body (preferably using constants)\n    const victoryColorBackground = document.body.getAttribute('theme') === 'theme-dark'\n      ? DARKMODE_VICTORY_BACKGROUND_COLOR : DEFAULT_VICTORY_BACKGROUND_COLOR;\n\n    return (\n      <div className=\"sequence-detail\">\n        {confirmProps &&\n          <Confirm\n            {...confirmProps}\n          />\n        }\n        <div className=\"navigation-bar\">\n          <div className=\"navigation\">\n            <Link\n              className=\"sequences-breadcrumb\"\n              to={!sequence.data.archived ? `/sequences` : `/sequences/archive`}\n            >\n              {!sequence.data.archived ? 'Sequences' : 'Archive'}\n            </Link>\n            <span className=\"arrow\">&gt;</span>\n            <Link to={`/sequences/${sequence.data.id}`} className=\"sequence-breadcrumb\">\n              {sequence.data.name}\n            </Link>\n            {!sequence.data.paused && <span className=\"live-badge\">\n              Live\n            </span>}\n          </div>\n          <div className=\"actions\">\n            {onboarding && !onboarding.addSequenceRecipients &&\n              <PulseGem top=\"-15px\" left=\"-30px\" />\n            }\n            {!sequence.data.archived && <button\n              className=\"add-recipients\"\n              onClick={this.handleAddRecipientClick}\n            >\n              + Add Recipients\n            </button>}\n            <Dropdown\n              placeholder=\"More\"\n              values={dropdownValues}\n              onSelect={this.handleMoreSelect}\n              value=\"\"\n            />\n            {showActivateGem &&\n              <PulseGem top=\"-16px\" left=\"-20px\" />\n            }\n            <button\n              className={classnames({\n                'set-live': sequence.data.paused,\n                pause: !sequence.data.paused,\n              })}\n              onClick={this.handlePausedToggle}\n            >\n              {sequence.data.paused ? <Play className=\"icon\" /> : <Pause className=\"icon\" />}\n              <span>{sequence.data.paused ? 'Set Live' : 'Pause'}</span>\n            </button>\n          </div>\n        </div>\n        <div className=\"main\">\n          <div className=\"sequence-analytics\">\n            <div className=\"top-row\">\n              <div className=\"title\">\n                <EditableInput\n                  className=\"name\"\n                  text={sequence.data.name}\n                  onSet={this.handleEditName}\n                  property=\"name\"\n                />\n              </div>\n              <div className=\"recipients-analytics\">\n                {!!recipientsNum && <Link\n                  className=\"link\"\n                  to={`/sequences/${sequence.data.id}/recipients?filter=AllRecipients`}\n                >\n                  <div className=\"recipients-analytic\">\n                    <span className=\"number\">{recipientsNum}</span>\n                    <span>Recipients</span>\n                  </div>\n                </Link>}\n                {recipientsAnalytics.filter(r => !!recipients[r.value]).map(r => (\n                  <Link\n                    className=\"link\"\n                    to={`/sequences/${sequence.data!.id}/recipients?filter=${r.name}`}\n                    key={r.value}\n                  >\n                    <div className={classnames('recipients-analytic', r.value)}>\n                      <span className=\"number\">{recipients[r.value]}</span>\n                      <span>{r.name}</span>\n                    </div>\n                  </Link>\n                ))}\n              </div>\n            </div>\n            <div className=\"details\">\n              <div className=\"numbers\">\n                {`${sequence.data.stages} stages  ${sequence.data.durationDays} days in sequence`}\n                {!!recipients.failed && <Link\n                  className=\"error\"\n                  to={`/sequences/${sequence.data.id}/recipients?filter=Failed`}\n                >\n                  {` ${recipients.failed} recipients failed`}\n                </Link>}\n              </div>\n              <div className=\"created\">\n                {`Created by ${user && `${user.firstName} ${user.lastName}`}  ${createdString}`}\n                <span\n                  className={classnames('tag', {\n                    shared: !!sequence.data.team,\n                    private: !sequence.data.team,\n                  })}\n                >\n                  {sequence.data.team ? 'Shared' : 'Private'}\n                </span>\n              </div>\n            </div>\n            {!!total && <div className=\"charts\">\n              {sequenceAnalytics.map(a => (\n                <Link\n                  className=\"link\"\n                  to={`/sequences/${sequence.data!.id}/recipients?filter=${a.name}`}\n                  key={a.name}\n                >\n                  <div className=\"chart-wrapper\">\n                    <div className=\"chart\">\n                      <VictoryPie\n                        key={a.name}\n                        data={[\n                          { x: 1, y: analytics[a.value] },\n                          { x: 2, y: total - analytics[a.value] },\n                        ]}\n                        colorScale={[a.color, victoryColorBackground]}\n                        innerRadius={130}\n                        animate={{\n                          duration: 5000,\n                        }}\n                      />\n                      <div className=\"numbers\">\n                        <h1 style={{ color: a.color }}>\n                          {a.total ?\n                            Math.round((analytics[a.value] / a.total) * 100)\n                            : 0}%\n                        </h1>\n                        <h4>{analytics[a.value]} of {a.total}</h4>\n                      </div>\n                    </div>\n                    <div className=\"label\">\n                      {a.name}\n                    </div>\n                  </div>\n                </Link>\n              ))}\n            </div>}\n          </div>\n          <div className=\"drilldowns\">\n            <div className=\"tabs\">\n              <Link to={`/sequences/${sequence.data.id}`} className=\"link\">\n                <div\n                  className={classnames('tab', {\n                    selected: selectedTab === SequenceTab.Stages,\n                  })}\n                >\n                  Stages\n                </div>\n              </Link>\n              <Link to={`/sequences/${sequence.data.id}/recipients`} className=\"link\">\n                <div\n                  className={classnames('tab', {\n                    selected: selectedTab === SequenceTab.Recipients,\n                  })}\n                >\n                  Recipients\n                </div>\n              </Link>\n              <Link to={`/sequences/${sequence.data.id}/settings`} className=\"link\">\n                <div\n                  className={classnames('tab', {\n                    selected: selectedTab === SequenceTab.Settings,\n                  })}\n                >\n                  Settings\n                </div>\n              </Link>\n              {!sequence.data.archived && <button className=\"private\" onClick={this.handleShare}>\n                {team && !sequence.data.team && <span>This sequence is private to you.</span>}\n                {team && !sequence.data.team && <span className=\"underline\">Share with team</span>}\n              </button>}\n              {!!sequence.data.archived && <div className=\"private\">\n                <span>This sequence is archived.</span>\n              </div>}\n            </div>\n            {selectedTab === SequenceTab.Stages && <StageList />}\n            {selectedTab === SequenceTab.Recipients && <SequenceRecipientsList\n              onAddRecipients={this.handleAddRecipientClick}\n            />}\n            {selectedTab === SequenceTab.Settings && <SequenceSettings />}\n          </div>\n        </div>\n        {sequenceRecipientsAddState && <Overlay>\n            <div className=\"upload-process\">\n              {!sequenceRecipientsAddState.headersToAdd &&\n                sequenceRecipientsAddState.successCount === undefined && <UploadRecipient\n                  handleFiles={this.handleFiles}\n                  sequenceName={sequence.data.name}\n                  onClose={this.handleAddRecipientClose}\n                  onAddRecipients={this.handleAddRecipients}\n                />}\n            {sequenceRecipientsAddState.headersToAdd &&\n              <CSVHeaderMapping\n                headers={sequenceRecipientsAddState.headersToAdd}\n                defaultEmailHeader={sequenceRecipientsAddState.emailHeader}\n                defaultFamilyNameHeader={sequenceRecipientsAddState.familyNameHeader}\n                defaultGivenNameHeader={sequenceRecipientsAddState.givenNameHeader}\n                onClose={this.handleAddRecipientClose}\n                addHeaders={addSequenceRecipientHeaders}\n              />}\n            {sequenceRecipientsAddState.successCount !== undefined &&\n              <UploadRecipientsConfirmation\n                successCount={sequenceRecipientsAddState.successCount}\n                recipients={sequenceRecipientsAddState.recipients}\n                sequenceName={sequence.data.name}\n                onDone={this.handleDone}\n                onInvalidClick={this.handleInvalidClick}\n              />}\n            </div>\n          </Overlay>}\n        {onboardingProps && !sequenceRecipientsAddState &&\n          <OnboardingFooter\n            {...onboardingProps}\n          />\n        }\n      </div>\n    );\n  }\n}\n\nexport default SequenceDetail;\n"]}]}