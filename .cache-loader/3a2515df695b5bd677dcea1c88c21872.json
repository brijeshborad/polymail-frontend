{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Sequences/routes/SequenceStageDetail/SequenceStageDetail.tsx","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Sequences/routes/SequenceStageDetail/SequenceStageDetail.tsx","mtime":1675280254091},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewogICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewogICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAogICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKICAgIH07CiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwogICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQogICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKICAgIH07Cn0pKCk7CnZhciBfX2Fzc2lnbiA9ICh0aGlzICYmIHRoaXMuX19hc3NpZ24pIHx8IGZ1bmN0aW9uICgpIHsKICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbih0KSB7CiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7CiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07CiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkKICAgICAgICAgICAgICAgIHRbcF0gPSBzW3BdOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdDsKICAgIH07CiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfTsKaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JzsKaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnOwppbXBvcnQgeyB2YWx1ZXMgfSBmcm9tICdsb2Rhc2gnOwppbXBvcnQgY2xhc3NuYW1lcyBmcm9tICdjbGFzc25hbWVzJzsKaW1wb3J0IHsgQXR0YWNobWVudE1ldGFTdGF0dXMsIH0gZnJvbSAnQHNyYy90eXBlcyc7CmltcG9ydCB7IFNlcXVlbmNlVGFiIH0gZnJvbSAnQHNyYy90eXBlcy9zZXF1ZW5jZXMnOwppbXBvcnQgRWRpdCBmcm9tICdAc3JjL2NvbXBvbmVudHMvSWNvbnMvRWRpdC5zdmcnOwppbXBvcnQgaGlzdG9yeSBmcm9tICdAc3JjL2xpYi8vYnJvd3Nlckhpc3RvcnknOwppbXBvcnQgJy4vU2VxdWVuY2VTdGFnZURldGFpbC5zY3NzJzsKaW1wb3J0IERyb3Bkb3duIGZyb20gJ0BzcmMvY29tcG9uZW50cy9Gb3JtL0Ryb3Bkb3duJzsKaW1wb3J0IHsgVmljdG9yeVBpZSB9IGZyb20gJ3ZpY3RvcnknOwppbXBvcnQgeyBMaW5rIH0gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSc7CmltcG9ydCBTZXF1ZW5jZVN0YWdlTWVzc2FnZSBmcm9tICcuL1NlcXVlbmNlU3RhZ2VNZXNzYWdlJzsKaW1wb3J0IFNlcXVlbmNlU3RhZ2VSZWNpcGllbnRzTGlzdCBmcm9tICcuL1NlcXVlbmNlU3RhZ2VSZWNpcGllbnRzTGlzdCc7CmltcG9ydCBPdmVybGF5IGZyb20gJ0BzcmMvY29tcG9uZW50cy9CYXNlL092ZXJsYXknOwppbXBvcnQgU2VuZFRlc3RFbWFpbCBmcm9tICcuL1NlbmRUZXN0RW1haWwvU2VuZFRlc3RFbWFpbCc7CmltcG9ydCB7IGNvbnZlcnRUb0F0dGFjaG1lbnQgfSBmcm9tICdAc3JjL2xpYi9hdHRhY2htZW50JzsKaW1wb3J0IHsgc3RhZ2VJbnN0YW5jZUF0dGFjaG1lbnRzVG9EZWxldGUgfSBmcm9tICdAc3JjL2xpYi9tb2RlbHMvc2VxdWVuY2VTdGFnZUluc3RhbmNlcyc7CmltcG9ydCBDb25maXJtIGZyb20gJ0BzcmMvY29tcG9uZW50cy9CYXNlL0NvbmZpcm0nOwppbXBvcnQgeyBGYWtlRE9NIH0gZnJvbSAnQHNyYy9saWIvaHRtbCc7CmltcG9ydCB7IERBUktNT0RFX1ZJQ1RPUllfQkFDS0dST1VORF9DT0xPUiwgREVGQVVMVF9WSUNUT1JZX0JBQ0tHUk9VTkRfQ09MT1IgfSBmcm9tICdAc3JjL2xpYi9jb2xvcnMnOwp2YXIgU2VxdWVuY2VTdGFnZURldGFpbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhTZXF1ZW5jZVN0YWdlRGV0YWlsLCBfc3VwZXIpOwogICAgZnVuY3Rpb24gU2VxdWVuY2VTdGFnZURldGFpbCgpIHsKICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzOwogICAgICAgIC8vIE1hcmtzIHN1Y2Nlc3NmdWwgY2FzZXMgZm9yIG9uYm9hZGluZyB1cGRhdGVzCiAgICAgICAgX3RoaXMuaGFuZGxlT25ib2FyZGluZ1VwZGF0ZXMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBfYSA9IF90aGlzLnByb3BzLCBvbmJvYXJkaW5nID0gX2Eub25ib2FyZGluZywgdXBkYXRlT25ib2FyZGluZyA9IF9hLnVwZGF0ZU9uYm9hcmRpbmc7CiAgICAgICAgICAgIGlmIChvbmJvYXJkaW5nICYmICFvbmJvYXJkaW5nLmVkaXRTZXF1ZW5jZVN0YWdlKSB7CiAgICAgICAgICAgICAgICB1cGRhdGVPbmJvYXJkaW5nKHsgc2tpcHBlZDogZmFsc2UsIHR5cGU6IHsgZWRpdFNlcXVlbmNlU3RhZ2U6IHRydWUgfSB9KTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAob25ib2FyZGluZyAmJiAhb25ib2FyZGluZy5jcmVhdGVBZGRpdGlvbmFsU3RhZ2UpIHsKICAgICAgICAgICAgICAgIHVwZGF0ZU9uYm9hcmRpbmcoeyBza2lwcGVkOiBmYWxzZSwgdHlwZTogeyBjcmVhdGVBZGRpdGlvbmFsU3RhZ2U6IHRydWUgfSB9KTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlTW9yZVNlbGVjdCA9IGZ1bmN0aW9uICh2YWx1ZSwgaW5kZXgpIHsKICAgICAgICAgICAgdmFyIF9hID0gX3RoaXMucHJvcHMsIHN0YWdlID0gX2Euc3RhZ2UsIGRlbGV0ZVN0YWdlID0gX2EuZGVsZXRlU3RhZ2UsIHNlcXVlbmNlID0gX2Euc2VxdWVuY2UsIGR1cGxpY2F0ZVN0YWdlID0gX2EuZHVwbGljYXRlU3RhZ2U7CiAgICAgICAgICAgIGlmICghc3RhZ2UgfHwgIXNlcXVlbmNlIHx8ICFzZXF1ZW5jZS5kYXRhKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgc3dpdGNoICh2YWx1ZSkgewogICAgICAgICAgICAgICAgY2FzZSAnRHVwbGljYXRlJzoKICAgICAgICAgICAgICAgICAgICBkdXBsaWNhdGVTdGFnZShzdGFnZSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlICdEZWxldGUnOgogICAgICAgICAgICAgICAgICAgIC8vIEhhbmRsZXMgZGVsZXRlIGFuZCByZXJvdXRlLCBhbmQgY29uZmlybSBkaXNtaXNzYWwKICAgICAgICAgICAgICAgICAgICB2YXIgZGVsZXRlSGFuZGxlcl8xID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhZ2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZVN0YWdlKHN0YWdlKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VxdWVuY2UgJiYgc2VxdWVuY2UuZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlzdG9yeS5wdXNoKCIvc2VxdWVuY2VzLyIgKyBzZXF1ZW5jZS5kYXRhLmlkKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IGNvbmZpcm1Qcm9wczogdW5kZWZpbmVkIH0pOwogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgLy8gU2hvdyBjb25maXJtIGRpYWxvZ3VlIHdpdGggY2FsbGJhY2sgdG8gZGVsZXRlCiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbmZpcm1Qcm9wcyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdEZWxldGUgdGhpcyBTdGFnZT8nLAogICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGlzIFN0YWdlPycKICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgJyBBbnkgYW5hbHl0aWNzIGFuZCByZWNpcGllbnRzIGRhdGEgd2lsbCBiZSBsb3N0IGZvcmV2ZXIuJywKICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlybUNvcHk6ICdEZWxldGUnLAogICAgICAgICAgICAgICAgICAgICAgICBjYW5jZWxDb3B5OiAnQ2FuY2VsJywKICAgICAgICAgICAgICAgICAgICAgICAgb25Db25maXJtOiBmdW5jdGlvbiAoKSB7IHJldHVybiBkZWxldGVIYW5kbGVyXzEoKTsgfSwKICAgICAgICAgICAgICAgICAgICAgICAgb25DYW5jZWw6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnNldFN0YXRlKHsgY29uZmlybVByb3BzOiB1bmRlZmluZWQgfSk7IH0sCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpcm1Qcm9wczogY29uZmlybVByb3BzLAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlRWRpdCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBlZGl0OiB0cnVlIH0pOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlVGVzdEVtYWlsQ2xpY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGlmIChfdGhpcy5zdGF0ZS5lZGl0KSB7CiAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IHNob3dUZXN0RW1haWxQb3BvdmVyOiB0cnVlIH0pOwogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5pZGVudGlmeU51bWJlck9mVW5tYXRjaGVkUGxhY2Vob2xkZXJzID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgc2VxdWVuY2UgPSBfdGhpcy5wcm9wcy5zZXF1ZW5jZTsKICAgICAgICAgICAgdmFyIHVubWF0Y2hlZFBsYWNlaG9sZGVycyA9IDA7CiAgICAgICAgICAgIHZhciBoZWFkZXJzID0gc2VxdWVuY2UgJiYgc2VxdWVuY2UuZGF0YSAmJiBzZXF1ZW5jZS5kYXRhLmhlYWRlcnMgfHwgW107CiAgICAgICAgICAgIHZhbHVlcyhfdGhpcy5zdGF0ZS51cGRhdGVkSW5zdGFuY2VzKQogICAgICAgICAgICAgICAgLmZvckVhY2goZnVuY3Rpb24gKGluc3RhbmNlKSB7CiAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgYm9keSBwbGFjZWhvbGRlcnMKICAgICAgICAgICAgICAgIHZhciBib2R5Q29udGFpbmVyID0gRmFrZURPTSgpLmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICAgICAgYm9keUNvbnRhaW5lci5pbm5lckhUTUwgPSBpbnN0YW5jZS5ib2R5OwogICAgICAgICAgICAgICAgdmFyIHVubWF0Y2hlZEJvZHlQbGFjZWhvbGRlcnMgPSBib2R5Q29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLXBtLW5vLXZhcmlhYmxlXScpOwogICAgICAgICAgICAgICAgaWYgKHVubWF0Y2hlZEJvZHlQbGFjZWhvbGRlcnMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgIHVubWF0Y2hlZFBsYWNlaG9sZGVycyArPSB1bm1hdGNoZWRCb2R5UGxhY2Vob2xkZXJzLmxlbmd0aDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBoZWFkZXJzIHBsYWNob2xkZXJzCiAgICAgICAgICAgICAgICB2YXIgaGVhZGVyUGxhY2hvbGRlcnMgPSBpbnN0YW5jZS5zdWJqZWN0Lm1hdGNoKC97e1tcd1xzXSt9fS9nKTsKICAgICAgICAgICAgICAgIGlmIChoZWFkZXJQbGFjaG9sZGVycykgewogICAgICAgICAgICAgICAgICAgIGhlYWRlclBsYWNob2xkZXJzCiAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKG1hdGNoKSB7IHJldHVybiBtYXRjaC5yZXBsYWNlKC9be31dKy9nLCAnJyk7IH0pCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JFYWNoKGZ1bmN0aW9uIChtYXRjaCkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGVhZGVycy5pbmRleE9mKG1hdGNoKSA9PT0gLTEgJiYKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoICE9PSAnZW1haWwnICYmIG1hdGNoICE9PSAnZmlyc3QgbmFtZScgJiYKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoICE9PSAnbGFzdCBuYW1lJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5tYXRjaGVkUGxhY2Vob2xkZXJzICs9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJldHVybiB1bm1hdGNoZWRQbGFjZWhvbGRlcnM7CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5oYW5kbGVTYXZlID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgX2EgPSBfdGhpcy5wcm9wcywgdXBkYXRlU3RhZ2VJbnN0YW5jZSA9IF9hLnVwZGF0ZVN0YWdlSW5zdGFuY2UsIGF0dGFjaG1lbnRNZXRhcyA9IF9hLmF0dGFjaG1lbnRNZXRhcywgYXR0YWNobWVudHMgPSBfYS5hdHRhY2htZW50cywgcmVtb3ZlQXR0YWNobWVudCA9IF9hLnJlbW92ZUF0dGFjaG1lbnQsIHNlcXVlbmNlID0gX2Euc2VxdWVuY2UsIHVwZGF0ZVN0YWdlID0gX2EudXBkYXRlU3RhZ2U7CiAgICAgICAgICAgIC8vIEJsb2NrcyBhbnkgc2F2ZXMgd2hlbiBhIHBsYWNlaG9sZGVyIGV4aXN0cyBhbmQgZG9lcyBub3QgbWF0Y2ggdmFyaWFibGVzCiAgICAgICAgICAgIHZhciB1bm1hdGNoZWRQbGFjZWhvbGRlcnMgPSBfdGhpcy5pZGVudGlmeU51bWJlck9mVW5tYXRjaGVkUGxhY2Vob2xkZXJzKCk7CiAgICAgICAgICAgIGlmICh1bm1hdGNoZWRQbGFjZWhvbGRlcnMgPiAwKSB7CiAgICAgICAgICAgICAgICB2YXIgY29uZmlybVByb3BzID0gewogICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnUmVtb3ZlIFBsYWNlaG9sZGVycycsCiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogIlRoaXMgbWVzc2FnZSBoYXMgIiArIHVubWF0Y2hlZFBsYWNlaG9sZGVycyArICIgcGxhY2Vob2xkZXJzIHRoYXQgZG8gbm90IG1hdGNoIgogICAgICAgICAgICAgICAgICAgICAgICArICcgYW55IHZhcmlhYmxlcy4gUGxlYXNlIHJlbW92ZSB0aGVzZSBwbGFjZWhvbGRlcnMgYmVmb3JlIHNhdmluZyB5b3VyIGNoYW5nZXMuJywKICAgICAgICAgICAgICAgICAgICBjb25maXJtQ29weTogJ09rJywKICAgICAgICAgICAgICAgICAgICBvbkNvbmZpcm06IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnNldFN0YXRlKHsgY29uZmlybVByb3BzOiB1bmRlZmluZWQgfSk7IH0sCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBjb25maXJtUHJvcHM6IGNvbmZpcm1Qcm9wcyB9KTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICB2YXIgc2F2ZUhhbmRsZXIgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB2YWx1ZXMoX3RoaXMuc3RhdGUudXBkYXRlZEluc3RhbmNlcykKICAgICAgICAgICAgICAgICAgICAuZm9yRWFjaChmdW5jdGlvbiAoaW5zdGFuY2UpIHsKICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmVzIGFueSBhdHRhY2htZW50cyB0aGF0IHdlcmUgcmVtb3ZlZCBmcm9tIHRoZSBib2R5IG9uIHNhdmUKICAgICAgICAgICAgICAgICAgICB2YXIgYXR0YWNobWVudHNUb1JlbW92ZSA9IHN0YWdlSW5zdGFuY2VBdHRhY2htZW50c1RvRGVsZXRlKGluc3RhbmNlLCBhdHRhY2htZW50cywgYXR0YWNobWVudE1ldGFzKTsKICAgICAgICAgICAgICAgICAgICBhdHRhY2htZW50c1RvUmVtb3ZlLmZvckVhY2goZnVuY3Rpb24gKG1ldGEpIHsgcmV0dXJuIHJlbW92ZUF0dGFjaG1lbnQobWV0YSk7IH0pOwogICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZXMgc3RhZ2UgaW5zdGFuY2UKICAgICAgICAgICAgICAgICAgICB1cGRhdGVTdGFnZUluc3RhbmNlKGluc3RhbmNlKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgaWYgKF90aGlzLnN0YXRlLnVwZGF0ZWRTdGFnZSkgewogICAgICAgICAgICAgICAgICAgIHVwZGF0ZVN0YWdlKF90aGlzLnN0YXRlLnVwZGF0ZWRTdGFnZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IGVkaXQ6IGZhbHNlLCBjb25maXJtUHJvcHM6IHVuZGVmaW5lZCB9KTsKICAgICAgICAgICAgfTsKICAgICAgICAgICAgaWYgKHNlcXVlbmNlICYmIHNlcXVlbmNlLmRhdGEgJiYgc2VxdWVuY2UuZGF0YS5wYXVzZWQpIHsKICAgICAgICAgICAgICAgIHNhdmVIYW5kbGVyKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICB2YXIgY29uZmlybVByb3BzID0gewogICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnVGhpcyBtZXNzYWdlIGlzIGxpdmUnLAogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gc2F2ZSB5b3VyIGNoYW5nZXM/JwogICAgICAgICAgICAgICAgICAgICAgICArICcgQW55IGNoYW5nZXMgeW91XCd2ZSBtYWRlIHdpbGwgYXV0b21hdGljYWxseSBnbyBsaXZlIHRvIHlvdXIgcmVjaXBpZW50cy4nLAogICAgICAgICAgICAgICAgICAgIGNvbmZpcm1Db3B5OiAnU2F2ZScsCiAgICAgICAgICAgICAgICAgICAgY2FuY2VsQ29weTogJ0NhbmNlbCcsCiAgICAgICAgICAgICAgICAgICAgb25Db25maXJtOiBmdW5jdGlvbiAoKSB7IHJldHVybiBzYXZlSGFuZGxlcigpOyB9LAogICAgICAgICAgICAgICAgICAgIG9uQ2FuY2VsOiBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5zZXRTdGF0ZSh7IGNvbmZpcm1Qcm9wczogdW5kZWZpbmVkIH0pOyB9LAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsgY29uZmlybVByb3BzOiBjb25maXJtUHJvcHMgfSk7CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIF90aGlzLmhhbmRsZUluc3RhbmNlRWRpdCA9IGZ1bmN0aW9uIChzdGFnZUluc3RhbmNlKSB7CiAgICAgICAgICAgIHZhciBfYTsKICAgICAgICAgICAgdmFyIHVwZGF0ZWRJbnN0YW5jZXMgPSBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgX3RoaXMuc3RhdGUudXBkYXRlZEluc3RhbmNlcyksIChfYSA9IHt9LCBfYVtzdGFnZUluc3RhbmNlLmlkXSA9IHN0YWdlSW5zdGFuY2UsIF9hKSk7CiAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgIHVwZGF0ZWRJbnN0YW5jZXM6IHVwZGF0ZWRJbnN0YW5jZXMsCiAgICAgICAgICAgIH0pOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlU3RhZ2VFZGl0ID0gZnVuY3Rpb24gKHN0YWdlKSB7CiAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgIHVwZGF0ZWRTdGFnZTogc3RhZ2UsCiAgICAgICAgICAgICAgICBlZGl0OiB0cnVlLAogICAgICAgICAgICB9KTsKICAgICAgICB9OwogICAgICAgIF90aGlzLmhhbmRsZVN0YWdlVXBkYXRlID0gZnVuY3Rpb24gKHN0YWdlKSB7CiAgICAgICAgICAgIF90aGlzLnByb3BzLnVwZGF0ZVN0YWdlKHN0YWdlKTsKICAgICAgICB9OwogICAgICAgIF90aGlzLmhhbmRsZVNlbmRUZXN0RW1haWwgPSBmdW5jdGlvbiAoZW1haWxzLCBpbnNlcnRWYXJpYWJsZXMpIHsKICAgICAgICAgICAgdmFyIF9hID0gX3RoaXMucHJvcHMsIHNlbmRUZXN0RW1haWwgPSBfYS5zZW5kVGVzdEVtYWlsLCBzZXF1ZW5jZSA9IF9hLnNlcXVlbmNlLCBzdGFnZSA9IF9hLnN0YWdlLCBpbnN0YW5jZXMgPSBfYS5pbnN0YW5jZXMsIGF0dGFjaG1lbnRNZXRhcyA9IF9hLmF0dGFjaG1lbnRNZXRhcywgYXR0YWNobWVudHMgPSBfYS5hdHRhY2htZW50czsKICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgc2hvd1Rlc3RFbWFpbFBvcG92ZXI6IGZhbHNlLAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgaWYgKHN0YWdlICYmIGluc3RhbmNlcyAmJiBzZXF1ZW5jZSAmJiBzZXF1ZW5jZS5kYXRhKSB7CiAgICAgICAgICAgICAgICB2YXIgZmlyc3RJbnN0YW5jZSA9IGluc3RhbmNlc1tPYmplY3Qua2V5cyhpbnN0YW5jZXMpWzBdXS5kYXRhOwogICAgICAgICAgICAgICAgaWYgKGZpcnN0SW5zdGFuY2UpIHsKICAgICAgICAgICAgICAgICAgICBzZW5kVGVzdEVtYWlsKHsKICAgICAgICAgICAgICAgICAgICAgICAgc2VxdWVuY2U6IHNlcXVlbmNlLmRhdGEuaWQsCiAgICAgICAgICAgICAgICAgICAgICAgIHN0YWdlOiBzdGFnZS5pZCwKICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2U6IF90aGlzLnN0YXRlLnVwZGF0ZWRJbnN0YW5jZXNbZmlyc3RJbnN0YW5jZS5pZF0gfHwgZmlyc3RJbnN0YW5jZSwKICAgICAgICAgICAgICAgICAgICAgICAgZW1haWxzOiBlbWFpbHMsCiAgICAgICAgICAgICAgICAgICAgICAgIGluc2VydFZhcmlhYmxlczogaW5zZXJ0VmFyaWFibGVzLAogICAgICAgICAgICAgICAgICAgICAgICBhdHRhY2htZW50czogYXR0YWNobWVudHMuY29uY2F0KGF0dGFjaG1lbnRNZXRhcy5maWx0ZXIoZnVuY3Rpb24gKG1ldGEpIHsgcmV0dXJuIG1ldGEuc3RhdHVzICE9PSBBdHRhY2htZW50TWV0YVN0YXR1cy5EZWxldGU7IH0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKGNvbnZlcnRUb0F0dGFjaG1lbnQpKSwKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlU2VuZFRlc3RFbWFpbENsb3NlID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICBzaG93VGVzdEVtYWlsUG9wb3ZlcjogZmFsc2UsCiAgICAgICAgICAgIH0pOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlQ2FuY2VsID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgX2EgPSBfdGhpcy5wcm9wcywgc3RhZ2UgPSBfYS5zdGFnZSwgcmVmcmVzaFN0YWdlID0gX2EucmVmcmVzaFN0YWdlOwogICAgICAgICAgICB2YXIgY2FuY2VsSGFuZGxlciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIC8vIFJldmVydCBzdGF0ZSBhbmQgcmVtb3ZlIGNvbmZpcm0gZGlhbG9ndWUKICAgICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgICAgICBlZGl0OiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICB1cGRhdGVkSW5zdGFuY2VzOiB7fSwKICAgICAgICAgICAgICAgICAgICB1cGRhdGVkU3RhZ2U6IHVuZGVmaW5lZCwKICAgICAgICAgICAgICAgICAgICBjb25maXJtUHJvcHM6IHVuZGVmaW5lZCwKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgLy8gSGFuZGxlIHJlZnJlc2hpbmcgc3RhZ2UKICAgICAgICAgICAgICAgIGlmIChzdGFnZSkgewogICAgICAgICAgICAgICAgICAgIHJlZnJlc2hTdGFnZSh7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0YWdlOiBzdGFnZS5pZCwKICAgICAgICAgICAgICAgICAgICAgICAgc2VxdWVuY2U6IHN0YWdlLnNlcXVlbmNlLAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgICAgICAvLyBTaG93IGNvbmZpcm0gZGlhbG9ndWUgZm9yIGNhbmNlbGxpbmcgY2hhbmdlcwogICAgICAgICAgICB2YXIgY29uZmlybVByb3BzID0gewogICAgICAgICAgICAgICAgdGl0bGU6ICdVbnNhdmVkIENoYW5nZXMnLAogICAgICAgICAgICAgICAgbWVzc2FnZTogJ1lvdSBoYXZlIHVuc2F2ZWQgY2hhbmdlcyB0byB0aGlzIG1lc3NhZ2UuICcKICAgICAgICAgICAgICAgICAgICArICdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGlzY2FyZCB0aGVzZSBjaGFuZ2VzPycsCiAgICAgICAgICAgICAgICBjb25maXJtQ29weTogJ0NvbnRpbnVlJywKICAgICAgICAgICAgICAgIGNhbmNlbENvcHk6ICdDYW5jZWwnLAogICAgICAgICAgICAgICAgb25Db25maXJtOiBmdW5jdGlvbiAoKSB7IHJldHVybiBjYW5jZWxIYW5kbGVyKCk7IH0sCiAgICAgICAgICAgICAgICBvbkNhbmNlbDogZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuc2V0U3RhdGUoeyBjb25maXJtUHJvcHM6IHVuZGVmaW5lZCB9KTsgfSwKICAgICAgICAgICAgfTsKICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBjb25maXJtUHJvcHM6IGNvbmZpcm1Qcm9wcyB9KTsKICAgICAgICB9OwogICAgICAgIF90aGlzLnN0YXRlID0gewogICAgICAgICAgICBlZGl0OiBmYWxzZSwKICAgICAgICAgICAgc2hvd1Rlc3RFbWFpbFBvcG92ZXI6IGZhbHNlLAogICAgICAgICAgICB1cGRhdGVkSW5zdGFuY2VzOiB7fSwKICAgICAgICB9OwogICAgICAgIHJldHVybiBfdGhpczsKICAgIH0KICAgIFNlcXVlbmNlU3RhZ2VEZXRhaWwucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50ID0gZnVuY3Rpb24gKCkgewogICAgICAgIC8vIE1hcmsgYW55IHN1Y2Nlc3NmdWwgb25ib2FyZGluZ3Mgb24gbW91bnQKICAgICAgICB0aGlzLmhhbmRsZU9uYm9hcmRpbmdVcGRhdGVzKCk7CiAgICB9OwogICAgU2VxdWVuY2VTdGFnZURldGFpbC5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBfYSA9IHRoaXMucHJvcHMsIHN0YWdlID0gX2Euc3RhZ2UsIGluc3RhbmNlcyA9IF9hLmluc3RhbmNlcywgc2VxdWVuY2UgPSBfYS5zZXF1ZW5jZSwgc3RhZ2VOYW1lID0gX2Euc3RhZ2VOYW1lLCByZWNpcGllbnRDb3VudHMgPSBfYS5yZWNpcGllbnRDb3VudHMsIHVzZXIgPSBfYS51c2VyOwogICAgICAgIHZhciBfYiA9IHRoaXMuc3RhdGUsIGVkaXQgPSBfYi5lZGl0LCBzaG93VGVzdEVtYWlsUG9wb3ZlciA9IF9iLnNob3dUZXN0RW1haWxQb3BvdmVyLCBjb25maXJtUHJvcHMgPSBfYi5jb25maXJtUHJvcHMsIHVwZGF0ZWRTdGFnZSA9IF9iLnVwZGF0ZWRTdGFnZTsKICAgICAgICB2YXIgc2VsZWN0ZWRUYWIgPSB0aGlzLnByb3BzLnNlbGVjdGVkVGFiIHx8IFNlcXVlbmNlVGFiLk1lc3NhZ2U7CiAgICAgICAgaWYgKCFzdGFnZSB8fCAhaW5zdGFuY2VzIHx8ICFzZXF1ZW5jZSB8fCAhc2VxdWVuY2UuZGF0YSkgewogICAgICAgICAgICByZXR1cm4gUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgbnVsbCk7CiAgICAgICAgfQogICAgICAgIC8vIFRPRE8oU0hJTik6IEFic3RyYWN0IHRvIG5vdCByZWx5IG9uIGRvY3VtZW50LmJvZHkgKHByZWZlcmFibHkgdXNpbmcgY29uc3RhbnRzKQogICAgICAgIHZhciB2aWN0b3J5Q29sb3JCYWNrZ3JvdW5kID0gZG9jdW1lbnQuYm9keS5nZXRBdHRyaWJ1dGUoJ3RoZW1lJykgPT09ICd0aGVtZS1kYXJrJwogICAgICAgICAgICA/IERBUktNT0RFX1ZJQ1RPUllfQkFDS0dST1VORF9DT0xPUiA6IERFRkFVTFRfVklDVE9SWV9CQUNLR1JPVU5EX0NPTE9SOwogICAgICAgIHZhciBhbmFseXRpY3MgPSBzdGFnZS5hbmFseXRpY3M7CiAgICAgICAgdmFyIHJlY2lwaWVudHNBbmFseXRpY3MgPSBbCiAgICAgICAgICAgIHsgbmFtZTogJ1NlbnQnLCB2YWx1ZTogJ3NlbnQnIH0sCiAgICAgICAgICAgIHsgbmFtZTogJ1NjaGVkdWxlZCcsIHZhbHVlOiAnc2NoZWR1bGVkJyB9LAogICAgICAgICAgICB7IG5hbWU6ICdQYXVzZWQnLCB2YWx1ZTogJ3BhdXNlZCcgfSwKICAgICAgICAgICAgeyBuYW1lOiAnQm91bmNlZCcsIHZhbHVlOiAnYm91bmNlZCcgfSwKICAgICAgICBdOwogICAgICAgIHZhciBzZXF1ZW5jZUFuYWx5dGljcyA9IFsKICAgICAgICAgICAgeyBuYW1lOiAnRGVsaXZlcmVkJywgdmFsdWU6ICdkZWxpdmVyZWQnLCBjb2xvcjogJyM0NDQnIH0sCiAgICAgICAgICAgIHsgbmFtZTogJ09wZW5lZCcsIHZhbHVlOiAnb3BlbmVkJywgY29sb3I6ICcjMDBhYWZmJyB9LAogICAgICAgICAgICB7IG5hbWU6ICdDbGlja2VkJywgdmFsdWU6ICdjbGlja2VkJywgY29sb3I6ICcjZmZhMDU3JyB9LAogICAgICAgICAgICB7IG5hbWU6ICdEb3dubG9hZGVkJywgdmFsdWU6ICdkb3dubG9hZGVkJywgY29sb3I6ICcjZDM0N2FlJyB9LAogICAgICAgICAgICB7IG5hbWU6ICdSZXBsaWVkJywgdmFsdWU6ICdyZXBsaWVkJywgY29sb3I6ICcjMGVjMzZiJyB9LAogICAgICAgICAgICB7IG5hbWU6ICdVbnN1YnNjcmliZWQnLCB2YWx1ZTogJ3Vuc3Vic2NyaWJlZCcsIGNvbG9yOiAnIzQ0NCcgfSwKICAgICAgICBdOwogICAgICAgIHZhciBjcmVhdG9yID0gdXNlciAmJiB1c2VyLmZpcnN0TmFtZSArICIgIiArIHVzZXIubGFzdE5hbWUgfHwgJyc7CiAgICAgICAgdmFyIGNyZWF0ZWRTdHJpbmcgPSBtb21lbnQoc3RhZ2UuY3JlYXRlZCkuZm9ybWF0KCdNTU0gREQsIFlZWVknKTsKICAgICAgICB2YXIgdG90YWwgPSBhbmFseXRpY3MuZGVsaXZlcmVkOwogICAgICAgIHJldHVybiAoUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJzZXF1ZW5jZS1zdGFnZS1kZXRhaWwiIH0sCiAgICAgICAgICAgIGNvbmZpcm1Qcm9wcyAmJgogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChDb25maXJtLCBfX2Fzc2lnbih7fSwgY29uZmlybVByb3BzKSksCiAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAibmF2aWdhdGlvbi1iYXIiIH0sCiAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogIm5hdmlnYXRpb24iIH0sCiAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChMaW5rLCB7IGNsYXNzTmFtZTogInNlcXVlbmNlcy1icmVhZGNydW1iIiwgdG86ICIvc2VxdWVuY2VzIiB9LCAiU2VxdWVuY2VzIiksCiAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIHsgY2xhc3NOYW1lOiAiYXJyb3ciIH0sICI+IiksCiAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChMaW5rLCB7IGNsYXNzTmFtZTogInNlcXVlbmNlLWJyZWFkY3J1bWIiLCB0bzogIi9zZXF1ZW5jZXMvIiArIHNlcXVlbmNlLmRhdGEuaWQgfSwgc2VxdWVuY2UuZGF0YS5uYW1lKSwKICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgeyBjbGFzc05hbWU6ICJhcnJvdyIgfSwgIj4iKSwKICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KExpbmssIHsgY2xhc3NOYW1lOiAic2VxdWVuY2Utc3RhZ2UtYnJlYWRjcnVtYiIsIHRvOiAiL3NlcXVlbmNlcy8iICsgc2VxdWVuY2UuZGF0YS5pZCArICIvc3RhZ2VzLyIgKyBzdGFnZS5pZCB9LCBzdGFnZU5hbWUpKSwKICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAiYWN0aW9ucyIgfSwKICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KERyb3Bkb3duLCB7IHBsYWNlaG9sZGVyOiAiTW9yZSIsIHZhbHVlOiAiIiwgdmFsdWVzOiBbJ0R1cGxpY2F0ZScsICdEZWxldGUnXSwgb25TZWxlY3Q6IHRoaXMuaGFuZGxlTW9yZVNlbGVjdCB9KSwKICAgICAgICAgICAgICAgICAgICAoIWVkaXQgJiYgIXNlcXVlbmNlLmRhdGEuYXJjaGl2ZWQpICYmCiAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIsIHsgY2xhc3NOYW1lOiAiZWRpdC1zdGFnZSIsIG9uQ2xpY2s6IHRoaXMuaGFuZGxlRWRpdCB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChFZGl0LCB7IGNsYXNzTmFtZTogImljb24iIH0pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIkVkaXQgU3RhZ2UiKSwKICAgICAgICAgICAgICAgICAgICBlZGl0ICYmIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIsIHsgY2xhc3NOYW1lOiAiY2FuY2VsIiwgb25DbGljazogdGhpcy5oYW5kbGVDYW5jZWwgfSwgIkNhbmNlbCIpLAogICAgICAgICAgICAgICAgICAgIGVkaXQgJiYgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnV0dG9uIiwgeyBjbGFzc05hbWU6ICJzYXZlIiwgb25DbGljazogdGhpcy5oYW5kbGVTYXZlIH0sICJTYXZlIikpKSwKICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJtYWluIiB9LAogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJzZXF1ZW5jZS1zdGFnZS1hbmFseXRpY3MiIH0sCiAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0b3Atcm93IiB9LAogICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogInRpdGxlIiB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiaDUiLCBudWxsLCBzZXF1ZW5jZS5kYXRhLm5hbWUpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiaDEiLCBudWxsLCBzdGFnZU5hbWUpKSwKICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJyZWNpcGllbnRzLWFuYWx5dGljcyIgfSwgcmVjaXBpZW50c0FuYWx5dGljcy5maWx0ZXIoZnVuY3Rpb24gKHIpIHsgcmV0dXJuICEhcmVjaXBpZW50Q291bnRzW3IudmFsdWVdOyB9KS5tYXAoZnVuY3Rpb24gKHIpIHsgcmV0dXJuIChSZWFjdC5jcmVhdGVFbGVtZW50KExpbmssIHsgY2xhc3NOYW1lOiAibGluayIsIHRvOiAiL3NlcXVlbmNlcy8iICsgc3RhZ2Uuc2VxdWVuY2UgKyAiL3N0YWdlcy8iICsgc3RhZ2UuaWQgKyAiL3JlY2lwaWVudHM/ZmlsdGVyPSIgKyByLm5hbWUsIGtleTogci52YWx1ZSB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6IGNsYXNzbmFtZXMoJ3JlY2lwaWVudHMtYW5hbHl0aWMnLCByLnZhbHVlKSwga2V5OiByLnZhbHVlIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIHsgY2xhc3NOYW1lOiAibnVtYmVyIiB9LCByZWNpcGllbnRDb3VudHNbci52YWx1ZV0pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCBudWxsLCByLm5hbWUpKSkpOyB9KSkpLAogICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAiZGV0YWlscyIgfSwKICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJjcmVhdGVkIiB9LCAiQ3JlYXRlZCBieSAiICsgY3JlYXRvciArICIgXHUwMEI3ICIgKyBjcmVhdGVkU3RyaW5nKSksCiAgICAgICAgICAgICAgICAgICAgISF0b3RhbCAmJiBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImNoYXJ0cyIgfSwgc2VxdWVuY2VBbmFseXRpY3MubWFwKGZ1bmN0aW9uIChhKSB7IHJldHVybiAoUmVhY3QuY3JlYXRlRWxlbWVudChMaW5rLCB7IGNsYXNzTmFtZTogImxpbmsiLCB0bzogIi9zZXF1ZW5jZXMvIiArIHN0YWdlLnNlcXVlbmNlICsgIi9zdGFnZXMvIiArIHN0YWdlLmlkICsgIi9yZWNpcGllbnRzP2ZpbHRlcj0iICsgYS5uYW1lLCBrZXk6IGEubmFtZSB9LAogICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImNoYXJ0LXdyYXBwZXIiLCBrZXk6IGEubmFtZSB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJjaGFydCIgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KFZpY3RvcnlQaWUsIHsga2V5OiBhLm5hbWUsIGRhdGE6IFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgeDogMSwgeTogYW5hbHl0aWNzW2EudmFsdWVdIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHg6IDIsIHk6IHRvdGFsIC0gYW5hbHl0aWNzW2EudmFsdWVdIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sIGNvbG9yU2NhbGU6IFthLmNvbG9yLCB2aWN0b3J5Q29sb3JCYWNrZ3JvdW5kXSwgaW5uZXJSYWRpdXM6IDEzMCwgYW5pbWF0ZTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IDUwMDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gfSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJudW1iZXJzIiB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJoMSIsIHsgc3R5bGU6IHsgY29sb3I6IGEuY29sb3IgfSB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWwgPyBNYXRoLnJvdW5kKChhbmFseXRpY3NbYS52YWx1ZV0gLyAoYS52YWx1ZSA9PT0gJ2RlbGl2ZXJlZCcgPwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuYWx5dGljcy5kZWxpdmVyZWQgKyByZWNpcGllbnRDb3VudHMuYm91bmNlZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdG90YWwpKSAqIDEwMCkgOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiUiKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiaDQiLCBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5hbHl0aWNzW2EudmFsdWVdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiBvZiAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS52YWx1ZSA9PT0gJ2RlbGl2ZXJlZCcgPwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuYWx5dGljcy5kZWxpdmVyZWQgKyByZWNpcGllbnRDb3VudHMuYm91bmNlZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdG90YWwpKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImxhYmVsIiB9LCBhLm5hbWUpKSkpOyB9KSkpLAogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJkcmlsbGRvd25zIiB9LAogICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAidGFicyIgfSwKICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChMaW5rLCB7IHRvOiAiL3NlcXVlbmNlcy8iICsgc2VxdWVuY2UuZGF0YS5pZCArICIvc3RhZ2VzLyIgKyBzdGFnZS5pZCwgY2xhc3NOYW1lOiAibGluayIgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiBjbGFzc25hbWVzKCd0YWInLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOiBzZWxlY3RlZFRhYiA9PT0gU2VxdWVuY2VUYWIuTWVzc2FnZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSB9LCAiTWVzc2FnZSIpKSwKICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChMaW5rLCB7IHRvOiAiL3NlcXVlbmNlcy8iICsgc2VxdWVuY2UuZGF0YS5pZCArICIvc3RhZ2VzLyIgKyBzdGFnZS5pZCArICIvcmVjaXBpZW50cyIsIGNsYXNzTmFtZTogImxpbmsiIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogY2xhc3NuYW1lcygndGFiJywgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZDogc2VsZWN0ZWRUYWIgPT09IFNlcXVlbmNlVGFiLlJlY2lwaWVudHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkgfSwgIlJlY2lwaWVudHMiKSkpLAogICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAibWFpbiIgfSwKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRUYWIgPT09IFNlcXVlbmNlVGFiLk1lc3NhZ2UgJiYKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoU2VxdWVuY2VTdGFnZU1lc3NhZ2UsIHsgc3RhZ2U6IHVwZGF0ZWRTdGFnZSA/IHVwZGF0ZWRTdGFnZSA6IHN0YWdlLCBpbnN0YW5jZXM6IGluc3RhbmNlcywgZWRpdDogZWRpdCwgb25FZGl0OiB0aGlzLmhhbmRsZUluc3RhbmNlRWRpdCwgcGxhY2Vob2xkZXJzOiBzZXF1ZW5jZS5kYXRhLmhlYWRlcnMsIG9uU3RhZ2VVcGRhdGU6IHRoaXMuaGFuZGxlU3RhZ2VVcGRhdGUsIG9uU3RhZ2VFZGl0OiB0aGlzLmhhbmRsZVN0YWdlRWRpdCwgb25UZXN0RW1haWxDbGljazogdGhpcy5oYW5kbGVUZXN0RW1haWxDbGljaywgc2VuZGVyOiBzZXF1ZW5jZS5kYXRhLnNlbmRlckVtYWlsLCByZWFkT25seTogc2VxdWVuY2UuZGF0YS5hcmNoaXZlZCwgZW5hYmxlRWRpdDogdGhpcy5oYW5kbGVFZGl0IH0pLAogICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZFRhYiA9PT0gU2VxdWVuY2VUYWIuUmVjaXBpZW50cyAmJgogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChTZXF1ZW5jZVN0YWdlUmVjaXBpZW50c0xpc3QsIHsgc3RhZ2U6IHN0YWdlLCByZWNpcGllbnRDb3VudHM6IHJlY2lwaWVudENvdW50cyB9KSkpKSwKICAgICAgICAgICAgc2hvd1Rlc3RFbWFpbFBvcG92ZXIgJiYgUmVhY3QuY3JlYXRlRWxlbWVudChPdmVybGF5LCBudWxsLAogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChTZW5kVGVzdEVtYWlsLCB7IG9uU2VuZDogdGhpcy5oYW5kbGVTZW5kVGVzdEVtYWlsLCBvbkNsb3NlOiB0aGlzLmhhbmRsZVNlbmRUZXN0RW1haWxDbG9zZSwgZGVmYXVsdFZhbHVlOiBzZXF1ZW5jZS5kYXRhLnNlbmRlckVtYWlsIH0pKSkpOwogICAgfTsKICAgIHJldHVybiBTZXF1ZW5jZVN0YWdlRGV0YWlsOwp9KFJlYWN0LlB1cmVDb21wb25lbnQpKTsKZXhwb3J0IGRlZmF1bHQgU2VxdWVuY2VTdGFnZURldGFpbDsK"},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Sequences/routes/SequenceStageDetail/SequenceStageDetail.tsx","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Sequences/routes/SequenceStageDetail/SequenceStageDetail.tsx"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAO,KAAK,MAAM,OAAO,CAAC;AAC1B,OAAO,MAAM,MAAM,QAAQ,CAAC;AAC5B,OAAO,EAAE,MAAM,EAAE,MAAM,QAAQ,CAAC;AAChC,OAAO,UAAU,MAAM,YAAY,CAAC;AACpC,OAAO,EAIL,oBAAoB,GAGrB,MAAM,YAAY,CAAC;AACpB,OAAO,EAAkD,WAAW,EAAE,MAAM,sBAAsB,CAAC;AACnG,OAAO,IAAI,MAAM,gCAAgC,CAAC;AAClD,OAAO,OAAO,MAAM,0BAA0B,CAAC;AAE/C,OAAO,4BAA4B,CAAC;AACpC,OAAO,QAAQ,MAAM,+BAA+B,CAAC;AACrD,OAAO,EAAE,UAAU,EAAE,MAAM,SAAS,CAAC;AACrC,OAAO,EAAE,IAAI,EAAuB,MAAM,kBAAkB,CAAC;AAC7D,OAAO,oBAAoB,MAAM,wBAAwB,CAAC;AAC1D,OAAO,2BAA2B,MAAM,+BAA+B,CAAC;AAExE,OAAO,OAAO,MAAM,8BAA8B,CAAC;AACnD,OAAO,aAAa,MAAM,+BAA+B,CAAC;AAI1D,OAAO,EAAE,mBAAmB,EAAE,MAAM,qBAAqB,CAAC;AAC1D,OAAO,EAAE,gCAAgC,EAAE,MAAM,wCAAwC,CAAC;AAC1F,OAAO,OAAkC,MAAM,8BAA8B,CAAC;AAC9E,OAAO,EAAE,OAAO,EAAE,MAAM,eAAe,CAAC;AACxC,OAAO,EAAE,iCAAiC,EAAE,gCAAgC,EAAE,MAAM,iBAAiB,CAAC;AAuCtG;IAAkC,uCAEjC;IACC;QAAA,YACE,iBAAO,SAOR;QAOD,+CAA+C;QAC/C,6BAAuB,GAAG;YAClB,IAAA,gBAA6C,EAA3C,0BAAU,EAAE,sCAA+B,CAAC;YACpD,IAAI,UAAU,IAAI,CAAC,UAAU,CAAC,iBAAiB,EAAE;gBAC/C,gBAAgB,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE,EAAE,iBAAiB,EAAE,IAAI,EAAE,EAAE,CAAC,CAAC;gBACxE,OAAO;aACR;YAED,IAAI,UAAU,IAAI,CAAC,UAAU,CAAC,qBAAqB,EAAE;gBACnD,gBAAgB,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE,EAAE,qBAAqB,EAAE,IAAI,EAAE,EAAE,CAAC,CAAC;gBAC5E,OAAO;aACR;QACH,CAAC,CAAA;QAED,sBAAgB,GAAG,UAAC,KAAa,EAAE,KAAa;YACxC,IAAA,gBAA6D,EAA3D,gBAAK,EAAE,4BAAW,EAAE,sBAAQ,EAAE,kCAA6B,CAAC;YAEpE,IAAI,CAAC,KAAK,IAAI,CAAC,QAAQ,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE;gBACzC,OAAO;aACR;YAED,QAAQ,KAAK,EAAE;gBACb,KAAK,WAAW;oBACd,cAAc,CAAC,KAAK,CAAC,CAAC;oBACtB,MAAM;gBACR,KAAK,QAAQ;oBAEX,oDAAoD;oBACpD,IAAM,eAAa,GAAG;wBACpB,IAAI,KAAK,EAAE;4BACT,WAAW,CAAC,KAAK,CAAC,CAAC;yBACpB;wBAED,IAAI,QAAQ,IAAI,QAAQ,CAAC,IAAI,EAAE;4BAC7B,OAAO,CAAC,IAAI,CAAC,gBAAc,QAAQ,CAAC,IAAI,CAAC,EAAI,CAAC,CAAC;yBAChD;wBACD,KAAI,CAAC,QAAQ,CAAC,EAAE,YAAY,EAAE,SAAS,EAAE,CAAC,CAAC;oBAC7C,CAAC,CAAC;oBAEF,gDAAgD;oBAChD,IAAM,YAAY,GAAiB;wBACjC,KAAK,EAAE,oBAAoB;wBAC3B,OAAO,EAAE,6CAA6C;8BAClD,0DAA0D;wBAC9D,WAAW,EAAE,QAAQ;wBACrB,UAAU,EAAE,QAAQ;wBACpB,SAAS,EAAE,cAAM,OAAA,eAAa,EAAE,EAAf,CAAe;wBAChC,QAAQ,EAAE,cAAM,OAAA,KAAI,CAAC,QAAQ,CAAC,EAAE,YAAY,EAAE,SAAS,EAAE,CAAC,EAA1C,CAA0C;qBAC3D,CAAC;oBAEF,KAAI,CAAC,QAAQ,CAAC;wBACZ,YAAY,cAAA;qBACb,CAAC,CAAC;oBACH,MAAM;gBACR;oBACE,MAAM;aACT;QACH,CAAC,CAAA;QAED,gBAAU,GAAG;YACX,KAAI,CAAC,QAAQ,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;QAChC,CAAC,CAAA;QAED,0BAAoB,GAAG;YACrB,IAAI,KAAI,CAAC,KAAK,CAAC,IAAI,EAAE;gBACnB,KAAI,CAAC,QAAQ,CAAC,EAAE,oBAAoB,EAAE,IAAI,EAAE,CAAC,CAAC;aAC/C;QACH,CAAC,CAAA;QAED,2CAAqC,GAAG;YAC9B,IAAA,+BAAQ,CAAgB;YAEhC,IAAI,qBAAqB,GAAG,CAAC,CAAC;YAC9B,IAAM,OAAO,GAAG,QAAQ,IAAI,QAAQ,CAAC,IAAI,IAAI,QAAQ,CAAC,IAAI,CAAC,OAAO,IAAI,EAAE,CAAC;YACzE,MAAM,CAAC,KAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC;iBAChC,OAAO,CAAC,UAAC,QAA+B;gBAEvC,8BAA8B;gBAC9B,IAAM,aAAa,GAAG,OAAO,EAAE,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;gBACrD,aAAa,CAAC,SAAS,GAAG,QAAQ,CAAC,IAAI,CAAC;gBACxC,IAAM,yBAAyB,GAAG,aAAa,CAAC,gBAAgB,CAAC,uBAAuB,CAAC,CAAC;gBAC1F,IAAI,yBAAyB,CAAC,MAAM,GAAG,CAAC,EAAE;oBACxC,qBAAqB,IAAI,yBAAyB,CAAC,MAAM,CAAC;iBAC3D;gBAED,gCAAgC;gBAChC,IAAM,iBAAiB,GAAG,QAAQ,CAAC,OAAO,CAAC,KAAK,CAAC,cAAc,CAAC,CAAC;gBACjE,IAAI,iBAAiB,EAAE;oBACrB,iBAAiB;yBACd,GAAG,CAAC,UAAA,KAAK,IAAI,OAAA,KAAK,CAAC,OAAO,CAAC,QAAQ,EAAE,EAAE,CAAC,EAA3B,CAA2B,CAAC;yBACzC,OAAO,CAAC,UAAC,KAAK;wBACb,IAAI,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;4BAC/B,KAAK,KAAK,OAAO,IAAI,KAAK,KAAK,YAAY;4BAC3C,KAAK,KAAK,WAAW,EAAE;4BACvB,qBAAqB,IAAI,CAAC,CAAC;yBAC5B;oBACH,CAAC,CAAC,CAAC;iBACN;YACH,CAAC,CAAC,CAAC;YAEL,OAAO,qBAAqB,CAAC;QAC/B,CAAC,CAAA;QAED,gBAAU,GAAG;YACL,IAAA,gBAOQ,EANZ,4CAAmB,EACnB,oCAAe,EACf,4BAAW,EACX,sCAAgB,EAChB,sBAAQ,EACR,4BACY,CAAC;YAEf,0EAA0E;YAC1E,IAAM,qBAAqB,GAAG,KAAI,CAAC,qCAAqC,EAAE,CAAC;YAC3E,IAAI,qBAAqB,GAAG,CAAC,EAAE;gBAC7B,IAAM,YAAY,GAAiB;oBACjC,KAAK,EAAE,qBAAqB;oBAC5B,OAAO,EAAE,sBAAoB,qBAAqB,oCAAiC;0BAC/E,8EAA8E;oBAClF,WAAW,EAAE,IAAI;oBACjB,SAAS,EAAE,cAAM,OAAA,KAAI,CAAC,QAAQ,CAAC,EAAE,YAAY,EAAE,SAAS,EAAE,CAAC,EAA1C,CAA0C;iBAC5D,CAAC;gBACF,KAAI,CAAC,QAAQ,CAAC,EAAE,YAAY,cAAA,EAAE,CAAC,CAAC;gBAChC,OAAO;aACR;YAED,IAAM,WAAW,GAAG;gBAClB,MAAM,CAAC,KAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC;qBAChC,OAAO,CAAC,UAAC,QAA+B;oBAEvC,kEAAkE;oBAClE,IAAM,mBAAmB,GAAG,gCAAgC,CAC1D,QAAQ,EACR,WAAW,EACX,eAAe,CAChB,CAAC;oBACF,mBAAmB,CAAC,OAAO,CAAC,UAAA,IAAI,IAAI,OAAA,gBAAgB,CAAC,IAAI,CAAC,EAAtB,CAAsB,CAAC,CAAC;oBAE5D,yBAAyB;oBACzB,mBAAmB,CAAC,QAAQ,CAAC,CAAC;gBAChC,CAAC,CAAC,CAAC;gBAEL,IAAI,KAAI,CAAC,KAAK,CAAC,YAAY,EAAE;oBAC3B,WAAW,CAAC,KAAI,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC;iBACtC;gBACD,KAAI,CAAC,QAAQ,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,YAAY,EAAE,SAAS,EAAE,CAAC,CAAC;YAC1D,CAAC,CAAC;YAEF,IAAI,QAAQ,IAAI,QAAQ,CAAC,IAAI,IAAI,QAAQ,CAAC,IAAI,CAAC,MAAM,EAAE;gBACrD,WAAW,EAAE,CAAC;aACf;iBAAM;gBACL,IAAM,YAAY,GAAiB;oBACjC,KAAK,EAAE,sBAAsB;oBAC7B,OAAO,EAAE,6CAA6C;0BAClD,0EAA0E;oBAC9E,WAAW,EAAE,MAAM;oBACnB,UAAU,EAAE,QAAQ;oBACpB,SAAS,EAAE,cAAM,OAAA,WAAW,EAAE,EAAb,CAAa;oBAC9B,QAAQ,EAAE,cAAM,OAAA,KAAI,CAAC,QAAQ,CAAC,EAAE,YAAY,EAAE,SAAS,EAAE,CAAC,EAA1C,CAA0C;iBAC3D,CAAC;gBAEF,KAAI,CAAC,QAAQ,CAAC,EAAE,YAAY,cAAA,EAAE,CAAC,CAAC;aACjC;QACH,CAAC,CAAA;QAED,wBAAkB,GAAG,UAAC,aAAoC;;YACxD,IAAM,gBAAgB,yBACjB,KAAI,CAAC,KAAK,CAAC,gBAAgB,gBAC7B,aAAa,CAAC,EAAE,IAAG,aAAa,MAClC,CAAC;YACF,KAAI,CAAC,QAAQ,CAAC;gBACZ,gBAAgB,kBAAA;aACjB,CAAC,CAAC;QACL,CAAC,CAAA;QAED,qBAAe,GAAG,UAAC,KAAoB;YACrC,KAAI,CAAC,QAAQ,CAAC;gBACZ,YAAY,EAAE,KAAK;gBACnB,IAAI,EAAE,IAAI;aACX,CAAC,CAAC;QACL,CAAC,CAAA;QAED,uBAAiB,GAAG,UAAC,KAAoB;YACvC,KAAI,CAAC,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;QAChC,CAAC,CAAA;QAED,yBAAmB,GAAG,UAAC,MAAgB,EAAE,eAAwB;YACzD,IAAA,gBAOO,EANX,gCAAa,EACb,sBAAQ,EACR,gBAAK,EACL,wBAAS,EACT,oCAAe,EACf,4BACW,CAAC;YAEd,KAAI,CAAC,QAAQ,CAAC;gBACZ,oBAAoB,EAAE,KAAK;aAC5B,CAAC,CAAC;YAEH,IAAI,KAAK,IAAI,SAAS,IAAI,QAAQ,IAAI,QAAQ,CAAC,IAAI,EAAE;gBACnD,IAAM,aAAa,GAAG,SAAS,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;gBAEhE,IAAI,aAAa,EAAE;oBACjB,aAAa,CAAC;wBACZ,QAAQ,EAAE,QAAQ,CAAC,IAAI,CAAC,EAAE;wBAC1B,KAAK,EAAE,KAAK,CAAC,EAAE;wBACf,QAAQ,EAAE,KAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,aAAa,CAAC,EAAE,CAAC,IAAI,aAAa;wBACxE,MAAM,QAAA;wBACN,eAAe,iBAAA;wBACf,WAAW,EAAE,WAAW,CAAC,MAAM,CAC7B,eAAe,CAAC,MAAM,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,MAAM,KAAK,oBAAoB,CAAC,MAAM,EAA3C,CAA2C,CAAC;6BACxE,GAAG,CAAC,mBAAmB,CAAC,CAC5B;qBACF,CAAC,CAAC;iBACJ;aACF;QACH,CAAC,CAAA;QAED,8BAAwB,GAAG;YACzB,KAAI,CAAC,QAAQ,CAAC;gBACZ,oBAAoB,EAAE,KAAK;aAC5B,CAAC,CAAC;QACL,CAAC,CAAA;QAED,kBAAY,GAAG;YACP,IAAA,gBAAoC,EAAlC,gBAAK,EAAE,8BAA2B,CAAC;YAE3C,IAAM,aAAa,GAAG;gBACpB,2CAA2C;gBAC3C,KAAI,CAAC,QAAQ,CAAC;oBACZ,IAAI,EAAE,KAAK;oBACX,gBAAgB,EAAE,EAAE;oBACpB,YAAY,EAAE,SAAS;oBACvB,YAAY,EAAE,SAAS;iBACxB,CAAC,CAAC;gBAEH,0BAA0B;gBAC1B,IAAI,KAAK,EAAE;oBACT,YAAY,CAAC;wBACX,KAAK,EAAE,KAAK,CAAC,EAAE;wBACf,QAAQ,EAAE,KAAK,CAAC,QAAQ;qBACzB,CAAC,CAAC;iBACJ;YACH,CAAC,CAAC;YAEF,+CAA+C;YAC/C,IAAM,YAAY,GAAiB;gBACjC,KAAK,EAAE,iBAAiB;gBACxB,OAAO,EAAE,4CAA4C;sBACnD,iDAAiD;gBACnD,WAAW,EAAE,UAAU;gBACvB,UAAU,EAAE,QAAQ;gBACpB,SAAS,EAAE,cAAM,OAAA,aAAa,EAAE,EAAf,CAAe;gBAChC,QAAQ,EAAE,cAAM,OAAA,KAAI,CAAC,QAAQ,CAAC,EAAE,YAAY,EAAE,SAAS,EAAE,CAAC,EAA1C,CAA0C;aAC3D,CAAC;YAEF,KAAI,CAAC,QAAQ,CAAC,EAAE,YAAY,cAAA,EAAE,CAAC,CAAC;QAClC,CAAC,CAAA;QA/QC,KAAI,CAAC,KAAK,GAAG;YACX,IAAI,EAAE,KAAK;YACX,oBAAoB,EAAE,KAAK;YAC3B,gBAAgB,EAAE,EAAE;SACrB,CAAC;;IACJ,CAAC;IAED,+CAAiB,GAAjB;QACE,2CAA2C;QAC3C,IAAI,CAAC,uBAAuB,EAAE,CAAC;IACjC,CAAC;IAuQD,oCAAM,GAAN;QACQ,IAAA,eAA6E,EAA3E,gBAAK,EAAE,wBAAS,EAAE,sBAAQ,EAAE,wBAAS,EAAE,oCAAe,EAAE,cAAmB,CAAC;QAC9E,IAAA,eAAuE,EAArE,cAAI,EAAE,8CAAoB,EAAE,8BAAY,EAAE,8BAA2B,CAAC;QAC9E,IAAM,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,WAAW,IAAI,WAAW,CAAC,OAAO,CAAC;QAElE,IAAI,CAAC,KAAK,IAAI,CAAC,SAAS,IAAI,CAAC,QAAQ,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE;YACvD,OAAO,gCAAO,CAAC;SAChB;QAED,iFAAiF;QACjF,IAAM,sBAAsB,GAAG,QAAQ,CAAC,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,KAAK,YAAY;YACjF,CAAC,CAAC,iCAAiC,CAAC,CAAC,CAAC,gCAAgC,CAAC;QAEjE,IAAA,2BAAS,CAAW;QAC5B,IAAM,mBAAmB,GAAG;YAC1B,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE;YAC/B,EAAE,IAAI,EAAE,WAAW,EAAE,KAAK,EAAE,WAAW,EAAE;YACzC,EAAE,IAAI,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAAE;YACnC,EAAE,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,SAAS,EAAE;SACtC,CAAC;QACF,IAAM,iBAAiB,GAAG;YACxB,EAAE,IAAI,EAAE,WAAW,EAAE,KAAK,EAAE,WAAW,EAAE,KAAK,EAAE,MAAM,EAAE;YACxD,EAAE,IAAI,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAAE,KAAK,EAAE,SAAS,EAAE;YACrD,EAAE,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,SAAS,EAAE;YACvD,EAAE,IAAI,EAAE,YAAY,EAAE,KAAK,EAAE,YAAY,EAAE,KAAK,EAAE,SAAS,EAAE;YAC7D,EAAE,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,SAAS,EAAE;YACvD,EAAE,IAAI,EAAE,cAAc,EAAE,KAAK,EAAE,cAAc,EAAE,KAAK,EAAE,MAAM,EAAE;SAC/D,CAAC;QACF,IAAM,OAAO,GAAG,IAAI,IAAO,IAAI,CAAC,SAAS,SAAI,IAAI,CAAC,QAAU,IAAI,EAAE,CAAC;QACnE,IAAM,aAAa,GAAG,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC;QACnE,IAAM,KAAK,GAAG,SAAS,CAAC,SAAS,CAAC;QAElC,OAAO,CACL,6BAAK,SAAS,EAAC,uBAAuB;YACnC,YAAY;gBACX,oBAAC,OAAO,eACF,YAAY,EAChB;YAEJ,6BAAK,SAAS,EAAC,gBAAgB;gBAC7B,6BAAK,SAAS,EAAC,YAAY;oBACzB,oBAAC,IAAI,IAAC,SAAS,EAAC,sBAAsB,EAAC,EAAE,EAAE,YAAY,gBAAkB;oBACzE,8BAAM,SAAS,EAAC,OAAO,QAAY;oBACnC,oBAAC,IAAI,IAAC,SAAS,EAAC,qBAAqB,EAAC,EAAE,EAAE,gBAAc,QAAQ,CAAC,IAAI,CAAC,EAAI,IACvE,QAAQ,CAAC,IAAI,CAAC,IAAI,CACd;oBACP,8BAAM,SAAS,EAAC,OAAO,QAAY;oBACnC,oBAAC,IAAI,IACJ,SAAS,EAAC,2BAA2B,EACrC,EAAE,EAAE,gBAAc,QAAQ,CAAC,IAAI,CAAC,EAAE,gBAAW,KAAK,CAAC,EAAI,IAErD,SAAS,CACL,CACH;gBACN,6BAAK,SAAS,EAAC,SAAS;oBACtB,oBAAC,QAAQ,IACP,WAAW,EAAC,MAAM,EAClB,KAAK,EAAC,EAAE,EACR,MAAM,EAAE,CAAC,WAAW,EAAE,QAAQ,CAAC,EAC/B,QAAQ,EAAE,IAAI,CAAC,gBAAgB,GAC/B;oBACD,CAAC,CAAC,IAAI,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC;wBACjC,gCAAQ,SAAS,EAAC,YAAY,EAAC,OAAO,EAAE,IAAI,CAAC,UAAU;4BACrD,oBAAC,IAAI,IAAC,SAAS,EAAC,MAAM,GAAG;yCAElB;oBACV,IAAI,IAAI,gCAAQ,SAAS,EAAC,QAAQ,EAAC,OAAO,EAAE,IAAI,CAAC,YAAY,aAErD;oBACR,IAAI,IAAI,gCAAQ,SAAS,EAAC,MAAM,EAAC,OAAO,EAAE,IAAI,CAAC,UAAU,WAEjD,CACL,CACF;YACN,6BAAK,SAAS,EAAC,MAAM;gBACnB,6BAAK,SAAS,EAAC,0BAA0B;oBACvC,6BAAK,SAAS,EAAC,SAAS;wBACtB,6BAAK,SAAS,EAAC,OAAO;4BACpB,gCAAK,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAM;4BAC7B,gCAAK,SAAS,CAAM,CAChB;wBACN,6BAAK,SAAS,EAAC,sBAAsB,IAClC,mBAAmB,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,eAAe,CAAC,CAAC,CAAC,KAAK,CAAC,EAA1B,CAA0B,CAAC,CAAC,GAAG,CAAC,UAAA,CAAC,IAAI,OAAA,CACpE,oBAAC,IAAI,IACH,SAAS,EAAC,MAAM,EAChB,EAAE,EACA,gBAAc,KAAK,CAAC,QAAQ,gBAAW,KAAK,CAAC,EAAE,2BAAsB,CAAC,CAAC,IAAM,EAC/E,GAAG,EAAE,CAAC,CAAC,KAAK;4BAEZ,6BAAK,SAAS,EAAE,UAAU,CAAC,qBAAqB,EAAE,CAAC,CAAC,KAAK,CAAC,EAAE,GAAG,EAAE,CAAC,CAAC,KAAK;gCACtE,8BAAM,SAAS,EAAC,QAAQ,IAAE,eAAe,CAAC,CAAC,CAAC,KAAK,CAAC,CAAQ;gCAC1D,kCAAO,CAAC,CAAC,IAAI,CAAQ,CACjB,CACD,CACR,EAZqE,CAYrE,CAAC,CACE,CACF;oBACN,6BAAK,SAAS,EAAC,SAAS;wBACtB,6BAAK,SAAS,EAAC,SAAS,IACrB,gBAAc,OAAO,gBAAM,aAAe,CACvC,CACF;oBACL,CAAC,CAAC,KAAK,IAAI,6BAAK,SAAS,EAAC,QAAQ,IAChC,iBAAiB,CAAC,GAAG,CAAC,UAAA,CAAC,IAAI,OAAA,CAC1B,oBAAC,IAAI,IACH,SAAS,EAAC,MAAM,EAChB,EAAE,EAAE,gBAAc,KAAK,CAAC,QAAQ,gBAAW,KAAK,CAAC,EAAE,2BAAsB,CAAC,CAAC,IAAM,EACjF,GAAG,EAAE,CAAC,CAAC,IAAI;wBAEX,6BAAK,SAAS,EAAC,eAAe,EAAC,GAAG,EAAE,CAAC,CAAC,IAAI;4BACxC,6BAAK,SAAS,EAAC,OAAO;gCACpB,oBAAC,UAAU,IACT,GAAG,EAAE,CAAC,CAAC,IAAI,EACX,IAAI,EAAE;wCACJ,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,SAAS,CAAC,CAAC,CAAC,KAAK,CAAC,EAAE;wCAC/B,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,GAAG,SAAS,CAAC,CAAC,CAAC,KAAK,CAAC,EAAE;qCACxC,EACD,UAAU,EAAE,CAAC,CAAC,CAAC,KAAK,EAAE,sBAAsB,CAAC,EAC7C,WAAW,EAAE,GAAG,EAChB,OAAO,EAAE;wCACP,QAAQ,EAAE,IAAI;qCACf,GACD;gCACF,6BAAK,SAAS,EAAC,SAAS;oCACtB,4BAAI,KAAK,EAAE,EAAE,KAAK,EAAE,CAAC,CAAC,KAAK,EAAE;wCAC1B,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CACtC,CAAC,CAAC,KAAK,KAAK,WAAW,CAAC,CAAC;4CACzB,SAAS,CAAC,SAAS,GAAG,eAAe,CAAC,OAAO;4CAC7C,CAAC,CAAC,KAAK,CACR,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;4CACZ;oCACL;wCACG,SAAS,CAAC,CAAC,CAAC,KAAK,CAAC;;wCACjB,CAAC,CAAC,KAAK,KAAK,WAAW,CAAC,CAAC;4CACzB,SAAS,CAAC,SAAS,GAAG,eAAe,CAAC,OAAO;4CAC7C,CAAC,CAAC,KAAK,CACN,CACD,CACF;4BACN,6BAAK,SAAS,EAAC,OAAO,IACnB,CAAC,CAAC,IAAI,CACH,CACF,CACD,CACR,EAzC2B,CAyC3B,CAAC,CACE,CACF;gBACN,6BAAK,SAAS,EAAC,YAAY;oBACzB,6BAAK,SAAS,EAAC,MAAM;wBACnB,oBAAC,IAAI,IAAC,EAAE,EAAE,gBAAc,QAAQ,CAAC,IAAI,CAAC,EAAE,gBAAW,KAAK,CAAC,EAAI,EAAE,SAAS,EAAC,MAAM;4BAC7E,6BACE,SAAS,EAAE,UAAU,CAAC,KAAK,EAAE;oCAC3B,QAAQ,EAAE,WAAW,KAAK,WAAW,CAAC,OAAO;iCAC9C,CAAC,cAGE,CACD;wBACP,oBAAC,IAAI,IACH,EAAE,EAAE,gBAAc,QAAQ,CAAC,IAAI,CAAC,EAAE,gBAAW,KAAK,CAAC,EAAE,gBAAa,EAClE,SAAS,EAAC,MAAM;4BAEhB,6BACE,SAAS,EAAE,UAAU,CAAC,KAAK,EAAE;oCAC3B,QAAQ,EAAE,WAAW,KAAK,WAAW,CAAC,UAAU;iCACjD,CAAC,iBAGE,CACD,CACH;oBACN,6BAAK,SAAS,EAAC,MAAM;wBAClB,WAAW,KAAK,WAAW,CAAC,OAAO;4BAClC,oBAAC,oBAAoB,IACnB,KAAK,EAAE,YAAY,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,KAAK,EAC1C,SAAS,EAAE,SAAS,EACpB,IAAI,EAAE,IAAI,EACV,MAAM,EAAE,IAAI,CAAC,kBAAkB,EAC/B,YAAY,EAAE,QAAQ,CAAC,IAAI,CAAC,OAAO,EACnC,aAAa,EAAE,IAAI,CAAC,iBAAiB,EACrC,WAAW,EAAE,IAAI,CAAC,eAAe,EACjC,gBAAgB,EAAE,IAAI,CAAC,oBAAoB,EAC3C,MAAM,EAAE,QAAQ,CAAC,IAAI,CAAC,WAAW,EACjC,QAAQ,EAAE,QAAQ,CAAC,IAAI,CAAC,QAAQ,EAChC,UAAU,EAAE,IAAI,CAAC,UAAU,GAC3B;wBACH,WAAW,KAAK,WAAW,CAAC,UAAU;4BACrC,oBAAC,2BAA2B,IAC1B,KAAK,EAAE,KAAK,EACZ,eAAe,EAAE,eAAe,GAChC,CACA,CACF,CACF;YACL,oBAAoB,IAAI,oBAAC,OAAO;gBAC/B,oBAAC,aAAa,IACZ,MAAM,EAAE,IAAI,CAAC,mBAAmB,EAChC,OAAO,EAAE,IAAI,CAAC,wBAAwB,EACtC,YAAY,EAAE,QAAQ,CAAC,IAAI,CAAC,WAAW,GACvC,CACM,CACN,CACP,CAAC;IACJ,CAAC;IACH,0BAAC;AAAD,CAAC,AAneD,CAAkC,KAAK,CAAC,aAAa,GAmepD;AAED,eAAe,mBAAmB,CAAC","sourcesContent":["import React from 'react';\nimport moment from 'moment';\nimport { values } from 'lodash';\nimport classnames from 'classnames';\nimport {\n  Resource,\n  Attachment,\n  AttachmentMeta,\n  AttachmentMetaStatus,\n  Onboarding,\n  TeamMember,\n} from '@src/types';\nimport { SequenceStage, SequenceStageInstance, Sequence, SequenceTab } from '@src/types/sequences';\nimport Edit from '@src/components/Icons/Edit.svg';\nimport history from '@src/lib//browserHistory';\n\nimport './SequenceStageDetail.scss';\nimport Dropdown from '@src/components/Form/Dropdown';\nimport { VictoryPie } from 'victory';\nimport { Link, RouteComponentProps } from 'react-router-dom';\nimport SequenceStageMessage from './SequenceStageMessage';\nimport SequenceStageRecipientsList from './SequenceStageRecipientsList';\nimport { RecipientCount } from './SequenceStageRecipientsList/SequenceStageRecipientsList';\nimport Overlay from '@src/components/Base/Overlay';\nimport SendTestEmail from './SendTestEmail/SendTestEmail';\nimport {\n  SequenceStageInstanceTestMeta, SequenceStageInstanceAttachmentMeta, SequenceStageInstanceMeta,\n} from '@src/ducks/sequenceStageInstances';\nimport { convertToAttachment } from '@src/lib/attachment';\nimport { stageInstanceAttachmentsToDelete } from '@src/lib/models/sequenceStageInstances';\nimport Confirm, { Props as ConfirmProps } from '@src/components/Base/Confirm';\nimport { FakeDOM } from '@src/lib/html';\nimport { DARKMODE_VICTORY_BACKGROUND_COLOR, DEFAULT_VICTORY_BACKGROUND_COLOR } from '@src/lib/colors';\nimport { OnboardingPatchMeta } from '@src/ducks/me';\n\nexport interface StateProps {\n  stage?: SequenceStage;\n  instances?: {\n    [instanceId: string]: Resource<SequenceStageInstance>,\n  };\n  stageName: string;\n  sequence?: Resource<Sequence>;\n  selectedTab?: SequenceTab;\n  recipientCounts: RecipientCount;\n  attachments: Attachment[];\n  attachmentMetas: AttachmentMeta[];\n  onboarding?: Onboarding;\n  user?: TeamMember;\n}\n\nexport interface DispatchProps {\n  updateStageInstance: (instance: SequenceStageInstance) => void;\n  updateStage: (stage: SequenceStage) => void;\n  sendTestEmail: (meta: SequenceStageInstanceTestMeta) => void;\n  deleteStage: (stage: SequenceStage) => void;\n  duplicateStage: (stage: SequenceStage) => void;\n  removeAttachment: (meta: SequenceStageInstanceAttachmentMeta) => void;\n  updateOnboarding: (type: OnboardingPatchMeta) => void;\n  refreshStage: (meta: SequenceStageInstanceMeta) => void;\n}\n\nexport interface State {\n  edit: boolean;\n  showTestEmailPopover: boolean;\n  updatedInstances: {\n    [instanceId: string]: SequenceStageInstance,\n  };\n  confirmProps?: ConfirmProps;\n  updatedStage?: SequenceStage;\n}\n\nclass SequenceStageDetail extends React.PureComponent<\n  StateProps & DispatchProps & RouteComponentProps<any>, State\n> {\n  constructor() {\n    super();\n\n    this.state = {\n      edit: false,\n      showTestEmailPopover: false,\n      updatedInstances: {},\n    };\n  }\n\n  componentDidMount() {\n    // Mark any successful onboardings on mount\n    this.handleOnboardingUpdates();\n  }\n\n  // Marks successful cases for onboading updates\n  handleOnboardingUpdates = () => {\n    const { onboarding, updateOnboarding } = this.props;\n    if (onboarding && !onboarding.editSequenceStage) {\n      updateOnboarding({ skipped: false, type: { editSequenceStage: true } });\n      return;\n    }\n\n    if (onboarding && !onboarding.createAdditionalStage) {\n      updateOnboarding({ skipped: false, type: { createAdditionalStage: true } });\n      return;\n    }\n  }\n\n  handleMoreSelect = (value: string, index: number) => {\n    const { stage, deleteStage, sequence, duplicateStage } = this.props;\n\n    if (!stage || !sequence || !sequence.data) {\n      return;\n    }\n\n    switch (value) {\n      case 'Duplicate':\n        duplicateStage(stage);\n        break;\n      case 'Delete':\n\n        // Handles delete and reroute, and confirm dismissal\n        const deleteHandler = () => {\n          if (stage) {\n            deleteStage(stage);\n          }\n\n          if (sequence && sequence.data) {\n            history.push(`/sequences/${sequence.data.id}`);\n          }\n          this.setState({ confirmProps: undefined });\n        };\n\n        // Show confirm dialogue with callback to delete\n        const confirmProps: ConfirmProps = {\n          title: 'Delete this Stage?',\n          message: 'Are you sure you want to delete this Stage?'\n            + ' Any analytics and recipients data will be lost forever.',\n          confirmCopy: 'Delete',\n          cancelCopy: 'Cancel',\n          onConfirm: () => deleteHandler(),\n          onCancel: () => this.setState({ confirmProps: undefined }),\n        };\n\n        this.setState({\n          confirmProps,\n        });\n        break;\n      default:\n        break;\n    }\n  }\n\n  handleEdit = () => {\n    this.setState({ edit: true });\n  }\n\n  handleTestEmailClick = () => {\n    if (this.state.edit) {\n      this.setState({ showTestEmailPopover: true });\n    }\n  }\n\n  identifyNumberOfUnmatchedPlaceholders = () => {\n    const { sequence } = this.props;\n\n    let unmatchedPlaceholders = 0;\n    const headers = sequence && sequence.data && sequence.data.headers || [];\n    values(this.state.updatedInstances)\n      .forEach((instance: SequenceStageInstance) => {\n\n        // Calculate body placeholders\n        const bodyContainer = FakeDOM().createElement('div');\n        bodyContainer.innerHTML = instance.body;\n        const unmatchedBodyPlaceholders = bodyContainer.querySelectorAll('[data-pm-no-variable]');\n        if (unmatchedBodyPlaceholders.length > 0) {\n          unmatchedPlaceholders += unmatchedBodyPlaceholders.length;\n        }\n\n        // Calculate headers placholders\n        const headerPlacholders = instance.subject.match(/{{[\\w\\s]+}}/g);\n        if (headerPlacholders) {\n          headerPlacholders\n            .map(match => match.replace(/[{}]+/g, ''))\n            .forEach((match) => {\n              if (headers.indexOf(match) === -1 &&\n                match !== 'email' && match !== 'first name' &&\n                match !== 'last name') {\n                unmatchedPlaceholders += 1;\n              }\n            });\n        }\n      });\n\n    return unmatchedPlaceholders;\n  }\n\n  handleSave = () => {\n    const {\n      updateStageInstance,\n      attachmentMetas,\n      attachments,\n      removeAttachment,\n      sequence,\n      updateStage,\n    } = this.props;\n\n    // Blocks any saves when a placeholder exists and does not match variables\n    const unmatchedPlaceholders = this.identifyNumberOfUnmatchedPlaceholders();\n    if (unmatchedPlaceholders > 0) {\n      const confirmProps: ConfirmProps = {\n        title: 'Remove Placeholders',\n        message: `This message has ${unmatchedPlaceholders} placeholders that do not match`\n          + ' any variables. Please remove these placeholders before saving your changes.',\n        confirmCopy: 'Ok',\n        onConfirm: () => this.setState({ confirmProps: undefined }),\n      };\n      this.setState({ confirmProps });\n      return;\n    }\n\n    const saveHandler = () => {\n      values(this.state.updatedInstances)\n        .forEach((instance: SequenceStageInstance) => {\n\n          // Removes any attachments that were removed from the body on save\n          const attachmentsToRemove = stageInstanceAttachmentsToDelete(\n            instance,\n            attachments,\n            attachmentMetas,\n          );\n          attachmentsToRemove.forEach(meta => removeAttachment(meta));\n\n          // Updates stage instance\n          updateStageInstance(instance);\n        });\n\n      if (this.state.updatedStage) {\n        updateStage(this.state.updatedStage);\n      }\n      this.setState({ edit: false, confirmProps: undefined });\n    };\n\n    if (sequence && sequence.data && sequence.data.paused) {\n      saveHandler();\n    } else {\n      const confirmProps: ConfirmProps = {\n        title: 'This message is live',\n        message: 'Are you sure you want to save your changes?'\n          + ' Any changes you\\'ve made will automatically go live to your recipients.',\n        confirmCopy: 'Save',\n        cancelCopy: 'Cancel',\n        onConfirm: () => saveHandler(),\n        onCancel: () => this.setState({ confirmProps: undefined }),\n      };\n\n      this.setState({ confirmProps });\n    }\n  }\n\n  handleInstanceEdit = (stageInstance: SequenceStageInstance) => {\n    const updatedInstances = {\n      ...this.state.updatedInstances,\n      [stageInstance.id]: stageInstance,\n    };\n    this.setState({\n      updatedInstances,\n    });\n  }\n\n  handleStageEdit = (stage: SequenceStage) => {\n    this.setState({\n      updatedStage: stage,\n      edit: true,\n    });\n  }\n\n  handleStageUpdate = (stage: SequenceStage) => {\n    this.props.updateStage(stage);\n  }\n\n  handleSendTestEmail = (emails: string[], insertVariables: boolean) => {\n    const {\n      sendTestEmail,\n      sequence,\n      stage,\n      instances,\n      attachmentMetas,\n      attachments,\n   } = this.props;\n\n    this.setState({\n      showTestEmailPopover: false,\n    });\n\n    if (stage && instances && sequence && sequence.data) {\n      const firstInstance = instances[Object.keys(instances)[0]].data;\n\n      if (firstInstance) {\n        sendTestEmail({\n          sequence: sequence.data.id,\n          stage: stage.id,\n          instance: this.state.updatedInstances[firstInstance.id] || firstInstance,\n          emails,\n          insertVariables,\n          attachments: attachments.concat(\n            attachmentMetas.filter(meta => meta.status !== AttachmentMetaStatus.Delete)\n              .map(convertToAttachment),\n          ),\n        });\n      }\n    }\n  }\n\n  handleSendTestEmailClose = () => {\n    this.setState({\n      showTestEmailPopover: false,\n    });\n  }\n\n  handleCancel = () => {\n    const { stage, refreshStage } = this.props;\n\n    const cancelHandler = () => {\n      // Revert state and remove confirm dialogue\n      this.setState({\n        edit: false,\n        updatedInstances: {},\n        updatedStage: undefined,\n        confirmProps: undefined,\n      });\n\n      // Handle refreshing stage\n      if (stage) {\n        refreshStage({\n          stage: stage.id,\n          sequence: stage.sequence,\n        });\n      }\n    };\n\n    // Show confirm dialogue for cancelling changes\n    const confirmProps: ConfirmProps = {\n      title: 'Unsaved Changes',\n      message: 'You have unsaved changes to this message. '\n      + 'Are you sure you want to discard these changes?',\n      confirmCopy: 'Continue',\n      cancelCopy: 'Cancel',\n      onConfirm: () => cancelHandler(),\n      onCancel: () => this.setState({ confirmProps: undefined }),\n    };\n\n    this.setState({ confirmProps });\n  }\n\n  render() {\n    const { stage, instances, sequence, stageName, recipientCounts, user } = this.props;\n    const { edit, showTestEmailPopover, confirmProps, updatedStage } = this.state;\n    const selectedTab = this.props.selectedTab || SequenceTab.Message;\n\n    if (!stage || !instances || !sequence || !sequence.data) {\n      return <div />;\n    }\n\n    // TODO(SHIN): Abstract to not rely on document.body (preferably using constants)\n    const victoryColorBackground = document.body.getAttribute('theme') === 'theme-dark'\n      ? DARKMODE_VICTORY_BACKGROUND_COLOR : DEFAULT_VICTORY_BACKGROUND_COLOR;\n\n    const { analytics } = stage;\n    const recipientsAnalytics = [\n      { name: 'Sent', value: 'sent' },\n      { name: 'Scheduled', value: 'scheduled' },\n      { name: 'Paused', value: 'paused' },\n      { name: 'Bounced', value: 'bounced' },\n    ];\n    const sequenceAnalytics = [\n      { name: 'Delivered', value: 'delivered', color: '#444' },\n      { name: 'Opened', value: 'opened', color: '#00aaff' },\n      { name: 'Clicked', value: 'clicked', color: '#ffa057' },\n      { name: 'Downloaded', value: 'downloaded', color: '#d347ae' },\n      { name: 'Replied', value: 'replied', color: '#0ec36b' },\n      { name: 'Unsubscribed', value: 'unsubscribed', color: '#444' },\n    ];\n    const creator = user && `${user.firstName} ${user.lastName}` || '';\n    const createdString = moment(stage.created).format('MMM DD, YYYY');\n    const total = analytics.delivered;\n\n    return (\n      <div className=\"sequence-stage-detail\">\n        {confirmProps &&\n          <Confirm\n            {...confirmProps}\n          />\n        }\n        <div className=\"navigation-bar\">\n          <div className=\"navigation\">\n            <Link className=\"sequences-breadcrumb\" to={`/sequences`}>Sequences</Link>\n            <span className=\"arrow\">&gt;</span>\n            <Link className=\"sequence-breadcrumb\" to={`/sequences/${sequence.data.id}`} >\n              {sequence.data.name}\n            </Link>\n            <span className=\"arrow\">&gt;</span>\n            <Link\n             className=\"sequence-stage-breadcrumb\"\n             to={`/sequences/${sequence.data.id}/stages/${stage.id}`}\n            >\n              {stageName}\n            </Link>\n          </div>\n          <div className=\"actions\">\n            <Dropdown\n              placeholder=\"More\"\n              value=\"\"\n              values={['Duplicate', 'Delete']}\n              onSelect={this.handleMoreSelect}\n            />\n            {(!edit && !sequence.data.archived) &&\n              <button className=\"edit-stage\" onClick={this.handleEdit}>\n                <Edit className=\"icon\" />\n                Edit Stage\n              </button>}\n            {edit && <button className=\"cancel\" onClick={this.handleCancel}>\n              Cancel\n            </button>}\n            {edit && <button className=\"save\" onClick={this.handleSave}>\n              Save\n            </button>}\n          </div>\n        </div>\n        <div className=\"main\">\n          <div className=\"sequence-stage-analytics\">\n            <div className=\"top-row\">\n              <div className=\"title\">\n                <h5>{sequence.data.name}</h5>\n                <h1>{stageName}</h1>\n              </div>\n              <div className=\"recipients-analytics\">\n                {recipientsAnalytics.filter(r => !!recipientCounts[r.value]).map(r => (\n                  <Link\n                    className=\"link\"\n                    to={\n                      `/sequences/${stage.sequence}/stages/${stage.id}/recipients?filter=${r.name}`}\n                    key={r.value}\n                  >\n                    <div className={classnames('recipients-analytic', r.value)} key={r.value}>\n                      <span className=\"number\">{recipientCounts[r.value]}</span>\n                      <span>{r.name}</span>\n                    </div>\n                  </Link>\n                ))}\n              </div>\n            </div>\n            <div className=\"details\">\n              <div className=\"created\">\n                {`Created by ${creator} · ${createdString}`}\n              </div>\n            </div>\n            {!!total && <div className=\"charts\">\n              {sequenceAnalytics.map(a => (\n                <Link\n                  className=\"link\"\n                  to={`/sequences/${stage.sequence}/stages/${stage.id}/recipients?filter=${a.name}`}\n                  key={a.name}\n                >\n                  <div className=\"chart-wrapper\" key={a.name}>\n                    <div className=\"chart\">\n                      <VictoryPie\n                        key={a.name}\n                        data={[\n                          { x: 1, y: analytics[a.value] },\n                          { x: 2, y: total - analytics[a.value] },\n                        ]}\n                        colorScale={[a.color, victoryColorBackground]}\n                        innerRadius={130}\n                        animate={{\n                          duration: 5000,\n                        }}\n                      />\n                      <div className=\"numbers\">\n                        <h1 style={{ color: a.color }}>\n                          {total ? Math.round((analytics[a.value] / (\n                              a.value === 'delivered' ?\n                              analytics.delivered + recipientCounts.bounced\n                              : total\n                            )) * 100) : 0}%\n                        </h1>\n                        <h4>\n                          {analytics[a.value]} of {\n                            a.value === 'delivered' ?\n                            analytics.delivered + recipientCounts.bounced\n                            : total}\n                        </h4>\n                      </div>\n                    </div>\n                    <div className=\"label\">\n                      {a.name}\n                    </div>\n                  </div>\n                </Link>\n              ))}\n            </div>}\n          </div>\n          <div className=\"drilldowns\">\n            <div className=\"tabs\">\n              <Link to={`/sequences/${sequence.data.id}/stages/${stage.id}`} className=\"link\">\n                <div\n                  className={classnames('tab', {\n                    selected: selectedTab === SequenceTab.Message,\n                  })}\n                >\n                  Message\n                </div>\n              </Link>\n              <Link\n                to={`/sequences/${sequence.data.id}/stages/${stage.id}/recipients`}\n                className=\"link\"\n              >\n                <div\n                  className={classnames('tab', {\n                    selected: selectedTab === SequenceTab.Recipients,\n                  })}\n                >\n                  Recipients\n                </div>\n              </Link>\n            </div>\n            <div className=\"main\">\n              {selectedTab === SequenceTab.Message &&\n                <SequenceStageMessage\n                  stage={updatedStage ? updatedStage : stage}\n                  instances={instances}\n                  edit={edit}\n                  onEdit={this.handleInstanceEdit}\n                  placeholders={sequence.data.headers}\n                  onStageUpdate={this.handleStageUpdate}\n                  onStageEdit={this.handleStageEdit}\n                  onTestEmailClick={this.handleTestEmailClick}\n                  sender={sequence.data.senderEmail}\n                  readOnly={sequence.data.archived}\n                  enableEdit={this.handleEdit}\n                />}\n              {selectedTab === SequenceTab.Recipients &&\n                <SequenceStageRecipientsList\n                  stage={stage}\n                  recipientCounts={recipientCounts}\n                />}\n            </div>\n          </div>\n        </div>\n        {showTestEmailPopover && <Overlay>\n          <SendTestEmail\n            onSend={this.handleSendTestEmail}\n            onClose={this.handleSendTestEmailClose}\n            defaultValue={sequence.data.senderEmail}\n          />\n        </Overlay>}\n      </div>\n    );\n  }\n}\n\nexport default SequenceStageDetail;\n"]}]}