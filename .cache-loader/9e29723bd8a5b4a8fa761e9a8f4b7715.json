{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Threads/components/ThreadList/components/InfiniteThreadList/DraftCell/DraftCell.tsx","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Threads/components/ThreadList/components/InfiniteThreadList/DraftCell/DraftCell.tsx","mtime":1675280254116},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JzsKaW1wb3J0IGNsYXNzbmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7CmltcG9ydCB7IHNob3dNb3N0UmVjZW50IH0gZnJvbSAnQHNyYy9saWIvZGF0ZXRpbWUnOwppbXBvcnQgeyBnZXREaXNwbGF5TmFtZSwgZ2V0Rmlyc3ROYW1lIH0gZnJvbSAnQHNyYy9saWIvYWRkcmVzcyc7CmltcG9ydCB7IERyYWZ0U3RhdHVzIH0gZnJvbSAnQHNyYy90eXBlcyc7CmltcG9ydCBEcmFmdEljb24gZnJvbSAnQHNyYy9jb21wb25lbnRzL0ljb25zL0RyYWZ0LnN2Zyc7CmltcG9ydCAnLi9EcmFmdENlbGwuc2Nzcyc7CmltcG9ydCB7IGV4dHJhY3REcmFmdFNuaXBwZXQgfSBmcm9tICdAc3JjL2xpYi9odG1sJzsKdmFyIERyYWZ0Q2VsbCA9IGZ1bmN0aW9uIChwcm9wcykgewogICAgdmFyIGRyYWZ0ID0gcHJvcHMuZHJhZnQsIHNlbGVjdGVkID0gcHJvcHMuc2VsZWN0ZWQsIG9uQ2xpY2sgPSBwcm9wcy5vbkNsaWNrOwogICAgdmFyIHRvID0gZHJhZnQudG8sIGNjID0gZHJhZnQuY2MsIGJjYyA9IGRyYWZ0LmJjYzsKICAgIHZhciByZWNpcGllbnRzID0gdG8gfHwgW107CiAgICBpZiAoY2MpIHsKICAgICAgICByZWNpcGllbnRzID0gcmVjaXBpZW50cy5jb25jYXQoY2MpOwogICAgfQogICAgaWYgKGJjYykgewogICAgICAgIHJlY2lwaWVudHMgPSByZWNpcGllbnRzLmNvbmNhdChiY2MpOwogICAgfQogICAgdmFyIHRpbWUgPSBzaG93TW9zdFJlY2VudChkcmFmdC51cGRhdGVkKTsKICAgIHZhciBkcmFmdEZhaWxlZCA9IGRyYWZ0LnN0YXR1cyA9PT0gRHJhZnRTdGF0dXMuRmFpbGVkOwogICAgLy8gUmVjaXBpZW50cwogICAgdmFyIHJlY2lwaWVudFN0cmluZyA9ICcnOwogICAgdmFyIG1heE5hbWVDb3VudCA9IDM7CiAgICBpZiAoIXJlY2lwaWVudHMubGVuZ3RoKSB7CiAgICAgICAgcmVjaXBpZW50U3RyaW5nID0gJ05vIFJlY2lwaWVudHMnOwogICAgfQogICAgZWxzZSBpZiAocmVjaXBpZW50cy5sZW5ndGggPT09IDEpIHsKICAgICAgICByZWNpcGllbnRTdHJpbmcgPSBnZXREaXNwbGF5TmFtZShyZWNpcGllbnRzWzBdKTsKICAgIH0KICAgIGVsc2UgaWYgKHJlY2lwaWVudHMubGVuZ3RoIDw9IG1heE5hbWVDb3VudCkgewogICAgICAgIHJlY2lwaWVudFN0cmluZyA9IHJlY2lwaWVudHMubWFwKGZ1bmN0aW9uIChyZWNpcGllbnQpIHsgcmV0dXJuIGdldEZpcnN0TmFtZShyZWNpcGllbnQpOyB9KS5qb2luKCcsICcpOwogICAgfQogICAgZWxzZSBpZiAocmVjaXBpZW50cy5sZW5ndGggPiBtYXhOYW1lQ291bnQpIHsKICAgICAgICB2YXIgbmFtZVN0cmluZyA9IHJlY2lwaWVudHMKICAgICAgICAgICAgLnNsaWNlKDAsIG1heE5hbWVDb3VudCkKICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAocmVjaXBpZW50KSB7IHJldHVybiBnZXRGaXJzdE5hbWUocmVjaXBpZW50KTsgfSkuam9pbignLCAnKTsKICAgICAgICB2YXIgb3RoZXJDb3VudCA9IHJlY2lwaWVudHMubGVuZ3RoIC0gbWF4TmFtZUNvdW50OwogICAgICAgIHZhciBvdGhlclN0cmluZyA9IG90aGVyQ291bnQgPT09IDEgPyAnb3RoZXInIDogJ290aGVycyc7CiAgICAgICAgcmVjaXBpZW50U3RyaW5nID0gbmFtZVN0cmluZyArICgiICYgIiArIG90aGVyQ291bnQgKyAiICIpICsgb3RoZXJTdHJpbmc7CiAgICB9CiAgICB2YXIgaGFuZGxlQ2xpY2sgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIG9uQ2xpY2soZSwgcHJvcHMuZHJhZnQpOwogICAgfTsKICAgIC8vIFNldCBkcmFmdCBmYWlsdXJlIGNvcHkKICAgIHZhciBkcmFmdEZhaWxlZENvcHkgPSBkcmFmdC5lcnJvciAmJiAiXHUyNkEwXHVGRTBGICIgKyBkcmFmdC5lcnJvciB8fCAn4pqg77iPIEZhaWxlZCB0byBzZW5kJzsKICAgIHZhciBjYW5jZWxlZExhdGVyID0gZmFsc2U7CiAgICBpZiAoZHJhZnQuZXJyb3IgJiYgZHJhZnQuZXJyb3IgPT09ICdTY2hlZHVsZWQgZHJhZnQgY2FuY2VsZWQgZHVlIHRvIG5ldyByZXBseS4nKSB7CiAgICAgICAgY2FuY2VsZWRMYXRlciA9IHRydWU7CiAgICB9CiAgICByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIsIHsgY2xhc3NOYW1lOiBjbGFzc25hbWVzKCdkcmFmdC1jZWxsJywgeyBzZWxlY3RlZDogc2VsZWN0ZWQgfSksIG9uQ2xpY2s6IGhhbmRsZUNsaWNrLCBpZDogZHJhZnQuaWQsIHRhYkluZGV4OiAtMSwga2V5OiBkcmFmdC5pZCArIGRyYWZ0LnVwZGF0ZWQgfSwKICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogIm1haW4iIH0sCiAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAidG9wLXJvdyIgfSwKICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNtYWxsIiwgbnVsbCwgIiIgKyAocmVjaXBpZW50U3RyaW5nIHx8ICcnKSksCiAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImRlc2MiIH0sCiAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgic21hbGwiLCB7IGNsYXNzTmFtZTogInRpbWUiIH0sIHRpbWUpKSksCiAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAic3ViamVjdCIgfSwKICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImg1IiwgbnVsbCwgZHJhZnQuc3ViamVjdCB8fCAnKE5vIHN1YmplY3QpJykpLAogICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogInNuaXBwZXQiIH0sCiAgICAgICAgICAgICAgICAhZHJhZnRGYWlsZWQgJiYgUmVhY3QuY3JlYXRlRWxlbWVudChEcmFmdEljb24sIHsgY2xhc3NOYW1lOiAiaWNvbiIsIHdpZHRoOiAiMTIiLCBoZWlnaHQ6ICIxMiIgfSksCiAgICAgICAgICAgICAgICAhZHJhZnRGYWlsZWQgJiYgUmVhY3QuY3JlYXRlRWxlbWVudCgic21hbGwiLCBudWxsLCBleHRyYWN0RHJhZnRTbmlwcGV0KGRyYWZ0KSksCiAgICAgICAgICAgICAgICBkcmFmdEZhaWxlZCAmJiAoUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIHsgY2xhc3NOYW1lOiBjbGFzc25hbWVzKCdlcnJvcicsIHsgY2FuY2VsZWQ6IGNhbmNlbGVkTGF0ZXIgfSkgfSwgZHJhZnRGYWlsZWRDb3B5KSkpKSkpOwp9OwpleHBvcnQgZGVmYXVsdCBEcmFmdENlbGw7Cg=="},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Threads/components/ThreadList/components/InfiniteThreadList/DraftCell/DraftCell.tsx","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Threads/components/ThreadList/components/InfiniteThreadList/DraftCell/DraftCell.tsx"],"names":[],"mappings":"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","sourcesContent":["import React from 'react';\nimport classnames from 'classnames';\n\nimport { showMostRecent } from '@src/lib/datetime';\nimport { getDisplayName, getFirstName } from '@src/lib/address';\nimport { Draft, DraftStatus } from '@src/types';\n\nimport DraftIcon from '@src/components/Icons/Draft.svg';\nimport './DraftCell.scss';\nimport { extractDraftSnippet } from '@src/lib/html';\n\ninterface Props {\n  draft: Draft;\n  selected: boolean;\n  onClick: (e: React.MouseEvent<HTMLElement>, draft: Draft) => void;\n}\n\nconst DraftCell = (props: Props) => {\n  const { draft, selected, onClick } = props;\n  const { to, cc, bcc } = draft;\n  let recipients = to || [];\n  if (cc) {\n    recipients = recipients.concat(cc);\n  }\n  if (bcc) {\n    recipients = recipients.concat(bcc);\n  }\n  const time = showMostRecent(draft.updated);\n  const draftFailed = draft.status === DraftStatus.Failed;\n\n  // Recipients\n  let recipientString = '';\n  const maxNameCount = 3;\n  if (!recipients.length) {\n    recipientString = 'No Recipients';\n  } else if (recipients.length === 1) {\n    recipientString = getDisplayName(recipients[0]);\n  } else if (recipients.length <= maxNameCount) {\n    recipientString = recipients.map(recipient => getFirstName(recipient)).join(', ');\n  } else if (recipients.length > maxNameCount) {\n    const nameString = recipients\n      .slice(0, maxNameCount)\n      .map(recipient => getFirstName(recipient)).join(', ');\n    const otherCount = recipients.length - maxNameCount;\n    const otherString = otherCount === 1 ? 'other' : 'others';\n    recipientString = nameString + ` & ${otherCount} ` + otherString;\n  }\n\n  const handleClick = (e: React.MouseEvent<HTMLElement>) => {\n    e.stopPropagation();\n    e.preventDefault();\n    onClick(e, props.draft);\n  };\n\n  // Set draft failure copy\n  const draftFailedCopy = draft.error && `⚠️ ${draft.error}` || '⚠️ Failed to send';\n  let canceledLater = false;\n  if (draft.error && draft.error === 'Scheduled draft canceled due to new reply.') {\n    canceledLater = true;\n  }\n\n  return (\n    <button\n      className={classnames('draft-cell', { selected })}\n      onClick={handleClick}\n      id={draft.id}\n      tabIndex={-1}\n      key={draft.id + draft.updated}\n    >\n      <div className=\"main\">\n        <div className=\"top-row\">\n          <small>{`${recipientString || ''}`}</small>\n          <div className=\"desc\">\n            <small className=\"time\">{time}</small>\n          </div>\n        </div>\n        <div className=\"subject\">\n          <h5>{draft.subject || '(No subject)'}</h5>\n        </div>\n        <div className=\"snippet\">\n          {!draftFailed && <DraftIcon className=\"icon\" width=\"12\" height=\"12\" />}\n          {!draftFailed && <small>{extractDraftSnippet(draft)}</small>}\n          {draftFailed && (\n            <span\n              className={classnames('error', { canceled: canceledLater })}\n            >\n              {draftFailedCopy}\n            </span>\n          )}\n        </div>\n      </div>\n    </button>\n  );\n};\n\nexport default DraftCell;\n"]}]}