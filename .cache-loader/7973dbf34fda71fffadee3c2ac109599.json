{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Login/components/MagicLink/MagicLink.tsx","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Login/components/MagicLink/MagicLink.tsx","mtime":1675280254078},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewogICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewogICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAogICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKICAgIH07CiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwogICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQogICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKICAgIH07Cn0pKCk7CmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7CmltcG9ydCBDdXN0b21Mb2FkZXIgZnJvbSAncmVhY3QtbG9hZGVycyc7CmltcG9ydCAnLi9NYWdpY0xpbmsuc2Nzcyc7CnZhciBNYWdpY0xpbmsgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoTWFnaWNMaW5rLCBfc3VwZXIpOwogICAgZnVuY3Rpb24gTWFnaWNMaW5rKCkgewogICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7CiAgICAgICAgX3RoaXMuaGFuZGxlRW1haWxDaGFuZ2UgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IGVtYWlsOiBlLmN1cnJlbnRUYXJnZXQudmFsdWUgfSk7CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5oYW5kbGVTdWJtaXQgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICBpZiAoZSkgewogICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIF90aGlzLnByb3BzLmdldE1hZ2ljTGluayhfdGhpcy5zdGF0ZS5lbWFpbCk7CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5oYW5kbGVSZXNlbmQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIF90aGlzLnByb3BzLmdldE1hZ2ljTGluayhfdGhpcy5zdGF0ZS5lbWFpbCk7CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5oYW5kbGVXZWJhcHAgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBjbGVhclJlZGlyZWN0ID0gX3RoaXMucHJvcHMuY2xlYXJSZWRpcmVjdDsKICAgICAgICAgICAgY2xlYXJSZWRpcmVjdCgpOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlTWFudWFsT3BlbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIF9hID0gX3RoaXMucHJvcHMsIG1lID0gX2EubWUsIGdldE1hZ2ljTGluayA9IF9hLmdldE1hZ2ljTGluazsKICAgICAgICAgICAgaWYgKG1lKSB7CiAgICAgICAgICAgICAgICBnZXRNYWdpY0xpbmsobWUuZW1haWwpOwogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5zdGF0ZSA9IHsKICAgICAgICAgICAgZW1haWw6ICcnLAogICAgICAgIH07CiAgICAgICAgcmV0dXJuIF90aGlzOwogICAgfQogICAgTWFnaWNMaW5rLnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgX2EgPSB0aGlzLnByb3BzLCBsb2dnZWRJbiA9IF9hLmxvZ2dlZEluLCBtZSA9IF9hLm1lLCBnZXRNYWdpY0xpbmsgPSBfYS5nZXRNYWdpY0xpbms7CiAgICAgICAgaWYgKGxvZ2dlZEluICYmIG1lKSB7CiAgICAgICAgICAgIGdldE1hZ2ljTGluayhtZS5lbWFpbCk7CiAgICAgICAgfQogICAgfTsKICAgIC8vIEhhbmRsZSBkaXNwbGF5IG9mIGNvZGUKICAgIE1hZ2ljTGluay5wcm90b3R5cGUuY29tcG9uZW50RGlkVXBkYXRlID0gZnVuY3Rpb24gKG9sZFByb3BzKSB7CiAgICAgICAgdmFyIF9hID0gdGhpcy5wcm9wcywgbWUgPSBfYS5tZSwgZ2V0TWFnaWNMaW5rID0gX2EuZ2V0TWFnaWNMaW5rOwogICAgICAgIHZhciBtZUF2YWlsYWJsZSA9IG1lICYmICFvbGRQcm9wcy5tZTsKICAgICAgICBpZiAobWUgJiYgbWVBdmFpbGFibGUpIHsKICAgICAgICAgICAgZ2V0TWFnaWNMaW5rKG1lLmVtYWlsKTsKICAgICAgICB9CiAgICB9OwogICAgLy8gVE9ETyhTSElOKTogQWRkIGJhY2sgYnV0dG9uCiAgICBNYWdpY0xpbmsucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgbWUgPSB0aGlzLnByb3BzLm1lOwogICAgICAgIHJldHVybiAoUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJtYWdpYy1saW5rLWxvZ2luIiB9LAogICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogInByb21wdCIgfSwKICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAibWFnaWMtbGluay1sb2FkaW5nIiB9LAogICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoQ3VzdG9tTG9hZGVyLCB7IHR5cGU6ICJsaW5lLXNjYWxlLXB1bHNlLW91dC1yYXBpZCIsIGlubmVyQ2xhc3NOYW1lOiAiY3VzdG9tLWxvYWRlci1pbm5lciIsIGFjdGl2ZTogdHJ1ZSB9KSksCiAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogInRpdGxlIiB9LCAiU2lnbmluZyB5b3UgaW50byBQb2x5bWFpbCIpLAogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJkZXNjcmlwdGlvbiIgfSwgIllvdSdsbCBiZSByZWRpcmVjdGVkIGludG8gUG9seW1haWwgaW4gYSBmZXcgbW9tZW50cy4uLiIpLAogICAgICAgICAgICAgICAgKG1lID09PSBudWxsIHx8IG1lID09PSB2b2lkIDAgPyB2b2lkIDAgOiBtZS5lbWFpbCkgJiYgKFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAibWFudWFsLXNlY3Rpb24iIH0sCiAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJtYW51YWwtYnV0dG9uIiwgb25DbGljazogdGhpcy5oYW5kbGVNYW51YWxPcGVuIH0sICJPcGVuIFBvbHltYWlsIikpKSwKICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAiZGlzY2xhaW1lciIgfSwgIkRvbid0IGhhdmUgdGhlIG5hdGl2ZSBhcHAgaW5zdGFsbGVkPyIpLAogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJkb3dubG9hZC11cmwiIH0sCiAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYSIsIHsgaHJlZjogImh0dHBzOi8vcG9seW1haWwuaW8vZG93bmxvYWQ/ZG93bmxvYWQ9MSIsIGNsYXNzTmFtZTogImRvd25sb2FkIiB9LCAiRG93bmxvYWQgUG9seW1haWwgZm9yIERlc2t0b3AiKSksCiAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogIndlYmFwcC1zZWN0aW9uIiB9LAogICAgICAgICAgICAgICAgICAgIChtZSA9PT0gbnVsbCB8fCBtZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogbWUuZW1haWwpICYmIChSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImVtYWlsLXNlY3Rpb24iIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICJTaWduZWQgaW4gYXMgIiwKICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYiIsIG51bGwsIG1lLmVtYWlsKSkpLAogICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICAiTm90IHlvdT8gU3dpdGNoIHlvdXIgYWNjb3VudCBpbiB0aGUgXHUwMEEwIiwKICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnV0dG9uIiwgeyBjbGFzc05hbWU6ICJ3ZWItYXBwIiwgb25DbGljazogdGhpcy5oYW5kbGVXZWJhcHAgfSwgIldlYiBBcHAiKSkpKSkpOwogICAgfTsKICAgIHJldHVybiBNYWdpY0xpbms7Cn0oUmVhY3QuUHVyZUNvbXBvbmVudCkpOwpleHBvcnQgZGVmYXVsdCBNYWdpY0xpbms7Cg=="},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Login/components/MagicLink/MagicLink.tsx","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Login/components/MagicLink/MagicLink.tsx"],"names":[],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Me } from '@src/types';\nimport CustomLoader from 'react-loaders';\n\nimport './MagicLink.scss';\n\ninterface State {\n  email: string;\n}\n\nexport interface StateProps {\n  me?: Me;\n  code?: string;\n  loggedIn?: boolean;\n  redirectPlatform?: string;\n}\n\nexport interface DispatchProps {\n  clearRedirect: () => void;\n  getMagicLink: (email: string) => void;\n  login: (code: string) => void;\n}\n\nclass MagicLink extends React.PureComponent<StateProps & DispatchProps, State> {\n  constructor() {\n    super();\n    this.state = {\n      email: '',\n    };\n  }\n\n  componentDidMount() {\n    const { loggedIn, me, getMagicLink } = this.props;\n    if (loggedIn && me) {\n      getMagicLink(me.email);\n    }\n  }\n\n  // Handle display of code\n  componentDidUpdate(oldProps: StateProps) {\n    const { me, getMagicLink } = this.props;\n    const meAvailable = me && !oldProps.me;\n    if (me && meAvailable) {\n      getMagicLink(me.email);\n    }\n  }\n\n  handleEmailChange = (e: React.FormEvent<HTMLInputElement>) => {\n    this.setState({ email: e.currentTarget.value });\n  }\n\n  handleSubmit = (e: React.FormEvent<HTMLFormElement>) => {\n    if (e) {\n      e.preventDefault();\n    }\n\n    this.props.getMagicLink(this.state.email);\n  }\n\n  handleResend = () => {\n    this.props.getMagicLink(this.state.email);\n  }\n\n  handleWebapp = () => {\n    const { clearRedirect } = this.props;\n    clearRedirect();\n  }\n\n  handleManualOpen = () => {\n    const { me, getMagicLink } = this.props;\n    if (me) {\n      getMagicLink(me.email);\n    }\n  }\n\n  // TODO(SHIN): Add back button\n  render() {\n    const { me } = this.props;\n    return (\n      <div className=\"magic-link-login\">\n        <div className=\"prompt\">\n          <div className=\"magic-link-loading\">\n            <CustomLoader\n              type=\"line-scale-pulse-out-rapid\"\n              innerClassName=\"custom-loader-inner\"\n              active\n            />\n          </div>\n          <div className=\"title\">\n            Signing you into Polymail\n          </div>\n          <div className=\"description\">\n            You'll be redirected into Polymail in a few moments...\n          </div>\n          {me?.email && (\n            <div\n              className=\"manual-section\"\n            >\n              <div\n                className=\"manual-button\"\n                onClick={this.handleManualOpen}\n              >\n                Open Polymail\n              </div>\n            </div>\n          )}\n          <div className=\"disclaimer\">\n            Don't have the native app installed?\n          </div>\n          <div className=\"download-url\">\n            <a href=\"https://polymail.io/download?download=1\" className=\"download\">\n              Download Polymail for Desktop\n            </a>\n          </div>\n          <div className=\"webapp-section\">\n          {me?.email && (\n            <div\n              className=\"email-section\"\n            >\n              Signed in as <b>{me.email}</b>\n            </div>\n          )}\n            <span>Not you? Switch your account in the\n              &nbsp;\n              <button className=\"web-app\" onClick={this.handleWebapp}>\n                Web App\n              </button>\n            </span>\n          </div>\n        </div>\n        {/* <div className=\"sign-out-container\">\n          <button className=\"sign-out\" onClick={this.props.logout}>Sign Out</button>\n        </div> */}\n      </div>\n    );\n  }\n}\n\nexport default MagicLink;\n"]}]}