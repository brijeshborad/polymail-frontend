{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/CommandControl/components/Draft/Draft.tsx","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/CommandControl/components/Draft/Draft.tsx","mtime":1675280253997},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewogICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewogICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAogICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKICAgIH07CiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwogICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQogICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKICAgIH07Cn0pKCk7CnZhciBfX2Fzc2lnbiA9ICh0aGlzICYmIHRoaXMuX19hc3NpZ24pIHx8IGZ1bmN0aW9uICgpIHsKICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbih0KSB7CiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7CiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07CiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkKICAgICAgICAgICAgICAgIHRbcF0gPSBzW3BdOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdDsKICAgIH07CiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfTsKaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JzsKaW1wb3J0IENvbnRyb2xQb3BvdmVyIGZyb20gJy4uL2NvbXBvbmVudHMvQ29udHJvbFBvcG92ZXInOwppbXBvcnQgYnJvd3Nlckhpc3RvcnkgZnJvbSAnQHNyYy9saWIvYnJvd3Nlckhpc3RvcnknOwppbXBvcnQgeyBDb21tYW5kQ29udHJvbFR5cGUsIE9uYm9hcmRpbmdUeXBlLCB9IGZyb20gJ0BzcmMvdHlwZXMnOwppbXBvcnQgeyBnZXRIb3RrZXlCeU5hbWUsIGhvdGtleXNUeXBlYWhlYWQsIEhvdGtleUFjdGlvbiwgfSBmcm9tICdAc3JjL2xpYi9ob3RrZXlzJzsKaW1wb3J0IENvbXBvc2UgZnJvbSAnQHNyYy9jb21wb25lbnRzL0ljb25zL0NvbXBvc2Uuc3ZnJzsKaW1wb3J0ICcuL0RyYWZ0LnNjc3MnOwppbXBvcnQgS2V5Ym9hcmRTeW1ib2wgZnJvbSAnQHNyYy9jb21wb25lbnRzL0Jhc2UvS2V5Ym9hcmRTeW1ib2wvS2V5Ym9hcmRTeW1ib2wnOwppbXBvcnQgeyBjb21tYW5kQ29udHJvbEhpZGUgfSBmcm9tICdAc3JjL2R1Y2tzL2NvbW1hbmRDb250cm9sJzsKaW1wb3J0IHsgZHJhZnRVcGRhdGUsIGRyYWZ0Q3JlYXRlQ29uZmlndXJhdGlvbiB9IGZyb20gJ0BzcmMvZHVja3MvZHJhZnRzJzsKaW1wb3J0IHsgdG9hc3RTZXQsIENvbmZpcm1hdGlvbkVycm9yIH0gZnJvbSAnQHNyYy9kdWNrcy90b2FzdHMnOwppbXBvcnQgeyBDb25maWd1cmF0aW9uIH0gZnJvbSAnQHNyYy9saWIvZHJhZnQnOwppbXBvcnQgeyBsYXN0LCBmaWx0ZXIgfSBmcm9tICdsb2Rhc2gnOwppbXBvcnQgeyB6b29tTWVldGluZ0NyZWF0ZSB9IGZyb20gJ0BzcmMvZHVja3Mvem9vbSc7CmltcG9ydCB7IEFtcGxpdHVkZUV2ZW50cywgbG9nQW1wbGl0dWRlRXZlbnQgfSBmcm9tICdAc3JjL2xpYi9hbXBsaXR1ZGUtYW5hbHl0aWNzJzsKdmFyIERyYWZ0ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewogICAgX19leHRlbmRzKERyYWZ0LCBfc3VwZXIpOwogICAgZnVuY3Rpb24gRHJhZnQocHJvcHMpIHsKICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzOwogICAgICAgIF90aGlzLmZpbHRlcmVkSG90a2V5cyA9IGZ1bmN0aW9uICh2YWx1ZSwgcHJvcHMpIHsKICAgICAgICAgICAgdmFyIHBhdGhuYW1lID0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lOwogICAgICAgICAgICByZXR1cm4gaG90a2V5c1R5cGVhaGVhZCh2YWx1ZSkKICAgICAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKGhvdGtleSkgewogICAgICAgICAgICAgICAgaWYgKHByb3BzLmZlYXR1cmVzKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCFwcm9wcy5mZWF0dXJlcy5mb2xsb3dVcCAmJiBob3RrZXkubmFtZSA9PT0gSG90a2V5QWN0aW9uLkZvbGxvd1VwUmVtaW5kZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoIXByb3BzLmZlYXR1cmVzLnNlbmRMYXRlciAmJgogICAgICAgICAgICAgICAgICAgICAgICBob3RrZXkubmFtZSA9PT0gSG90a2V5QWN0aW9uLlNlbmRMYXRlcikgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmICghcHJvcHMuZmVhdHVyZXMubWVzc2FnZVRlbXBsYXRlcyAmJgogICAgICAgICAgICAgICAgICAgICAgICBob3RrZXkubmFtZSA9PT0gSG90a2V5QWN0aW9uLk1lc3NhZ2VUZW1wbGF0ZXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHN3aXRjaCAoaG90a2V5Lm5hbWUpIHsKICAgICAgICAgICAgICAgICAgICBjYXNlIEhvdGtleUFjdGlvbi5DYW5jZWxGb2xsb3d1cDoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCghcHJvcHMuZHJhZnQgfHwgIXByb3BzLmRyYWZ0LndhaXRpbmcpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBIb3RrZXlBY3Rpb24uUG9wb3V0RHJhZnQ6CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhcGF0aG5hbWUuc3RhcnRzV2l0aCgnL3BvcG91dCcpOwogICAgICAgICAgICAgICAgICAgIGNhc2UgSG90a2V5QWN0aW9uLkNyZWF0ZVNoYXJlTGluazoKICAgICAgICAgICAgICAgICAgICBjYXNlIEhvdGtleUFjdGlvbi5SZXBseToKICAgICAgICAgICAgICAgICAgICBjYXNlIEhvdGtleUFjdGlvbi5SZXBseUFsbDogewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWRUaHJlYWQgPSBwcm9wcy5zZWxlY3RlZFRocmVhZDsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICEhc2VsZWN0ZWRUaHJlYWQ7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNhc2UgSG90a2V5QWN0aW9uLlJlcGx5QkNDOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZWxlY3RlZFRocmVhZCA9IHByb3BzLnNlbGVjdGVkVGhyZWFkOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGFzdE1lc3NhZ2UgPSBzZWxlY3RlZFRocmVhZCAmJiBzZWxlY3RlZFRocmVhZC5tZXNzYWdlcy5sZW5ndGggPwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdChmaWx0ZXIoc2VsZWN0ZWRUaHJlYWQubWVzc2FnZXMsIGZ1bmN0aW9uIChtZXNzYWdlKSB7IHJldHVybiAhbWVzc2FnZS5zZW50OyB9KSkgOiB1bmRlZmluZWQ7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2VsZWN0ZWRUaHJlYWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpZiAobGFzdE1lc3NhZ2UgJiYgbGFzdE1lc3NhZ2UudG8uY29uY2F0KGxhc3RNZXNzYWdlLmNjKS5sZW5ndGggPiAxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIGhvdGtleS5zY29wZSAmJgogICAgICAgICAgICAgICAgICAgIFsKICAgICAgICAgICAgICAgICAgICAgICAgQ29tbWFuZENvbnRyb2xUeXBlLkRyYWZ0LAogICAgICAgICAgICAgICAgICAgICAgICBDb21tYW5kQ29udHJvbFR5cGUuR2xvYmFsLAogICAgICAgICAgICAgICAgICAgICAgICBDb21tYW5kQ29udHJvbFR5cGUuU3lzdGVtLAogICAgICAgICAgICAgICAgICAgICAgICBDb21tYW5kQ29udHJvbFR5cGUuTmF2aWdhdGlvbiwKICAgICAgICAgICAgICAgICAgICBdLmluZGV4T2YoaG90a2V5LnNjb3BlKSAhPT0gLTE7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChob3RrZXkpIHsKICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGhvdGtleS5uYW1lLAogICAgICAgICAgICAgICAgICAgIGRlc2M6IGhvdGtleS50ZXh0LAogICAgICAgICAgICAgICAgICAgIGN1c3RvbURlc2NSZW5kZXJlcjogaG90a2V5LmtleUNvZGUgPyBfdGhpcy5yZW5kZXJPcHRpb25EZXNjIDogdW5kZWZpbmVkLAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5yZW5kZXJPcHRpb25EZXNjID0gZnVuY3Rpb24gKGRlc2MpIHsKICAgICAgICAgICAgcmV0dXJuIGRlc2Muc3BsaXQoJysnKS5tYXAoZnVuY3Rpb24gKGMsIGkpIHsgcmV0dXJuIChSZWFjdC5jcmVhdGVFbGVtZW50KEtleWJvYXJkU3ltYm9sLCB7IGtleTogYyArICItIiArIGksIGNoYXJhY3RlcjogYyB9KSk7IH0pOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlSW5wdXRDaGFuZ2UgPSBmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgb3B0aW9uczogX3RoaXMuZmlsdGVyZWRIb3RrZXlzKHZhbHVlLCBfdGhpcy5wcm9wcyksCiAgICAgICAgICAgIH0pOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlU2VsZWN0ID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgICAgIHZhciBfYSA9IF90aGlzLnByb3BzLCBkaXNwYXRjaEFjdGlvbiA9IF9hLmRpc3BhdGNoQWN0aW9uLCB1cGRhdGVIb3RrZXkgPSBfYS51cGRhdGVIb3RrZXksIHNlbGVjdGVkTWFpbGJveCA9IF9hLnNlbGVjdGVkTWFpbGJveCwgZHJhZnQgPSBfYS5kcmFmdCwgc2VsZWN0ZWRUaHJlYWQgPSBfYS5zZWxlY3RlZFRocmVhZCwgY29tbWFuZENvbnRyb2xTaG93ID0gX2EuY29tbWFuZENvbnRyb2xTaG93LCBhY3RpdmVTdGVwID0gX2EucnNiT25ib2FyZGluZzsKICAgICAgICAgICAgdmFyIGhvdGtleSA9IGdldEhvdGtleUJ5TmFtZSh2YWx1ZSk7CiAgICAgICAgICAgIGlmIChob3RrZXkpIHsKICAgICAgICAgICAgICAgIC8vIHN0ZXAgZml2ZSAtIHNhdmUgYSBtZXNzYWdlIHRlbXBsYXRlIGZyb20gdGhlIGNvbW1hbmQgY2VudGVyCiAgICAgICAgICAgICAgICBpZiAoYWN0aXZlU3RlcCA9PT0gT25ib2FyZGluZ1R5cGUuU2F2ZUFzVGVtcGxhdGUKICAgICAgICAgICAgICAgICAgICAmJiB2YWx1ZSA9PT0gSG90a2V5QWN0aW9uLlNhdmVBc1RlbXBsYXRlKSB7CiAgICAgICAgICAgICAgICAgICAgbG9nQW1wbGl0dWRlRXZlbnQoQW1wbGl0dWRlRXZlbnRzLlRvdXJTdGVwRml2ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAvLyBIQUNLKFNISU4pOiBDdXN0b20gcmVkaXJlY3QgdG8gQ2FsZW5kYXIgU2V0dGluZ3MgcGFnZSB3aGVuIHNjaGVkdWxpbmcgdXJsIGRvZXMgbm90IGV4aXN0CiAgICAgICAgICAgICAgICAvLyBhbmQgY29weSBpcyBhY2Nlc3NlZCBmcm9tIGNvbW1hbmQgY29udHJvbAogICAgICAgICAgICAgICAgaWYgKGhvdGtleS5uYW1lID09PSBIb3RrZXlBY3Rpb24uQ29weVNjaGVkdWxpbmdVcmwpIHsKICAgICAgICAgICAgICAgICAgICBjb21tYW5kQ29udHJvbFNob3coQ29tbWFuZENvbnRyb2xUeXBlLlNjaGVkdWxpbmdQYWdlcyk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgc3dpdGNoIChob3RrZXkubmFtZSkgewogICAgICAgICAgICAgICAgICAgIGNhc2UgSG90a2V5QWN0aW9uLk9wZW5DYWxlbmRhcjoKICAgICAgICAgICAgICAgICAgICAgICAgY29tbWFuZENvbnRyb2xTaG93KENvbW1hbmRDb250cm9sVHlwZS5DYWxlbmRhcik7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICBjYXNlIEhvdGtleUFjdGlvbi5ab29tQ3JlYXRlTWVldGluZzoKICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hBY3Rpb24oem9vbU1lZXRpbmdDcmVhdGUobnVsbCkpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIEhvdGtleUFjdGlvbi5SZXBseUJDQzogewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWRyYWZ0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzZWxlY3RlZFRocmVhZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoQWN0aW9uKGRyYWZ0Q3JlYXRlQ29uZmlndXJhdGlvbihDb25maWd1cmF0aW9uLk1vdmVCY2MpKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6IGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gUmVtb3ZlIGZvbGxvd3VwIHJlbWluZGVyCiAgICAgICAgICAgICAgICB2YXIgd2FpdGluZyA9IF90aGlzLnByb3BzLmRyYWZ0ICYmIF90aGlzLnByb3BzLmRyYWZ0LndhaXRpbmc7CiAgICAgICAgICAgICAgICBpZiAoaG90a2V5Lm5hbWUgPT09IEhvdGtleUFjdGlvbi5DYW5jZWxGb2xsb3d1cCAmJiBkcmFmdCAmJiB3YWl0aW5nKSB7CiAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hBY3Rpb24oZHJhZnRVcGRhdGUoX19hc3NpZ24oX19hc3NpZ24oe30sIGRyYWZ0KSwgeyB3YWl0aW5nOiBudWxsIH0pKSk7CiAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hBY3Rpb24odG9hc3RTZXQobmV3IENvbmZpcm1hdGlvbkVycm9yKCdZb3VyIGZvbGxvd3VwIGhhcyBiZWVuIGNhbmNlbGVkIScsIHRydWUpKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoaG90a2V5LmFjdGlvbikgewogICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoQWN0aW9uKGhvdGtleS5hY3Rpb24pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gSGFuZGxlIHJvdXRlIGNoYW5nZSBpZiByb3V0ZSBjaGFuZ2UKICAgICAgICAgICAgICAgIGlmIChob3RrZXkucm91dGUgJiYgISFzZWxlY3RlZE1haWxib3gpIHsKICAgICAgICAgICAgICAgICAgICBicm93c2VySGlzdG9yeS5wdXNoKGhvdGtleS5yb3V0ZShzZWxlY3RlZE1haWxib3gpKTsKICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaEFjdGlvbihjb21tYW5kQ29udHJvbEhpZGUodW5kZWZpbmVkKSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdXBkYXRlSG90a2V5KGhvdGtleS5uYW1lKTsKICAgICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlUmVmID0gZnVuY3Rpb24gKHJlZikgewogICAgICAgICAgICBfdGhpcy5wb3BvdmVyID0gcmVmOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuc3RhdGUgPSB7CiAgICAgICAgICAgIG9wdGlvbnM6IF90aGlzLmZpbHRlcmVkSG90a2V5cygnJywgcHJvcHMpLAogICAgICAgIH07CiAgICAgICAgcmV0dXJuIF90aGlzOwogICAgfQogICAgRHJhZnQucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50ID0gZnVuY3Rpb24gKCkgewogICAgICAgIGlmICh0aGlzLnByb3BzLmlzRGVmYXVsdCkgewogICAgICAgICAgICB0aGlzLnBvcG92ZXIuaGlkZSgpOwogICAgICAgIH0KICAgIH07CiAgICBEcmFmdC5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBjb21wb3NlID0gUmVhY3QuY3JlYXRlRWxlbWVudChDb21wb3NlLCB7IHdpZHRoOiAiMTRweCIsIGhlaWdodDogIjE0cHgiIH0pOwogICAgICAgIHZhciBvbkhpZGUgPSB0aGlzLnByb3BzLm9uSGlkZTsKICAgICAgICB2YXIgb3B0aW9ucyA9IHRoaXMuc3RhdGUub3B0aW9uczsKICAgICAgICByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoQ29udHJvbFBvcG92ZXIsIHsgaWNvbjogY29tcG9zZSwgaGVhZGluZzogIkRyYWZ0IEFjdGlvbnMiLCBjbGFzc05hbWU6ICJkcmFmdC1wb3BvdmVyIiwgdHlwZTogQ29tbWFuZENvbnRyb2xUeXBlLkRyYWZ0LCBvcHRpb25zOiBvcHRpb25zLCBwbGFjZWhvbGRlcjogInNlbmQgbGF0ZXIsIHNldCBhIGZvbGxvdyB1cC4uLiIsIG9uSGlkZTogb25IaWRlLCBvbklucHV0Q2hhbmdlOiB0aGlzLmhhbmRsZUlucHV0Q2hhbmdlLCBvblNlbGVjdDogdGhpcy5oYW5kbGVTZWxlY3QsIHJlZjogdGhpcy5oYW5kbGVSZWYsIHNob3dPbk1vdW50OiAhdGhpcy5wcm9wcy5pc0RlZmF1bHQgfSkpOwogICAgfTsKICAgIHJldHVybiBEcmFmdDsKfShSZWFjdC5QdXJlQ29tcG9uZW50KSk7CmV4cG9ydCBkZWZhdWx0IERyYWZ0Owo="},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/CommandControl/components/Draft/Draft.tsx","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/CommandControl/components/Draft/Draft.tsx"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAO,KAAK,MAAM,OAAO,CAAC;AAE1B,OAAO,cAA0B,MAAM,8BAA8B,CAAC;AACtE,OAAO,cAAc,MAAM,yBAAyB,CAAC;AACrD,OAAO,EACL,kBAAkB,EAElB,cAAc,GACf,MAAM,YAAY,CAAC;AACpB,OAAO,EACL,eAAe,EACf,gBAAgB,EAChB,YAAY,GAGb,MAAM,kBAAkB,CAAC;AAE1B,OAAO,OAAO,MAAM,mCAAmC,CAAC;AAExD,OAAO,cAAc,CAAC;AACtB,OAAO,cAAc,MAAM,oDAAoD,CAAC;AAChF,OAAO,EAAE,kBAAkB,EAAE,MAAM,2BAA2B,CAAC;AAC/D,OAAO,EAAE,WAAW,EAAE,wBAAwB,EAAE,MAAM,mBAAmB,CAAC;AAC1E,OAAO,EAAE,QAAQ,EAAE,iBAAiB,EAAE,MAAM,mBAAmB,CAAC;AAEhE,OAAO,EAAE,aAAa,EAAE,MAAM,gBAAgB,CAAC;AAC/C,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,MAAM,QAAQ,CAAC;AACtC,OAAO,EAAE,iBAAiB,EAAE,MAAM,iBAAiB,CAAC;AACpD,OAAO,EAAE,eAAe,EAAE,iBAAiB,EAAE,MAAM,8BAA8B,CAAC;AA2BlF;IAAoB,yBAA8D;IAGhF,eAAY,KAAyC;QAArD,YACE,iBAAO,SAKR;QAQD,qBAAe,GAAG,UAAC,KAAa,EAAE,KAAyC;YACzE,IAAM,QAAQ,GAAG,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC;YAC1C,OAAO,gBAAgB,CAAC,KAAK,CAAC;iBAC3B,MAAM,CAAC,UAAC,MAAM;gBACb,IAAI,KAAK,CAAC,QAAQ,EAAE;oBAClB,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,IAAI,MAAM,CAAC,IAAI,KAAK,YAAY,CAAC,gBAAgB,EAAE;wBAC7E,OAAO,KAAK,CAAC;qBACd;oBACD,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,SAAS;wBAC3B,MAAM,CAAC,IAAI,KAAK,YAAY,CAAC,SAAS,EAAE;wBACxC,OAAO,KAAK,CAAC;qBACd;oBACD,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,gBAAgB;wBAClC,MAAM,CAAC,IAAI,KAAK,YAAY,CAAC,gBAAgB,EAAE;wBAC/C,OAAO,KAAK,CAAC;qBACd;iBACF;gBAED,QAAQ,MAAM,CAAC,IAAI,EAAE;oBACnB,KAAK,YAAY,CAAC,cAAc;wBAC9B,IAAI,CAAC,CAAC,KAAK,CAAC,KAAK,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE;4BAC1C,OAAO,KAAK,CAAC;yBACd;wBACD,MAAM;oBACR,KAAK,YAAY,CAAC,WAAW;wBAC3B,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;oBACzC,KAAK,YAAY,CAAC,eAAe,CAAC;oBAClC,KAAK,YAAY,CAAC,KAAK,CAAC;oBACxB,KAAK,YAAY,CAAC,QAAQ,CAAC,CAAC;wBAClB,IAAA,qCAAc,CAAW;wBACjC,OAAO,CAAC,CAAC,cAAc,CAAC;qBACzB;oBACD,KAAK,YAAY,CAAC,QAAQ,CAAC,CAAC;wBAClB,IAAA,qCAAc,CAAW;wBACjC,IAAM,WAAW,GAAG,cAAc,IAAI,cAAc,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;4BACpE,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,QAAQ,EAAE,UAAA,OAAO,IAAI,OAAA,CAAC,OAAO,CAAC,IAAI,EAAb,CAAa,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC;wBAC9E,IAAI,CAAC,cAAc,EAAE;4BACnB,OAAO,KAAK,CAAC;yBACd;wBAED,IAAI,WAAW,IAAI,WAAW,CAAC,EAAE,CAAC,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;4BACnE,OAAO,IAAI,CAAC;yBACb;wBAED,OAAO,KAAK,CAAC;qBACd;oBACD;wBACE,MAAM;iBACT;gBAED,OAAO,MAAM,CAAC,KAAK;oBACjB;wBACE,kBAAkB,CAAC,KAAK;wBACxB,kBAAkB,CAAC,MAAM;wBACzB,kBAAkB,CAAC,MAAM;wBACzB,kBAAkB,CAAC,UAAU;qBAC9B,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC;YACnC,CAAC,CAAC;iBACD,GAAG,CAAC,UAAC,MAA2B;gBAC/B,OAAO;oBACL,KAAK,EAAE,MAAM,CAAC,IAAI;oBAClB,IAAI,EAAE,MAAM,CAAC,IAAI;oBACjB,kBAAkB,EAAE,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,KAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC,SAAS;iBACvE,CAAC;YACJ,CAAC,CAAC,CAAC;QACP,CAAC,CAAA;QAED,sBAAgB,GAAG,UAAC,IAAY;YAC9B,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,UAAC,CAAC,EAAE,CAAC,IAAK,OAAA,CACnC,oBAAC,cAAc,IACb,GAAG,EAAK,CAAC,SAAI,CAAG,EAChB,SAAS,EAAE,CAAC,GACZ,CACH,EALoC,CAKpC,CAAC,CAAC;QACL,CAAC,CAAA;QAED,uBAAiB,GAAG,UAAC,KAAa;YAChC,KAAI,CAAC,QAAQ,CAAC;gBACZ,OAAO,EAAE,KAAI,CAAC,eAAe,CAAC,KAAK,EAAE,KAAI,CAAC,KAAK,CAAC;aACjD,CAAC,CAAC;QACL,CAAC,CAAA;QAED,kBAAY,GAAG,UAAC,KAAa;YACrB,IAAA,gBAKQ,EAJZ,kCAAc,EAAE,8BAAY,EAC5B,oCAAe,EAAE,gBAAK,EACtB,kCAAc,EAAE,0CAAkB,EAClC,6BACY,CAAC;YACf,IAAM,MAAM,GAAG,eAAe,CAAC,KAAK,CAAC,CAAC;YACtC,IAAI,MAAM,EAAE;gBACV,8DAA8D;gBAC9D,IAAI,UAAU,KAAK,cAAc,CAAC,cAAc;uBACzC,KAAK,KAAK,YAAY,CAAC,cAAc,EAAE;oBAC5C,iBAAiB,CAAC,eAAe,CAAC,YAAY,CAAC,CAAC;iBACjD;gBAED,2FAA2F;gBAC3F,4CAA4C;gBAC5C,IAAI,MAAM,CAAC,IAAI,KAAK,YAAY,CAAC,iBAAiB,EAAE;oBAClD,kBAAkB,CAAC,kBAAkB,CAAC,eAAe,CAAC,CAAC;oBACvD,OAAO;iBACR;gBAED,QAAQ,MAAM,CAAC,IAAI,EAAE;oBACnB,KAAK,YAAY,CAAC,YAAY;wBAC5B,kBAAkB,CAAC,kBAAkB,CAAC,QAAQ,CAAC,CAAC;wBAChD,OAAO;oBACT,KAAK,YAAY,CAAC,iBAAiB;wBACjC,cAAc,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC,CAAC;wBACxC,MAAM;oBACR,KAAK,YAAY,CAAC,QAAQ,CAAC,CAAC;wBAC1B,IAAI,CAAC,KAAK,EAAE;4BACV,OAAO;yBACR;wBAED,IAAI,CAAC,cAAc,EAAE;4BACnB,OAAO;yBACR;wBAED,cAAc,CAAC,wBAAwB,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC,CAAC;wBAChE,MAAM;qBACP;oBAED,OAAO,CAAC,CAAC,MAAM;iBAChB;gBAED,2BAA2B;gBAC3B,IAAM,OAAO,GAAG,KAAI,CAAC,KAAK,CAAC,KAAK,IAAI,KAAI,CAAC,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC;gBAC7D,IAAI,MAAM,CAAC,IAAI,KAAK,YAAY,CAAC,cAAc,IAAI,KAAK,IAAI,OAAO,EAAE;oBACnE,cAAc,CAAC,WAAW,uBAAM,KAAK,KAAE,OAAO,EAAE,IAAI,IAAG,CAAC,CAAC;oBACzD,cAAc,CACZ,QAAQ,CAAC,IAAI,iBAAiB,CAC5B,kCAAkC,EAClC,IAAI,CACL,CAAC,CACH,CAAC;iBACH;gBAED,IAAI,MAAM,CAAC,MAAM,EAAE;oBACjB,cAAc,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;iBAC/B;gBAED,sCAAsC;gBACtC,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC,CAAC,eAAe,EAAE;oBACrC,cAAc,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,eAAe,CAAC,CAAC,CAAC;oBACnD,cAAc,CAAC,kBAAkB,CAAC,SAAS,CAAC,CAAC,CAAC;oBAC9C,OAAO;iBACR;gBAED,YAAY,CAAC,MAAM,CAAC,IAAoB,CAAC,CAAC;aAC3C;QACH,CAAC,CAAA;QAED,eAAS,GAAG,UAAC,GAAmB;YAC9B,KAAI,CAAC,OAAO,GAAG,GAAG,CAAC;QACrB,CAAC,CAAA;QAvKC,KAAI,CAAC,KAAK,GAAG;YACX,OAAO,EAAE,KAAI,CAAC,eAAe,CAAC,EAAE,EAAE,KAAK,CAAC;SACzC,CAAC;;IACJ,CAAC;IAED,iCAAiB,GAAjB;QACE,IAAI,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE;YACxB,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;SACrB;IACH,CAAC;IAgKD,sBAAM,GAAN;QACE,IAAM,OAAO,GAAG,oBAAC,OAAO,IAAC,KAAK,EAAC,MAAM,EAAC,MAAM,EAAC,MAAM,GAAG,CAAC;QAC/C,IAAA,0BAAM,CAAgB;QACtB,IAAA,4BAAO,CAAgB;QAE/B,OAAO,CACL,oBAAC,cAAc,IACb,IAAI,EAAE,OAAO,EACb,OAAO,EAAC,eAAe,EACvB,SAAS,EAAC,eAAe,EACzB,IAAI,EAAE,kBAAkB,CAAC,KAAK,EAC9B,OAAO,EAAE,OAAO,EAChB,WAAW,EAAC,gCAAgC,EAC5C,MAAM,EAAE,MAAM,EACd,aAAa,EAAE,IAAI,CAAC,iBAAiB,EACrC,QAAQ,EAAE,IAAI,CAAC,YAAY,EAC3B,GAAG,EAAE,IAAI,CAAC,SAAS,EACnB,WAAW,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,GAClC,CACH,CAAC;IACJ,CAAC;IACH,YAAC;AAAD,CAAC,AApMD,CAAoB,KAAK,CAAC,aAAa,GAoMtC;AAED,eAAe,KAAK,CAAC","sourcesContent":["import React from 'react';\n\nimport ControlPopover, { Option } from '../components/ControlPopover';\nimport browserHistory from '@src/lib/browserHistory';\nimport {\n  CommandControlType, Action,\n  Features, Mailbox, Draft as DraftType,\n  OnboardingType, Thread,\n} from '@src/types';\nimport {\n  getHotkeyByName,\n  hotkeysTypeahead,\n  HotkeyAction,\n  Hotkey,\n  HotkeyCode,\n} from '@src/lib/hotkeys';\n\nimport Compose from '@src/components/Icons/Compose.svg';\n\nimport './Draft.scss';\nimport KeyboardSymbol from '@src/components/Base/KeyboardSymbol/KeyboardSymbol';\nimport { commandControlHide } from '@src/ducks/commandControl';\nimport { draftUpdate, draftCreateConfiguration } from '@src/ducks/drafts';\nimport { toastSet, ConfirmationError } from '@src/ducks/toasts';\nimport { OnboardingPatchMeta } from '@src/ducks/me';\nimport { Configuration } from '@src/lib/draft';\nimport { last, filter } from 'lodash';\nimport { zoomMeetingCreate } from '@src/ducks/zoom';\nimport { AmplitudeEvents, logAmplitudeEvent } from '@src/lib/amplitude-analytics';\n\nexport interface Props {\n  onHide: () => void;\n  isDefault?: boolean;\n}\n\nexport interface StateProps {\n  features: Features;\n  schedulingUrl?: string;\n  selectedMailbox?: Mailbox;\n  draft?: DraftType;\n  rsbOnboarding?: OnboardingType;\n  selectedThread?: Thread;\n}\n\nexport interface DispatchProps {\n  commandControlShow: (type: CommandControlType) => void;\n  dispatchAction: (action: Action<any, any>) => void;\n  updateHotkey: (action: HotkeyAction) => void;\n  updateOnboarding?: (meta: OnboardingPatchMeta) => void;\n}\n\ninterface State {\n  options: Option[];\n}\n\nclass Draft extends React.PureComponent<Props & DispatchProps & StateProps, State> {\n  private popover: ControlPopover;\n\n  constructor(props: Props & DispatchProps & StateProps) {\n    super();\n\n    this.state = {\n      options: this.filteredHotkeys('', props),\n    };\n  }\n\n  componentDidMount() {\n    if (this.props.isDefault) {\n      this.popover.hide();\n    }\n  }\n\n  filteredHotkeys = (value: string, props: Props & DispatchProps & StateProps) => {\n    const pathname = window.location.pathname;\n    return hotkeysTypeahead(value)\n      .filter((hotkey) => {\n        if (props.features) {\n          if (!props.features.followUp && hotkey.name === HotkeyAction.FollowUpReminder) {\n            return false;\n          }\n          if (!props.features.sendLater &&\n            hotkey.name === HotkeyAction.SendLater) {\n            return false;\n          }\n          if (!props.features.messageTemplates &&\n            hotkey.name === HotkeyAction.MessageTemplates) {\n            return false;\n          }\n        }\n\n        switch (hotkey.name) {\n          case HotkeyAction.CancelFollowup:\n            if ((!props.draft || !props.draft.waiting)) {\n              return false;\n            }\n            break;\n          case HotkeyAction.PopoutDraft:\n            return !pathname.startsWith('/popout');\n          case HotkeyAction.CreateShareLink:\n          case HotkeyAction.Reply:\n          case HotkeyAction.ReplyAll: {\n            const { selectedThread } = props;\n            return !!selectedThread;\n          }\n          case HotkeyAction.ReplyBCC: {\n            const { selectedThread } = props;\n            const lastMessage = selectedThread && selectedThread.messages.length ?\n              last(filter(selectedThread.messages, message => !message.sent)) : undefined;\n            if (!selectedThread) {\n              return false;\n            }\n\n            if (lastMessage && lastMessage.to.concat(lastMessage.cc).length > 1) {\n              return true;\n            }\n\n            return false;\n          }\n          default:\n            break;\n        }\n\n        return hotkey.scope &&\n          [\n            CommandControlType.Draft,\n            CommandControlType.Global,\n            CommandControlType.System,\n            CommandControlType.Navigation,\n          ].indexOf(hotkey.scope) !== -1;\n      })\n      .map((hotkey: Hotkey & HotkeyCode) => {\n        return {\n          title: hotkey.name,\n          desc: hotkey.text,\n          customDescRenderer: hotkey.keyCode ? this.renderOptionDesc : undefined,\n        };\n      });\n  }\n\n  renderOptionDesc = (desc: string) => {\n    return desc.split('+').map((c, i) => (\n      <KeyboardSymbol\n        key={`${c}-${i}`}\n        character={c}\n      />\n    ));\n  }\n\n  handleInputChange = (value: string) => {\n    this.setState({\n      options: this.filteredHotkeys(value, this.props),\n    });\n  }\n\n  handleSelect = (value: string) => {\n    const {\n      dispatchAction, updateHotkey,\n      selectedMailbox, draft,\n      selectedThread, commandControlShow,\n      rsbOnboarding: activeStep,\n    } = this.props;\n    const hotkey = getHotkeyByName(value);\n    if (hotkey) {\n      // step five - save a message template from the command center\n      if (activeStep === OnboardingType.SaveAsTemplate\n          && value === HotkeyAction.SaveAsTemplate) {\n        logAmplitudeEvent(AmplitudeEvents.TourStepFive);\n      }\n\n      // HACK(SHIN): Custom redirect to Calendar Settings page when scheduling url does not exist\n      // and copy is accessed from command control\n      if (hotkey.name === HotkeyAction.CopySchedulingUrl) {\n        commandControlShow(CommandControlType.SchedulingPages);\n        return;\n      }\n\n      switch (hotkey.name) {\n        case HotkeyAction.OpenCalendar:\n          commandControlShow(CommandControlType.Calendar);\n          return;\n        case HotkeyAction.ZoomCreateMeeting:\n          dispatchAction(zoomMeetingCreate(null));\n          break;\n        case HotkeyAction.ReplyBCC: {\n          if (!draft) {\n            return;\n          }\n\n          if (!selectedThread) {\n            return;\n          }\n\n          dispatchAction(draftCreateConfiguration(Configuration.MoveBcc));\n          break;\n        }\n\n        default: break;\n      }\n\n      // Remove followup reminder\n      const waiting = this.props.draft && this.props.draft.waiting;\n      if (hotkey.name === HotkeyAction.CancelFollowup && draft && waiting) {\n        dispatchAction(draftUpdate({ ...draft, waiting: null }));\n        dispatchAction(\n          toastSet(new ConfirmationError(\n            'Your followup has been canceled!',\n            true,\n          )),\n        );\n      }\n\n      if (hotkey.action) {\n        dispatchAction(hotkey.action);\n      }\n\n      // Handle route change if route change\n      if (hotkey.route && !!selectedMailbox) {\n        browserHistory.push(hotkey.route(selectedMailbox));\n        dispatchAction(commandControlHide(undefined));\n        return;\n      }\n\n      updateHotkey(hotkey.name as HotkeyAction);\n    }\n  }\n\n  handleRef = (ref: ControlPopover) => {\n    this.popover = ref;\n  }\n\n  render() {\n    const compose = <Compose width=\"14px\" height=\"14px\" />;\n    const { onHide } = this.props;\n    const { options } = this.state;\n\n    return (\n      <ControlPopover\n        icon={compose}\n        heading=\"Draft Actions\"\n        className=\"draft-popover\"\n        type={CommandControlType.Draft}\n        options={options}\n        placeholder=\"send later, set a follow up...\"\n        onHide={onHide}\n        onInputChange={this.handleInputChange}\n        onSelect={this.handleSelect}\n        ref={this.handleRef}\n        showOnMount={!this.props.isDefault}\n      />\n    );\n  }\n}\n\nexport default Draft;\n"]}]}