{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/lib/DataSource.tsx","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/lib/DataSource.tsx","mtime":1675280254060},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewogICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewogICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAogICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKICAgIH07CiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwogICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQogICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKICAgIH07Cn0pKCk7CnZhciBfX2Fzc2lnbiA9ICh0aGlzICYmIHRoaXMuX19hc3NpZ24pIHx8IGZ1bmN0aW9uICgpIHsKICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbih0KSB7CiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7CiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07CiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkKICAgICAgICAgICAgICAgIHRbcF0gPSBzW3BdOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdDsKICAgIH07CiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfTsKdmFyIF9fc3ByZWFkQXJyYXlzID0gKHRoaXMgJiYgdGhpcy5fX3NwcmVhZEFycmF5cykgfHwgZnVuY3Rpb24gKCkgewogICAgZm9yICh2YXIgcyA9IDAsIGkgPSAwLCBpbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSBzICs9IGFyZ3VtZW50c1tpXS5sZW5ndGg7CiAgICBmb3IgKHZhciByID0gQXJyYXkocyksIGsgPSAwLCBpID0gMDsgaSA8IGlsOyBpKyspCiAgICAgICAgZm9yICh2YXIgYSA9IGFyZ3VtZW50c1tpXSwgaiA9IDAsIGpsID0gYS5sZW5ndGg7IGogPCBqbDsgaisrLCBrKyspCiAgICAgICAgICAgIHJba10gPSBhW2pdOwogICAgcmV0dXJuIHI7Cn07CmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7CnZhciBEYXRhU291cmNlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewogICAgX19leHRlbmRzKERhdGFTb3VyY2UsIF9zdXBlcik7CiAgICBmdW5jdGlvbiBEYXRhU291cmNlKCkgewogICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7CiAgICAgICAgX3RoaXMudXBkYXRlSXRlbXMgPSBmdW5jdGlvbiAobmV3SXRlbXMpIHsKICAgICAgICAgICAgdmFyIG5ld1N0YXRlID0gbmV3SXRlbXMucmVkdWNlKF90aGlzLnVwZGF0ZUl0ZW1SZWR1Y2VyLCB7CiAgICAgICAgICAgICAgICBpdGVtczogX19zcHJlYWRBcnJheXMoX3RoaXMuc3RhdGUuaXRlbXMpLAogICAgICAgICAgICAgICAgbG9jYXRpb25zOiBfX2Fzc2lnbih7fSwgX3RoaXMuc3RhdGUubG9jYXRpb25zKSwKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKG5ld1N0YXRlKTsKICAgICAgICAgICAgX3RoaXMucHJvcHMub25VcGRhdGUoKTsKICAgICAgICB9OwogICAgICAgIF90aGlzLnVwZGF0ZUl0ZW0gPSBmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZShfdGhpcy51cGRhdGVJdGVtUmVkdWNlcihfdGhpcy5zdGF0ZSwgaXRlbSkpOwogICAgICAgICAgICBfdGhpcy5wcm9wcy5vblVwZGF0ZSgpOwogICAgICAgIH07CiAgICAgICAgX3RoaXMudXBkYXRlSXRlbVJlZHVjZXIgPSBmdW5jdGlvbiAoc3RhdGUsIGl0ZW0pIHsKICAgICAgICAgICAgdmFyIF9hOwogICAgICAgICAgICB2YXIgaXRlbXMgPSBzdGF0ZS5pdGVtczsKICAgICAgICAgICAgdmFyIGxvY2F0aW9ucyA9IHN0YXRlLmxvY2F0aW9uczsKICAgICAgICAgICAgdmFyIGluZGV4ID0gbG9jYXRpb25zW2l0ZW0uaWRlbnRpZmllcl07CiAgICAgICAgICAgIC8vIElmIGV4aXN0cyBpbiBsb2NhdGlvbnMKICAgICAgICAgICAgaWYgKGluZGV4ID49IDApIHsKICAgICAgICAgICAgICAgIHZhciBmb3VuZCA9IGl0ZW1zW2luZGV4XTsKICAgICAgICAgICAgICAgIC8vIFJlcGxhY2UgaWYgaXRlbSBpcyB0aGUgc2FtZSBhbmQgbG9jYXRpb25zIGFyZSBlcXVhbAogICAgICAgICAgICAgICAgaWYgKGZvdW5kLnNvcnRWYWx1ZSA9PT0gaXRlbS5zb3J0VmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpdGVtc1tpbmRleF0gPSBpdGVtOwogICAgICAgICAgICAgICAgICAgIHJldHVybiB7IGl0ZW1zOiBpdGVtcywgbG9jYXRpb25zOiBsb2NhdGlvbnMgfTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vIElmIHNvcnQgaGFzIGNoYW5nZWQsIHJlY29tcHV0ZQogICAgICAgICAgICAgICAgaXRlbXMuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgICAgICAgICAgIGxvY2F0aW9ucyA9IHt9OwogICAgICAgICAgICAgICAgaXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoZWFjaCwgbikgewogICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uc1tlYWNoLmlkZW50aWZpZXJdID0gbjsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIEJhc2ljIGluc2VydCBpZiBhbHJlYWR5IGV4aXN0cwogICAgICAgICAgICBpZiAoaXRlbXMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgICAgICByZXR1cm4geyBpdGVtczogW2l0ZW1dLCBsb2NhdGlvbnM6IChfYSA9IHt9LCBfYVtpdGVtLmlkZW50aWZpZXJdID0gMCwgX2EpIH07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gU29ydGVkIEluc2VydCB3aGVuIG5vbi1leGlzdGVudAogICAgICAgICAgICB2YXIgbG93ID0gMDsKICAgICAgICAgICAgdmFyIGhpZ2ggPSBpdGVtcy5sZW5ndGggLSAxOwogICAgICAgICAgICB2YXIgbWlkID0gMDsKICAgICAgICAgICAgd2hpbGUgKGxvdyA8IGhpZ2gpIHsKICAgICAgICAgICAgICAgIG1pZCA9IE1hdGguZmxvb3IoKGhpZ2ggLSBsb3cpIC8gMikgKyBsb3c7CiAgICAgICAgICAgICAgICAvLyBUT0RPKFNISU4pOiBDaGVjayB0aGF0IGlkIGNvbXBhcmlzb24gaXMga29zaGVyCiAgICAgICAgICAgICAgICBpZiAoaXRlbXNbbWlkXSAmJiBpdGVtc1ttaWRdLnNvcnRWYWx1ZSA8IGl0ZW0uc29ydFZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgbG93ID0gbWlkICsgMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIGhpZ2ggPSBtaWQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdmFyIGVuZEluZGV4ID0gaXRlbXMubGVuZ3RoOwogICAgICAgICAgICBpZiAoaXRlbXNbbG93XSAmJiBpdGVtc1tsb3ddLnNvcnRWYWx1ZSA+PSBpdGVtLnNvcnRWYWx1ZSkgewogICAgICAgICAgICAgICAgZW5kSW5kZXggPSBsb3c7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGVuZEluZGV4ID09PSBpdGVtcy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgIGl0ZW1zLnB1c2goaXRlbSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBpdGVtcy5zcGxpY2UoZW5kSW5kZXgsIDAsIGl0ZW0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHZhciBpbnNlcnRlZExvY2F0aW9ucyA9IHt9OwogICAgICAgICAgICBpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChlYWNoLCBuKSB7CiAgICAgICAgICAgICAgICBpbnNlcnRlZExvY2F0aW9uc1tlYWNoLmlkZW50aWZpZXJdID0gbjsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJldHVybiB7IGl0ZW1zOiBpdGVtcywgbG9jYXRpb25zOiBpbnNlcnRlZExvY2F0aW9ucyB9OwogICAgICAgIH07CiAgICAgICAgLy8gT25seSB0byBiZSB1c2VkIGlmIGl0ZW1zIGFyZSBwcmUtc29ydGVkIGluIGNvcnJlY3Qgb3JkZXIKICAgICAgICBfdGhpcy5hcHBlbmRTb3J0ZWRJdGVtcyA9IGZ1bmN0aW9uIChzb3J0ZWRJdGVtcykgewogICAgICAgICAgICB2YXIgaXRlbXMgPSBfX3NwcmVhZEFycmF5cyhfdGhpcy5zdGF0ZS5pdGVtcyk7CiAgICAgICAgICAgIHZhciBsb2NhdGlvbnMgPSBfX2Fzc2lnbih7fSwgX3RoaXMuc3RhdGUubG9jYXRpb25zKTsKICAgICAgICAgICAgc29ydGVkSXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgICAgdmFyIGZvdW5kSW5kZXggPSBsb2NhdGlvbnNbaXRlbS5pZGVudGlmaWVyXTsKICAgICAgICAgICAgICAgIGlmIChmb3VuZEluZGV4ID49IDApIHsKICAgICAgICAgICAgICAgICAgICBpdGVtc1tmb3VuZEluZGV4XSA9IGl0ZW07CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gaXRlbXMubGVuZ3RoOwogICAgICAgICAgICAgICAgaXRlbXMucHVzaChpdGVtKTsKICAgICAgICAgICAgICAgIGxvY2F0aW9uc1tpdGVtLmlkZW50aWZpZXJdID0gaW5kZXg7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IGl0ZW1zOiBpdGVtcywgbG9jYXRpb25zOiBsb2NhdGlvbnMgfSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9OwogICAgICAgIC8vIFJlbW92ZXMgaWRlbnRpZmllcgogICAgICAgIF90aGlzLnJlbW92ZSA9IGZ1bmN0aW9uIChpZCkgewogICAgICAgICAgICB2YXIgbG9jYXRpb25zID0gX3RoaXMuc3RhdGUubG9jYXRpb25zOwogICAgICAgICAgICB2YXIgaXRlbXMgPSBfX3NwcmVhZEFycmF5cyhfdGhpcy5zdGF0ZS5pdGVtcyk7CiAgICAgICAgICAgIHZhciBpbmRleCA9IGxvY2F0aW9uc1tpZF07CiAgICAgICAgICAgIGlmIChpbmRleCA+PSAwKSB7CiAgICAgICAgICAgICAgICBpdGVtcy5zcGxpY2UoaW5kZXgsIDEpOwogICAgICAgICAgICAgICAgdmFyIG5ld0xvY2F0aW9uc18xID0ge307CiAgICAgICAgICAgICAgICBpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpKSB7CiAgICAgICAgICAgICAgICAgICAgbmV3TG9jYXRpb25zXzFbaXRlbS5pZGVudGlmaWVyXSA9IGk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgICAgICBpdGVtczogaXRlbXMsCiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25zOiBuZXdMb2NhdGlvbnNfMSwKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgX3RoaXMucHJvcHMub25VcGRhdGUoKTsKICAgICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgLy8gR2V0IGluZGV4IG9mIGl0ZW0gaWRlbnRpZmllcgogICAgICAgIF90aGlzLmdldExvY2F0aW9uID0gZnVuY3Rpb24gKGlkZW50aWZpZXIpIHsKICAgICAgICAgICAgcmV0dXJuIF90aGlzLnN0YXRlLmxvY2F0aW9uc1tpZGVudGlmaWVyXTsKICAgICAgICB9OwogICAgICAgIC8vIEdldCBpdGVtIGF0IHNwZWNpZmljIGluZGV4LgogICAgICAgIF90aGlzLmdldEl0ZW0gPSBmdW5jdGlvbiAoaW5kZXgpIHsKICAgICAgICAgICAgcmV0dXJuIF90aGlzLnN0YXRlLml0ZW1zW2luZGV4XTsKICAgICAgICB9OwogICAgICAgIF90aGlzLmdldExlbmd0aCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIF90aGlzLnN0YXRlLml0ZW1zLmxlbmd0aDsKICAgICAgICB9OwogICAgICAgIF90aGlzLmNsZWFyID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICBpdGVtczogW10sCiAgICAgICAgICAgICAgICBsb2NhdGlvbnM6IHt9LAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgX3RoaXMucHJvcHMub25VcGRhdGUoKTsKICAgICAgICB9OwogICAgICAgIF90aGlzLnN0YXRlID0gewogICAgICAgICAgICBpdGVtczogW10sCiAgICAgICAgICAgIGxvY2F0aW9uczoge30sCiAgICAgICAgfTsKICAgICAgICByZXR1cm4gX3RoaXM7CiAgICB9CiAgICBEYXRhU291cmNlLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuY2hpbGRyZW4odGhpcy5zdGF0ZS5pdGVtcy5tYXAoZnVuY3Rpb24gKGVhY2gpIHsgcmV0dXJuIGVhY2gucmVzb3VyY2U7IH0pKTsKICAgIH07CiAgICByZXR1cm4gRGF0YVNvdXJjZTsKfShSZWFjdC5QdXJlQ29tcG9uZW50KSk7CmV4cG9ydCBkZWZhdWx0IERhdGFTb3VyY2U7Cg=="},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/lib/DataSource.tsx","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/lib/DataSource.tsx"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAO,KAAK,MAAM,OAAO,CAAC;AAkB1B;IACQ,8BAAmD;IACzD;QAAA,YACE,iBAAO,SAKR;QAED,iBAAW,GAAG,UAAC,QAAkC;YAC/C,IAAM,QAAQ,GAAG,QAAQ,CAAC,MAAM,CAAC,KAAI,CAAC,iBAAiB,EAAE;gBACvD,KAAK,iBAAM,KAAI,CAAC,KAAK,CAAC,KAAK,CAAC;gBAC5B,SAAS,eAAO,KAAI,CAAC,KAAK,CAAC,SAAS,CAAE;aACvC,CAAC,CAAC;YACH,KAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;YACxB,KAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC;QACxB,CAAC,CAAA;QAED,gBAAU,GAAG,UAAC,IAAuB;YACnC,KAAI,CAAC,QAAQ,CAAC,KAAI,CAAC,iBAAiB,CAAC,KAAI,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC;YACxD,KAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC;QACxB,CAAC,CAAA;QAED,uBAAiB,GAAG,UAAC,KAAY,EAAE,IAAuB;;YACxD,IAAM,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC;YAC1B,IAAI,SAAS,GAAG,KAAK,CAAC,SAAS,CAAC;YAChC,IAAM,KAAK,GAAG,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YAEzC,yBAAyB;YACzB,IAAI,KAAK,IAAI,CAAC,EAAE;gBAEd,IAAM,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC,CAAC;gBAC3B,sDAAsD;gBACtD,IAAI,KAAK,CAAC,SAAS,KAAK,IAAI,CAAC,SAAS,EAAE;oBACtC,KAAK,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC;oBACpB,OAAO,EAAE,KAAK,OAAA,EAAE,SAAS,WAAA,EAAE,CAAC;iBAC7B;gBAED,iCAAiC;gBACjC,KAAK,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;gBACvB,SAAS,GAAG,EAAE,CAAC;gBACf,KAAK,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,CAAC;oBACpB,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;gBACjC,CAAC,CAAC,CAAC;aACJ;YAED,iCAAiC;YACjC,IAAI,KAAK,CAAC,MAAM,KAAK,CAAC,EAAE;gBACtB,OAAO,EAAE,KAAK,EAAE,CAAC,IAAI,CAAC,EAAE,SAAS,YAAI,GAAC,IAAI,CAAC,UAAU,IAAG,CAAC,KAAE,EAAE,CAAC;aAC/D;YAED,kCAAkC;YAClC,IAAI,GAAG,GAAG,CAAC,CAAC;YACZ,IAAI,IAAI,GAAG,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC;YAC5B,IAAI,GAAG,GAAG,CAAC,CAAC;YAEZ,OAAO,GAAG,GAAG,IAAI,EAAE;gBACjB,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,IAAI,GAAG,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,GAAG,CAAC;gBAEzC,iDAAiD;gBACjD,IAAI,KAAK,CAAC,GAAG,CAAC,IAAI,KAAK,CAAC,GAAG,CAAC,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,EAAE;oBACvD,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC;iBACf;qBAAM;oBACL,IAAI,GAAG,GAAG,CAAC;iBACZ;aACF;YAED,IAAI,QAAQ,GAAG,KAAK,CAAC,MAAM,CAAC;YAC5B,IAAI,KAAK,CAAC,GAAG,CAAC,IAAI,KAAK,CAAC,GAAG,CAAC,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,EAAE;gBACxD,QAAQ,GAAG,GAAG,CAAC;aAChB;YAED,IAAI,QAAQ,KAAK,KAAK,CAAC,MAAM,EAAE;gBAC7B,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;aAClB;iBAAM;gBACL,KAAK,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC,EAAE,IAAI,CAAC,CAAC;aACjC;YAED,IAAM,iBAAiB,GAAG,EAAE,CAAC;YAC7B,KAAK,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,CAAC;gBACpB,iBAAiB,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;YACzC,CAAC,CAAC,CAAC;YACH,OAAO,EAAE,KAAK,OAAA,EAAE,SAAS,EAAE,iBAAiB,EAAE,CAAC;QACjD,CAAC,CAAA;QAED,2DAA2D;QAC3D,uBAAiB,GAAG,UAAC,WAAqC;YACxD,IAAM,KAAK,kBAAO,KAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;YACpC,IAAM,SAAS,gBAAQ,KAAI,CAAC,KAAK,CAAC,SAAS,CAAE,CAAC;YAE9C,WAAW,CAAC,OAAO,CAAC,UAAC,IAAI;gBACvB,IAAM,UAAU,GAAG,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;gBAC9C,IAAI,UAAU,IAAI,CAAC,EAAE;oBACnB,KAAK,CAAC,UAAU,CAAC,GAAG,IAAI,CAAC;oBACzB,OAAO;iBACR;gBAED,IAAM,KAAK,GAAG,KAAK,CAAC,MAAM,CAAC;gBAC3B,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBACjB,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,KAAK,CAAC;YACrC,CAAC,CAAC,CAAC;YAEH,KAAI,CAAC,QAAQ,CAAC,EAAE,KAAK,OAAA,EAAE,SAAS,WAAA,EAAE,CAAC,CAAC;YACpC,OAAO;QACT,CAAC,CAAA;QAED,qBAAqB;QACrB,YAAM,GAAG,UAAC,EAAU;YACV,IAAA,iCAAS,CAAgB;YACjC,IAAM,KAAK,kBAAO,KAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;YACpC,IAAM,KAAK,GAAG,SAAS,CAAC,EAAE,CAAC,CAAC;YAE5B,IAAI,KAAK,IAAI,CAAC,EAAE;gBACd,KAAK,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;gBACvB,IAAM,cAAY,GAAG,EAAE,CAAC;gBACxB,KAAK,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,CAAC;oBACpB,cAAY,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;gBACpC,CAAC,CAAC,CAAC;gBAEH,KAAI,CAAC,QAAQ,CAAC;oBACZ,KAAK,OAAA;oBACL,SAAS,EAAE,cAAY;iBACxB,CAAC,CAAC;gBACH,KAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC;aACvB;QACH,CAAC,CAAA;QAED,+BAA+B;QAC/B,iBAAW,GAAG,UAAC,UAAkB;YAC/B,OAAO,KAAI,CAAC,KAAK,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;QAC1C,CAAC,CAAA;QAED,8BAA8B;QAC9B,aAAO,GAAG,UAAC,KAAa;YACtB,OAAO,KAAI,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;QACjC,CAAC,CAAA;QAED,eAAS,GAAG;YACV,OAAO,KAAI,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC;QACjC,CAAC,CAAA;QAED,WAAK,GAAG;YACN,KAAI,CAAC,QAAQ,CAAC;gBACZ,KAAK,EAAE,EAAE;gBACT,SAAS,EAAE,EAAE;aACd,CAAC,CAAC;YACH,KAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC;QACxB,CAAC,CAAA;QAhJC,KAAI,CAAC,KAAK,GAAG;YACX,KAAK,EAAE,EAAE;YACT,SAAS,EAAE,EAAE;SACd,CAAC;;IACJ,CAAC;IA8ID,2BAAM,GAAN;QACE,OAAQ,IAAI,CAAC,KAAK,CAAC,QAAgB,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,QAAQ,EAAb,CAAa,CAAC,CAAC,CAAC;IACnF,CAAC;IACH,iBAAC;AAAD,CAAC,AAzJD,CACQ,KAAK,CAAC,aAAa,GAwJ1B","sourcesContent":["import React from 'react';\n\ninterface Props {\n  children: (child: any[]) => any;\n  onUpdate: () => void;\n}\n\nexport interface DataSourceItem<T> {\n  identifier: string;\n  resource: T;\n  sortValue: number;\n}\n\ninterface State {\n  items: Array<DataSourceItem<any>>;\n  locations: { [id: string]: number };\n}\n\nexport default class DataSource<T, AdditionalProps = {}>\nextends React.PureComponent<Props & AdditionalProps, State> {\n  constructor() {\n    super();\n    this.state = {\n      items: [],\n      locations: {},\n    };\n  }\n\n  updateItems = (newItems: Array<DataSourceItem<T>>) => {\n    const newState = newItems.reduce(this.updateItemReducer, {\n      items: [...this.state.items],\n      locations: { ...this.state.locations },\n    });\n    this.setState(newState);\n    this.props.onUpdate();\n  }\n\n  updateItem = (item: DataSourceItem<T>) => {\n    this.setState(this.updateItemReducer(this.state, item));\n    this.props.onUpdate();\n  }\n\n  updateItemReducer = (state: State, item: DataSourceItem<T>): State => {\n    const items = state.items;\n    let locations = state.locations;\n    const index = locations[item.identifier];\n\n    // If exists in locations\n    if (index >= 0) {\n\n      const found = items[index];\n      // Replace if item is the same and locations are equal\n      if (found.sortValue === item.sortValue) {\n        items[index] = item;\n        return { items, locations };\n      }\n\n      // If sort has changed, recompute\n      items.splice(index, 1);\n      locations = {};\n      items.forEach((each, n) => {\n        locations[each.identifier] = n;\n      });\n    }\n\n    // Basic insert if already exists\n    if (items.length === 0) {\n      return { items: [item], locations: { [item.identifier]: 0 } };\n    }\n\n    // Sorted Insert when non-existent\n    let low = 0;\n    let high = items.length - 1;\n    let mid = 0;\n\n    while (low < high) {\n      mid = Math.floor((high - low) / 2) + low;\n\n      // TODO(SHIN): Check that id comparison is kosher\n      if (items[mid] && items[mid].sortValue < item.sortValue) {\n        low = mid + 1;\n      } else {\n        high = mid;\n      }\n    }\n\n    let endIndex = items.length;\n    if (items[low] && items[low].sortValue >= item.sortValue) {\n      endIndex = low;\n    }\n\n    if (endIndex === items.length) {\n      items.push(item);\n    } else {\n      items.splice(endIndex, 0, item);\n    }\n\n    const insertedLocations = {};\n    items.forEach((each, n) => {\n      insertedLocations[each.identifier] = n;\n    });\n    return { items, locations: insertedLocations };\n  }\n\n  // Only to be used if items are pre-sorted in correct order\n  appendSortedItems = (sortedItems: Array<DataSourceItem<T>>) => {\n    const items = [...this.state.items];\n    const locations = { ...this.state.locations };\n\n    sortedItems.forEach((item) => {\n      const foundIndex = locations[item.identifier];\n      if (foundIndex >= 0) {\n        items[foundIndex] = item;\n        return;\n      }\n\n      const index = items.length;\n      items.push(item);\n      locations[item.identifier] = index;\n    });\n\n    this.setState({ items, locations });\n    return;\n  }\n\n  // Removes identifier\n  remove = (id: string) => {\n    const { locations } = this.state;\n    const items = [...this.state.items];\n    const index = locations[id];\n\n    if (index >= 0) {\n      items.splice(index, 1);\n      const newLocations = {};\n      items.forEach((item, i) => {\n        newLocations[item.identifier] = i;\n      });\n\n      this.setState({\n        items,\n        locations: newLocations,\n      });\n      this.props.onUpdate();\n    }\n  }\n\n  // Get index of item identifier\n  getLocation = (identifier: string) => {\n    return this.state.locations[identifier];\n  }\n\n  // Get item at specific index.\n  getItem = (index: number) => {\n    return this.state.items[index];\n  }\n\n  getLength = () => {\n    return this.state.items.length;\n  }\n\n  clear = () => {\n    this.setState({\n      items: [],\n      locations: {},\n    });\n    this.props.onUpdate();\n  }\n\n  render() {\n    return (this.props.children as any)(this.state.items.map(each => each.resource));\n  }\n}\n"]}]}