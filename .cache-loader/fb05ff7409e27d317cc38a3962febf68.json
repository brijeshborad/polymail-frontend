{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/ducks/shareLinks.ts","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/ducks/shareLinks.ts","mtime":1675280254052},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF9fYXNzaWduID0gKHRoaXMgJiYgdGhpcy5fX2Fzc2lnbikgfHwgZnVuY3Rpb24gKCkgewogICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uKHQpIHsKICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHsKICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTsKICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKQogICAgICAgICAgICAgICAgdFtwXSA9IHNbcF07CiAgICAgICAgfQogICAgICAgIHJldHVybiB0OwogICAgfTsKICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9Owp2YXIgX2EsIF9iOwppbXBvcnQgdXBkYXRlIGZyb20gJ2ltbXV0YWJpbGl0eS1oZWxwZXInOwppbXBvcnQgeyBjcmVhdGUgfSBmcm9tICdAc3JjL2xpYi9yZWR1eCc7CmltcG9ydCB7IHJlc291cmNlT2ssIHJlc291cmNlUGVuZGluZyB9IGZyb20gJ0BzcmMvbGliL3Jlc291cmNlJzsKdmFyIGdldFNoYXJlTGlua0tleSA9IGZ1bmN0aW9uIChzaGFyZWRUaHJlYWQsIG1lc3NhZ2UpIHsKICAgIHJldHVybiBzaGFyZWRUaHJlYWQgKyAobWVzc2FnZSB8fCAnJyk7Cn07CmV4cG9ydCB2YXIgU0hBUkVfTElOS19DUkVBVEUgPSAoX2EgPSBjcmVhdGUoJ1NIQVJFX0xJTktfQ1JFQVRFJywgewogICAgc3RhcnQ6IGZ1bmN0aW9uIChzdGF0ZSwgbWV0YSkgewogICAgICAgIHZhciBfYTsKICAgICAgICByZXR1cm4gdXBkYXRlKHN0YXRlLCB7CiAgICAgICAgICAgIHNoYXJlTGlua3M6IChfYSA9IHt9LAogICAgICAgICAgICAgICAgX2FbbWV0YS5zaGFyZWRUaHJlYWQgKyAobWV0YS5tZXNzYWdlIHx8ICcnKV0gPSB7CiAgICAgICAgICAgICAgICAgICAgJHNldDogcmVzb3VyY2VQZW5kaW5nKCksCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgX2EpLAogICAgICAgICAgICBzZWxlY3RlZFNoYXJlTGluazogewogICAgICAgICAgICAgICAgJHNldDogbWV0YS5zaGFyZWRUaHJlYWQgKyAobWV0YS5tZXNzYWdlIHx8ICcnKSwKICAgICAgICAgICAgfSwKICAgICAgICB9KTsKICAgIH0sCiAgICBzdWNjZXNzOiBmdW5jdGlvbiAoc3RhdGUsIG1ldGEsIHBheWxvYWQpIHsKICAgICAgICB2YXIgX2E7CiAgICAgICAgcmV0dXJuIHVwZGF0ZShzdGF0ZSwgewogICAgICAgICAgICBzaGFyZUxpbmtzOiAoX2EgPSB7fSwKICAgICAgICAgICAgICAgIF9hW2dldFNoYXJlTGlua0tleShtZXRhLnNoYXJlZFRocmVhZCwgbWV0YS5tZXNzYWdlKV0gPSB7CiAgICAgICAgICAgICAgICAgICAgJHNldDogcmVzb3VyY2VPayhfX2Fzc2lnbihfX2Fzc2lnbih7fSwgbWV0YSksIHsgdXJsOiBwYXlsb2FkLnVybCB9KSksCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgX2EpLAogICAgICAgICAgICBzZWxlY3RlZFNoYXJlTGluazogewogICAgICAgICAgICAgICAgJHNldDogZ2V0U2hhcmVMaW5rS2V5KG1ldGEuc2hhcmVkVGhyZWFkLCBtZXRhLm1lc3NhZ2UpLAogICAgICAgICAgICB9LAogICAgICAgIH0pOwogICAgfSwKfSksIF9hLnR5cGUpLCBzaGFyZUxpbmtDcmVhdGUgPSBfYS5hY3Rpb24sIHNoYXJlTGlua0NyZWF0ZVJlZHVjZXIgPSBfYS5yZWR1Y2VyOwpleHBvcnQgdmFyIFNIQVJFX0xJTktfU0VUID0gKF9iID0gY3JlYXRlKCdTSEFSRV9MSU5LX1NFVCcsIHsKICAgIHN0YXJ0OiBmdW5jdGlvbiAoc3RhdGUsIG1ldGEpIHsgcmV0dXJuIHVwZGF0ZShzdGF0ZSwgewogICAgICAgIHNlbGVjdGVkU2hhcmVMaW5rOiB7ICRzZXQ6IG1ldGEgfSwKICAgIH0pOyB9LAp9KSwgX2IudHlwZSksIHNoYXJlTGlua1NldCA9IF9iLmFjdGlvbiwgc2hhcmVMaW5rU2V0UmVkdWNlciA9IF9iLnJlZHVjZXI7CmV4cG9ydCB2YXIgc2VsZWN0U2hhcmVMaW5rID0gZnVuY3Rpb24gKHN0YXRlKSB7CiAgICB2YXIgc2hhcmVMaW5rSWQgPSBzdGF0ZS5zZWxlY3RlZFNoYXJlTGluazsKICAgIHJldHVybiBzaGFyZUxpbmtJZAogICAgICAgICYmIHN0YXRlLnNoYXJlTGlua3Nbc2hhcmVMaW5rSWRdCiAgICAgICAgJiYgc3RhdGUuc2hhcmVMaW5rc1tzaGFyZUxpbmtJZF0uZGF0YSB8fCB1bmRlZmluZWQ7Cn07CmV4cG9ydCBkZWZhdWx0IFsKICAgIHNoYXJlTGlua0NyZWF0ZVJlZHVjZXIsCiAgICBzaGFyZUxpbmtTZXRSZWR1Y2VyLApdOwo="},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/ducks/shareLinks.ts","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/ducks/shareLinks.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA,OAAO,MAAM,MAAM,qBAAqB,CAAC;AACzC,OAAO,EAAE,MAAM,EAAE,MAAM,gBAAgB,CAAC;AAMxC,OAAO,EAAE,UAAU,EAAE,eAAe,EAAE,MAAM,mBAAmB,CAAC;AAOhE,IAAM,eAAe,GAAG,UAAC,YAAoB,EAAE,OAAgB;IAC7D,OAAO,YAAY,GAAG,CAAC,OAAO,IAAI,EAAE,CAAC,CAAC;AACxC,CAAC,CAAC;AAEF,MAAM,CACJ,IAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;YAAuB,EACvB,2BAAuB,EACvB,mCAA+B,CA6B9B;AAEH,MAAM,CACJ,IAAA;;;;YAAoB,EACpB,wBAAoB,EACpB,gCAA4B,CAK3B;AAEH,MAAM,CAAC,IAAM,eAAe,GAAG,UAAC,KAAiB;IAC/C,IAAM,WAAW,GAAG,KAAK,CAAC,iBAAiB,CAAC;IAC5C,OAAO,WAAW;WACb,KAAK,CAAC,UAAU,CAAC,WAAW,CAAC;WAC7B,KAAK,CAAC,UAAU,CAAC,WAAW,CAAC,CAAC,IAAI,IAAI,SAAS,CAAC;AACvD,CAAC,CAAC;AAEF,eAAe;IACb,sBAAsB;IACtB,mBAAmB;CACpB,CAAC","sourcesContent":["import update from 'immutability-helper';\nimport { create } from '@src/lib/redux';\nimport {\n  ShareLink,\n  StoreState,\n } from '@src/types';\n\nimport { resourceOk, resourcePending } from '@src/lib/resource';\n\nexport interface ShareLinkMeta {\n  sharedThread: string;\n  message?: string;\n}\n\nconst getShareLinkKey = (sharedThread: string, message?: string) => {\n  return sharedThread + (message || '');\n};\n\nexport const {\n  type: SHARE_LINK_CREATE,\n  action: shareLinkCreate,\n  reducer: shareLinkCreateReducer,\n} = create<ShareLinkMeta, ShareLink>('SHARE_LINK_CREATE', {\n  start: (state, meta) => {\n    return update(state, {\n      shareLinks: {\n        [meta.sharedThread + (meta.message || '')]: {\n          $set: resourcePending(),\n        },\n      },\n      selectedShareLink: {\n        $set: meta.sharedThread + (meta.message || ''),\n      },\n    });\n  },\n  success: (state, meta, payload) => {\n    return update(state, {\n      shareLinks: {\n        [getShareLinkKey(meta.sharedThread, meta.message)]: {\n          $set: resourceOk({\n            ...meta,\n            url: payload.url,\n          }),\n        },\n      },\n      selectedShareLink: {\n        $set: getShareLinkKey(meta.sharedThread, meta.message),\n      },\n    });\n  },\n});\n\nexport const {\n  type: SHARE_LINK_SET,\n  action: shareLinkSet,\n  reducer: shareLinkSetReducer,\n} = create<string | undefined, undefined>('SHARE_LINK_SET', {\n  start: (state, meta) => update(state, {\n    selectedShareLink: { $set: meta },\n  }),\n});\n\nexport const selectShareLink = (state: StoreState): ShareLink|undefined => {\n  const shareLinkId = state.selectedShareLink;\n  return shareLinkId\n    && state.shareLinks[shareLinkId]\n    && state.shareLinks[shareLinkId].data || undefined;\n};\n\nexport default [\n  shareLinkCreateReducer,\n  shareLinkSetReducer,\n];\n"]}]}