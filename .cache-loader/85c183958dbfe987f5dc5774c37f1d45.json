{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/lib/state.ts","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/lib/state.ts","mtime":1675280254068},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF9fYXNzaWduID0gKHRoaXMgJiYgdGhpcy5fX2Fzc2lnbikgfHwgZnVuY3Rpb24gKCkgewogICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uKHQpIHsKICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHsKICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTsKICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKQogICAgICAgICAgICAgICAgdFtwXSA9IHNbcF07CiAgICAgICAgfQogICAgICAgIHJldHVybiB0OwogICAgfTsKICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9OwppbXBvcnQgeyByZXNvdXJjZVBlbmRpbmcsIHJlc291cmNlTG9hZGluZywgcmVzb3VyY2VPayB9IGZyb20gJ0BzcmMvbGliL3Jlc291cmNlJzsKaW1wb3J0IHsgTWFpbGJveFR5cGUsIFJlc291cmNlU3RhdHVzLCBUaGVtZVNldHRpbmcsIFBvbHltYWlsU3RhdHVzVHlwZSwgfSBmcm9tICdAc3JjL3R5cGVzJzsKaW1wb3J0IHsgUmlnaHRTaWRlYmFyVGFiLCBSaWdodFNpZGViYXJTdWJUYWIsIH0gZnJvbSAnQHNyYy90eXBlcy9yaWdodFNpZGViYXInOwppbXBvcnQgeyBkZWZhdWx0RmVhdHVyZXMsIGRlZmF1bHRQcmVmZXJlbmNlcyB9IGZyb20gJ0BzcmMvbGliL21lJzsKaW1wb3J0IHsgZm52MWEzMiB9IGZyb20gJ0BzcmMvbGliL2NyeXB0JzsKaW1wb3J0IHsgaXNMb2dnZWRJbiB9IGZyb20gJ0BzcmMvYXBpL2Jhc2UnOwppbXBvcnQgeyBjcmVhdGVPbmJvYXJkaW5nIH0gZnJvbSAnQHNyYy9tb2Nrcy9tZSc7CmltcG9ydCB7IE5hdmJhclRhYiB9IGZyb20gJ0BzcmMvdHlwZXMvbGVmdFNpZGViYXInOwppbXBvcnQgeyBpc0VsZWN0cm9uIH0gZnJvbSAnQHNyYy9saWIvZWxlY3Ryb24nOwppbXBvcnQgeyBnZXROZWVkc1RGQUZyb21Db29raWUgfSBmcm9tICcuL2Nvb2tpZXMnOwppbXBvcnQgQ29va2llcyBmcm9tICdqcy1jb29raWUnOwppbXBvcnQgeyBpc0RiUmVhZHkgfSBmcm9tICcuL2RiJzsKaW1wb3J0IHsgQ2FsZW5kYXJFdmVudERpc3BsYXlTY29wZSB9IGZyb20gJ0BzcmMvZHVja3MvY2FsZW5kYXJzJzsKaW1wb3J0IHsgY29uZmlndXJlQW1wbGl0dWRlVXNlciB9IGZyb20gJy4vYW1wbGl0dWRlLWFuYWx5dGljcyc7CmltcG9ydCB7IGlzTW9iaWxlU2NyZWVuIH0gZnJvbSAnLi91dGlscyc7CmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVJbml0aWFsU3RhdGUoc2Vzc2lvbklkKSB7CiAgICB2YXIgX2E7CiAgICByZXR1cm4gewogICAgICAgIGRiUmVhZHk6IGlzRGJSZWFkeSgpLAogICAgICAgIHRoZW1lOiByZXNvdXJjZU9rKFRoZW1lU2V0dGluZy5MaWdodCksCiAgICAgICAgYXBwVXBkYXRlUmVhZHk6IGZhbHNlLAogICAgICAgIHdlYmFwcFVwZGF0ZVJlYWR5OiBmYWxzZSwKICAgICAgICBpc09ubGluZTogbmF2aWdhdG9yLm9uTGluZSwKICAgICAgICBpc0RlZmF1bHRDbGllbnQ6IGZhbHNlLAogICAgICAgIGxvZ2dlZEluOiBpc0xvZ2dlZEluKCksCiAgICAgICAgY2xlYXJpbmdDYWNoZTogZmFsc2UsCiAgICAgICAgYXV0aFBlbmRpbmc6IGZhbHNlLAogICAgICAgIHNpZ25VcFBlbmRpbmc6IGZhbHNlLAogICAgICAgIG1haWxib3g6IHsKICAgICAgICAgICAgdHlwZTogTWFpbGJveFR5cGUuTm9uZSwKICAgICAgICB9LAogICAgICAgIG1haWxib3hUaHJlYWRzOiByZXNvdXJjZUxvYWRpbmcoKSwKICAgICAgICBtZXNzYWdlQm9kaWVzOiB7fSwKICAgICAgICBjb250YWN0czoge30sCiAgICAgICAgY29udGFjdEdyb3Vwczoge30sCiAgICAgICAgbWU6IHJlc291cmNlUGVuZGluZygpLAogICAgICAgIGZlYXR1cmVzOiBkZWZhdWx0RmVhdHVyZXMsCiAgICAgICAgcHJlZmVyZW5jZXM6IGRlZmF1bHRQcmVmZXJlbmNlcywKICAgICAgICBiaWxsaW5nOiBjcmVhdGVCaWxsaW5nU3RhdGUoKSwKICAgICAgICBjb250YWN0U3VwcG9ydFBvcHVwOiB7CiAgICAgICAgICAgIGNvbGxhcHNlZDogdHJ1ZSwKICAgICAgICB9LAogICAgICAgIHRlYW06IHJlc291cmNlUGVuZGluZygpLAogICAgICAgIHRlYW1NZW1iZXJzOiB7fSwKICAgICAgICB0ZWFtSW52aXRlczogcmVzb3VyY2VQZW5kaW5nKCksCiAgICAgICAgdGVhbUludml0ZXNWYWxpZGF0aW9uOiB7fSwKICAgICAgICBpbnRlZ3JhdGlvbnM6IFtdLAogICAgICAgIGFjY291bnRzOiBbXSwKICAgICAgICBkZXZpY2VzOiBbXSwKICAgICAgICBsaXN0czogW10sCiAgICAgICAgcm91dGluZzogewogICAgICAgICAgICBsb2NhdGlvbjogbnVsbCwKICAgICAgICB9LAogICAgICAgIHR5cGVhaGVhZENvbnRhY3RzOiBbXSwKICAgICAgICBtYWlsQ291bnRzOiB7fSwKICAgICAgICB0ZW1wbGF0ZXM6IHt9LAogICAgICAgIHJlZmVycmFsSW52aXRlczoge30sCiAgICAgICAgdHJhY2tzOiB7fSwKICAgICAgICBkcmFmdHM6IHt9LAogICAgICAgIHRocmVhZHM6IHt9LAogICAgICAgIHB1YmxpY01lbWJlcnM6IHt9LAogICAgICAgIHB1YmxpY1RlYW1zOiB7fSwKICAgICAgICAvLyBTZWxlY3RlZCBpZHMgaW4gbGlzdCB2aWV3LiBMYXN0IGVudHJ5IGlzIHJlZmVyZW5jZSBwb2ludCBmb3IgbXVsdGlwbGUgc2VsZWN0aW9ucy4KICAgICAgICBzZWxlY3RlZElkczogbmV3IE1hcCgpLAogICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTogaW5zZWN1cmUtcmFuZG9tCiAgICAgICAgc2Vzc2lvbklkOiBmbnYxYTMyKHNlc3Npb25JZCB8fCBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKCkpLAogICAgICAgIGF0dGFjaG1lbnRzOiB7fSwKICAgICAgICBhdHRhY2htZW50TWV0YXM6IHt9LAogICAgICAgIGF0dGFjaG1lbnRzRG93bmxvYWRpbmc6IHt9LAogICAgICAgIHNlbGVjdGVkQ29udGFjdE5vdGVzOiBbXSwKICAgICAgICBzZWxlY3RlZENvbnRhY3RUaHJlYWRzOiBbXSwKICAgICAgICBzZWxlY3RlZENvbnRhY3RGaWxlczogW10sCiAgICAgICAgYWN0aXZpdHlGZWVkOiByZXNvdXJjZVBlbmRpbmcoKSwKICAgICAgICBzaGFyZUxpbmtzOiB7fSwKICAgICAgICBjYWxlbmRhcnM6IHt9LAogICAgICAgIGNhbGVuZGFyRXZlbnRzOiAoX2EgPSB7fSwKICAgICAgICAgICAgX2FbQ2FsZW5kYXJFdmVudERpc3BsYXlTY29wZS5Db21tYW5kXSA9IHt9LAogICAgICAgICAgICBfYVtDYWxlbmRhckV2ZW50RGlzcGxheVNjb3BlLlJzYl0gPSB7fSwKICAgICAgICAgICAgX2EpLAogICAgICAgIHBlcm1pc3Npb25zOiB7CiAgICAgICAgICAgIG1haWxUb1Byb3RvY29sOiBmYWxzZSwKICAgICAgICAgICAgbm90aWZpY2F0aW9uczogZmFsc2UsCiAgICAgICAgfSwKICAgICAgICBjbG9zZWRCYW5uZXJzOiB7fSwKICAgICAgICBvbmJvYXJkaW5nOiBjcmVhdGVPbmJvYXJkaW5nKCksCiAgICAgICAgaW5jcmVtZW50YWxTeW5jaW5nOiBmYWxzZSwKICAgICAgICBob3RrZXlBY3Rpb25zOiB7fSwKICAgICAgICBsZWZ0U2lkZWJhcjogewogICAgICAgICAgICBsaXN0c0NvbGxhcHNlZDogdHJ1ZSwKICAgICAgICAgICAgc2VsZWN0ZWRUYWI6IE5hdmJhclRhYi5NYWlsLAogICAgICAgICAgICB0cmFzaENvbGxhcHNlZDogZmFsc2UsCiAgICAgICAgICAgIGFwcHNDb2xsYXBzZWQ6IHRydWUsCiAgICAgICAgICAgIHRlYW1Db2xsYXBzZWQ6IHRydWUsCiAgICAgICAgICAgIHdpZHRoOiAyMDAsCiAgICAgICAgICAgIGNvbGxhcHNlZDogZmFsc2UsCiAgICAgICAgfSwKICAgICAgICByaWdodFNpZGViYXI6IHsKICAgICAgICAgICAgY29sbGFwc2VkOiB7CiAgICAgICAgICAgICAgICB0aHJlYWRzOiBmYWxzZSwKICAgICAgICAgICAgICAgIHNldHRpbmdzOiB0cnVlLAogICAgICAgICAgICB9LAogICAgICAgICAgICB0YWI6IFJpZ2h0U2lkZWJhclRhYi5PbmJvYXJkaW5nLAogICAgICAgICAgICBzdWJUYWI6IFJpZ2h0U2lkZWJhclN1YlRhYi5Db252ZXJzYXRpb24sCiAgICAgICAgfSwKICAgICAgICBzYWxlc2ZvcmNlOiB7CiAgICAgICAgICAgIGxpc3RWaWV3czoge30sCiAgICAgICAgICAgIHBlbmRpbmdTdW1tYXJpZXM6IHt9LAogICAgICAgICAgICBzdW1tYXJpZXM6IHt9LAogICAgICAgICAgICBzY2hlbWFzOiB7fSwKICAgICAgICB9LAogICAgICAgIGh1YnNwb3Q6IHsKICAgICAgICAgICAgcHJvZmlsZXM6IHt9LAogICAgICAgIH0sCiAgICAgICAgem9vbToge30sCiAgICAgICAgc2VxdWVuY2VzOiB7fSwKICAgICAgICBzZXF1ZW5jZVN0YWdlczoge30sCiAgICAgICAgc2VxdWVuY2VTdGFnZUluc3RhbmNlczoge30sCiAgICAgICAgc2VxdWVuY2VTdGFnZVJlY2lwaWVudHM6IHt9LAogICAgICAgIHNlcXVlbmNlUmVjaXBpZW50czoge30sCiAgICAgICAgc2VxdWVuY2VQYWdlTG9hZGVkOiB7fSwKICAgICAgICBjb21tZW50czoge30sCiAgICAgICAgc2hhcmVkVGhyZWFkczoge30sCiAgICAgICAgc2hhcmVkVGhyZWFkRHJhZnRzOiB7fSwKICAgICAgICBhc2FuYTogewogICAgICAgICAgICB1c2VyczogcmVzb3VyY2VMb2FkaW5nKCksCiAgICAgICAgICAgIHRhc2tzOiB7fSwKICAgICAgICAgICAgcHJvamVjdHM6IHJlc291cmNlTG9hZGluZygpLAogICAgICAgICAgICB3b3Jrc3BhY2VzOiByZXNvdXJjZUxvYWRpbmcoKSwKICAgICAgICB9LAogICAgICAgIHNjaGVkdWxpbmc6IHsKICAgICAgICAgICAgc2NoZWR1bGluZ3M6IHt9LAogICAgICAgICAgICB0aW1lU2xvdHM6IHt9LAogICAgICAgICAgICB0aW1lU2xvdHNMb2FkaW5nOiBmYWxzZSwKICAgICAgICAgICAgc2NoZWR1bGluZ1B1YmxpY3M6IHt9LAogICAgICAgIH0sCiAgICAgICAgdGhyZWFkTGlzdFdpZHRoOiAzMDAsCiAgICAgICAgc2hhcmVkVGhyZWFkQWN0aXZpdHk6IHsKICAgICAgICAgICAgY29tbWVudDoge30sCiAgICAgICAgICAgIHZpZXc6IHt9LAogICAgICAgICAgICByZXBseToge30sCiAgICAgICAgfSwKICAgICAgICBmaWx0ZXJzOiB7fSwKICAgICAgICB5ZWFybHlTdW1tYXJpZXM6IHt9LAogICAgICAgIC8vIE1pc2NlbGxhbmVvdXMgU3RhdGUKICAgICAgICB0ZmFOZWVkZWQ6IGZhbHNlLAogICAgICAgIHRmYVBhc3N3b3JkQ29uZmlybWVkOiBmYWxzZSwKICAgICAgICBtdXRlU291bmRzOiBmYWxzZSwKICAgICAgICBzaG93SG90a2V5U3VnZ2VzdGlvbnM6IHRydWUsCiAgICAgICAgaXNNb2JpbGU6IGlzTW9iaWxlU2NyZWVuKCksCiAgICAgICAgLy8gU3RhdHVzCiAgICAgICAgc3RhdHVzOiB7CiAgICAgICAgICAgIHN0YXR1c1R5cGU6IFBvbHltYWlsU3RhdHVzVHlwZS5PbmxpbmUsCiAgICAgICAgICAgIGNvbW1pdHNSZW1haW5pbmc6IDAsCiAgICAgICAgfSwKICAgIH07Cn0KZXhwb3J0IGZ1bmN0aW9uIGluaXRpYWxTdGF0ZVdpdGhDYWNoZWREYXRhKCkgewogICAgdmFyIHN0YXRlID0gY3JlYXRlSW5pdGlhbFN0YXRlKCk7CiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6IG5vLWNvbnNvbGUKICAgIHZhciBtZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdtZScpOwogICAgaWYgKG1lKSB7CiAgICAgICAgc3RhdGUubWUuZGF0YSA9IEpTT04ucGFyc2UobWUpOwogICAgICAgIGNvbmZpZ3VyZUFtcGxpdHVkZVVzZXIoc3RhdGUubWUuZGF0YSk7CiAgICAgICAgc3RhdGUubWUuc3RhdHVzID0gUmVzb3VyY2VTdGF0dXMuT2s7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBjb25maWd1cmVBbXBsaXR1ZGVVc2VyKHVuZGVmaW5lZCk7CiAgICB9CiAgICB2YXIgdGhlbWUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndGhlbWUnKTsKICAgIGlmICh0aGVtZSkgewogICAgICAgIHN0YXRlLnRoZW1lLmRhdGEgPSBKU09OLnBhcnNlKHRoZW1lKTsKICAgICAgICBzdGF0ZS50aGVtZS5zdGF0dXMgPSBSZXNvdXJjZVN0YXR1cy5PazsKICAgIH0KICAgIHZhciBsaXN0cyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdsaXN0cycpOwogICAgaWYgKGxpc3RzKSB7CiAgICAgICAgc3RhdGUubGlzdHMgPSBKU09OLnBhcnNlKGxpc3RzKTsKICAgIH0KICAgIHZhciBvbmJvYXJkaW5nID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ29uYm9hcmRpbmcnKTsKICAgIGlmIChvbmJvYXJkaW5nKSB7CiAgICAgICAgc3RhdGUub25ib2FyZGluZyA9IEpTT04ucGFyc2Uob25ib2FyZGluZyk7CiAgICB9CiAgICB2YXIgYWNjb3VudHMgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYWNjb3VudHMnKTsKICAgIGlmIChhY2NvdW50cykgewogICAgICAgIHN0YXRlLmFjY291bnRzID0gSlNPTi5wYXJzZShhY2NvdW50cyk7CiAgICB9CiAgICB2YXIgZGV2aWNlcyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdkZXZpY2VzJyk7CiAgICBpZiAoZGV2aWNlcykgewogICAgICAgIHN0YXRlLmRldmljZXMgPSBKU09OLnBhcnNlKGRldmljZXMpOwogICAgfQogICAgdmFyIHByZWZlcmVuY2VzID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3ByZWZlcmVuY2VzJyk7CiAgICBpZiAocHJlZmVyZW5jZXMpIHsKICAgICAgICBzdGF0ZS5wcmVmZXJlbmNlcyA9IEpTT04ucGFyc2UocHJlZmVyZW5jZXMpOwogICAgfQogICAgdmFyIGZlYXR1cmVzID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2ZlYXR1cmVzJyk7CiAgICBpZiAoZmVhdHVyZXMpIHsKICAgICAgICBzdGF0ZS5mZWF0dXJlcyA9IEpTT04ucGFyc2UoZmVhdHVyZXMpOwogICAgfQogICAgdmFyIG11dGVTb3VuZHMgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbXV0ZVNvdW5kcycpOwogICAgaWYgKG11dGVTb3VuZHMpIHsKICAgICAgICBzdGF0ZS5tdXRlU291bmRzID0gSlNPTi5wYXJzZShtdXRlU291bmRzKTsKICAgIH0KICAgIHZhciBzaG93SG90a2V5U3VnZ2VzdGlvbnMgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnc2hvd0hvdGtleVN1Z2dlc3Rpb25zJyk7CiAgICBpZiAoc2hvd0hvdGtleVN1Z2dlc3Rpb25zKSB7CiAgICAgICAgc3RhdGUuc2hvd0hvdGtleVN1Z2dlc3Rpb25zID0gSlNPTi5wYXJzZShzaG93SG90a2V5U3VnZ2VzdGlvbnMpOwogICAgfQogICAgdmFyIHRlYW0gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndGVhbScpOwogICAgaWYgKHRlYW0pIHsKICAgICAgICBzdGF0ZS50ZWFtLmRhdGEgPSBKU09OLnBhcnNlKHRlYW0pOwogICAgICAgIHN0YXRlLnRlYW0uc3RhdHVzID0gUmVzb3VyY2VTdGF0dXMuT2s7CiAgICB9CiAgICB2YXIgaW50ZWdyYXRpb25zID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2ludGVncmF0aW9ucycpOwogICAgaWYgKGludGVncmF0aW9ucykgewogICAgICAgIHN0YXRlLmludGVncmF0aW9ucyA9IEpTT04ucGFyc2UoaW50ZWdyYXRpb25zKTsKICAgIH0KICAgIHZhciBwZXJtaXNzaW9ucyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdwZXJtaXNzaW9ucycpOwogICAgaWYgKHBlcm1pc3Npb25zKSB7CiAgICAgICAgc3RhdGUucGVybWlzc2lvbnMgPSBKU09OLnBhcnNlKHBlcm1pc3Npb25zKTsKICAgIH0KICAgIHZhciByaWdodFNpZGViYXJDb2xsYXBzZWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncmlnaHRTaWRlYmFyQ29sbGFwc2VkJyk7CiAgICBpZiAocmlnaHRTaWRlYmFyQ29sbGFwc2VkKSB7CiAgICAgICAgc3RhdGUucmlnaHRTaWRlYmFyLmNvbGxhcHNlZCA9IEpTT04ucGFyc2UocmlnaHRTaWRlYmFyQ29sbGFwc2VkKTsKICAgICAgICAvLyBEb24ndCBkZWZhdWx0IHRvIG9uYm9hcmRpbmcgaWYgb25ib2FyZGluZyB3YXMgY29tcGxldGVkCiAgICAgICAgaWYgKHN0YXRlLm9uYm9hcmRpbmcuY2xhaW1lZENyZWRpdCkgewogICAgICAgICAgICBzdGF0ZS5yaWdodFNpZGViYXIudGFiID0gUmlnaHRTaWRlYmFyVGFiLkNvbnRhY3Q7CiAgICAgICAgfQogICAgfQogICAgdmFyIGxlZnRTaWRlYmFyV2lkdGggPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbGVmdFNpZGViYXJXaWR0aCcpOwogICAgaWYgKGxlZnRTaWRlYmFyV2lkdGgpIHsKICAgICAgICBzdGF0ZS5sZWZ0U2lkZWJhci53aWR0aCA9IHBhcnNlSW50KGxlZnRTaWRlYmFyV2lkdGgsIDEwKTsKICAgIH0KICAgIHZhciBsZWZ0U2lkZWJhckNvbGxhcHNlZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdsZWZ0U2lkZWJhckNvbGxhcHNlZCcpOwogICAgc3RhdGUubGVmdFNpZGViYXIuY29sbGFwc2VkID0gbGVmdFNpZGViYXJDb2xsYXBzZWQKICAgICAgICA/IGlzTW9iaWxlU2NyZWVuKCkgfHwgSlNPTi5wYXJzZShsZWZ0U2lkZWJhckNvbGxhcHNlZCkKICAgICAgICA6IGlzTW9iaWxlU2NyZWVuKCk7CiAgICB2YXIgdGhyZWFkTGlzdFdpZHRoID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3RocmVhZExpc3RXaWR0aCcpOwogICAgaWYgKHRocmVhZExpc3RXaWR0aCkgewogICAgICAgIHN0YXRlLnRocmVhZExpc3RXaWR0aCA9IHBhcnNlSW50KHRocmVhZExpc3RXaWR0aCwgMTApOwogICAgfQogICAgLy8gU2V0IHJlZGlyZWN0IHBsYXRmb3JtCiAgICB2YXIgcmVkaXJlY3RQbGF0Zm9ybSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdyZWRpcmVjdFBsYXRmb3JtJyk7CiAgICBpZiAocmVkaXJlY3RQbGF0Zm9ybSkgewogICAgICAgIHZhciBjb29raWUgPSBDb29raWVzLmdldCgncG1sdCcpOwogICAgICAgIGlmIChjb29raWUpIHsKICAgICAgICAgICAgc3RhdGUucmVkaXJlY3RQbGF0Zm9ybSA9IEpTT04ucGFyc2UocmVkaXJlY3RQbGF0Zm9ybSk7CiAgICAgICAgfQogICAgfQogICAgLy8gU2V0IFRGQSBuZWVkZWQgb24gc3RhdGUKICAgIHN0YXRlLnRmYU5lZWRlZCA9IGdldE5lZWRzVEZBRnJvbUNvb2tpZSgpOwogICAgLy8gU3BlY2lhbCBoYW5kbGluZyBmb3IgZWxlY3Ryb24KICAgIGlmIChpc0VsZWN0cm9uKSB7CiAgICAgICAgdmFyIHNhdmUgPSBmYWxzZTsKICAgICAgICAvLyBFbGVjdHJvbiBhcHAgaGFzIG5vdGlmaWNhdGlvbiBwZXJtaXNzaW9uIGdyYW50ZWQgYXV0b21hdGljYWxseQogICAgICAgIGlmICghc3RhdGUucGVybWlzc2lvbnMubm90aWZpY2F0aW9ucykgewogICAgICAgICAgICBzdGF0ZS5wZXJtaXNzaW9ucy5ub3RpZmljYXRpb25zID0gdHJ1ZTsKICAgICAgICAgICAgc2F2ZSA9IHRydWU7CiAgICAgICAgfQogICAgICAgIC8vIERvbid0IG5lZWQgdG8gcHJvbXB0IGRlZmF1bHQgYXBwLCBpZiBhbHJlYWR5IGhhdmUgc2V0IHRvIGRlZmF1bHQgYXBwCiAgICAgICAgaWYgKCFzdGF0ZS5wZXJtaXNzaW9ucy5tYWlsVG9Qcm90b2NvbCAmJiB3aW5kb3cuUE1FbGVjdHJvbkJyaWRnZQogICAgICAgICAgICAmJiB3aW5kb3cuUE1FbGVjdHJvbkJyaWRnZS5pc0RlZmF1bHRDbGllbnQpIHsKICAgICAgICAgICAgc3RhdGUucGVybWlzc2lvbnMubWFpbFRvUHJvdG9jb2wgPSB3aW5kb3cuUE1FbGVjdHJvbkJyaWRnZS5pc0RlZmF1bHRDbGllbnQoKTsKICAgICAgICAgICAgc2F2ZSA9IHRydWU7CiAgICAgICAgfQogICAgICAgIGlmIChzYXZlKSB7CiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdwZXJtaXNzaW9ucycsIEpTT04uc3RyaW5naWZ5KHN0YXRlLnBlcm1pc3Npb25zKSk7CiAgICAgICAgfQogICAgfQogICAgdmFyIGNsb3NlZEJhbm5lcnMgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY2xvc2VkQmFubmVycycpOwogICAgaWYgKGNsb3NlZEJhbm5lcnMpIHsKICAgICAgICBzdGF0ZS5jbG9zZWRCYW5uZXJzID0gSlNPTi5wYXJzZShjbG9zZWRCYW5uZXJzKTsKICAgIH0KICAgIHZhciB1dG1QYXJhbXMgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncG1VdG1QYXJhbXMnKTsKICAgIGlmICh1dG1QYXJhbXMpIHsKICAgICAgICBzdGF0ZS51dG1QYXJhbXMgPSBKU09OLnBhcnNlKHV0bVBhcmFtcyk7CiAgICB9CiAgICByZXR1cm4gc3RhdGU7Cn0KZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUJpbGxpbmdTdGF0ZShzdGF0ZSkgewogICAgcmV0dXJuIF9fYXNzaWduKHsgcmVzb3VyY2U6IHJlc291cmNlUGVuZGluZygpLCB1cGRhdGluZzogZmFsc2UsIGNvdXBvbnM6IHt9IH0sIHN0YXRlKTsKfQo="},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/lib/state.ts","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/lib/state.ts"],"names":[],"mappings":"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","sourcesContent":["import { resourcePending, resourceLoading, resourceOk } from '@src/lib/resource';\nimport {\n  Me,\n  StoreState,\n  Team,\n  MailboxType,\n  ResourceStatus,\n  Thread,\n  TeamInvite,\n  ThemeSetting,\n  PolymailStatusType,\n} from '@src/types';\nimport {\n  RightSidebarTab,\n  RightSidebarSubTab,\n} from '@src/types/rightSidebar';\nimport { defaultFeatures, defaultPreferences } from '@src/lib/me';\nimport { fnv1a32 } from '@src/lib/crypt';\n\nimport { isLoggedIn } from '@src/api/base';\nimport { createOnboarding } from '@src/mocks/me';\nimport { BillingState } from '@src/types/billing';\nimport { NavbarTab } from '@src/types/leftSidebar';\nimport { isElectron } from '@src/lib/electron';\nimport { getNeedsTFAFromCookie } from './cookies';\nimport Cookies from 'js-cookie';\nimport { isDbReady } from './db';\nimport { CalendarEventDisplayScope } from '@src/ducks/calendars';\nimport { configureAmplitudeUser } from './amplitude-analytics';\nimport { isMobileScreen } from './utils';\n\nexport function createInitialState(sessionId?: string): StoreState {\n  return {\n    dbReady: isDbReady(),\n    theme: resourceOk(ThemeSetting.Light),\n    appUpdateReady: false,\n    webappUpdateReady: false,\n    isOnline: navigator.onLine,\n    isDefaultClient: false,\n    loggedIn: isLoggedIn(),\n    clearingCache: false,\n    authPending: false,\n    signUpPending: false,\n\n    mailbox: {\n      type: MailboxType.None,\n    },\n    mailboxThreads: resourceLoading<Thread[]>(),\n\n    messageBodies: {},\n    contacts: {},\n    contactGroups: {},\n    me: resourcePending<Me>(),\n    features: defaultFeatures,\n    preferences: defaultPreferences,\n    billing: createBillingState(),\n\n    contactSupportPopup: {\n      collapsed: true,\n    },\n\n    team: resourcePending<Team>(),\n    teamMembers: {},\n    teamInvites: resourcePending<TeamInvite[]>(),\n    teamInvitesValidation: {},\n    integrations: [],\n    accounts: [],\n    devices: [],\n    lists: [],\n    routing: {\n      location: null,\n    },\n    typeaheadContacts: [],\n    mailCounts: {},\n    templates: {},\n\n    referralInvites: {},\n\n    tracks: {},\n    drafts: {},\n    threads: {},\n    publicMembers: {},\n    publicTeams: {},\n\n    // Selected ids in list view. Last entry is reference point for multiple selections.\n    selectedIds: new Map<string, boolean>(),\n\n    // tslint:disable-next-line: insecure-random\n    sessionId: fnv1a32(sessionId || Math.random().toString()),\n    attachments: {},\n    attachmentMetas: {},\n    attachmentsDownloading: {},\n\n    selectedContactNotes: [],\n    selectedContactThreads: [],\n    selectedContactFiles: [],\n    activityFeed: resourcePending(),\n\n    shareLinks: {},\n    calendars: {},\n    calendarEvents: {\n      [CalendarEventDisplayScope.Command]: {},\n      [CalendarEventDisplayScope.Rsb]: {},\n    },\n    permissions: {\n      mailToProtocol: false,\n      notifications: false,\n    },\n    closedBanners: {},\n    onboarding: createOnboarding(),\n    incrementalSyncing: false,\n    hotkeyActions: {},\n\n    leftSidebar: {\n      listsCollapsed: true,\n      selectedTab: NavbarTab.Mail,\n      trashCollapsed: false,\n      appsCollapsed: true,\n      teamCollapsed: true,\n      width: 200,\n      collapsed: false,\n    },\n\n    rightSidebar: {\n      collapsed: {\n        threads: false,\n        settings: true,\n      },\n      tab: RightSidebarTab.Onboarding,\n      subTab: RightSidebarSubTab.Conversation,\n    },\n\n    salesforce: {\n      listViews: {},\n      pendingSummaries: {},\n      summaries: {},\n      schemas: {},\n    },\n\n    hubspot: {\n      profiles: {},\n    },\n\n    zoom: {},\n\n    sequences: {},\n    sequenceStages: {},\n    sequenceStageInstances: {},\n    sequenceStageRecipients: {},\n    sequenceRecipients: {},\n    sequencePageLoaded: {},\n\n    comments: {},\n    sharedThreads: {},\n    sharedThreadDrafts: {},\n    asana: {\n      users: resourceLoading(),\n      tasks: {},\n      projects: resourceLoading(),\n      workspaces: resourceLoading(),\n    },\n\n    scheduling: {\n      schedulings: {},\n      timeSlots: {},\n      timeSlotsLoading: false,\n      schedulingPublics: {},\n    },\n    threadListWidth: 300,\n\n    sharedThreadActivity: {\n      comment: {},\n      view: {},\n      reply: {},\n    },\n\n    filters: {},\n    yearlySummaries: {},\n\n    // Miscellaneous State\n    tfaNeeded: false,\n    tfaPasswordConfirmed: false,\n    muteSounds: false,\n    showHotkeySuggestions: true,\n    isMobile: isMobileScreen(),\n\n    // Status\n    status: {\n      statusType: PolymailStatusType.Online,\n      commitsRemaining: 0,\n    },\n  };\n}\n\nexport function initialStateWithCachedData(): StoreState {\n  const state = createInitialState();\n\n  // tslint:disable-next-line: no-console\n  const me = localStorage.getItem('me');\n  if (me) {\n    state.me.data = JSON.parse(me);\n\n    configureAmplitudeUser(state.me.data);\n    state.me.status = ResourceStatus.Ok;\n  } else {\n    configureAmplitudeUser(undefined);\n  }\n\n  const theme = localStorage.getItem('theme');\n  if (theme) {\n    state.theme.data = JSON.parse(theme);\n    state.theme.status = ResourceStatus.Ok;\n  }\n\n  const lists = localStorage.getItem('lists');\n  if (lists) {\n    state.lists = JSON.parse(lists);\n  }\n\n  const onboarding = localStorage.getItem('onboarding');\n  if (onboarding) {\n    state.onboarding = JSON.parse(onboarding);\n  }\n\n  const accounts = localStorage.getItem('accounts');\n  if (accounts) {\n    state.accounts = JSON.parse(accounts);\n  }\n\n  const devices = localStorage.getItem('devices');\n  if (devices) {\n    state.devices = JSON.parse(devices);\n  }\n\n  const preferences = localStorage.getItem('preferences');\n  if (preferences) {\n    state.preferences = JSON.parse(preferences);\n  }\n\n  const features = localStorage.getItem('features');\n  if (features) {\n    state.features = JSON.parse(features);\n  }\n\n  const muteSounds = localStorage.getItem('muteSounds');\n  if (muteSounds) {\n    state.muteSounds = JSON.parse(muteSounds);\n  }\n\n  const showHotkeySuggestions = localStorage.getItem('showHotkeySuggestions');\n  if (showHotkeySuggestions) {\n    state.showHotkeySuggestions = JSON.parse(showHotkeySuggestions);\n  }\n\n  const team = localStorage.getItem('team');\n  if (team) {\n    state.team.data = JSON.parse(team);\n    state.team.status = ResourceStatus.Ok;\n  }\n\n  const integrations = localStorage.getItem('integrations');\n  if (integrations) {\n    state.integrations = JSON.parse(integrations);\n  }\n\n  const permissions = localStorage.getItem('permissions');\n  if (permissions) {\n    state.permissions = JSON.parse(permissions);\n  }\n\n  const rightSidebarCollapsed = localStorage.getItem('rightSidebarCollapsed');\n  if (rightSidebarCollapsed) {\n    state.rightSidebar.collapsed = JSON.parse(rightSidebarCollapsed);\n\n    // Don't default to onboarding if onboarding was completed\n    if (state.onboarding.claimedCredit) {\n      state.rightSidebar.tab = RightSidebarTab.Contact;\n    }\n  }\n\n  const leftSidebarWidth = localStorage.getItem('leftSidebarWidth');\n  if (leftSidebarWidth) {\n    state.leftSidebar.width = parseInt(leftSidebarWidth, 10);\n  }\n\n  const leftSidebarCollapsed = localStorage.getItem('leftSidebarCollapsed');\n  state.leftSidebar.collapsed = leftSidebarCollapsed\n    ? isMobileScreen() || JSON.parse(leftSidebarCollapsed)\n    : isMobileScreen();\n\n  const threadListWidth = localStorage.getItem('threadListWidth');\n  if (threadListWidth) {\n    state.threadListWidth = parseInt(threadListWidth, 10);\n  }\n\n  // Set redirect platform\n  const redirectPlatform = localStorage.getItem('redirectPlatform');\n  if (redirectPlatform) {\n    const cookie = Cookies.get('pmlt');\n    if (cookie) {\n      state.redirectPlatform = JSON.parse(redirectPlatform);\n    }\n  }\n\n  // Set TFA needed on state\n  state.tfaNeeded = getNeedsTFAFromCookie();\n\n  // Special handling for electron\n  if (isElectron) {\n    let save = false;\n\n    // Electron app has notification permission granted automatically\n    if (!state.permissions.notifications) {\n      state.permissions.notifications = true;\n      save = true;\n    }\n\n    // Don't need to prompt default app, if already have set to default app\n    if (!state.permissions.mailToProtocol && window.PMElectronBridge\n      && window.PMElectronBridge.isDefaultClient) {\n      state.permissions.mailToProtocol = window.PMElectronBridge.isDefaultClient();\n      save = true;\n    }\n\n    if (save) {\n      localStorage.setItem('permissions', JSON.stringify(state.permissions));\n    }\n  }\n\n  const closedBanners = localStorage.getItem('closedBanners');\n  if (closedBanners) {\n    state.closedBanners = JSON.parse(closedBanners);\n  }\n\n  const utmParams = localStorage.getItem('pmUtmParams');\n  if (utmParams) {\n    state.utmParams = JSON.parse(utmParams);\n  }\n\n  return state;\n}\n\nexport function createBillingState(state?: Partial<BillingState>): BillingState {\n  return {\n    resource: resourcePending(),\n    updating: false,\n    coupons: {},\n    ...state,\n  };\n}\n"]}]}