{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/ThreadDetail/components/UndoSendPopup/index.ts","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/ThreadDetail/components/UndoSendPopup/index.ts","mtime":1675280254045},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgY29ubmVjdCB9IGZyb20gJ3JlYWN0LXJlZHV4JzsKaW1wb3J0IHsgRHJhZnRTdGF0dXMgfSBmcm9tICdAc3JjL3R5cGVzJzsKaW1wb3J0IHsgZHJhZnRTZW5kVW5kbywgc2VsZWN0U2VuZGluZ0RyYWZ0cywgc2VsZWN0RHJhZnQsIHNlbGVjdERyYWZ0Rm9yVGhyZWFkLCBkcmFmdFNlbmROb3csIH0gZnJvbSAnQHNyYy9kdWNrcy9kcmFmdHMnOwppbXBvcnQgVW5kb1NlbmRQb3B1cCBmcm9tICcuL1VuZG9TZW5kUG9wdXAnOwppbXBvcnQgeyBsYXN0IH0gZnJvbSAnbG9kYXNoJzsKaW1wb3J0IHsgaXNEcmFmdFNlbmRpbmcgfSBmcm9tICdAc3JjL2xpYi9kcmFmdCc7CnZhciBtYXBTdGF0ZVRvUHJvcHMgPSBmdW5jdGlvbiAoc3RhdGUsIG93blByb3BzKSB7CiAgICB2YXIgc2VsZWN0ZWREcmFmdCA9IHN0YXRlLnNlbGVjdGVkRHJhZnQgJiYgc2VsZWN0RHJhZnQoc3RhdGUsIHN0YXRlLnNlbGVjdGVkRHJhZnQpLmRhdGE7CiAgICB2YXIgc2VsZWN0ZWRUaHJlYWRBY3RpdmVEcmFmdCA9IHN0YXRlLnNlbGVjdGVkVGhyZWFkICYmCiAgICAgICAgc2VsZWN0RHJhZnRGb3JUaHJlYWQoc3RhdGUsIHN0YXRlLnNlbGVjdGVkVGhyZWFkLmlkKS5kYXRhOwogICAgdmFyIHNlbGVjdGVkVGhyZWFkU2VuZGluZ0RyYWZ0ID0gc3RhdGUuc2VsZWN0ZWRUaHJlYWQgJiYKICAgICAgICBzZWxlY3REcmFmdEZvclRocmVhZChzdGF0ZSwgc3RhdGUuc2VsZWN0ZWRUaHJlYWQuaWQsIFtEcmFmdFN0YXR1cy5TZW5kaW5nLCBEcmFmdFN0YXR1cy5TdGFnZWRdKS5kYXRhOwogICAgLy8gUmV0dXJuIG5vdGhpbmcgaWYgY3VycmVudGx5IGFjdGl2ZSBkcmFmdCBleGlzdHMKICAgIGlmIChzZWxlY3RlZERyYWZ0ICYmICFpc0RyYWZ0U2VuZGluZyhzZWxlY3RlZERyYWZ0KSB8fAogICAgICAgIHNlbGVjdGVkVGhyZWFkQWN0aXZlRHJhZnQpIHsKICAgICAgICByZXR1cm4gKHsKICAgICAgICAgICAgZHJhZnQ6IHVuZGVmaW5lZCwKICAgICAgICAgICAgaXNPZmZsaW5lOiAhc3RhdGUuaXNPbmxpbmUsCiAgICAgICAgfSk7CiAgICB9CiAgICAvLyBJZiBzZWxlY3RlZCBkcmFmdCBhbmQgc3RhdHVzIHNlbmRpbmcgc2V0IHRvIHVuZG9EcmFmdAogICAgaWYgKHNlbGVjdGVkRHJhZnQgJiYgaXNEcmFmdFNlbmRpbmcoc2VsZWN0ZWREcmFmdCkpIHsKICAgICAgICByZXR1cm4gKHsKICAgICAgICAgICAgZHJhZnQ6IHNlbGVjdGVkRHJhZnQsCiAgICAgICAgICAgIGlzT2ZmbGluZTogIXN0YXRlLmlzT25saW5lLAogICAgICAgIH0pOwogICAgfQogICAgLy8gSWYgc2VsZWN0ZWQgZHJhZnRUaHJlYWQgd2l0aCBzdGF0dXMgc2VuZGluZywgc2V0IHRvIHVuZG8KICAgIGlmIChzZWxlY3RlZFRocmVhZFNlbmRpbmdEcmFmdCkgewogICAgICAgIHJldHVybiAoewogICAgICAgICAgICBkcmFmdDogc2VsZWN0ZWRUaHJlYWRTZW5kaW5nRHJhZnQsCiAgICAgICAgICAgIGlzT2ZmbGluZTogIXN0YXRlLmlzT25saW5lLAogICAgICAgIH0pOwogICAgfQogICAgLy8gT3RoZXJ3aXNlIHJldHVybiBsYXN0IG9mIGF2YWlsYWJsZSB1bmRvYWJsZSBkcmFmdHMKICAgIHJldHVybiAoewogICAgICAgIGRyYWZ0OiBsYXN0KHNlbGVjdFNlbmRpbmdEcmFmdHMoc3RhdGUpKSwKICAgICAgICBpc09mZmxpbmU6ICFzdGF0ZS5pc09ubGluZSwKICAgIH0pOwp9Owp2YXIgbWFwRGlzcGF0Y2hUb1Byb3BzID0gZnVuY3Rpb24gKGRpc3BhdGNoKSB7IHJldHVybiAoewogICAgdW5kb1NlbmQ6IGZ1bmN0aW9uIChkcmFmdCkgeyByZXR1cm4gZGlzcGF0Y2goZHJhZnRTZW5kVW5kbyhkcmFmdCkpOyB9LAogICAgc2VuZE5vdzogZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGRpc3BhdGNoKGRyYWZ0U2VuZE5vdyhkKSk7IH0sCn0pOyB9OwpleHBvcnQgZGVmYXVsdCBjb25uZWN0KG1hcFN0YXRlVG9Qcm9wcywgbWFwRGlzcGF0Y2hUb1Byb3BzKShVbmRvU2VuZFBvcHVwKTsK"},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/ThreadDetail/components/UndoSendPopup/index.ts","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/ThreadDetail/components/UndoSendPopup/index.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,OAAO,EAAE,MAAM,aAAa,CAAC;AACtC,OAAO,EAAc,WAAW,EAAE,MAAM,YAAY,CAAC;AACrD,OAAO,EACL,aAAa,EACb,mBAAmB,EACnB,WAAW,EACX,oBAAoB,EACpB,YAAY,GACb,MAAM,mBAAmB,CAAC;AAE3B,OAAO,aAAuC,MAAM,iBAAiB,CAAC;AACtE,OAAO,EAAE,IAAI,EAAE,MAAM,QAAQ,CAAC;AAC9B,OAAO,EAAE,cAAc,EAAE,MAAM,gBAAgB,CAAC;AAEhD,IAAM,eAAe,GAAG,UAAC,KAAiB,EAAE,QAAe;IACzD,IAAM,aAAa,GAAG,KAAK,CAAC,aAAa,IAAI,WAAW,CAAC,KAAK,EAAE,KAAK,CAAC,aAAa,CAAC,CAAC,IAAI,CAAC;IAC1F,IAAM,yBAAyB,GAAG,KAAK,CAAC,cAAc;QACpD,oBAAoB,CAAC,KAAK,EAAE,KAAK,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC;IAC5D,IAAM,0BAA0B,GAAG,KAAK,CAAC,cAAc;QACrD,oBAAoB,CAClB,KAAK,EACL,KAAK,CAAC,cAAc,CAAC,EAAE,EACvB,CAAC,WAAW,CAAC,OAAO,EAAE,WAAW,CAAC,MAAM,CAAC,CAC1C,CAAC,IAAI,CAAC;IAET,kDAAkD;IAClD,IACE,aAAa,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC;QAC/C,yBAAyB,EACzB;QACA,OAAM,CAAC;YACL,KAAK,EAAE,SAAS;YAChB,SAAS,EAAE,CAAC,KAAK,CAAC,QAAQ;SAC3B,CAAC,CAAC;KACJ;IAED,wDAAwD;IACxD,IAAI,aAAa,IAAI,cAAc,CAAC,aAAa,CAAC,EAAE;QAClD,OAAO,CAAC;YACN,KAAK,EAAE,aAAa;YACpB,SAAS,EAAE,CAAC,KAAK,CAAC,QAAQ;SAC3B,CAAC,CAAC;KACJ;IAED,2DAA2D;IAC3D,IAAI,0BAA0B,EAAE;QAC9B,OAAO,CAAC;YACN,KAAK,EAAE,0BAA0B;YACjC,SAAS,EAAE,CAAC,KAAK,CAAC,QAAQ;SAC3B,CAAC,CAAC;KACJ;IAED,qDAAqD;IACrD,OAAO,CAAC;QACN,KAAK,EAAE,IAAI,CAAC,mBAAmB,CAAC,KAAK,CAAC,CAAC;QACvC,SAAS,EAAE,CAAC,KAAK,CAAC,QAAQ;KAC3B,CAAC,CAAC;AACL,CAAC,CAAC;AAEF,IAAM,kBAAkB,GAAG,UAAC,QAA8B,IAAoB,OAAA,CAAC;IAC7E,QAAQ,EAAE,UAAA,KAAK,IAAI,OAAA,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,EAA9B,CAA8B;IACjD,OAAO,EAAE,UAAA,CAAC,IAAI,OAAA,QAAQ,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,EAAzB,CAAyB;CACxC,CAAC,EAH4E,CAG5E,CAAC;AAEH,eAAe,OAAO,CAAC,eAAe,EAAE,kBAAkB,CAAC,CAAC,aAAa,CAAC,CAAC","sourcesContent":["import { Dispatch } from 'redux';\nimport { connect } from 'react-redux';\nimport { StoreState, DraftStatus } from '@src/types';\nimport {\n  draftSendUndo,\n  selectSendingDrafts,\n  selectDraft,\n  selectDraftForThread,\n  draftSendNow,\n} from '@src/ducks/drafts';\n\nimport UndoSendPopup, { Props, DispatchProps } from './UndoSendPopup';\nimport { last } from 'lodash';\nimport { isDraftSending } from '@src/lib/draft';\n\nconst mapStateToProps = (state: StoreState, ownProps: Props): Props => {\n  const selectedDraft = state.selectedDraft && selectDraft(state, state.selectedDraft).data;\n  const selectedThreadActiveDraft = state.selectedThread &&\n    selectDraftForThread(state, state.selectedThread.id).data;\n  const selectedThreadSendingDraft = state.selectedThread &&\n    selectDraftForThread(\n      state,\n      state.selectedThread.id,\n      [DraftStatus.Sending, DraftStatus.Staged],\n    ).data;\n\n  // Return nothing if currently active draft exists\n  if (\n    selectedDraft && !isDraftSending(selectedDraft) ||\n    selectedThreadActiveDraft\n  ) {\n    return({\n      draft: undefined,\n      isOffline: !state.isOnline,\n    });\n  }\n\n  // If selected draft and status sending set to undoDraft\n  if (selectedDraft && isDraftSending(selectedDraft)) {\n    return ({\n      draft: selectedDraft,\n      isOffline: !state.isOnline,\n    });\n  }\n\n  // If selected draftThread with status sending, set to undo\n  if (selectedThreadSendingDraft) {\n    return ({\n      draft: selectedThreadSendingDraft,\n      isOffline: !state.isOnline,\n    });\n  }\n\n  // Otherwise return last of available undoable drafts\n  return ({\n    draft: last(selectSendingDrafts(state)),\n    isOffline: !state.isOnline,\n  });\n};\n\nconst mapDispatchToProps = (dispatch: Dispatch<StoreState>): DispatchProps => ({\n  undoSend: draft => dispatch(draftSendUndo(draft)),\n  sendNow: d => dispatch(draftSendNow(d)),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(UndoSendPopup);\n"]}]}