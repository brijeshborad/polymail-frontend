{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Settings/routes/Billing/components/BillingStatusBanner.tsx","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Settings/routes/Billing/components/BillingStatusBanner.tsx","mtime":1675280254099},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JzsKaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnOwppbXBvcnQgeyBjYXBpdGFsaXplIH0gZnJvbSAnbG9kYXNoJzsKaW1wb3J0IHsgQmlsbGluZ1N1YnNjcmlwdGlvblN0YXR1cyB9IGZyb20gJ0BzcmMvdHlwZXMvYmlsbGluZyc7CmltcG9ydCAnLi9CaWxsaW5nU3RhdHVzQmFubmVyLnNjc3MnOwppbXBvcnQgeyB0cmlhbERheXNMZWZ0LCB0aWVyRnJvbVRlYW1QbGFuLCB0aXRsZUZvclRpZXIgfSBmcm9tICdAc3JjL2xpYi9tb2RlbHMvYmlsbGluZyc7CmltcG9ydCB7IHJlbW92ZUVuZGluZ1BlcmlvZCB9IGZyb20gJ0BzcmMvbGliL3V0aWxzJzsKdmFyIEJpbGxpbmdTdGF0dXNCYW5uZXIgPSBmdW5jdGlvbiAocHJvcHMpIHsKICAgIHZhciB1bnBhaWRTdWJzID0gcHJvcHMuc3Vic2NyaXB0aW9uCiAgICAgICAgJiYgcHJvcHMuc3Vic2NyaXB0aW9uLnN0YXR1cyA9PT0gQmlsbGluZ1N1YnNjcmlwdGlvblN0YXR1cy5VbnBhaWQ7CiAgICAvLyB0aGlzIGJhbm5lciBpcyBwcmlvcml0aXplZCBvdmVyIGFueSBvdGhlcgogICAgaWYgKHByb3BzLmlzRGlzYWJsZWQpIHsKICAgICAgICByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAiYmlsbGluZy1zdGF0dXMtYmFubmVyIGVycm9yIiB9LCAiU2VsZWN0IGEgcGxhbiB0byBjb250aW51ZSB1c2luZyBQb2x5bWFpbCIpKTsKICAgIH0KICAgIGlmIChwcm9wcy5zdWJzY3JpcHRpb24pIHsKICAgICAgICBpZiAocHJvcHMuc3Vic2NyaXB0aW9uLnBsYW5FeHBpcmVzICYmIHByb3BzLnRyaWFsRXhwaXJlcyAmJiBwcm9wcy5zZWxlY3RlZFRpZXIpIHsKICAgICAgICAgICAgcmV0dXJuIChSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImJpbGxpbmctc3RhdHVzLWJhbm5lciIgfSwKICAgICAgICAgICAgICAgICJZb3VyIG5ldyAiLAogICAgICAgICAgICAgICAgY2FwaXRhbGl6ZSh0aXRsZUZvclRpZXIocHJvcHMuc2VsZWN0ZWRUaWVyKSksCiAgICAgICAgICAgICAgICAiIHN1YnNjcmlwdGlvbiB3aWxsIHN0YXJ0IG9uICIsCiAgICAgICAgICAgICAgICBtb21lbnQocHJvcHMuc3Vic2NyaXB0aW9uLnBsYW5FeHBpcmVzKS5mb3JtYXQoJ01NTU0gRCwgWVlZWScpKSk7CiAgICAgICAgfQogICAgICAgIC8vIENhbmNlbGVkIHN1YnNjcmlwdGlvbgogICAgICAgIGlmIChwcm9wcy5zdWJzY3JpcHRpb24ucGxhbkV4cGlyZXMgJiYgIXVucGFpZFN1YnMpIHsKICAgICAgICAgICAgcmV0dXJuIChSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImJpbGxpbmctc3RhdHVzLWJhbm5lciIgfSwKICAgICAgICAgICAgICAgICJZb3VyIGNhbmNlbGVkICIsCiAgICAgICAgICAgICAgICBjYXBpdGFsaXplKHRpdGxlRm9yVGllcihwcm9wcy5zdWJzY3JpcHRpb24udGllcikpLAogICAgICAgICAgICAgICAgIiBzdWJzY3JpcHRpb24gd2lsbCBlbmQgb24gIiwKICAgICAgICAgICAgICAgIG1vbWVudChwcm9wcy5zdWJzY3JpcHRpb24ucGxhbkV4cGlyZXMpLmZvcm1hdCgnTU1NTSBELCBZWVlZJykpKTsKICAgICAgICB9CiAgICAgICAgLy8gRGVsaW5xdWVudCBjYXNlCiAgICAgICAgaWYgKHByb3BzLnN1YnNjcmlwdGlvbi5zdGF0dXMgPT09IEJpbGxpbmdTdWJzY3JpcHRpb25TdGF0dXMuUGFzdER1ZQogICAgICAgICAgICB8fCB1bnBhaWRTdWJzKSB7CiAgICAgICAgICAgIHZhciBtZXNzYWdlID0gcHJvcHMuZXh0cmFNZXNzYWdlICYmIHJlbW92ZUVuZGluZ1BlcmlvZChwcm9wcy5leHRyYU1lc3NhZ2UpOwogICAgICAgICAgICByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAiYmlsbGluZy1zdGF0dXMtYmFubmVyIGVycm9yIiB9LAogICAgICAgICAgICAgICAgIllvdXIgbGFzdCBwYXltZW50IGZhaWxlZCIsCiAgICAgICAgICAgICAgICBwcm9wcy5jYXJkICYmICIgdXNpbmcgdGhlIGNhcmQgZW5kaW5nICIgKyBwcm9wcy5jYXJkLmxhc3RGb3VyLAogICAgICAgICAgICAgICAgcHJvcHMuZXh0cmFNZXNzYWdlICYmICIgd2l0aCB0aGUgZm9sbG93aW5nIGVycm9yOiA8IiArIG1lc3NhZ2UgKyAiPiIsCiAgICAgICAgICAgICAgICAiLiBZb3UgY2FuIHJldHJ5IGJlbG93LiIpKTsKICAgICAgICB9CiAgICAgICAgLy8gTm8gYmFubmVyIG5lZWRlZCwgaGF2ZSBhbiBhY3RpdmUgc3Vic2NyaXB0aW9uCiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgICAvLyBDb3B5CiAgICB2YXIgYWRtaW5VcGdyYWRlQ29weSA9IHByb3BzLmlzQWRtaW4gPyAnWW91ciBjcmVkaXQgY2FyZCB3aWxsIG5vdCBiZSBjaGFyZ2VkLicKICAgICAgICA6ICdDb250YWN0IHlvdXIgYmlsbGluZyBhZG1pbmlzdHJhdG9yIHRvIHVwZ3JhZGUuJzsKICAgIHZhciB0aWVyUGxhbiA9IHByb3BzLnRyaWFsUGxhbiAmJiB0aWVyRnJvbVRlYW1QbGFuKHByb3BzLnRyaWFsUGxhbik7CiAgICB2YXIgdGllclBsYW5Db3JyZWN0aW9uID0gdGllclBsYW47CiAgICB2YXIgdGllciA9IHRpZXJQbGFuQ29ycmVjdGlvbiAmJiBjYXBpdGFsaXplKHRpZXJQbGFuQ29ycmVjdGlvbikgfHwgJyc7CiAgICAvLyBIYW5kbGUgdHJpYWwgZXhwaXJpbmcKICAgIGlmIChwcm9wcy50cmlhbEV4cGlyZXMpIHsKICAgICAgICB2YXIgZGF5c0xlZnQgPSB0cmlhbERheXNMZWZ0KHByb3BzLnRyaWFsRXhwaXJlcyk7CiAgICAgICAgaWYgKGRheXNMZWZ0ID4gMCkgewogICAgICAgICAgICByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAiYmlsbGluZy1zdGF0dXMtYmFubmVyIiB9LAogICAgICAgICAgICAgICAgIllvdSBoYXZlICIsCiAgICAgICAgICAgICAgICBkYXlzTGVmdCwKICAgICAgICAgICAgICAgICIgIiwKICAgICAgICAgICAgICAgIGRheXNMZWZ0ID4gMSA/ICdkYXlzJyA6ICdkYXknLAogICAgICAgICAgICAgICAgIiByZW1haW5pbmcgaW4geW91ciAiLAogICAgICAgICAgICAgICAgdGllciwKICAgICAgICAgICAgICAgICIgZnJlZSB0cmlhbC4iLAogICAgICAgICAgICAgICAgJyAnLAogICAgICAgICAgICAgICAgYWRtaW5VcGdyYWRlQ29weSkpOwogICAgICAgIH0KICAgIH0KICAgIC8vIHVzZXIgaXMgb24gZnJlZSB0aWVyIHdpdGggdHJpYWwgZXhwaXJlZAogICAgcmV0dXJuIChSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImJpbGxpbmctc3RhdHVzLWJhbm5lciBlcnJvciIgfSwKICAgICAgICAiWW91ciAiLAogICAgICAgIHRpZXIsCiAgICAgICAgIiB0cmlhbCBoYXMgZXhwaXJlZC4gIiwKICAgICAgICBhZG1pblVwZ3JhZGVDb3B5KSk7Cn07CmV4cG9ydCBkZWZhdWx0IEJpbGxpbmdTdGF0dXNCYW5uZXI7Cg=="},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Settings/routes/Billing/components/BillingStatusBanner.tsx","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Settings/routes/Billing/components/BillingStatusBanner.tsx"],"names":[],"mappings":"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","sourcesContent":["import React from 'react';\nimport moment from 'moment';\nimport { capitalize } from 'lodash';\n\nimport { BillingCard, BillingSubscription, BillingSubscriptionStatus, BillingTier } from '@src/types/billing';\n\nimport './BillingStatusBanner.scss';\n\nimport { trialDaysLeft, tierFromTeamPlan, titleForTier } from '@src/lib/models/billing';\nimport { TeamPlan } from '@src/types';\nimport { removeEndingPeriod } from '@src/lib/utils';\n\nexport interface Props {\n  isAdmin: boolean;\n  trialExpires?: Date;\n  trialPlan?: TeamPlan;\n  subscription?: BillingSubscription;\n  isDisabled?: boolean;\n  card?: BillingCard;\n  extraMessage?: string;\n  selectedTier?: BillingTier;\n}\n\nconst BillingStatusBanner: React.SFC<Props> = (props: Props) => {\n  const unpaidSubs =\n    props.subscription\n    && props.subscription.status === BillingSubscriptionStatus.Unpaid;\n\n  // this banner is prioritized over any other\n  if (props.isDisabled) {\n    return (\n      <div className=\"billing-status-banner error\">\n        Select a plan to continue using Polymail\n      </div>\n    );\n  }\n\n  if (props.subscription) {\n    if (props.subscription.planExpires && props.trialExpires && props.selectedTier) {\n      return (\n        <div className=\"billing-status-banner\">\n          Your new {capitalize(titleForTier(props.selectedTier))} subscription\n          will start on {moment(props.subscription.planExpires).format('MMMM D, YYYY')}\n        </div>\n      );\n    }\n    // Canceled subscription\n    if (props.subscription.planExpires && !unpaidSubs) {\n      return (\n        <div className=\"billing-status-banner\">\n          Your canceled {capitalize(titleForTier(props.subscription.tier))} subscription will\n          end on {moment(props.subscription.planExpires).format('MMMM D, YYYY')}\n        </div>\n      );\n    }\n\n    // Delinquent case\n    if (props.subscription.status === BillingSubscriptionStatus.PastDue\n      || unpaidSubs) {\n      const message = props.extraMessage && removeEndingPeriod(props.extraMessage);\n\n      return (\n        <div className=\"billing-status-banner error\">\n          Your last payment failed\n          {props.card && ` using the card ending ${props.card.lastFour}`}\n          {props.extraMessage && ` with the following error: <${message}>`}\n          .\n          You can retry below.\n        </div>\n      );\n    }\n\n    // No banner needed, have an active subscription\n    return null;\n  }\n\n  // Copy\n  const adminUpgradeCopy = props.isAdmin ? 'Your credit card will not be charged.'\n    : 'Contact your billing administrator to upgrade.';\n  const tierPlan = props.trialPlan && tierFromTeamPlan(props.trialPlan);\n  const tierPlanCorrection = tierPlan;\n  const tier = tierPlanCorrection && capitalize(tierPlanCorrection) || '';\n\n  // Handle trial expiring\n  if (props.trialExpires) {\n    const daysLeft = trialDaysLeft(props.trialExpires);\n    if (daysLeft > 0) {\n      return (\n        <div className=\"billing-status-banner\">\n          You have {daysLeft} {daysLeft > 1 ? 'days' : 'day'} remaining in your {tier} free trial.{' '}\n          {adminUpgradeCopy}\n        </div>\n      );\n    }\n  }\n\n  // user is on free tier with trial expired\n  return (\n    <div className=\"billing-status-banner error\">\n      Your {tier} trial has expired. {adminUpgradeCopy}\n    </div>\n  );\n};\n\nexport default BillingStatusBanner;\n"]}]}