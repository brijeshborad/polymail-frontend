{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/ThreadDetail/components/Cell/SharedDraftCell/SharedDraftCell.tsx","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/ThreadDetail/components/Cell/SharedDraftCell/SharedDraftCell.tsx","mtime":1675280254038},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JzsKaW1wb3J0IGNsYXNzbmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7CmltcG9ydCAnLi9TaGFyZWREcmFmdENlbGwuc2Nzcyc7CmltcG9ydCB7IHNob3dNb3N0UmVjZW50IH0gZnJvbSAnQHNyYy9saWIvZGF0ZXRpbWUnOwppbXBvcnQgeyBnZXREaXNwbGF5TmFtZSwgZ2V0Rmlyc3ROYW1lIH0gZnJvbSAnQHNyYy9saWIvYWRkcmVzcyc7CmltcG9ydCBCYWxsUHVsc2UgZnJvbSAnQHNyYy9jb21wb25lbnRzL0xvYWRlci9CYWxsUHVsc2UvQmFsbFB1bHNlJzsKaW1wb3J0IEF0dGFjaG1lbnRDZWxsIGZyb20gJ0BzcmMvY29tcG9uZW50cy9Db21wb3NlL0F0dGFjaG1lbnRzL0F0dGFjaG1lbnRDZWxsJzsKaW1wb3J0IHsgZmlsZW5hbWVJY29uVXJsIH0gZnJvbSAnQHNyYy9saWIvYXR0YWNobWVudCc7CnZhciBTaGFyZWREcmFmdENlbGwgPSBmdW5jdGlvbiAocHJvcHMpIHsKICAgIHZhciBzaGFyZWRPd25lclBob3RvVXJsID0gcHJvcHMuc2hhcmVkT3duZXJQaG90b1VybCwgc2hhcmVkRHJhZnQgPSBwcm9wcy5zaGFyZWREcmFmdCwgc2hhcmVkT3duZXIgPSBwcm9wcy5zaGFyZWRPd25lciwgbWUgPSBwcm9wcy5tZSwgc2hhcmVkVGhyZWFkID0gcHJvcHMuc2hhcmVkVGhyZWFkLCByZXBseWluZyA9IHByb3BzLnJlcGx5aW5nLCBwdWJsaWNVcmwgPSBwcm9wcy5wdWJsaWNVcmw7CiAgICBpZiAoIXNoYXJlZERyYWZ0KSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgICAvLyBEbyBub3Qgc2hvdyBzaGFyZWQgZHJhZnQgY2VsbCBpZiBpbiBhcHAgYW5kIG93bmVyCiAgICB2YXIgaXNPd25lciA9IHNoYXJlZFRocmVhZCAmJiBtZSAmJiBzaGFyZWRUaHJlYWQudXNlciA9PT0gbWUuaWQ7CiAgICBpZiAoaXNPd25lciAmJiAhcHVibGljVXJsKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgICB2YXIgdG8gPSBzaGFyZWREcmFmdC50bywgY2MgPSBzaGFyZWREcmFmdC5jYywgYmNjID0gc2hhcmVkRHJhZnQuYmNjOwogICAgdmFyIHRpbWUgPSBzaG93TW9zdFJlY2VudChzaGFyZWREcmFmdC51cGRhdGVkKTsKICAgIHZhciByZWNpcGllbnRzID0gdG8gfHwgW107CiAgICBpZiAoY2MpIHsKICAgICAgICByZWNpcGllbnRzID0gcmVjaXBpZW50cy5jb25jYXQoY2MpOwogICAgfQogICAgaWYgKGJjYykgewogICAgICAgIHJlY2lwaWVudHMgPSByZWNpcGllbnRzLmNvbmNhdChiY2MpOwogICAgfQogICAgLy8gUmVjaXBpZW50cwogICAgdmFyIHJlY2lwaWVudFN0cmluZyA9ICcnOwogICAgdmFyIG1heE5hbWVDb3VudCA9IDM7CiAgICBpZiAoIXJlY2lwaWVudHMubGVuZ3RoKSB7CiAgICAgICAgcmVjaXBpZW50U3RyaW5nID0gJ05vIFJlY2lwaWVudHMnOwogICAgfQogICAgZWxzZSBpZiAocmVjaXBpZW50cy5sZW5ndGggPT09IDEpIHsKICAgICAgICByZWNpcGllbnRTdHJpbmcgPSBnZXREaXNwbGF5TmFtZShyZWNpcGllbnRzWzBdKTsKICAgIH0KICAgIGVsc2UgaWYgKHJlY2lwaWVudHMubGVuZ3RoIDw9IG1heE5hbWVDb3VudCkgewogICAgICAgIHJlY2lwaWVudFN0cmluZyA9IHJlY2lwaWVudHMubWFwKGZ1bmN0aW9uIChyZWNpcGllbnQpIHsgcmV0dXJuIGdldEZpcnN0TmFtZShyZWNpcGllbnQpOyB9KS5qb2luKCcsICcpOwogICAgfQogICAgZWxzZSBpZiAocmVjaXBpZW50cy5sZW5ndGggPiBtYXhOYW1lQ291bnQpIHsKICAgICAgICB2YXIgbmFtZVN0cmluZyA9IHJlY2lwaWVudHMKICAgICAgICAgICAgLnNsaWNlKDAsIG1heE5hbWVDb3VudCkKICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAocmVjaXBpZW50KSB7IHJldHVybiBnZXRGaXJzdE5hbWUocmVjaXBpZW50KTsgfSkuam9pbignLCAnKTsKICAgICAgICB2YXIgb3RoZXJDb3VudCA9IHJlY2lwaWVudHMubGVuZ3RoIC0gbWF4TmFtZUNvdW50OwogICAgICAgIHZhciBvdGhlclN0cmluZyA9IG90aGVyQ291bnQgPT09IDEgPyAnb3RoZXInIDogJ290aGVycyc7CiAgICAgICAgcmVjaXBpZW50U3RyaW5nID0gbmFtZVN0cmluZyArICgiICYgIiArIG90aGVyQ291bnQgKyAiICIpICsgb3RoZXJTdHJpbmc7CiAgICB9CiAgICB2YXIgbmFtZSA9IHNoYXJlZE93bmVyID09PSBudWxsIHx8IHNoYXJlZE93bmVyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzaGFyZWRPd25lci5maXJzdE5hbWU7CiAgICBpZiAoISEoc2hhcmVkT3duZXIgPT09IG51bGwgfHwgc2hhcmVkT3duZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHNoYXJlZE93bmVyLmxhc3ROYW1lKSAmJiBzaGFyZWRPd25lci5sYXN0TmFtZSAhPT0gJycpIHsKICAgICAgICBuYW1lICs9ICcgJyArIHNoYXJlZE93bmVyLmxhc3ROYW1lOwogICAgfQogICAgcmV0dXJuIChSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogY2xhc3NuYW1lcygnc2hhcmVkLWRyYWZ0LWNlbGwnLCAnaGlkZS1oaXN0b3J5JykgfSwKICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImRyYWZ0LWRpc2NsYWltZXIiIH0sICJEUkFGVCIpLAogICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAiaGVhZGVyIiB9LAogICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImF2YXRhci1zZWN0aW9uIiB9LAogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiaW1nIiwgeyBzcmM6IHNoYXJlZE93bmVyUGhvdG9VcmwsIGFsdDogIiIsIGNsYXNzTmFtZTogImF2YXRhciIgfSkpLAogICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogInJlY2lwaWVudHMiIH0sCiAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogInNlbmRlciIgfSwKICAgICAgICAgICAgICAgICAgICBuYW1lLAogICAgICAgICAgICAgICAgICAgICIgaXMgY29tcG9zaW5nIiwKICAgICAgICAgICAgICAgICAgICAhIShyZXBseWluZyA9PT0gbnVsbCB8fCByZXBseWluZyA9PT0gdm9pZCAwID8gdm9pZCAwIDogcmVwbHlpbmcubGVuZ3RoKSAmJiAoUmVhY3QuY3JlYXRlRWxlbWVudChCYWxsUHVsc2UsIG51bGwpKSksCiAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImVtYWlsLWxhYmVsIiB9LCAidG8gIiArIHJlY2lwaWVudFN0cmluZykpLAogICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImRhdGUtc2VjdGlvbiIgfSwgdGltZSkpLAogICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAiZHJhZnQtYm9keSIgfSwKICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJjb250ZW50IiwgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw6IHsKICAgICAgICAgICAgICAgICAgICBfX2h0bWw6IHNoYXJlZERyYWZ0LmJvZHksCiAgICAgICAgICAgICAgICB9IH0pLAogICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImF0dGFjaG1lbnRzLXNlY3Rpb24iIH0sIHNoYXJlZERyYWZ0LmF0dGFjaG1lbnRzLm1hcChmdW5jdGlvbiAoYXR0YWNobWVudCkgeyByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoQXR0YWNobWVudENlbGwsIHsga2V5OiBhdHRhY2htZW50LmlkLCBpZDogYXR0YWNobWVudC5pZCwgZmlsZW5hbWU6IGF0dGFjaG1lbnQuZmlsZW5hbWUsIGljb25Vcmw6IGZpbGVuYW1lSWNvblVybChhdHRhY2htZW50LmZpbGVuYW1lKSwgbGVuZ3RoOiBhdHRhY2htZW50Lmxlbmd0aCwgcHJvZ3Jlc3M6IDEsIGZpbGVVcmw6IGF0dGFjaG1lbnQuY2xvdWRVcmwgfSkpOyB9KSkpKSk7Cn07CmV4cG9ydCBkZWZhdWx0IFNoYXJlZERyYWZ0Q2VsbDsK"},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/ThreadDetail/components/Cell/SharedDraftCell/SharedDraftCell.tsx","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/ThreadDetail/components/Cell/SharedDraftCell/SharedDraftCell.tsx"],"names":[],"mappings":"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","sourcesContent":["import React from 'react';\nimport classnames from 'classnames';\nimport { Draft, Me, TeamMember } from '@src/types';\n\nimport './SharedDraftCell.scss';\nimport { SharedThread, SharedThreadActivity } from '@src/types/sharedThreads';\nimport { showMostRecent } from '@src/lib/datetime';\nimport { getDisplayName, getFirstName } from '@src/lib/address';\nimport BallPulse from '@src/components/Loader/BallPulse/BallPulse';\nimport AttachmentCell from '@src/components/Compose/Attachments/AttachmentCell';\nimport { filenameIconUrl } from '@src/lib/attachment';\n\nexport interface Props {\n  sharedDraft?: Draft;\n  sharedThread?: SharedThread;\n  sharedOwner?: TeamMember;\n  sharedOwnerPhotoUrl?: string;\n  me?: Me;\n  replying?: SharedThreadActivity[];\n  publicUrl?: boolean;\n}\n\nconst SharedDraftCell = (props: Props) => {\n  const {\n    sharedOwnerPhotoUrl, sharedDraft,\n    sharedOwner, me, sharedThread, replying,\n    publicUrl,\n  } = props;\n\n  if (!sharedDraft) {\n    return null;\n  }\n\n  // Do not show shared draft cell if in app and owner\n  const isOwner = sharedThread && me && sharedThread.user === me.id;\n  if (isOwner && !publicUrl) {\n    return null;\n  }\n\n  const { to, cc, bcc } = sharedDraft;\n  const time = showMostRecent(sharedDraft.updated);\n  let recipients = to || [];\n  if (cc) {\n    recipients = recipients.concat(cc);\n  }\n  if (bcc) {\n    recipients = recipients.concat(bcc);\n  }\n\n  // Recipients\n  let recipientString = '';\n  const maxNameCount = 3;\n  if (!recipients.length) {\n    recipientString = 'No Recipients';\n  } else if (recipients.length === 1) {\n    recipientString = getDisplayName(recipients[0]);\n  } else if (recipients.length <= maxNameCount) {\n    recipientString = recipients.map(recipient => getFirstName(recipient)).join(', ');\n  } else if (recipients.length > maxNameCount) {\n    const nameString = recipients\n      .slice(0, maxNameCount)\n      .map(recipient => getFirstName(recipient)).join(', ');\n    const otherCount = recipients.length - maxNameCount;\n    const otherString = otherCount === 1 ? 'other' : 'others';\n    recipientString = nameString + ` & ${otherCount} ` + otherString;\n  }\n\n  let name = sharedOwner?.firstName;\n  if (!!sharedOwner?.lastName && sharedOwner.lastName !== '') {\n    name += ' ' + sharedOwner.lastName;\n  }\n\n  return (\n    <div className={classnames('shared-draft-cell', 'hide-history')}>\n      <div className=\"draft-disclaimer\">\n        DRAFT\n      </div>\n      <div className=\"header\">\n        <div className=\"avatar-section\">\n          <img src={sharedOwnerPhotoUrl} alt=\"\" className=\"avatar\"/>\n        </div>\n        <div className=\"recipients\">\n          <div className=\"sender\">\n            {name} is composing\n            {!!replying?.length && (\n              <BallPulse />\n            )}\n          </div>\n          <div className=\"email-label\">\n            {`to ${recipientString}`}\n          </div>\n        </div>\n        <div className=\"date-section\">\n          {time}\n        </div>\n      </div>\n      <div className=\"draft-body\">\n        <div className=\"content\"\n          dangerouslySetInnerHTML={{\n            __html: sharedDraft.body,\n          }}\n        />\n        <div className=\"attachments-section\">\n          {sharedDraft.attachments.map(attachment => (\n              <AttachmentCell\n                key={attachment.id}\n                id={attachment.id}\n                filename={attachment.filename}\n                iconUrl={filenameIconUrl(attachment.filename)}\n                length={attachment.length}\n                progress={1}\n                fileUrl={attachment.cloudUrl}\n              />\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default SharedDraftCell;\n"]}]}