{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/worker/sync/ActivityFeedSync.ts","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/worker/sync/ActivityFeedSync.ts","mtime":1675280254124},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewogICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewogICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAogICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKICAgIH07CiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwogICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQogICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKICAgIH07Cn0pKCk7CmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JzsKaW1wb3J0IHsgU3RvcmVzIH0gZnJvbSAnQHNyYy9saWIvZGInOwppbXBvcnQgeyBBY3Rpdml0eUZlZWRDbGllbnQgfSBmcm9tICdAc3JjL2FwaS9hY3Rpdml0eUZlZWQnOwppbXBvcnQgeyBBUElTeW5jIH0gZnJvbSAnLi9BUElTeW5jJzsKdmFyIEFjdGl2aXR5RmVlZEluY3JTeW5jID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewogICAgX19leHRlbmRzKEFjdGl2aXR5RmVlZEluY3JTeW5jLCBfc3VwZXIpOwogICAgZnVuY3Rpb24gQWN0aXZpdHlGZWVkSW5jclN5bmMoYXBpKSB7CiAgICAgICAgaWYgKGFwaSA9PT0gdm9pZCAwKSB7IGFwaSA9IG5ldyBBY3Rpdml0eUZlZWRDbGllbnQoKTsgfQogICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsICdBY3Rpdml0eUZlZWRTeW5jJywgU3RvcmVzLkFjdGl2aXR5RmVlZCwgZmFsc2UpIHx8IHRoaXM7CiAgICAgICAgX3RoaXMuYXBpID0gYXBpOwogICAgICAgIHJldHVybiBfdGhpczsKICAgIH0KICAgIEFjdGl2aXR5RmVlZEluY3JTeW5jLnByb3RvdHlwZS5mZXRjaE5leHRQYWdlID0gZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiB0aGlzLmFwaS5saXN0KHRoaXMub2Zmc2V0KTsKICAgIH07CiAgICBBY3Rpdml0eUZlZWRJbmNyU3luYy5wcm90b3R5cGUubmV4dFBhZ2VPZmZzZXQgPSBmdW5jdGlvbiAobW9kZWxzKSB7CiAgICAgICAgcmV0dXJuIG1vbWVudChtb2RlbHNbbW9kZWxzLmxlbmd0aCAtIDFdLnVwZGF0ZWQpLnRvSVNPU3RyaW5nKCk7CiAgICB9OwogICAgcmV0dXJuIEFjdGl2aXR5RmVlZEluY3JTeW5jOwp9KEFQSVN5bmMpKTsKZXhwb3J0IHsgQWN0aXZpdHlGZWVkSW5jclN5bmMgfTsKZXhwb3J0IGRlZmF1bHQgQWN0aXZpdHlGZWVkSW5jclN5bmM7Cg=="},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/worker/sync/ActivityFeedSync.ts","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/worker/sync/ActivityFeedSync.ts"],"names":[],"mappings":";;;;;;;;;;;;;AAAA,OAAO,MAAM,MAAM,QAAQ,CAAC;AAC5B,OAAO,EAAE,MAAM,EAAE,MAAM,aAAa,CAAC;AAErC,OAAO,EAAmB,kBAAkB,EAAE,MAAM,uBAAuB,CAAC;AAE5E,OAAO,EAAE,OAAO,EAAE,MAAM,WAAW,CAAC;AAEpC;IAA0C,wCAAiB;IAGzD,8BACE,GAA+C;QAA/C,oBAAA,EAAA,UAA2B,kBAAkB,EAAE;QADjD,YAGE,kBAAM,kBAAkB,EAAE,MAAM,CAAC,YAAY,EAAE,KAAK,CAAC,SAGtD;QADC,KAAI,CAAC,GAAG,GAAG,GAAG,CAAC;;IACjB,CAAC;IAES,4CAAa,GAAvB;QACE,OAAO,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IACpC,CAAC;IAES,6CAAc,GAAxB,UAAyB,MAAkB;QACzC,OAAO,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,WAAW,EAAE,CAAC;IACjE,CAAC;IACH,2BAAC;AAAD,CAAC,AAlBD,CAA0C,OAAO,GAkBhD;;AAED,eAAe,oBAAoB,CAAC","sourcesContent":["import moment from 'moment';\nimport { Stores } from '@src/lib/db';\nimport { Activity } from '@src/types';\nimport { ActivityFeedAPI, ActivityFeedClient } from '@src/api/activityFeed';\nimport { Observable } from 'rxjs';\nimport { APISync } from './APISync';\n\nexport class ActivityFeedIncrSync extends APISync<Activity> {\n  private api: ActivityFeedAPI;\n\n  constructor(\n    api: ActivityFeedAPI = new ActivityFeedClient(),\n  ) {\n    super('ActivityFeedSync', Stores.ActivityFeed, false);\n\n    this.api = api;\n  }\n\n  protected fetchNextPage(): Observable<Activity[]> {\n    return this.api.list(this.offset);\n  }\n\n  protected nextPageOffset(models: Activity[]): string {\n    return moment(models[models.length - 1].updated).toISOString();\n  }\n}\n\nexport default ActivityFeedIncrSync;\n"]}]}