{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/CommandControl/components/Calendar/Calendar.tsx","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/CommandControl/components/Calendar/Calendar.tsx","mtime":1675280253994},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewogICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewogICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAogICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKICAgIH07CiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwogICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQogICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKICAgIH07Cn0pKCk7CmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7CmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JzsKaW1wb3J0IENvbnRyb2xQb3BvdmVyIGZyb20gJy4uL2NvbXBvbmVudHMvQ29udHJvbFBvcG92ZXInOwppbXBvcnQgTXVsdGlEYXlWaWV3IGZyb20gJy4vY29tcG9uZW50cy9NdWx0aURheVZpZXcvTXVsdGlEYXlWaWV3JzsKaW1wb3J0IEV2ZW50RGV0YWlsIGZyb20gJy4vY29tcG9uZW50cy9FdmVudERldGFpbC9FdmVudERldGFpbCc7CmltcG9ydCBDYWxlbmRhckxpc3QgZnJvbSAnLi9jb21wb25lbnRzL0NhbGVuZGFyTGlzdC9DYWxlbmRhckxpc3QnOwppbXBvcnQgQ2FsZW5kYXJIZWFkZXIgZnJvbSAnLi9jb21wb25lbnRzL0NhbGVuZGFySGVhZGVyL0NhbGVuZGFySGVhZGVyJzsKaW1wb3J0IHsgQ29tbWFuZENvbnRyb2xUeXBlLCBFdmVudFJlY2lwaWVudFR5cGUsIH0gZnJvbSAnQHNyYy90eXBlcyc7CmltcG9ydCBDYWxlbmRhckljb24gZnJvbSAnQHNyYy9jb21wb25lbnRzL0ljb25zL0NhbGVuZGFyLnN2Zyc7CmltcG9ydCAnLi9DYWxlbmRhci5zY3NzJzsKaW1wb3J0IHsgc3RyaW5nVG9UaW1lQmxvY2sgfSBmcm9tICdAc3JjL2xpYi9kYXRldGltZSc7CmltcG9ydCB7IHBhcnNlQWRkcmVzcyB9IGZyb20gJ0BzcmMvbGliL2FkZHJlc3MnOwppbXBvcnQgeyBpc0VxdWFsLCBpc0VtcHR5LCBtYXAsIGZsYXR0ZW4sIGZvckVhY2ggfSBmcm9tICdsb2Rhc2gnOwppbXBvcnQgeyBnZXRFdmVudHNGb3JEYXRlIH0gZnJvbSAnQHNyYy9saWIvZXZlbnQnOwppbXBvcnQgS2V5Ym9hcmRTeW1ib2wgZnJvbSAnQHNyYy9jb21wb25lbnRzL0Jhc2UvS2V5Ym9hcmRTeW1ib2wvS2V5Ym9hcmRTeW1ib2wnOwppbXBvcnQgeyByZWNvcmRFdmVudCwgVXNlckV2ZW50cyB9IGZyb20gJ0BzcmMvbGliL2FuYWx5dGljcyc7CmltcG9ydCB7IGxvZ0FtcGxpdHVkZUV2ZW50LCBBbXBsaXR1ZGVFdmVudHMgfSBmcm9tICdAc3JjL2xpYi9hbXBsaXR1ZGUtYW5hbHl0aWNzJzsKaW1wb3J0IHsgQ2FsZW5kYXJFdmVudERpc3BsYXlTY29wZSB9IGZyb20gJ0BzcmMvZHVja3MvY2FsZW5kYXJzJzsKdmFyIExFRlRfU0lERV9XSURUSCA9IDMwMDsKdmFyIFJJR0hUX1BBRERJTkcgPSAyMCArIDcwOwp2YXIgTUlOX1BPUE9WRVJfV0lEVEggPSA4MDA7CnZhciBTVEFSVF9IT1VSID0gMDsKdmFyIEVORF9IT1VSID0gMjQ7CnZhciBDYWxlbmRhciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhDYWxlbmRhciwgX3N1cGVyKTsKICAgIGZ1bmN0aW9uIENhbGVuZGFyKHByb3BzKSB7CiAgICAgICAgdmFyIF9hOwogICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzOwogICAgICAgIF90aGlzLmhhbmRsZVJlc2l6ZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgY29sdW1uV2lkdGg6IE1hdGguZmxvb3IoKChNYXRoLm1heCh3aW5kb3cuaW5uZXJXaWR0aCwgTUlOX1BPUE9WRVJfV0lEVEgpICogLjgpCiAgICAgICAgICAgICAgICAgICAgLSBMRUZUX1NJREVfV0lEVEggLSBSSUdIVF9QQURESU5HKSAvIDUpLAogICAgICAgICAgICAgICAgd2luZG93V2lkdGg6IHdpbmRvdy5pbm5lcldpZHRoLAogICAgICAgICAgICAgICAgd2luZG93SGVpZ2h0OiB3aW5kb3cuaW5uZXJIZWlnaHQsCiAgICAgICAgICAgIH0pOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuY29udmVydENhbGVuZGFySW52aXRlVG9UaW1lQmxvY2sgPSBmdW5jdGlvbiAoY2FsSW52aXRlKSB7CiAgICAgICAgICAgIGlmICghY2FsSW52aXRlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICBzdGFydFRpbWU6IG1vbWVudChjYWxJbnZpdGUuc3RhcnQpLAogICAgICAgICAgICAgICAgZW5kVGltZTogbW9tZW50KGNhbEludml0ZS5lbmQpLAogICAgICAgICAgICAgICAgZXZlbnQ6IHsKICAgICAgICAgICAgICAgICAgICBuYW1lOiBjYWxJbnZpdGUubmFtZSwKICAgICAgICAgICAgICAgICAgICBub3RlczogY2FsSW52aXRlLm5vdGVzLAogICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uOiBjYWxJbnZpdGUubG9jYXRpb24sCiAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50czogY2FsSW52aXRlLnJlY2lwaWVudHMubWFwKGZ1bmN0aW9uIChyKSB7IHJldHVybiAoewogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBFdmVudFJlY2lwaWVudFR5cGUuQ29udGFjdCwKICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6IHIsCiAgICAgICAgICAgICAgICAgICAgICAgIGlkZW50aWZpZXI6IHBhcnNlQWRkcmVzcyhyKS5lbWFpbCwKICAgICAgICAgICAgICAgICAgICB9KTsgfSksCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9OwogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlUmVmID0gZnVuY3Rpb24gKHJlZikgewogICAgICAgICAgICBfdGhpcy5wb3BvdmVyID0gcmVmOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlVXBkYXRlVGltZUJsb2NrID0gZnVuY3Rpb24gKHRiKSB7CiAgICAgICAgICAgIHZhciBzZWxlY3RlZFRpbWVCbG9jayA9IF90aGlzLnN0YXRlLnNlbGVjdGVkVGltZUJsb2NrOwogICAgICAgICAgICB2YXIgX2EgPSBfdGhpcy5wcm9wcywgZHJhZnQgPSBfYS5kcmFmdCwgcmVhZE9ubHkgPSBfYS5yZWFkT25seTsKICAgICAgICAgICAgdmFyIHRpbWVibG9jayA9IHRiOwogICAgICAgICAgICBpZiAocmVhZE9ubHkpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBmaXJzdCB0aW1lIHNldHRpbmcgc2VsZWN0ZWRUaW1lQmxvY2sKICAgICAgICAgICAgaWYgKCFzZWxlY3RlZFRpbWVCbG9jayAmJiBkcmFmdCkgewogICAgICAgICAgICAgICAgdGltZWJsb2NrLmV2ZW50LnJlY2lwaWVudHMgPSBkcmFmdC5jYy5jb25jYXQoZHJhZnQudG8pLm1hcChmdW5jdGlvbiAoZSkgeyByZXR1cm4gKHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiBFdmVudFJlY2lwaWVudFR5cGUuQ29udGFjdCwKICAgICAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogZSwKICAgICAgICAgICAgICAgICAgICBpZGVudGlmaWVyOiBlLAogICAgICAgICAgICAgICAgfSk7IH0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsgc2VsZWN0ZWRUaW1lQmxvY2s6IHRpbWVibG9jaywgc2hvd0V2ZW50RGV0YWlsOiB0cnVlIH0pOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuZ2VuZXJhdGVDYWxlbmRhckV2ZW50cyA9IGZ1bmN0aW9uIChkYXRlUmFuZ2UsIHByb3BzLCBmb3JjZUhpZGRlbkNhbGVuZGFycykgewogICAgICAgICAgICB2YXIgZXZlbnRzID0ge307CiAgICAgICAgICAgIHZhciBoaWRkZW5DYWxlbmRhcnMgPSBmb3JjZUhpZGRlbkNhbGVuZGFycyB8fCBfdGhpcy5zdGF0ZS5oaWRkZW5DYWxlbmRhcnM7CiAgICAgICAgICAgIHZhciBjYWxlbmRhckV2ZW50cyA9IHByb3BzLmNhbGVuZGFyRXZlbnRzOwogICAgICAgICAgICB2YXIgYWNjb3VudEV2ZW50cyA9IFtdOwogICAgICAgICAgICBmb3JFYWNoKGNhbGVuZGFyRXZlbnRzLCBmdW5jdGlvbiAodmFsKSB7CiAgICAgICAgICAgICAgICBhY2NvdW50RXZlbnRzID0gYWNjb3VudEV2ZW50cy5jb25jYXQodmFsKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRhdGVSYW5nZS5mb3JFYWNoKGZ1bmN0aW9uIChkKSB7CiAgICAgICAgICAgICAgICBldmVudHNbZC5mb3JtYXQoJ01NLURELVlZWVknKV0gPSBnZXRFdmVudHNGb3JEYXRlKGQsIGFjY291bnRFdmVudHMsIFNUQVJUX0hPVVIsIEVORF9IT1VSLCBoaWRkZW5DYWxlbmRhcnMpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuIGV2ZW50czsKICAgICAgICB9OwogICAgICAgIF90aGlzLnJlbmRlckZvb3RlciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIHJlYWRPbmx5ID0gX3RoaXMucHJvcHMucmVhZE9ubHk7CiAgICAgICAgICAgIHZhciBkZXNjcmlwdGlvbiA9ICdDbGljayBvbiB5b3VyIGNhbGVuZGFyIHRvIHNlbGVjdCBhIG1lZXRpbmcgdGltZSc7CiAgICAgICAgICAgIGlmIChyZWFkT25seSkgewogICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAnVmlldyB0aGUgZXZlbnRzIHRoYXQgYXJlIG9uIHlvdXIgY2FsZW5kYXInOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiAoUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJjb250cm9sLWZvb3RlciIgfSwKICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIG51bGwsIGRlc2NyaXB0aW9uKSwKICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIG51bGwsCiAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChLZXlib2FyZFN5bWJvbCwgeyBjaGFyYWN0ZXI6ICJcdTIzOEIgKGVzYykiIH0pLAogICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCBudWxsLCAidG8gZGlzbWlzcyIpKSkpOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlU3RhcnREYXRlQ2hhbmdlID0gZnVuY3Rpb24gKG5ld1N0YXJ0RGF0ZSkgewogICAgICAgICAgICB2YXIgbGlzdENhbGVuZGFyRXZlbnRzID0gX3RoaXMucHJvcHMubGlzdENhbGVuZGFyRXZlbnRzOwogICAgICAgICAgICB2YXIgc3RhcnREYXRlID0gbmV3U3RhcnREYXRlLmNsb25lKCk7CiAgICAgICAgICAgIHZhciBlbmREYXRlID0gbmV3U3RhcnREYXRlLmNsb25lKCkuYWRkKDQsICdkYXlzJyk7CiAgICAgICAgICAgIHZhciBkYXRlUmFuZ2UgPSBfdGhpcy5nZW5lcmF0ZURhdGVSYW5nZShzdGFydERhdGUsIGVuZERhdGUpOwogICAgICAgICAgICBsaXN0Q2FsZW5kYXJFdmVudHMoewogICAgICAgICAgICAgICAgc3RhcnQ6IHN0YXJ0RGF0ZS50b0RhdGUoKSwKICAgICAgICAgICAgICAgIGVuZDogZW5kRGF0ZS50b0RhdGUoKSwKICAgICAgICAgICAgICAgIHNjb3BlOiBDYWxlbmRhckV2ZW50RGlzcGxheVNjb3BlLkNvbW1hbmQsCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICBzdGFydERhdGU6IHN0YXJ0RGF0ZSwKICAgICAgICAgICAgICAgIGVuZERhdGU6IGVuZERhdGUsCiAgICAgICAgICAgICAgICBjYWxlbmRhckV2ZW50czogX3RoaXMuZ2VuZXJhdGVDYWxlbmRhckV2ZW50cyhkYXRlUmFuZ2UsIF90aGlzLnByb3BzKSwKICAgICAgICAgICAgICAgIGRhdGVSYW5nZTogZGF0ZVJhbmdlLAogICAgICAgICAgICB9KTsKICAgICAgICB9OwogICAgICAgIF90aGlzLmhhbmRsZUV2ZW50VXBkYXRlID0gZnVuY3Rpb24gKHByb3BlcnR5LCB2YWx1ZSkgewogICAgICAgICAgICB2YXIgX2EgPSBfdGhpcy5zdGF0ZSwgc2VsZWN0ZWRUaW1lQmxvY2sgPSBfYS5zZWxlY3RlZFRpbWVCbG9jaywgc3RhcnREYXRlID0gX2Euc3RhcnREYXRlLCBlbmREYXRlID0gX2EuZW5kRGF0ZTsKICAgICAgICAgICAgaWYgKHNlbGVjdGVkVGltZUJsb2NrKSB7CiAgICAgICAgICAgICAgICB2YXIgZXZlbnQgPSBzZWxlY3RlZFRpbWVCbG9jay5ldmVudDsKICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICAgICAgICAgICAgZXZlbnRbcHJvcGVydHldID0gdmFsdWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmIChwcm9wZXJ0eSA9PT0gJ3JlY2lwaWVudHMnKSB7CiAgICAgICAgICAgICAgICAgICAgZXZlbnRbcHJvcGVydHldID0gdmFsdWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRUaW1lQmxvY2s6IHsKICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRUaW1lOiBwcm9wZXJ0eSA9PT0gJ3N0YXJ0VGltZScgJiYKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0RGF0ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jbG9uZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN0YXJ0T2YoJ2RheScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmlzU2FtZU9yQmVmb3JlKHZhbHVlKSAmJgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kRGF0ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jbG9uZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmVuZE9mKCdkYXknKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5pc1NhbWVPckFmdGVyKHZhbHVlKSAmJgogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRUaW1lQmxvY2suZW5kVGltZS5pc0FmdGVyKHZhbHVlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB2YWx1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBzZWxlY3RlZFRpbWVCbG9jay5zdGFydFRpbWUsCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZFRpbWU6IHByb3BlcnR5ID09PSAnZW5kVGltZScgJiYKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0RGF0ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jbG9uZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN0YXJ0T2YoJ2RheScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmlzU2FtZU9yQmVmb3JlKHZhbHVlKSAmJgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kRGF0ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jbG9uZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmVuZE9mKCdkYXknKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5pc1NhbWVPckFmdGVyKHZhbHVlKSAmJgogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRUaW1lQmxvY2suc3RhcnRUaW1lLmlzQmVmb3JlKHZhbHVlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB2YWx1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBzZWxlY3RlZFRpbWVCbG9jay5lbmRUaW1lLAogICAgICAgICAgICAgICAgICAgICAgICBldmVudDogZXZlbnQsCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5oYW5kbGVBZGQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGlmIChfdGhpcy5zdGF0ZS5zZWxlY3RlZFRpbWVCbG9jaykgewogICAgICAgICAgICAgICAgX3RoaXMucHJvcHMuYWRkQ2FsZW5kYXJJbnZpdGVUb0RyYWZ0KF90aGlzLnN0YXRlLnNlbGVjdGVkVGltZUJsb2NrKTsKICAgICAgICAgICAgICAgIF90aGlzLnBvcG92ZXIuaGlkZSgpOwogICAgICAgICAgICAgICAgX3RoaXMucHJvcHMub25IaWRlKCk7CiAgICAgICAgICAgICAgICBsb2dBbXBsaXR1ZGVFdmVudChBbXBsaXR1ZGVFdmVudHMuU2VuZENhbGVuZGFySW52aXRlKTsKICAgICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlQ2FsZW5kYXJDbGljayA9IGZ1bmN0aW9uIChjYWxlbmRhcikgewogICAgICAgICAgICB2YXIgdG9nZ2xlQ2FsZW5kYXJIaWRlID0gX3RoaXMucHJvcHMudG9nZ2xlQ2FsZW5kYXJIaWRlOwogICAgICAgICAgICB0b2dnbGVDYWxlbmRhckhpZGUoY2FsZW5kYXIpOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlSW5wdXRSZWYgPSBmdW5jdGlvbiAocmVmKSB7CiAgICAgICAgICAgIF90aGlzLmlucHV0ID0gcmVmOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlQ2FsZW5kYXJOb2RlUmVmID0gZnVuY3Rpb24gKHJlZikgewogICAgICAgICAgICBfdGhpcy5jYWxlbmRhck5vZGUgPSByZWY7CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5oYW5kbGVJbnB1dFN1Ym1pdCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIGRyYWZ0ID0gX3RoaXMucHJvcHMuZHJhZnQ7CiAgICAgICAgICAgIHZhciBzZWxlY3RlZFRpbWVCbG9jayA9IHN0cmluZ1RvVGltZUJsb2NrKF90aGlzLmlucHV0LnZhbHVlKTsKICAgICAgICAgICAgaWYgKGRyYWZ0KSB7CiAgICAgICAgICAgICAgICBzZWxlY3RlZFRpbWVCbG9jay5ldmVudC5yZWNpcGllbnRzID0gZHJhZnQuY2MuY29uY2F0KGRyYWZ0LnRvKS5tYXAoZnVuY3Rpb24gKGUpIHsgcmV0dXJuICh7CiAgICAgICAgICAgICAgICAgICAgdHlwZTogRXZlbnRSZWNpcGllbnRUeXBlLkNvbnRhY3QsCiAgICAgICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6IGUsCiAgICAgICAgICAgICAgICAgICAgaWRlbnRpZmllcjogZSwKICAgICAgICAgICAgICAgIH0pOyB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgICB2YXIgc3RhcnREYXRlID0gc2VsZWN0ZWRUaW1lQmxvY2suc3RhcnRUaW1lLmNsb25lKCk7CiAgICAgICAgICAgIHZhciBlbmREYXRlID0gc2VsZWN0ZWRUaW1lQmxvY2suc3RhcnRUaW1lLmNsb25lKCkuYWRkKDQsICdkYXlzJyk7CiAgICAgICAgICAgIHZhciBkYXRlUmFuZ2UgPSBfdGhpcy5nZW5lcmF0ZURhdGVSYW5nZShzdGFydERhdGUsIGVuZERhdGUpOwogICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICBzZWxlY3RlZFRpbWVCbG9jazogc2VsZWN0ZWRUaW1lQmxvY2ssCiAgICAgICAgICAgICAgICBzaG93RXZlbnREZXRhaWw6IHRydWUsCiAgICAgICAgICAgICAgICBzdGFydERhdGU6IHN0YXJ0RGF0ZSwKICAgICAgICAgICAgICAgIGVuZERhdGU6IGVuZERhdGUsCiAgICAgICAgICAgICAgICBkYXRlUmFuZ2U6IGRhdGVSYW5nZSwKICAgICAgICAgICAgICAgIGNhbGVuZGFyRXZlbnRzOiBfdGhpcy5nZW5lcmF0ZUNhbGVuZGFyRXZlbnRzKGRhdGVSYW5nZSwgX3RoaXMucHJvcHMpLAogICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuY2FsZW5kYXJOb2RlKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGUgPSBfdGhpcy5jYWxlbmRhck5vZGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnc2VsZWN0ZWQtZXZlbnQnKVswXTsKICAgICAgICAgICAgICAgICAgICBpZiAobm9kZSkgewogICAgICAgICAgICAgICAgICAgICAgICBub2RlLnNjcm9sbEludG9WaWV3KCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9OwogICAgICAgIF90aGlzLmdlbmVyYXRlRGF0ZVJhbmdlID0gZnVuY3Rpb24gKHN0YXJ0RGF0ZSwgZW5kRGF0ZSkgewogICAgICAgICAgICB2YXIgc3RhcnQgPSBzdGFydERhdGUuY2xvbmUoKS5zdGFydE9mKCdkYXknKTsKICAgICAgICAgICAgdmFyIGVuZCA9IGVuZERhdGUuY2xvbmUoKS5zdGFydE9mKCdkYXknKTsKICAgICAgICAgICAgdmFyIGRhdGVSYW5nZSA9IFtdOwogICAgICAgICAgICB3aGlsZSAoc3RhcnQuaXNTYW1lT3JCZWZvcmUoZW5kKSkgewogICAgICAgICAgICAgICAgZGF0ZVJhbmdlLnB1c2goc3RhcnQuY2xvbmUoKSk7CiAgICAgICAgICAgICAgICBzdGFydC5hZGQoMSwgJ2RheScpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBkYXRlUmFuZ2U7CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5yZW5kZXJNYWluID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgX2EgPSBfdGhpcy5wcm9wcywgZHJhZnQgPSBfYS5kcmFmdCwgcmVhZE9ubHkgPSBfYS5yZWFkT25seTsKICAgICAgICAgICAgdmFyIF9iID0gX3RoaXMuc3RhdGUsIHN0YXJ0RGF0ZSA9IF9iLnN0YXJ0RGF0ZSwgZW5kRGF0ZSA9IF9iLmVuZERhdGUsIHNlbGVjdGVkVGltZUJsb2NrID0gX2Iuc2VsZWN0ZWRUaW1lQmxvY2ssIHNob3dFdmVudERldGFpbCA9IF9iLnNob3dFdmVudERldGFpbCwgaGlkZGVuQ2FsZW5kYXJzID0gX2IuaGlkZGVuQ2FsZW5kYXJzLCBjYWxlbmRhcnMgPSBfYi5jYWxlbmRhcnMsIGNvbHVtbldpZHRoID0gX2IuY29sdW1uV2lkdGgsIGNhbGVuZGFyRXZlbnRzID0gX2IuY2FsZW5kYXJFdmVudHMsIGRhdGVSYW5nZSA9IF9iLmRhdGVSYW5nZTsKICAgICAgICAgICAgdmFyIHRpdGxlID0gISEoZHJhZnQgPT09IG51bGwgfHwgZHJhZnQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGRyYWZ0LmNhbGVuZGFySW52aXRlKSA/ICdVcGRhdGUgQ2FsZW5kYXIgSW52aXRlJyA6ICdBZGQgQ2FsZW5kYXIgSW52aXRlJzsKICAgICAgICAgICAgaWYgKHJlYWRPbmx5KSB7CiAgICAgICAgICAgICAgICB0aXRsZSA9ICdZb3VyIENhbGVuZGFyIEV2ZW50cyc7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIChSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogIm1haW4iIH0sCiAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImxlZnQiLCBzdHlsZTogeyB3aWR0aDogTEVGVF9TSURFX1dJRFRIIH0gfSwKICAgICAgICAgICAgICAgICAgICAoIXNlbGVjdGVkVGltZUJsb2NrIHx8ICFzaG93RXZlbnREZXRhaWwpICYmIChSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogIm1vbnRoLWNhbGVuZGFycyIgfSwKICAgICAgICAgICAgICAgICAgICAgICAgIXJlYWRPbmx5ICYmIChSZWFjdC5jcmVhdGVFbGVtZW50KCJmb3JtIiwgeyBvblN1Ym1pdDogX3RoaXMuaGFuZGxlSW5wdXRTdWJtaXQgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImlucHV0IiwgeyBkaXI6ICJhdXRvIiwgY2xhc3NOYW1lOiAiY29udHJvbC1pbnB1dCIsIHBsYWNlaG9sZGVyOiAiTWVldGluZyBhdCAxMWFtIG5leHQgRnJpZGF5IiwgcmVmOiBfdGhpcy5oYW5kbGVJbnB1dFJlZiwgYXV0b0ZvY3VzOiB0cnVlIH0pKSksCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGVuZGFycyAmJiAoUmVhY3QuY3JlYXRlRWxlbWVudChDYWxlbmRhckxpc3QsIHsgY2FsZW5kYXJzOiBjYWxlbmRhcnMsIG9uQ2FsZW5kYXJDbGljazogX3RoaXMuaGFuZGxlQ2FsZW5kYXJDbGljaywgaGlkZGVuQ2FsZW5kYXJzOiBoaWRkZW5DYWxlbmRhcnMgfSkpKSksCiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRUaW1lQmxvY2sgJiYKICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0V2ZW50RGV0YWlsICYmIChSZWFjdC5jcmVhdGVFbGVtZW50KEV2ZW50RGV0YWlsLCB7IG5hbWU6IHNlbGVjdGVkVGltZUJsb2NrLmV2ZW50Lm5hbWUsIHJlY2lwaWVudHM6IHNlbGVjdGVkVGltZUJsb2NrLmV2ZW50LnJlY2lwaWVudHMsIG5vdGVzOiBzZWxlY3RlZFRpbWVCbG9jay5ldmVudC5ub3Rlcywgb25VcGRhdGU6IF90aGlzLmhhbmRsZUV2ZW50VXBkYXRlLCBzdGFydFRpbWU6IHNlbGVjdGVkVGltZUJsb2NrLnN0YXJ0VGltZSwgZW5kVGltZTogc2VsZWN0ZWRUaW1lQmxvY2suZW5kVGltZSwgb25BZGQ6IF90aGlzLmhhbmRsZUFkZCwgY3RhVGV4dDogdGl0bGUsIGxvY2F0aW9uOiBzZWxlY3RlZFRpbWVCbG9jay5ldmVudC5sb2NhdGlvbiB9KSkpLAogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJyaWdodCIsIHJlZjogX3RoaXMuaGFuZGxlQ2FsZW5kYXJOb2RlUmVmIH0sCiAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChDYWxlbmRhckhlYWRlciwgeyBzdGFydERhdGU6IHN0YXJ0RGF0ZSwgZW5kRGF0ZTogZW5kRGF0ZSwgb25TdGFydERhdGVDaGFuZ2U6IF90aGlzLmhhbmRsZVN0YXJ0RGF0ZUNoYW5nZSwgY29sdW1uV2lkdGg6IGNvbHVtbldpZHRoLCBkYXRlUmFuZ2U6IGRhdGVSYW5nZSwgZXZlbnRzOiBjYWxlbmRhckV2ZW50cyB9KSwKICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KE11bHRpRGF5VmlldywgeyBzdGFydERhdGU6IHN0YXJ0RGF0ZSwgZW5kRGF0ZTogZW5kRGF0ZSwgc3RhcnRIb3VyOiBNYXRoLm1pbihzdGFydERhdGUuaG91cigpLCBTVEFSVF9IT1VSKSwgZW5kSG91cjogRU5EX0hPVVIsIHNlbGVjdGVkVGltZUJsb2NrOiBzZWxlY3RlZFRpbWVCbG9jaywgb25VcGRhdGVUaW1lQmxvY2s6IF90aGlzLmhhbmRsZVVwZGF0ZVRpbWVCbG9jaywgaGlkZGVuQ2FsZW5kYXJzOiBoaWRkZW5DYWxlbmRhcnMsIGNvbHVtbldpZHRoOiBjb2x1bW5XaWR0aCwgZGF0ZVJhbmdlOiBkYXRlUmFuZ2UsIGV2ZW50czogY2FsZW5kYXJFdmVudHMsIHJlYWRPbmx5OiAhZHJhZnQgfSkpKSk7CiAgICAgICAgfTsKICAgICAgICB2YXIgc3RhcnREYXRlID0gKChfYSA9IHByb3BzLmRyYWZ0KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuY2FsZW5kYXJJbnZpdGUpID8KICAgICAgICAgICAgbW9tZW50KHByb3BzLmRyYWZ0LmNhbGVuZGFySW52aXRlLnN0YXJ0KSA6IG1vbWVudCgpLnN0YXJ0T2YoJ2RheScpOwogICAgICAgIHZhciBlbmREYXRlID0gc3RhcnREYXRlLmNsb25lKCkuYWRkKDQsICdkYXlzJyk7CiAgICAgICAgdmFyIGRhdGVSYW5nZSA9IF90aGlzLmdlbmVyYXRlRGF0ZVJhbmdlKHN0YXJ0RGF0ZSwgZW5kRGF0ZSk7CiAgICAgICAgdmFyIGNhbGVuZGFycyA9IHByb3BzLmFjY291bnQgPyBwcm9wcy5jYWxlbmRhcnNbcHJvcHMuYWNjb3VudF0gOgogICAgICAgICAgICBmbGF0dGVuKG1hcChwcm9wcy5jYWxlbmRhcnMsIGZ1bmN0aW9uIChjKSB7IHJldHVybiBjOyB9KSk7CiAgICAgICAgdmFyIGhpZGRlbkNhbGVuZGFycyA9IGNhbGVuZGFycyA/IGNhbGVuZGFycy5maWx0ZXIoZnVuY3Rpb24gKGMpIHsgcmV0dXJuIGMuaGlkZGVuOyB9KS5tYXAoZnVuY3Rpb24gKGMpIHsgcmV0dXJuIGMuaWQ7IH0pIDogW107CiAgICAgICAgX3RoaXMuc3RhdGUgPSB7CiAgICAgICAgICAgIHN0YXJ0RGF0ZTogc3RhcnREYXRlLAogICAgICAgICAgICBlbmREYXRlOiBlbmREYXRlLAogICAgICAgICAgICBzaG93RXZlbnREZXRhaWw6IHByb3BzLmRyYWZ0ICYmIHByb3BzLmRyYWZ0LmNhbGVuZGFySW52aXRlID8gdHJ1ZSA6IGZhbHNlLAogICAgICAgICAgICBzZWxlY3RlZFRpbWVCbG9jazogcHJvcHMuZHJhZnQKICAgICAgICAgICAgICAgID8gX3RoaXMuY29udmVydENhbGVuZGFySW52aXRlVG9UaW1lQmxvY2socHJvcHMuZHJhZnQuY2FsZW5kYXJJbnZpdGUpCiAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZCwKICAgICAgICAgICAgaGlkZGVuQ2FsZW5kYXJzOiBoaWRkZW5DYWxlbmRhcnMsCiAgICAgICAgICAgIGNhbGVuZGFyRXZlbnRzOiBfdGhpcy5nZW5lcmF0ZUNhbGVuZGFyRXZlbnRzKGRhdGVSYW5nZSwgcHJvcHMsIGhpZGRlbkNhbGVuZGFycyksCiAgICAgICAgICAgIGNvbHVtbldpZHRoOiBNYXRoLmZsb29yKCgoTWF0aC5tYXgod2luZG93LmlubmVyV2lkdGgsIE1JTl9QT1BPVkVSX1dJRFRIKSAqIC44KQogICAgICAgICAgICAgICAgLSBMRUZUX1NJREVfV0lEVEggLSBSSUdIVF9QQURESU5HKSAvIDUpLAogICAgICAgICAgICB3aW5kb3dXaWR0aDogd2luZG93LmlubmVyV2lkdGgsCiAgICAgICAgICAgIHdpbmRvd0hlaWdodDogd2luZG93LmlubmVySGVpZ2h0LAogICAgICAgICAgICBkYXRlUmFuZ2U6IGRhdGVSYW5nZSwKICAgICAgICAgICAgY2FsZW5kYXJzOiBjYWxlbmRhcnMsCiAgICAgICAgfTsKICAgICAgICByZXR1cm4gX3RoaXM7CiAgICB9CiAgICBDYWxlbmRhci5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgICB2YXIgX2EgPSB0aGlzLnByb3BzLCBsaXN0Q2FsZW5kYXJzID0gX2EubGlzdENhbGVuZGFycywgYWNjb3VudCA9IF9hLmFjY291bnQsIGxpc3RDYWxlbmRhckV2ZW50cyA9IF9hLmxpc3RDYWxlbmRhckV2ZW50czsKICAgICAgICB2YXIgX2IgPSB0aGlzLnN0YXRlLCBzdGFydERhdGUgPSBfYi5zdGFydERhdGUsIGVuZERhdGUgPSBfYi5lbmREYXRlOwogICAgICAgIC8vIEFsd2F5cyBmZXRjaCBjYWxlbmRhcnMgb24gbW91bnQKICAgICAgICBsaXN0Q2FsZW5kYXJzKGFjY291bnQpOwogICAgICAgIGxpc3RDYWxlbmRhckV2ZW50cyh7CiAgICAgICAgICAgIHN0YXJ0OiBzdGFydERhdGUudG9EYXRlKCksCiAgICAgICAgICAgIGVuZDogZW5kRGF0ZS50b0RhdGUoKSwKICAgICAgICAgICAgc2NvcGU6IENhbGVuZGFyRXZlbnREaXNwbGF5U2NvcGUuQ29tbWFuZCwKICAgICAgICB9KTsKICAgICAgICAvLyBUcmFjayBDYWxlbmRhciBPcGVuCiAgICAgICAgcmVjb3JkRXZlbnQoVXNlckV2ZW50cy5DYWxlbmRhclZpZXdlZCk7CiAgICAgICAgdGhpcy50aW1lb3V0ID0gZ2xvYmFsLnNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgbm9kZSA9IF90aGlzLmNhbGVuZGFyTm9kZSAmJgogICAgICAgICAgICAgICAgX3RoaXMuY2FsZW5kYXJOb2RlLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3NlbGVjdGVkLWV2ZW50JylbMF07CiAgICAgICAgICAgIGlmIChub2RlKSB7CiAgICAgICAgICAgICAgICBub2RlLnNjcm9sbEludG9WaWV3KCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKF90aGlzLmlucHV0KSB7CiAgICAgICAgICAgICAgICBfdGhpcy5pbnB1dC5mb2N1cygpOwogICAgICAgICAgICB9CiAgICAgICAgfSwgMCk7CiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMuaGFuZGxlUmVzaXplKTsKICAgIH07CiAgICBDYWxlbmRhci5wcm90b3R5cGUuY29tcG9uZW50V2lsbFVubW91bnQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKHRoaXMudGltZW91dCkgewogICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lb3V0KTsKICAgICAgICB9CiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMuaGFuZGxlUmVzaXplKTsKICAgIH07CiAgICBDYWxlbmRhci5wcm90b3R5cGUuVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMgPSBmdW5jdGlvbiAobmV4dFByb3BzKSB7CiAgICAgICAgdmFyIG5ld1N0YXRlID0ge307CiAgICAgICAgdmFyIGRhdGVSYW5nZSA9IHRoaXMuc3RhdGUuZGF0ZVJhbmdlOwogICAgICAgIHZhciBuZXh0RHJhZnQgPSBuZXh0UHJvcHMuZHJhZnQ7CiAgICAgICAgdmFyIHRoaXNEcmFmdCA9IHRoaXMucHJvcHMuZHJhZnQ7CiAgICAgICAgaWYgKCEhbmV4dERyYWZ0ICYmICEhdGhpc0RyYWZ0ICYmCiAgICAgICAgICAgIHRoaXNEcmFmdCAhPT0gbmV4dERyYWZ0ICYmCiAgICAgICAgICAgIGlzRXF1YWwobmV4dERyYWZ0ID09PSBudWxsIHx8IG5leHREcmFmdCA9PT0gdm9pZCAwID8gdm9pZCAwIDogbmV4dERyYWZ0LmNhbGVuZGFySW52aXRlLCB0aGlzRHJhZnQgPT09IG51bGwgfHwgdGhpc0RyYWZ0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiB0aGlzRHJhZnQuY2FsZW5kYXJJbnZpdGUpKSB7CiAgICAgICAgICAgIG5ld1N0YXRlLnNlbGVjdGVkVGltZUJsb2NrID0gbmV4dFByb3BzLmRyYWZ0CiAgICAgICAgICAgICAgICA/IHRoaXMuY29udmVydENhbGVuZGFySW52aXRlVG9UaW1lQmxvY2sobmV4dFByb3BzLmRyYWZ0LmNhbGVuZGFySW52aXRlKQogICAgICAgICAgICAgICAgOiB1bmRlZmluZWQ7CiAgICAgICAgfQogICAgICAgIGlmIChuZXh0UHJvcHMuY2FsZW5kYXJzICYmIG5leHRQcm9wcy5jYWxlbmRhcnMgIT09IHRoaXMucHJvcHMuY2FsZW5kYXJzKSB7CiAgICAgICAgICAgIHZhciBjYWxlbmRhcnMgPSB2b2lkIDA7CiAgICAgICAgICAgIGlmIChuZXh0UHJvcHMuYWNjb3VudCkgewogICAgICAgICAgICAgICAgY2FsZW5kYXJzID0gbmV4dFByb3BzLmNhbGVuZGFyc1tuZXh0UHJvcHMuYWNjb3VudF07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBjYWxlbmRhcnMgPSBPYmplY3Qua2V5cyhuZXh0UHJvcHMuY2FsZW5kYXJzKS5sZW5ndGgKICAgICAgICAgICAgICAgICAgICA/IGZsYXR0ZW4obWFwKG5leHRQcm9wcy5jYWxlbmRhcnMsIGZ1bmN0aW9uIChjKSB7IHJldHVybiBjOyB9KSkKICAgICAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZDsKICAgICAgICAgICAgfQogICAgICAgICAgICBuZXdTdGF0ZS5jYWxlbmRhcnMgPSBjYWxlbmRhcnM7CiAgICAgICAgICAgIG5ld1N0YXRlLmhpZGRlbkNhbGVuZGFycyA9IGNhbGVuZGFycyA/CiAgICAgICAgICAgICAgICBjYWxlbmRhcnMuZmlsdGVyKGZ1bmN0aW9uIChjKSB7IHJldHVybiAhIWMuaGlkZGVuOyB9KS5tYXAoZnVuY3Rpb24gKGMpIHsgcmV0dXJuIGMuaWQ7IH0pIDogdW5kZWZpbmVkOwogICAgICAgIH0KICAgICAgICBpZiAoKG5leHRQcm9wcy5jYWxlbmRhckV2ZW50cyAmJiB0aGlzLnByb3BzLmNhbGVuZGFyRXZlbnRzICE9PSBuZXh0UHJvcHMuY2FsZW5kYXJFdmVudHMpIHx8CiAgICAgICAgICAgIG5ld1N0YXRlLmhpZGRlbkNhbGVuZGFycykgewogICAgICAgICAgICBuZXdTdGF0ZS5jYWxlbmRhckV2ZW50cyA9IHRoaXMuZ2VuZXJhdGVDYWxlbmRhckV2ZW50cyhkYXRlUmFuZ2UsIG5leHRQcm9wcywgbmV3U3RhdGUuaGlkZGVuQ2FsZW5kYXJzKTsKICAgICAgICB9CiAgICAgICAgaWYgKCFpc0VtcHR5KG5ld1N0YXRlKSkgewogICAgICAgICAgICB0aGlzLnNldFN0YXRlKG5ld1N0YXRlKTsKICAgICAgICB9CiAgICB9OwogICAgQ2FsZW5kYXIucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgX2EgPSB0aGlzLnByb3BzLCBvbkhpZGUgPSBfYS5vbkhpZGUsIHJlYWRPbmx5ID0gX2EucmVhZE9ubHksIGRyYWZ0ID0gX2EuZHJhZnQ7CiAgICAgICAgdmFyIF9iID0gdGhpcy5zdGF0ZSwgd2luZG93V2lkdGggPSBfYi53aW5kb3dXaWR0aCwgd2luZG93SGVpZ2h0ID0gX2Iud2luZG93SGVpZ2h0OwogICAgICAgIHZhciB0aXRsZSA9ICEhKGRyYWZ0ID09PSBudWxsIHx8IGRyYWZ0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBkcmFmdC5jYWxlbmRhckludml0ZSkgPyAnVXBkYXRlIENhbGVuZGFyIEludml0ZScgOiAnQWRkIENhbGVuZGFyIEludml0ZSc7CiAgICAgICAgaWYgKHJlYWRPbmx5KSB7CiAgICAgICAgICAgIHRpdGxlID0gJ1lvdXIgQ2FsZW5kYXIgRXZlbnRzJzsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIChSZWFjdC5jcmVhdGVFbGVtZW50KENvbnRyb2xQb3BvdmVyLCB7IGNsYXNzTmFtZTogImNhbGVuZGFyLXBvcG92ZXIiLCB0eXBlOiBDb21tYW5kQ29udHJvbFR5cGUuQ2FsZW5kYXIsIGljb246IFJlYWN0LmNyZWF0ZUVsZW1lbnQoQ2FsZW5kYXJJY29uLCB7IHdpZHRoOiAiMTRweCIsIGhlaWdodDogIjE0cHgiIH0pLCBoZWFkaW5nOiB0aXRsZSwgb3B0aW9uczogW10sIG9uSGlkZTogb25IaWRlLCByZWY6IHRoaXMuaGFuZGxlUmVmLCByZW5kZXJNYWluOiB0aGlzLnJlbmRlck1haW4sIHJlbmRlckZvb3RlcjogdGhpcy5yZW5kZXJGb290ZXIsIHBsYWNlaG9sZGVyOiAiU3RhbmR1cCBhdCAxMXBtIG9uIEZyaWRheSIsIHN0eWxlOiB7CiAgICAgICAgICAgICAgICBtaW5XaWR0aDogTUlOX1BPUE9WRVJfV0lEVEgsCiAgICAgICAgICAgICAgICB3aWR0aDogd2luZG93V2lkdGggKiAuOCwKICAgICAgICAgICAgICAgIGhlaWdodDogd2luZG93SGVpZ2h0ICogLjgsCiAgICAgICAgICAgICAgICB0b3A6ICh3aW5kb3dIZWlnaHQgKiAuNSkgLSAod2luZG93SGVpZ2h0ICogLjQpLAogICAgICAgICAgICB9LCBzaG93T25Nb3VudDogdHJ1ZSwgaGlkZUlucHV0OiB0cnVlIH0pKTsKICAgIH07CiAgICByZXR1cm4gQ2FsZW5kYXI7Cn0oUmVhY3QuUHVyZUNvbXBvbmVudCkpOwpleHBvcnQgZGVmYXVsdCBDYWxlbmRhcjsK"},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/CommandControl/components/Calendar/Calendar.tsx","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/CommandControl/components/Calendar/Calendar.tsx"],"names":[],"mappings":"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","sourcesContent":["import React from 'react';\nimport moment, { Moment } from 'moment';\n\nimport ControlPopover from '../components/ControlPopover';\nimport MultiDayView from './components/MultiDayView/MultiDayView';\nimport EventDetail from './components/EventDetail/EventDetail';\nimport CalendarList from './components/CalendarList/CalendarList';\nimport CalendarHeader from './components/CalendarHeader/CalendarHeader';\n\nimport {\n  CommandControlType,\n  TimeBlock,\n  Event as EventType,\n  Thread,\n  EventRecipientType,\n  EventRecipient,\n  Draft,\n  DraftCalendarInvite,\n  Calendar as CalendarType,\n  CalendarEvent,\n} from '@src/types';\nimport CalendarIcon from '@src/components/Icons/Calendar.svg';\n\nimport './Calendar.scss';\nimport { stringToTimeBlock } from '@src/lib/datetime';\nimport { parseAddress } from '@src/lib/address';\nimport { isEqual, isEmpty, map, flatten, forEach } from 'lodash';\nimport { getEventsForDate } from '@src/lib/event';\nimport KeyboardSymbol from '@src/components/Base/KeyboardSymbol/KeyboardSymbol';\nimport { recordEvent, UserEvents } from '@src/lib/analytics';\nimport { logAmplitudeEvent, AmplitudeEvents } from '@src/lib/amplitude-analytics';\nimport { CalendarEventRangeMeta, CalendarEventDisplayScope } from '@src/ducks/calendars';\n\nexport interface Props {\n  isDefault: boolean;\n  onHide: () => void;\n}\n\nexport interface StateProps {\n  selectedThread?: Thread;\n  draft?: Draft;\n  account?: string;\n  calendars: {\n    [account: string]: CalendarType[];\n  };\n  calendarEvents: {\n    [account: string]: CalendarEvent[];\n  };\n  readOnly?: boolean;\n}\n\nexport interface DispatchProps {\n  addCalendarInviteToDraft: (timeblock: TimeBlock) => void;\n  listCalendars: (accounts?: string) => void;\n  toggleCalendarHide: (calendar: string) => void;\n  listCalendarEvents: (range: CalendarEventRangeMeta) => void;\n}\n\ninterface State {\n  startDate: Moment;\n  endDate: Moment;\n  selectedTimeBlock?: TimeBlock;\n  showEventDetail: boolean;\n  hiddenCalendars: string[];\n  calendarEvents: { [date: string]: CalendarEvent[] };\n  calendars?: CalendarType[];\n  columnWidth: number;\n  windowWidth: number;\n  windowHeight: number;\n  dateRange: Moment[];\n}\n\nconst LEFT_SIDE_WIDTH = 300;\nconst RIGHT_PADDING = 20 + 70;\nconst MIN_POPOVER_WIDTH = 800;\nconst START_HOUR = 0;\nconst END_HOUR = 24;\n\nclass Calendar extends React.PureComponent<Props & StateProps & DispatchProps, State> {\n  private popover: ControlPopover;\n  private input: HTMLInputElement;\n  private timeout: NodeJS.Timer;\n  private calendarNode: HTMLDivElement;\n\n  constructor(props: Props & StateProps & DispatchProps) {\n    super(props);\n\n    const startDate = props.draft?.calendarInvite ?\n      moment(props.draft.calendarInvite.start) : moment().startOf('day');\n    const endDate = startDate.clone().add(4, 'days');\n    const dateRange = this.generateDateRange(startDate, endDate);\n    const calendars = props.account ? props.calendars[props.account] :\n      flatten(map(props.calendars, c => c));\n    const hiddenCalendars = calendars ? calendars.filter(c => c.hidden).map(c => c.id) : [];\n\n    this.state = {\n      startDate,\n      endDate,\n      showEventDetail: props.draft && props.draft.calendarInvite ? true : false,\n      selectedTimeBlock: props.draft\n        ? this.convertCalendarInviteToTimeBlock(props.draft.calendarInvite)\n        : undefined,\n      hiddenCalendars,\n      calendarEvents: this.generateCalendarEvents(dateRange, props, hiddenCalendars),\n      columnWidth: Math.floor(((Math.max(window.innerWidth, MIN_POPOVER_WIDTH) * .8)\n        - LEFT_SIDE_WIDTH - RIGHT_PADDING) / 5),\n      windowWidth: window.innerWidth,\n      windowHeight: window.innerHeight,\n      dateRange,\n      calendars,\n    };\n  }\n\n  componentDidMount() {\n    const { listCalendars, account, listCalendarEvents } = this.props;\n    const { startDate, endDate } = this.state;\n\n    // Always fetch calendars on mount\n    listCalendars(account);\n\n    listCalendarEvents({\n      start: startDate.toDate(),\n      end: endDate.toDate(),\n      scope: CalendarEventDisplayScope.Command,\n    });\n\n    // Track Calendar Open\n    recordEvent(UserEvents.CalendarViewed);\n\n    this.timeout = global.setTimeout(\n      () => {\n        const node = this.calendarNode &&\n          this.calendarNode.getElementsByClassName('selected-event')[0];\n        if (node) {\n          node.scrollIntoView();\n        }\n\n        if (this.input) {\n          this.input.focus();\n        }\n      },\n      0,\n    );\n    window.addEventListener('resize', this.handleResize);\n  }\n\n  componentWillUnmount() {\n    if (this.timeout) {\n      clearTimeout(this.timeout);\n    }\n\n    window.removeEventListener('resize', this.handleResize);\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps: Props & StateProps & DispatchProps) {\n    const newState: any = {};\n    const { dateRange } = this.state;\n\n    const nextDraft = nextProps.draft;\n    const thisDraft = this.props.draft;\n\n    if (!!nextDraft && !!thisDraft &&\n      thisDraft !== nextDraft &&\n      isEqual(nextDraft?.calendarInvite, thisDraft?.calendarInvite)\n    ) {\n      newState.selectedTimeBlock = nextProps.draft\n        ? this.convertCalendarInviteToTimeBlock(nextProps.draft.calendarInvite)\n        : undefined;\n    }\n\n    if (nextProps.calendars && nextProps.calendars !== this.props.calendars) {\n      let calendars;\n      if (nextProps.account) {\n        calendars = nextProps.calendars[nextProps.account];\n      } else {\n        calendars = Object.keys(nextProps.calendars).length\n          ? flatten(map(nextProps.calendars, c => c))\n          : undefined;\n      }\n      newState.calendars = calendars;\n      newState.hiddenCalendars = calendars ?\n        calendars.filter(c => !!c.hidden).map(c => c.id) : undefined;\n    }\n\n    if ((nextProps.calendarEvents && this.props.calendarEvents !== nextProps.calendarEvents) ||\n      newState.hiddenCalendars) {\n      newState.calendarEvents = this.generateCalendarEvents(\n        dateRange,\n        nextProps,\n        newState.hiddenCalendars,\n      );\n    }\n\n    if (!isEmpty(newState)) {\n      this.setState(newState);\n    }\n  }\n\n  handleResize = () => {\n    this.setState({\n      columnWidth: Math.floor(((Math.max(window.innerWidth, MIN_POPOVER_WIDTH) * .8)\n        - LEFT_SIDE_WIDTH - RIGHT_PADDING) / 5),\n      windowWidth: window.innerWidth,\n      windowHeight: window.innerHeight,\n    });\n  }\n\n  convertCalendarInviteToTimeBlock = (\n    calInvite?: DraftCalendarInvite | null,\n  ): TimeBlock | undefined => {\n    if (!calInvite) {\n      return undefined;\n    }\n\n    return {\n      startTime: moment(calInvite.start),\n      endTime: moment(calInvite.end),\n      event: {\n        name: calInvite.name,\n        notes: calInvite.notes,\n        location: calInvite.location,\n        recipients: calInvite.recipients.map(r => ({\n          type: EventRecipientType.Contact,\n          displayName: r,\n          identifier: parseAddress(r).email,\n        })),\n      },\n    };\n  }\n\n  handleRef = (ref: ControlPopover) => {\n    this.popover = ref;\n  }\n\n  handleUpdateTimeBlock = (tb: TimeBlock) => {\n    const { selectedTimeBlock } = this.state;\n    const { draft, readOnly } = this.props;\n    const timeblock = tb;\n\n    if (readOnly) {\n      return;\n    }\n\n    // first time setting selectedTimeBlock\n    if (!selectedTimeBlock && draft) {\n      timeblock.event.recipients = draft.cc.concat(draft.to).map(e => ({\n        type: EventRecipientType.Contact,\n        displayName: e,\n        identifier: e,\n      }));\n    }\n\n    this.setState({ selectedTimeBlock: timeblock, showEventDetail: true });\n  }\n\n  generateCalendarEvents = (\n    dateRange: Moment[],\n    props: Props & StateProps & DispatchProps,\n    forceHiddenCalendars?: string[],\n  ) => {\n    const events = {};\n    const hiddenCalendars = forceHiddenCalendars || this.state.hiddenCalendars;\n    const { calendarEvents } = props;\n\n    let accountEvents: CalendarEvent[] = [];\n    forEach(calendarEvents, (val: CalendarEvent[]) => {\n      accountEvents = accountEvents.concat(val);\n    });\n\n    dateRange.forEach((d) => {\n      events[d.format('MM-DD-YYYY')] = getEventsForDate(\n        d,\n        accountEvents,\n        START_HOUR,\n        END_HOUR,\n        hiddenCalendars,\n      );\n    });\n\n    return events;\n  }\n\n  renderFooter = () => {\n    const { readOnly } = this.props;\n\n    let description = 'Click on your calendar to select a meeting time';\n    if (readOnly) {\n      description  = 'View the events that are on your calendar';\n    }\n\n    return (\n      <div className=\"control-footer\">\n        <div>\n          {description}\n        </div>\n        <div>\n          <KeyboardSymbol\n            character=\"⎋ (esc)\"\n          />\n          <span>to dismiss</span>\n        </div>\n      </div>\n    );\n  }\n\n  handleStartDateChange = (newStartDate: Moment) => {\n    const { listCalendarEvents } = this.props;\n    const startDate = newStartDate.clone();\n    const endDate = newStartDate.clone().add(4, 'days');\n    const dateRange = this.generateDateRange(startDate, endDate);\n\n    listCalendarEvents({\n      start: startDate.toDate(),\n      end: endDate.toDate(),\n      scope: CalendarEventDisplayScope.Command,\n    });\n\n    this.setState({\n      startDate,\n      endDate,\n      calendarEvents: this.generateCalendarEvents(dateRange, this.props),\n      dateRange,\n    });\n  }\n\n  handleEventUpdate = (property: string, value: string | Moment | EventRecipient[]) => {\n    const { selectedTimeBlock, startDate, endDate } = this.state;\n    if (selectedTimeBlock) {\n      const event: EventType = selectedTimeBlock.event;\n\n      if (typeof value === 'string') {\n        event[property] = value;\n      } else if (property === 'recipients') {\n        event[property] = value as EventRecipient[];\n      }\n\n      this.setState({\n        selectedTimeBlock: {\n          startTime:\n          property === 'startTime' &&\n            startDate\n              .clone()\n              .startOf('day')\n              .isSameOrBefore(value as Moment) &&\n            endDate\n              .clone()\n              .endOf('day')\n              .isSameOrAfter(value as Moment) &&\n            selectedTimeBlock.endTime.isAfter(value as Moment)\n            ? (value as Moment)\n            : selectedTimeBlock.startTime,\n          endTime:\n          property === 'endTime' &&\n            startDate\n              .clone()\n              .startOf('day')\n              .isSameOrBefore(value as Moment) &&\n            endDate\n              .clone()\n              .endOf('day')\n              .isSameOrAfter(value as Moment) &&\n            selectedTimeBlock.startTime.isBefore(value as Moment)\n            ? (value as Moment)\n            : selectedTimeBlock.endTime,\n          event,\n        },\n      });\n    }\n  }\n\n  handleAdd = () => {\n    if (this.state.selectedTimeBlock) {\n      this.props.addCalendarInviteToDraft(this.state.selectedTimeBlock);\n      this.popover.hide();\n      this.props.onHide();\n      logAmplitudeEvent(AmplitudeEvents.SendCalendarInvite);\n    }\n  }\n\n  handleCalendarClick = (calendar: string) => {\n    const { toggleCalendarHide } = this.props;\n\n    toggleCalendarHide(calendar);\n  }\n\n  handleInputRef = (ref: HTMLInputElement) => {\n    this.input = ref;\n  }\n\n  handleCalendarNodeRef = (ref: HTMLDivElement) => {\n    this.calendarNode = ref;\n  }\n\n  handleInputSubmit = () => {\n    const { draft } = this.props;\n    const selectedTimeBlock = stringToTimeBlock(this.input.value);\n\n    if (draft) {\n      selectedTimeBlock.event.recipients = draft.cc.concat(draft.to).map(e => ({\n        type: EventRecipientType.Contact,\n        displayName: e,\n        identifier: e,\n      }));\n    }\n\n    const startDate = selectedTimeBlock.startTime.clone();\n    const endDate = selectedTimeBlock.startTime.clone().add(4, 'days');\n    const dateRange = this.generateDateRange(startDate, endDate);\n    this.setState(\n      {\n        selectedTimeBlock,\n        showEventDetail: true,\n        startDate,\n        endDate,\n        dateRange,\n        calendarEvents: this.generateCalendarEvents(dateRange, this.props),\n      },\n      () => {\n        if (this.calendarNode) {\n          const node = this.calendarNode.getElementsByClassName('selected-event')[0];\n          if (node) {\n            node.scrollIntoView();\n          }\n        }\n      },\n    );\n  }\n\n  generateDateRange = (startDate: Moment, endDate: Moment) => {\n    const start = startDate.clone().startOf('day');\n    const end = endDate.clone().startOf('day');\n    const dateRange = [];\n\n    while (start.isSameOrBefore(end)) {\n      dateRange.push(start.clone());\n      start.add(1, 'day');\n    }\n\n    return dateRange;\n  }\n\n  renderMain = () => {\n    const { draft, readOnly } = this.props;\n    const {\n      startDate,\n      endDate,\n      selectedTimeBlock,\n      showEventDetail,\n      hiddenCalendars,\n      calendars,\n      columnWidth,\n      calendarEvents,\n      dateRange,\n    } = this.state;\n\n    let title = !!draft?.calendarInvite ? 'Update Calendar Invite' : 'Add Calendar Invite';\n    if (readOnly) {\n      title = 'Your Calendar Events';\n    }\n\n    return (\n      <div className=\"main\">\n        <div className=\"left\" style={{ width: LEFT_SIDE_WIDTH }}>\n          {(!selectedTimeBlock || !showEventDetail) && (\n            <div className=\"month-calendars\">\n              {!readOnly && (\n                <form\n                  onSubmit={this.handleInputSubmit}\n                >\n                  <input\n                    dir=\"auto\"\n                    className=\"control-input\"\n                    placeholder=\"Meeting at 11am next Friday\"\n                    ref={this.handleInputRef}\n                    autoFocus\n                  />\n                </form>\n              )}\n              {calendars && (\n                <CalendarList\n                  calendars={calendars}\n                  onCalendarClick={this.handleCalendarClick}\n                  hiddenCalendars={hiddenCalendars}\n                />\n              )}\n            </div>\n          )}\n          {selectedTimeBlock &&\n            showEventDetail && (\n              <EventDetail\n                name={selectedTimeBlock.event.name}\n                recipients={selectedTimeBlock.event.recipients}\n                notes={selectedTimeBlock.event.notes}\n                onUpdate={this.handleEventUpdate}\n                startTime={selectedTimeBlock.startTime}\n                endTime={selectedTimeBlock.endTime}\n                onAdd={this.handleAdd}\n                ctaText={title}\n                location={selectedTimeBlock.event.location}\n              />\n            )}\n        </div>\n        <div className=\"right\" ref={this.handleCalendarNodeRef}>\n          <CalendarHeader\n            startDate={startDate}\n            endDate={endDate}\n            onStartDateChange={this.handleStartDateChange}\n            columnWidth={columnWidth}\n            dateRange={dateRange}\n            events={calendarEvents}\n          />\n          <MultiDayView\n            startDate={startDate}\n            endDate={endDate}\n            startHour={Math.min(startDate.hour(), START_HOUR)}\n            endHour={END_HOUR}\n            selectedTimeBlock={selectedTimeBlock}\n            onUpdateTimeBlock={this.handleUpdateTimeBlock}\n            hiddenCalendars={hiddenCalendars}\n            columnWidth={columnWidth}\n            dateRange={dateRange}\n            events={calendarEvents}\n            readOnly={!draft}\n          />\n        </div>\n      </div>\n    );\n  }\n\n  render() {\n    const { onHide, readOnly, draft } = this.props;\n    const { windowWidth, windowHeight } = this.state;\n\n    let title = !!draft?.calendarInvite ? 'Update Calendar Invite' : 'Add Calendar Invite';\n    if (readOnly) {\n      title = 'Your Calendar Events';\n    }\n\n    return (\n      <ControlPopover\n        className=\"calendar-popover\"\n        type={CommandControlType.Calendar}\n        icon={<CalendarIcon width=\"14px\" height=\"14px\" />}\n        heading={title}\n        options={[]}\n        onHide={onHide}\n        ref={this.handleRef}\n        renderMain={this.renderMain}\n        renderFooter={this.renderFooter}\n        placeholder=\"Standup at 11pm on Friday\"\n        style={{\n          minWidth: MIN_POPOVER_WIDTH,\n          width: windowWidth * .8,\n          height: windowHeight * .8,\n          top: (windowHeight * .5) - (windowHeight * .4),\n        }}\n        showOnMount\n        hideInput\n      />\n    );\n  }\n}\n\nexport default Calendar;\n"]}]}