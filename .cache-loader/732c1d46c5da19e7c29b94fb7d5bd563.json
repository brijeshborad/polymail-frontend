{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/ducks/contacts.ts","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/ducks/contacts.ts","mtime":1675280254048},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF9fYXNzaWduID0gKHRoaXMgJiYgdGhpcy5fX2Fzc2lnbikgfHwgZnVuY3Rpb24gKCkgewogICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uKHQpIHsKICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHsKICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTsKICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKQogICAgICAgICAgICAgICAgdFtwXSA9IHNbcF07CiAgICAgICAgfQogICAgICAgIHJldHVybiB0OwogICAgfTsKICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9Owp2YXIgX2EsIF9iLCBfYywgX2QsIF9lLCBfZiwgX2csIF9oOwppbXBvcnQgdXBkYXRlIGZyb20gJ2ltbXV0YWJpbGl0eS1oZWxwZXInOwppbXBvcnQgeyBjcmVhdGVTZWxlY3RvciB9IGZyb20gJ0BzcmMvbGliL3NlbGVjdG9yJzsKaW1wb3J0IHsgY3JlYXRlLCBjcmVhdGVBY3Rpb24sIGNyZWF0ZVNpbmdsZSB9IGZyb20gJ0BzcmMvbGliL3JlZHV4JzsKaW1wb3J0IHsgcmVzb3VyY2VMb2FkaW5nLCByZXNvdXJjZU9rLCByZXNvdXJjZVBlbmRpbmcgfSBmcm9tICdAc3JjL2xpYi9yZXNvdXJjZSc7CmltcG9ydCB7IFJlc291cmNlU3RhdHVzLCBDb250YWN0VHlwZSwgfSBmcm9tICdAc3JjL3R5cGVzJzsKaW1wb3J0IHsgZGVmYXVsdENvbnRhY3QgfSBmcm9tICdAc3JjL2xpYi9jb250YWN0JzsKaW1wb3J0IHsgcGFyc2VBZGRyZXNzIH0gZnJvbSAnQHNyYy9saWIvYWRkcmVzcyc7CmV4cG9ydCB2YXIgQ09OVEFDVF9TRUxFQ1QgPSAoX2EgPSBjcmVhdGUoJ0NPTlRBQ1RfU0VMRUNUJywgewogICAgc3VjY2VzczogZnVuY3Rpb24gKHN0YXRlLCBtZXRhLCBwYXlsb2FkKSB7CiAgICAgICAgcmV0dXJuIHVwZGF0ZShzdGF0ZSwgewogICAgICAgICAgICBzZWxlY3RlZENvbnRhY3Q6IHsgJHNldDogbWV0YSA9PT0gdW5kZWZpbmVkID8gbWV0YSA6IHBhcnNlQWRkcmVzcyhtZXRhKS5lbWFpbCB9LAogICAgICAgIH0pOwogICAgfSwKfSksIF9hLnR5cGUpLCBjb250YWN0U2VsZWN0ID0gX2EuYWN0aW9uLCBjb250YWN0U2VsZWN0UmVkdWNlciA9IF9hLnJlZHVjZXI7CmV4cG9ydCB2YXIgQ09OVEFDVF9GRVRDSCA9IChfYiA9IGNyZWF0ZSgnQ09OVEFDVF9GRVRDSCcsIHsKICAgIC8vIE5PVEUoU0hJTik6IFNhZmUgc2V0dXAgYmVjYXVzZSBjb250YWN0cyBjYW4gYmVjb21lIGNsZWFyZWQ/CiAgICBzZXR1cDogZnVuY3Rpb24gKHN0YXRlLCBtZXRhKSB7CiAgICAgICAgdmFyIF9hOwogICAgICAgIGlmIChzdGF0ZS5jb250YWN0c1ttZXRhXSkgewogICAgICAgICAgICByZXR1cm4gc3RhdGU7CiAgICAgICAgfQogICAgICAgIHJldHVybiB1cGRhdGUoc3RhdGUsIHsKICAgICAgICAgICAgY29udGFjdHM6IChfYSA9IHt9LAogICAgICAgICAgICAgICAgX2FbbWV0YV0gPSB7ICRzZXQ6IHJlc291cmNlUGVuZGluZygpIH0sCiAgICAgICAgICAgICAgICBfYSksCiAgICAgICAgfSk7CiAgICB9LAogICAgc3RhcnQ6IGZ1bmN0aW9uIChzdGF0ZSwgbWV0YSkgewogICAgICAgIHZhciBfYSwgX2I7CiAgICAgICAgdmFyIGV4aXN0aW5nID0gc3RhdGUuY29udGFjdHNbbWV0YV0uZGF0YTsKICAgICAgICBpZiAoZXhpc3RpbmcpIHsKICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZShzdGF0ZSwgewogICAgICAgICAgICAgICAgY29udGFjdHM6IChfYSA9IHt9LAogICAgICAgICAgICAgICAgICAgIF9hW21ldGFdID0gewogICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHsgJHNldDogUmVzb3VyY2VTdGF0dXMuTG9hZGluZyB9LAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgX2EpLAogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHVwZGF0ZShzdGF0ZSwgewogICAgICAgICAgICBjb250YWN0czogKF9iID0ge30sCiAgICAgICAgICAgICAgICBfYlttZXRhXSA9IHsgJHNldDogcmVzb3VyY2VMb2FkaW5nKCkgfSwKICAgICAgICAgICAgICAgIF9iKSwKICAgICAgICB9KTsKICAgIH0sCiAgICBzdWNjZXNzOiBmdW5jdGlvbiAoc3RhdGUsIG1ldGEsIHBheWxvYWQpIHsKICAgICAgICB2YXIgX2E7CiAgICAgICAgcmV0dXJuIHVwZGF0ZShzdGF0ZSwgewogICAgICAgICAgICBjb250YWN0czogKF9hID0ge30sCiAgICAgICAgICAgICAgICBfYVttZXRhXSA9IHsKICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHsgJHNldDogUmVzb3VyY2VTdGF0dXMuT2sgfSwKICAgICAgICAgICAgICAgICAgICBkYXRhOiB7ICRzZXQ6IF9fYXNzaWduKF9fYXNzaWduKHt9LCBwYXlsb2FkKSwgeyB0eXBlOiBDb250YWN0VHlwZS5FbnJpY2hlZCB9KSB9LAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIF9hKSwKICAgICAgICB9KTsKICAgIH0sCiAgICBmYWlsdXJlOiBmdW5jdGlvbiAoc3RhdGUsIG1ldGEsIGVycm9yKSB7CiAgICAgICAgdmFyIF9hOwogICAgICAgIHJldHVybiB1cGRhdGUoc3RhdGUsIHsKICAgICAgICAgICAgY29udGFjdHM6IChfYSA9IHt9LAogICAgICAgICAgICAgICAgX2FbbWV0YV0gPSB7CiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiB7ICRzZXQ6IFJlc291cmNlU3RhdHVzLkZhaWx1cmUgfSwKICAgICAgICAgICAgICAgICAgICBlcnJvcjogeyAkc2V0OiBlcnJvciB9LAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIF9hKSwKICAgICAgICB9KTsKICAgIH0sCn0pLCBfYi50eXBlKSwgY29udGFjdEZldGNoID0gX2IuYWN0aW9uLCBjb250YWN0RmV0Y2hSZWR1Y2VyID0gX2IucmVkdWNlcjsKZXhwb3J0IHZhciBDT05UQUNUX1VQREFURSA9IChfYyA9IGNyZWF0ZSgnQ09OVEFDVFNfUEFUQ0gnLCB7CiAgICBzdWNjZXNzOiBmdW5jdGlvbiAoc3RhdGUsIG1ldGEsIHBheWxvYWQpIHsKICAgICAgICB2YXIgX2E7CiAgICAgICAgdmFyIGVtYWlsID0gcGFyc2VBZGRyZXNzKG1ldGEuZW1haWwpLmVtYWlsLnRvTG93ZXJDYXNlKCkudHJpbSgpOwogICAgICAgIHJldHVybiB1cGRhdGUoc3RhdGUsIHsKICAgICAgICAgICAgY29udGFjdHM6IChfYSA9IHt9LAogICAgICAgICAgICAgICAgX2FbZW1haWxdID0gewogICAgICAgICAgICAgICAgICAgICRzZXQ6IHJlc291cmNlT2socGF5bG9hZCksCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgX2EpLAogICAgICAgIH0pOwogICAgfSwKfSksIF9jLnR5cGUpLCBjb250YWN0VXBkYXRlID0gX2MuYWN0aW9uLCBjb250YWN0VXBkYXRlUmVkdWNlciA9IF9jLnJlZHVjZXI7CmV4cG9ydCB2YXIgQ09OVEFDVFNfQUREID0gKF9kID0gY3JlYXRlKCdDT05UQUNUU19BREQnLCB7CiAgICBzdWNjZXNzOiBmdW5jdGlvbiAoc3RhdGUsIG1ldGEsIHBheWxvYWQpIHsKICAgICAgICBpZiAoIXBheWxvYWQubGVuZ3RoKSB7CiAgICAgICAgICAgIHJldHVybiBzdGF0ZTsKICAgICAgICB9CiAgICAgICAgdmFyIGNvbnRhY3RzID0gc3RhdGUuY29udGFjdHM7CiAgICAgICAgcGF5bG9hZC5mb3JFYWNoKGZ1bmN0aW9uIChjb250YWN0KSB7CiAgICAgICAgICAgIHZhciBvbGRDb250YWN0ID0gY29udGFjdHNbY29udGFjdC5lbWFpbF07CiAgICAgICAgICAgIGlmICgob2xkQ29udGFjdCAmJiBvbGRDb250YWN0LmRhdGEgJiYgb2xkQ29udGFjdC5kYXRhLnR5cGUgPT09IENvbnRhY3RUeXBlLkRlZmF1bHQpIHx8CiAgICAgICAgICAgICAgICAhb2xkQ29udGFjdCkgewogICAgICAgICAgICAgICAgY29udGFjdHNbY29udGFjdC5lbWFpbF0gPSByZXNvdXJjZU9rKGNvbnRhY3QpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHVwZGF0ZShzdGF0ZSwgewogICAgICAgICAgICBjb250YWN0czogeyAkc2V0OiBjb250YWN0cyB9LAogICAgICAgIH0pOwogICAgfSwKfSksIF9kLnR5cGUpLCBjb250YWN0c0FkZCA9IF9kLmFjdGlvbiwgY29udGFjdHNBZGRSZWR1Y2VyID0gX2QucmVkdWNlcjsKZXhwb3J0IHZhciBDT05UQUNUX1RZUEVBSEVBRCA9IChfZSA9IGNyZWF0ZSgnQ09OVEFDVF9UWVBFQUhFQUQnLCB7CiAgICBzdWNjZXNzOiBmdW5jdGlvbiAoc3RhdGUsIG1ldGEsIHBheWxvYWQpIHsKICAgICAgICByZXR1cm4gdXBkYXRlKHN0YXRlLCB7CiAgICAgICAgICAgIHR5cGVhaGVhZENvbnRhY3RzOiB7ICRzZXQ6IHBheWxvYWQgfSwKICAgICAgICB9KTsKICAgIH0sCn0pLCBfZS50eXBlKSwgY29udGFjdFR5cGVhaGVhZCA9IF9lLmFjdGlvbiwgY29udGFjdFR5cGVhaGVhZFJlZHVjZXIgPSBfZS5yZWR1Y2VyOwpleHBvcnQgdmFyIENPTlRBQ1RfVFlQRUFIRUFEX0RPTUFJTiA9IChfZiA9IGNyZWF0ZSgnQ09OVEFDVF9UWVBFQUhFQURfRE9NQUlOJywgewogICAgc3VjY2VzczogZnVuY3Rpb24gKHN0YXRlLCBtZXRhLCBwYXlsb2FkKSB7CiAgICAgICAgcmV0dXJuIHVwZGF0ZShzdGF0ZSwgewogICAgICAgICAgICB0eXBlYWhlYWRDb250YWN0czogeyAkc2V0OiBwYXlsb2FkIH0sCiAgICAgICAgfSk7CiAgICB9LAp9KSwgX2YudHlwZSksIGNvbnRhY3RUeXBlYWhlYWREb21haW4gPSBfZi5hY3Rpb24sIGNvbnRhY3RUeXBlYWhlYWREb21haW5SZWR1Y2VyID0gX2YucmVkdWNlcjsKZXhwb3J0IHZhciBDT05UQUNUX1RZUEVBSEVBRF9DTEVBUiA9IChfZyA9IGNyZWF0ZVNpbmdsZSgnQ09OVEFDVF9UWVBFQUhFQURfQ0xFQVInLCBmdW5jdGlvbiAoc3RhdGUsIG1ldGEpIHsKICAgIHJldHVybiB1cGRhdGUoc3RhdGUsIHsKICAgICAgICB0eXBlYWhlYWRDb250YWN0czogeyAkc2V0OiBbXSB9LAogICAgfSk7Cn0pLCBfZy50eXBlKSwgY29udGFjdFR5cGVhaGVhZENsZWFyID0gX2cuYWN0aW9uLCBjb250YWN0VHlwZWFoZWFkQ2xlYXJSZWR1Y2VyID0gX2cucmVkdWNlcjsKLy8gTk9URShTSElOKSBJbmNyZW1lbnRDb3VudCBpcyB1c2VkIHRvIG9ubHkgZmV0Y2ggYW4gaXRlbSBvbmNlCmV4cG9ydCB2YXIgQ09OVEFDVF9HRVQgPSAoX2ggPSBjcmVhdGUoJ0NPTlRBQ1RfR0VUJywgewogICAgc3RhcnQ6IGZ1bmN0aW9uIChzdGF0ZSwgbWV0YSkgewogICAgICAgIHZhciBfYSwgX2I7CiAgICAgICAgdmFyIF9jOwogICAgICAgIHZhciBhZGRyZXNzID0gcGFyc2VBZGRyZXNzKG1ldGEpOwogICAgICAgIHZhciBlbWFpbCA9IGFkZHJlc3MuZW1haWwsIGdpdmVuTmFtZSA9IGFkZHJlc3MuZ2l2ZW5OYW1lLCBmYW1pbHlOYW1lID0gYWRkcmVzcy5mYW1pbHlOYW1lOwogICAgICAgIHZhciBjb250YWN0ID0gc3RhdGUuY29udGFjdHNbZW1haWxdOwogICAgICAgIHZhciBpbmNyZW1lbnRDb3VudCA9IChjb250YWN0ID09PSBudWxsIHx8IGNvbnRhY3QgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGNvbnRhY3QuaW5jcmVtZW50Q291bnQpIHx8IDA7CiAgICAgICAgLy8gY29uc3QgY2hlY2tLZXlzID0gWydlbWFpbCcsICdnaXZlbk5hbWUnLCAnZmFtaWx5TmFtZSddOwogICAgICAgIGlmICghY29udGFjdCkgewogICAgICAgICAgICByZXR1cm4gdXBkYXRlKHN0YXRlLCB7CiAgICAgICAgICAgICAgICBjb250YWN0czogKF9hID0ge30sCiAgICAgICAgICAgICAgICAgICAgX2FbZW1haWxdID0gewogICAgICAgICAgICAgICAgICAgICAgICAkc2V0OiBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgcmVzb3VyY2VPayhfX2Fzc2lnbih7fSwgZGVmYXVsdENvbnRhY3QoZW1haWwsIGdpdmVuTmFtZSwgZmFtaWx5TmFtZSkpKSksIHsgaW5jcmVtZW50Q291bnQ6IGluY3JlbWVudENvdW50ICsgMSB9KSwKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIF9hKSwKICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIGlmICgoKF9jID0gY29udGFjdCA9PT0gbnVsbCB8fCBjb250YWN0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjb250YWN0LmRhdGEpID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYy50eXBlKSA9PT0gQ29udGFjdFR5cGUuRGVmYXVsdCkgewogICAgICAgICAgICByZXR1cm4gdXBkYXRlKHN0YXRlLCB7CiAgICAgICAgICAgICAgICBjb250YWN0czogKF9iID0ge30sIF9iW2VtYWlsXSA9IHsKICAgICAgICAgICAgICAgICAgICAkc2V0OiBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgcmVzb3VyY2VPayhfX2Fzc2lnbih7fSwgZGVmYXVsdENvbnRhY3QoZW1haWwsIGdpdmVuTmFtZSB8fCBjb250YWN0LmRhdGEuZ2l2ZW5OYW1lLCBmYW1pbHlOYW1lIHx8IGNvbnRhY3QuZGF0YS5mYW1pbHlOYW1lKSkpKSwgeyBpbmNyZW1lbnRDb3VudDogaW5jcmVtZW50Q291bnQgKyAxIH0pLAogICAgICAgICAgICAgICAgfSwgX2IpLAogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHN0YXRlOwogICAgfSwKICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChzdGF0ZSwgbWV0YSwgcGF5bG9hZCkgewogICAgICAgIHZhciBfYTsKICAgICAgICB2YXIgX2IsIF9jOwogICAgICAgIC8vIERvIG5vdCB1cGRhdGUgd2l0aCBjYWNoZWQgZGF0YSBpZiBhbHJlYWR5IGVucmljaGVkCiAgICAgICAgdmFyIHBhcnNlZEVtYWlsID0gcGFyc2VBZGRyZXNzKG1ldGEpLmVtYWlsOwogICAgICAgIHZhciBmb3VuZENvbnRhY3QgPSAoX2IgPSBzdGF0ZS5jb250YWN0c1twYXJzZWRFbWFpbF0pID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5kYXRhOwogICAgICAgIGlmIChmb3VuZENvbnRhY3QgJiYgZm91bmRDb250YWN0LnR5cGUgPT09IENvbnRhY3RUeXBlLkVucmljaGVkKSB7CiAgICAgICAgICAgIHJldHVybiBzdGF0ZTsKICAgICAgICB9CiAgICAgICAgLy8gT3RoZXJ3aXNlIHVwZGF0ZQogICAgICAgIHJldHVybiB1cGRhdGUoc3RhdGUsIHsKICAgICAgICAgICAgY29udGFjdHM6IChfYSA9IHt9LAogICAgICAgICAgICAgICAgX2FbcGFyc2VBZGRyZXNzKG1ldGEpLmVtYWlsXSA9IHsKICAgICAgICAgICAgICAgICAgICAkc2V0OiBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgcmVzb3VyY2VPayhfX2Fzc2lnbih7fSwgcGF5bG9hZCkpKSwgeyBpbmNyZW1lbnRDb3VudDogKCgoX2MgPSBzdGF0ZS5jb250YWN0c1twYXJzZWRFbWFpbF0pID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYy5pbmNyZW1lbnRDb3VudCkgfHwgMCkgKyAxIH0pLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIF9hKSwKICAgICAgICB9KTsKICAgIH0sCn0pLCBfaC50eXBlKSwgY29udGFjdEdldCA9IF9oLmFjdGlvbiwgY29udGFjdEdldFJlZHVjZXIgPSBfaC5yZWR1Y2VyOwpleHBvcnQgdmFyIENPTlRBQ1RfUkVTT1VSQ0VTX0ZFVENIID0gJ0NPTlRBQ1RfUkVTT1VSQ0VTX0ZFVENIJzsKZXhwb3J0IHZhciBjb250YWN0UmVzb3VyY2VzRmV0Y2ggPSBjcmVhdGVBY3Rpb24oQ09OVEFDVF9SRVNPVVJDRVNfRkVUQ0gpOwovLyBTZWxlY3RzIGNvbnRhY3QgdHlwZWFoZWFkcyB3aXRoIHZhbGlkIGVtYWlsLCBtZW1vaXplZCBvbiB0eXBlYWhlYWQgY29udGFjdHMKZXhwb3J0IHZhciBzZWxlY3RUeXBlYWhlYWRDb250YWN0cyA9IGNyZWF0ZVNlbGVjdG9yKFtmdW5jdGlvbiAoc3RhdGUpIHsgcmV0dXJuIHN0YXRlLnR5cGVhaGVhZENvbnRhY3RzOyB9XSwgZnVuY3Rpb24gKGNvbnRhY3RzKSB7CiAgICByZXR1cm4gY29udGFjdHMuZmlsdGVyKGZ1bmN0aW9uIChjb250YWN0KSB7IHJldHVybiAhIWNvbnRhY3QuZW1haWw7IH0pOwp9LCB1bmRlZmluZWQsIFsndHlwZWFoZWFkQ29udGFjdHMnXSk7Ci8vIHNlbGVjdENvbnRhY3QgZmluZHMgdGhlIGNvbnRhY3QgaW4gdGhlIHN0YXRlLAovLyAgYW5kIHByb3ZpZGVzIGEgZGVmYXVsdCBwbGFjZWhvbGRlciBjb250YWN0IHdoZW4gbm90IGluIHRoZSBzdGF0ZQpleHBvcnQgdmFyIHNlbGVjdENvbnRhY3QgPSBjcmVhdGVTZWxlY3RvcihbCiAgICBmdW5jdGlvbiAoc3RhdGUsIGFkZHJlc3MpIHsKICAgICAgICB2YXIgaWQgPSBwYXJzZUFkZHJlc3MoYWRkcmVzcykuZW1haWwudG9Mb3dlckNhc2UoKS50cmltKCk7CiAgICAgICAgcmV0dXJuIHN0YXRlLmNvbnRhY3RzW2lkXTsKICAgIH0sCl0sIGZ1bmN0aW9uIChjb250YWN0LCBhZGRyZXNzKSB7CiAgICB2YXIgX2EgPSBwYXJzZUFkZHJlc3MoYWRkcmVzcyksIGVtYWlsID0gX2EuZW1haWwsIGdpdmVuTmFtZSA9IF9hLmdpdmVuTmFtZSwgZmFtaWx5TmFtZSA9IF9hLmZhbWlseU5hbWU7CiAgICBpZiAoY29udGFjdCAmJiBjb250YWN0LmRhdGEpIHsKICAgICAgICByZXR1cm4gY29udGFjdC5kYXRhOwogICAgfQogICAgcmV0dXJuIGRlZmF1bHRDb250YWN0KGVtYWlsLCBnaXZlbk5hbWUsIGZhbWlseU5hbWUpOwp9LCBmdW5jdGlvbiAoY29udGFjdCwgYWRkcmVzcykgeyByZXR1cm4gcGFyc2VBZGRyZXNzKGFkZHJlc3MpLmVtYWlsOyB9KTsKZXhwb3J0IGRlZmF1bHQgWwogICAgY29udGFjdEZldGNoUmVkdWNlciwKICAgIGNvbnRhY3RUeXBlYWhlYWRSZWR1Y2VyLAogICAgY29udGFjdFR5cGVhaGVhZENsZWFyUmVkdWNlciwKICAgIGNvbnRhY3RTZWxlY3RSZWR1Y2VyLAogICAgY29udGFjdEdldFJlZHVjZXIsCiAgICBjb250YWN0c0FkZFJlZHVjZXIsCiAgICBjb250YWN0VHlwZWFoZWFkRG9tYWluUmVkdWNlciwKICAgIGNvbnRhY3RVcGRhdGVSZWR1Y2VyLApdOwo="},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/ducks/contacts.ts","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/ducks/contacts.ts"],"names":[],"mappings":"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","sourcesContent":["import update from 'immutability-helper';\nimport { createSelector } from '@src/lib/selector';\n\nimport { create, createAction, createSingle } from '@src/lib/redux';\nimport { resourceLoading, resourceOk, resourcePending } from '@src/lib/resource';\n\nimport {\n  Contact, StoreState, ResourceStatus, ContactGroup, Resource, ContactType, RequiredPartial,\n} from '@src/types';\nimport { defaultContact } from '@src/lib/contact';\nimport { parseAddress } from '@src/lib/address';\n\nexport const {\n  type: CONTACT_SELECT,\n  action: contactSelect,\n  reducer: contactSelectReducer,\n} = create<string|undefined, null>('CONTACT_SELECT', {\n  success: (state, meta, payload) =>\n    update(state, {\n      selectedContact: { $set: meta === undefined ? meta : parseAddress(meta).email },\n    }),\n});\n\nexport const {\n  type: CONTACT_FETCH,\n  action: contactFetch,\n  reducer: contactFetchReducer,\n} = create<string, Contact>('CONTACT_FETCH', {\n  // NOTE(SHIN): Safe setup because contacts can become cleared?\n  setup: (state, meta) => {\n    if (state.contacts[meta]) {\n      return state;\n    }\n    return update(state, {\n      contacts: {\n        [meta]: { $set: resourcePending() },\n      },\n    });\n  },\n  start: (state, meta) => {\n    const existing = state.contacts[meta].data;\n    if (existing) {\n      return update(state, {\n        contacts: {\n          [meta]: {\n            status: { $set: ResourceStatus.Loading },\n          },\n        },\n      });\n    }\n\n    return update(state, {\n      contacts: {\n        [meta]: { $set: resourceLoading<Contact>() },\n      },\n    });\n  },\n\n  success: (state, meta, payload) => {\n    return update(state, {\n      contacts: {\n        [meta]: {\n          status: { $set: ResourceStatus.Ok },\n          data: { $set: { ...payload, type: ContactType.Enriched } },\n        },\n      },\n    });\n  },\n\n  failure: (state, meta, error) => {\n    return update(state, {\n      contacts: {\n        [meta]: {\n          status: { $set: ResourceStatus.Failure },\n          error: { $set: error },\n        },\n      },\n    });\n  },\n});\n\nexport type ContactUpdateMeta = RequiredPartial<\n  Contact,\n  'givenName' | 'familyName' | 'fullName'| 'email'| 'id'\n>;\n\nexport const {\n  type: CONTACT_UPDATE,\n  action: contactUpdate,\n  reducer: contactUpdateReducer,\n} = create<ContactUpdateMeta, Contact>('CONTACTS_PATCH', {\n  success: (state, meta, payload) => {\n    const email = parseAddress(meta.email).email.toLowerCase().trim();\n    return update(state, {\n      contacts: {\n        [email]: {\n          $set: resourceOk(payload),\n        },\n      },\n    });\n  },\n});\n\nexport const {\n  type: CONTACTS_ADD,\n  action: contactsAdd,\n  reducer: contactsAddReducer,\n} = create<string, Contact[]>('CONTACTS_ADD', {\n  success: (state, meta, payload) => {\n    if (!payload.length) {\n      return state;\n    }\n\n    const contacts = state.contacts;\n    payload.forEach((contact) => {\n      const oldContact = contacts[contact.email];\n\n      if ((oldContact && oldContact.data && oldContact.data.type === ContactType.Default) ||\n        !oldContact) {\n        contacts[contact.email] = resourceOk(contact);\n      }\n    });\n\n    return update(state, {\n      contacts: { $set: contacts },\n    });\n  },\n});\n\nexport const {\n  type: CONTACT_TYPEAHEAD,\n  action: contactTypeahead,\n  reducer: contactTypeaheadReducer,\n} = create<string, Array<Contact|ContactGroup>>('CONTACT_TYPEAHEAD', {\n  success: (state, meta, payload) => {\n    return update(state, {\n      typeaheadContacts: { $set: payload },\n    });\n  },\n});\n\nexport const {\n  type: CONTACT_TYPEAHEAD_DOMAIN,\n  action: contactTypeaheadDomain,\n  reducer: contactTypeaheadDomainReducer,\n} = create<string[], Contact[]>('CONTACT_TYPEAHEAD_DOMAIN', {\n  success: (state, meta, payload) => {\n    return update(state, {\n      typeaheadContacts: { $set: payload },\n    });\n  },\n});\n\nexport const {\n  type: CONTACT_TYPEAHEAD_CLEAR,\n  action: contactTypeaheadClear,\n  reducer: contactTypeaheadClearReducer,\n} = createSingle<Contact[]>('CONTACT_TYPEAHEAD_CLEAR',  (state, meta) => {\n  return update(state, {\n    typeaheadContacts: { $set: [] },\n  });\n});\n\n// NOTE(SHIN) IncrementCount is used to only fetch an item once\nexport const {\n  type: CONTACT_GET,\n  action: contactGet,\n  reducer: contactGetReducer,\n} = create<string, Contact>('CONTACT_GET', {\n  start: (state, meta) => {\n    const address = parseAddress(meta);\n    const { email, givenName, familyName } = address;\n    const contact = state.contacts[email];\n    const incrementCount = contact?.incrementCount || 0;\n    // const checkKeys = ['email', 'givenName', 'familyName'];\n\n    if (!contact) {\n      return update(state, {\n        contacts: {\n          [email]: {\n            $set: {\n              ...resourceOk({\n                ...defaultContact(email, givenName, familyName),\n              }),\n              incrementCount: incrementCount + 1,\n            },\n          },\n        },\n      });\n    }\n\n    if (contact?.data?.type === ContactType.Default) {\n      return update(state, {\n        contacts: { [email]: {\n          $set: {\n            ...resourceOk({\n              ...defaultContact(\n                email,\n                givenName || contact.data.givenName,\n                familyName || contact.data.familyName,\n              ),\n            }),\n            incrementCount: incrementCount + 1,\n          },\n        } },\n      });\n    }\n\n    return state;\n  },\n  success: (state, meta, payload) => {\n    // Do not update with cached data if already enriched\n    const parsedEmail = parseAddress(meta).email;\n    const foundContact = state.contacts[parsedEmail]?.data;\n    if (foundContact && foundContact.type === ContactType.Enriched) {\n      return state;\n    }\n\n    // Otherwise update\n    return update(state, {\n      contacts: {\n        [parseAddress(meta).email]: {\n          $set: {\n            ...resourceOk({\n              ...payload,\n            }),\n            incrementCount: (state.contacts[parsedEmail]?.incrementCount || 0) + 1,\n          },\n        },\n      },\n    });\n  },\n});\n\nexport const CONTACT_RESOURCES_FETCH = 'CONTACT_RESOURCES_FETCH';\nexport const contactResourcesFetch = createAction<string|undefined, null>(\n  CONTACT_RESOURCES_FETCH,\n);\n\n// Selects contact typeaheads with valid email, memoized on typeahead contacts\nexport const selectTypeaheadContacts = createSelector<undefined, Contact[], Contact[]>(\n  [state => state.typeaheadContacts],\n  (contacts: Contact[]) => {\n    return contacts.filter(contact => !!contact.email);\n  },\n  undefined,\n  ['typeaheadContacts'],\n);\n\n// selectContact finds the contact in the state,\n//  and provides a default placeholder contact when not in the state\nexport const selectContact = createSelector<string, Resource<Contact>, Contact>(\n  [\n    (state: StoreState, address: string) => {\n      const id = parseAddress(address).email.toLowerCase().trim();\n      return state.contacts[id];\n    },\n  ],\n  (contact: Resource<Contact>, address: string) => {\n    const { email, givenName, familyName } = parseAddress(address);\n\n    if (contact && contact.data) {\n      return contact.data;\n    }\n\n    return defaultContact(email, givenName, familyName);\n  },\n  (contact: Resource<Contact>, address: string) => parseAddress(address).email,\n);\n\nexport default [\n  contactFetchReducer,\n  contactTypeaheadReducer,\n  contactTypeaheadClearReducer,\n  contactSelectReducer,\n  contactGetReducer,\n  contactsAddReducer,\n  contactTypeaheadDomainReducer,\n  contactUpdateReducer,\n];\n"]}]}