{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/epics/sequenceRecipients.ts","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/epics/sequenceRecipients.ts","mtime":1675280254058},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF9fYXNzaWduID0gKHRoaXMgJiYgdGhpcy5fX2Fzc2lnbikgfHwgZnVuY3Rpb24gKCkgewogICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uKHQpIHsKICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHsKICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTsKICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKQogICAgICAgICAgICAgICAgdFtwXSA9IHNbcF07CiAgICAgICAgfQogICAgICAgIHJldHVybiB0OwogICAgfTsKICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9OwppbXBvcnQgeyBBY3Rpb25TdGF0dXMsIH0gZnJvbSAnQHNyYy90eXBlcyc7CmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzJzsKaW1wb3J0IHsgU0VRVUVOQ0VfUkVDSVBJRU5UX0xJU1QsIHNlcXVlbmNlUmVjaXBpZW50TGlzdCwgU0VRVUVOQ0VfUkVDSVBJRU5UX0RFTEVURSwgc2VxdWVuY2VSZWNpcGllbnREZWxldGUsIFNFUVVFTkNFX1JFQ0lQSUVOVF9VUExPQUQsIHNlcXVlbmNlUmVjaXBpZW50VXBsb2FkLCBTRVFVRU5DRV9SRUNJUElFTlRfVVBEQVRFLCBzZXF1ZW5jZVJlY2lwaWVudFVwZGF0ZSwgc2VxdWVuY2VSZWNpcGllbnRDcmVhdGUsIFNFUVVFTkNFX1JFQ0lQSUVOVF9DUkVBVEUsIFNFUVVFTkNFX1JFQ0lQSUVOVF9IRUFERVJTX0FERCwgc2VxdWVuY2VSZWNpcGllbnRIZWFkZXJzQWRkLCBzZXF1ZW5jZVJlY2lwaWVudFRlbXBVcGRhdGUsIFNFUVVFTkNFX1JFQ0lQSUVOVF9URU1QX1VQREFURSwgU0VRVUVOQ0VfUkVDSVBJRU5UX1JFQUNUSVZBVEUsIHNlcXVlbmNlUmVjaXBpZW50UmVhY3RpdmF0ZSwgfSBmcm9tICdAc3JjL2R1Y2tzL3NlcXVlbmNlUmVjaXBpZW50cyc7CmltcG9ydCB7IHRvYXN0U2V0IH0gZnJvbSAnQHNyYy9kdWNrcy90b2FzdHMnOwppbXBvcnQgeyBzZXF1ZW5jZVN0YWdlUmVjaXBpZW50RGVsZXRlIH0gZnJvbSAnQHNyYy9kdWNrcy9zZXF1ZW5jZVN0YWdlUmVjaXBpZW50cyc7CmltcG9ydCB7IHJlY29yZEV2ZW50LCBVc2VyRXZlbnRzIH0gZnJvbSAnQHNyYy9saWIvYW5hbHl0aWNzJzsKdmFyIHNlcXVlbmNlUmVjaXBpZW50TGlzdEVwaWMgPSBmdW5jdGlvbiAoYWN0aW9uJCwgc3RvcmUsIGRlcHMpIHsKICAgIHJldHVybiBhY3Rpb24kLm9mVHlwZShTRVFVRU5DRV9SRUNJUElFTlRfTElTVCkKICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChhY3Rpb24pIHsgcmV0dXJuIGFjdGlvbi5zdGF0dXMgPT09IEFjdGlvblN0YXR1cy5TdGFydDsgfSkKICAgICAgICAuZmxhdE1hcChmdW5jdGlvbiAoYWN0aW9uKSB7CiAgICAgICAgcmV0dXJuIGRlcHMuc2VxdWVuY2VSZWNpcGllbnRzLmxpc3QoYWN0aW9uLm1ldGEpCiAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKHJlc3VsdCkgeyByZXR1cm4gc2VxdWVuY2VSZWNpcGllbnRMaXN0KGFjdGlvbi5tZXRhLCByZXN1bHQpOyB9KQogICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGUpIHsgcmV0dXJuIE9ic2VydmFibGUub2Yoc2VxdWVuY2VSZWNpcGllbnRMaXN0KGFjdGlvbi5tZXRhLCBlKSk7IH0pOwogICAgfSk7Cn07CnZhciBzZXF1ZW5jZVJlY2lwaWVudFVwbG9hZEVwaWMgPSBmdW5jdGlvbiAoYWN0aW9uJCwgc3RvcmUsIGRlcHMpIHsKICAgIHJldHVybiBhY3Rpb24kLm9mVHlwZShTRVFVRU5DRV9SRUNJUElFTlRfVVBMT0FEKQogICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKGFjdGlvbikgeyByZXR1cm4gYWN0aW9uLnN0YXR1cyA9PT0gQWN0aW9uU3RhdHVzLlN0YXJ0OyB9KQogICAgICAgIC5mbGF0TWFwKGZ1bmN0aW9uIChhY3Rpb24pIHsKICAgICAgICByZXR1cm4gZGVwcy5zZXF1ZW5jZVJlY2lwaWVudHMudXBsb2FkKGFjdGlvbi5tZXRhLnNlcXVlbmNlLCBhY3Rpb24ubWV0YS5jbG91ZEZpbGUsIGFjdGlvbi5tZXRhLmVtYWlsSGVhZGVyLCBhY3Rpb24ubWV0YS5naXZlbk5hbWVIZWFkZXIsIGFjdGlvbi5tZXRhLmZhbWlseU5hbWVIZWFkZXIpCiAgICAgICAgICAgIC5mbGF0TWFwKGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICAgICAgcmV0dXJuIE9ic2VydmFibGUubWVyZ2UoT2JzZXJ2YWJsZS5vZihzZXF1ZW5jZVJlY2lwaWVudFVwbG9hZChhY3Rpb24ubWV0YSwgcmVzdWx0KSkpOwogICAgICAgIH0pCiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsgcmV0dXJuIE9ic2VydmFibGUubWVyZ2UoT2JzZXJ2YWJsZS5vZih0b2FzdFNldChlcnJvcikpLCBPYnNlcnZhYmxlLm9mKHNlcXVlbmNlUmVjaXBpZW50VXBsb2FkKGFjdGlvbi5tZXRhLCBlcnJvcikpKTsgfSk7CiAgICB9KTsKfTsKdmFyIHNlcXVlbmNlUmVjaXBpZW50Q3JlYXRlRXBpYyA9IGZ1bmN0aW9uIChhY3Rpb24kLCBzdG9yZSwgZGVwcykgewogICAgcmV0dXJuIGFjdGlvbiQub2ZUeXBlKFNFUVVFTkNFX1JFQ0lQSUVOVF9DUkVBVEUpCiAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoYWN0aW9uKSB7IHJldHVybiBhY3Rpb24uc3RhdHVzID09PSBBY3Rpb25TdGF0dXMuU3RhcnQKICAgICAgICAmJiAhIXN0b3JlLmdldFN0YXRlKCkuc2VxdWVuY2VSZWNpcGllbnRzQWRkU3RhdGUKICAgICAgICAmJiAhIXN0b3JlLmdldFN0YXRlKCkuc2VxdWVuY2VSZWNpcGllbnRzQWRkU3RhdGUucmVjaXBpZW50cwogICAgICAgICYmICEhc3RvcmUuZ2V0U3RhdGUoKS5zZXF1ZW5jZVJlY2lwaWVudHNBZGRTdGF0ZS5oZWFkZXJzOyB9KQogICAgICAgIC5mbGF0TWFwKGZ1bmN0aW9uIChhY3Rpb24pIHsKICAgICAgICB2YXIgc2VxdWVuY2VSZWNpcGllbnRzQWRkU3RhdGUgPSBzdG9yZS5nZXRTdGF0ZSgpLnNlcXVlbmNlUmVjaXBpZW50c0FkZFN0YXRlOwogICAgICAgIHZhciByZWNpcGllbnRzID0gc2VxdWVuY2VSZWNpcGllbnRzQWRkU3RhdGUucmVjaXBpZW50cwogICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChyKSB7IHJldHVybiAhIXIuZGF0YTsgfSkKICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAocikgewogICAgICAgICAgICB2YXIgdmFyaWFibGVzID0ge307CiAgICAgICAgICAgIHNlcXVlbmNlUmVjaXBpZW50c0FkZFN0YXRlLmhlYWRlcnMuZm9yRWFjaChmdW5jdGlvbiAoaCkgewogICAgICAgICAgICAgICAgaWYgKGgudG9Mb3dlckNhc2UoKSAhPT0gJ2VtYWlsJyAmJiBoLnRvTG93ZXJDYXNlKCkgIT09ICdsYXN0IG5hbWUnICYmCiAgICAgICAgICAgICAgICAgICAgaC50b0xvd2VyQ2FzZSgpICE9PSAnZmlyc3QgbmFtZScgJiYgci5kYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyaWFibGVzW2hdID0gci5kYXRhLnZhcmlhYmxlcyA/IHIuZGF0YS52YXJpYWJsZXNbaF0gOiAnJzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJldHVybiBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgci5kYXRhKSwgeyBwYXVzZWQ6IGFjdGlvbi5tZXRhLmFkZEFzUGF1c2VkLCB2YXJpYWJsZXM6IHZhcmlhYmxlcyB9KTsKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gZGVwcy5zZXF1ZW5jZVJlY2lwaWVudHMuY3JlYXRlKHsKICAgICAgICAgICAgc2VxdWVuY2U6IGFjdGlvbi5tZXRhLnNlcXVlbmNlLAogICAgICAgICAgICByZWNpcGllbnRzOiByZWNpcGllbnRzLAogICAgICAgIH0pCiAgICAgICAgICAgIC8vIExvZyBTZXF1ZW5jZSBSZWNpcGllbnQgVXBsb2FkIGV2ZW50cwogICAgICAgICAgICAuZG8oZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgc3RhdGUgPSBzdG9yZS5nZXRTdGF0ZSgpOwogICAgICAgICAgICB2YXIgbWV0YSA9IGFjdGlvbi5tZXRhOwogICAgICAgICAgICByZWNvcmRFdmVudChVc2VyRXZlbnRzLlNlcXVlbmNlUmVjaXBpZW50c1VwbG9hZGVkLCB7CiAgICAgICAgICAgICAgICBzZXF1ZW5jZTogYWN0aW9uLm1ldGEuc2VxdWVuY2UsCiAgICAgICAgICAgICAgICBjb3VudDogcmVjaXBpZW50cy5sZW5ndGgsCiAgICAgICAgICAgICAgICB0ZWFtOiBzdGF0ZS5zZXF1ZW5jZXNbbWV0YS5zZXF1ZW5jZV0gJiYKICAgICAgICAgICAgICAgICAgICBzdGF0ZS5zZXF1ZW5jZXNbbWV0YS5zZXF1ZW5jZV0uZGF0YSAmJgogICAgICAgICAgICAgICAgICAgIHN0YXRlLnNlcXVlbmNlc1ttZXRhLnNlcXVlbmNlXS5kYXRhLnRlYW0sCiAgICAgICAgICAgIH0pOwogICAgICAgIH0pCiAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKHJlc3VsdCkgeyByZXR1cm4gc2VxdWVuY2VSZWNpcGllbnRDcmVhdGUoYWN0aW9uLm1ldGEsIHJlc3VsdCk7IH0pCiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZSkgeyByZXR1cm4gT2JzZXJ2YWJsZS5tZXJnZShPYnNlcnZhYmxlLm9mKHRvYXN0U2V0KGUpKSwgT2JzZXJ2YWJsZS5vZihzZXF1ZW5jZVJlY2lwaWVudENyZWF0ZShhY3Rpb24ubWV0YSwgZSkpKTsgfSk7CiAgICB9KTsKfTsKdmFyIHNlcXVlbmNlUmVjaXBpZW50VXBkYXRlRXBpYyA9IGZ1bmN0aW9uIChhY3Rpb24kLCBzdG9yZSwgZGVwcykgewogICAgcmV0dXJuIGFjdGlvbiQub2ZUeXBlKFNFUVVFTkNFX1JFQ0lQSUVOVF9VUERBVEUpCiAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoYWN0aW9uKSB7IHJldHVybiBhY3Rpb24uc3RhdHVzID09PSBBY3Rpb25TdGF0dXMuU3RhcnQ7IH0pCiAgICAgICAgLmZsYXRNYXAoZnVuY3Rpb24gKGFjdGlvbikgewogICAgICAgIHJldHVybiBkZXBzLnNlcXVlbmNlUmVjaXBpZW50cy51cGRhdGUoYWN0aW9uLm1ldGEpCiAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKHJlc3VsdCkgeyByZXR1cm4gc2VxdWVuY2VSZWNpcGllbnRVcGRhdGUoYWN0aW9uLm1ldGEsIHJlc3VsdCk7IH0pCiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZSkgeyByZXR1cm4gT2JzZXJ2YWJsZS5tZXJnZShPYnNlcnZhYmxlLm9mKHRvYXN0U2V0KGUpKSwgT2JzZXJ2YWJsZS5vZihzZXF1ZW5jZVJlY2lwaWVudFVwZGF0ZShhY3Rpb24ubWV0YSwgZSkpKTsgfSk7CiAgICB9KTsKfTsKdmFyIHNlcXVlbmNlUmVjaXBpZW50UmVhY3RpdmF0ZUVwaWMgPSBmdW5jdGlvbiAoYWN0aW9uJCwgc3RvcmUsIGRlcHMpIHsKICAgIHJldHVybiBhY3Rpb24kLm9mVHlwZShTRVFVRU5DRV9SRUNJUElFTlRfUkVBQ1RJVkFURSkKICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChhY3Rpb24pIHsgcmV0dXJuIGFjdGlvbi5zdGF0dXMgPT09IEFjdGlvblN0YXR1cy5TdGFydDsgfSkKICAgICAgICAuZmxhdE1hcChmdW5jdGlvbiAoYWN0aW9uKSB7CiAgICAgICAgcmV0dXJuIGRlcHMuc2VxdWVuY2VSZWNpcGllbnRzLnJlYWN0aXZhdGUoYWN0aW9uLm1ldGEpCiAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKHJlc3VsdCkgeyByZXR1cm4gc2VxdWVuY2VSZWNpcGllbnRSZWFjdGl2YXRlKGFjdGlvbi5tZXRhLCByZXN1bHQpOyB9KQogICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGUpIHsgcmV0dXJuIE9ic2VydmFibGUubWVyZ2UoT2JzZXJ2YWJsZS5vZih0b2FzdFNldChlKSksIE9ic2VydmFibGUub2Yoc2VxdWVuY2VSZWNpcGllbnRSZWFjdGl2YXRlKGFjdGlvbi5tZXRhLCBlKSkpOyB9KTsKICAgIH0pOwp9Owp2YXIgc2VxdWVuY2VSZWNpcGllbnREZWxldGVFcGljID0gZnVuY3Rpb24gKGFjdGlvbiQsIHN0b3JlLCBkZXBzKSB7CiAgICByZXR1cm4gYWN0aW9uJC5vZlR5cGUoU0VRVUVOQ0VfUkVDSVBJRU5UX0RFTEVURSkKICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChhY3Rpb24pIHsgcmV0dXJuIGFjdGlvbi5zdGF0dXMgPT09IEFjdGlvblN0YXR1cy5TdGFydDsgfSkKICAgICAgICAuZmxhdE1hcChmdW5jdGlvbiAoYWN0aW9uKSB7CiAgICAgICAgcmV0dXJuIGRlcHMuc2VxdWVuY2VSZWNpcGllbnRzLmRlbGV0ZShhY3Rpb24ubWV0YSkKICAgICAgICAgICAgLmZsYXRNYXAoZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgICAgICByZXR1cm4gT2JzZXJ2YWJsZS5tZXJnZShPYnNlcnZhYmxlLm9mKHNlcXVlbmNlUmVjaXBpZW50RGVsZXRlKGFjdGlvbi5tZXRhLCBudWxsKSksIE9ic2VydmFibGUub2Yoc2VxdWVuY2VTdGFnZVJlY2lwaWVudERlbGV0ZShhY3Rpb24ubWV0YSwgbnVsbCkpKTsKICAgICAgICB9KQogICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgLy8gaGFuZGxlIDQwNCBhcyBjb21wbGV0aW9uCiAgICAgICAgICAgIGlmIChlICYmIGUuY29kZSA9PT0gNDA0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gT2JzZXJ2YWJsZS5tZXJnZShPYnNlcnZhYmxlLm9mKHNlcXVlbmNlUmVjaXBpZW50RGVsZXRlKGFjdGlvbi5tZXRhLCBudWxsKSksIE9ic2VydmFibGUub2Yoc2VxdWVuY2VTdGFnZVJlY2lwaWVudERlbGV0ZShhY3Rpb24ubWV0YSwgbnVsbCkpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aHJvdyBlOwogICAgICAgIH0pCiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZSkgeyByZXR1cm4gT2JzZXJ2YWJsZS5tZXJnZShPYnNlcnZhYmxlLm9mKHRvYXN0U2V0KGUpKSwgT2JzZXJ2YWJsZS5vZihzZXF1ZW5jZVJlY2lwaWVudERlbGV0ZShhY3Rpb24ubWV0YSwgZSkpKTsgfSk7CiAgICB9KTsKfTsKdmFyIHNlcXVlbmNlUmVjaXBpZW50SGVhZGVyc0FkZEVwaWMgPSBmdW5jdGlvbiAoYWN0aW9uJCwgc3RvcmUsIGRlcHMpIHsKICAgIHJldHVybiBhY3Rpb24kLm9mVHlwZShTRVFVRU5DRV9SRUNJUElFTlRfSEVBREVSU19BREQpCiAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoYWN0aW9uKSB7IHJldHVybiBhY3Rpb24uc3RhdHVzID09PSBBY3Rpb25TdGF0dXMuU3RhcnQgJiYKICAgICAgICAhIXN0b3JlLmdldFN0YXRlKCkuc2VsZWN0ZWRTZXF1ZW5jZSAmJgogICAgICAgICEhc3RvcmUuZ2V0U3RhdGUoKS5zZXF1ZW5jZVJlY2lwaWVudHNBZGRTdGF0ZSAmJgogICAgICAgICEhc3RvcmUuZ2V0U3RhdGUoKS5zZXF1ZW5jZVJlY2lwaWVudHNBZGRTdGF0ZS5jc3Y7IH0pCiAgICAgICAgLmZsYXRNYXAoZnVuY3Rpb24gKGFjdGlvbikgewogICAgICAgIHZhciBzZXF1ZW5jZSA9IHN0b3JlLmdldFN0YXRlKCkuc2VsZWN0ZWRTZXF1ZW5jZTsKICAgICAgICB2YXIgc3RhdGUgPSBzdG9yZS5nZXRTdGF0ZSgpLnNlcXVlbmNlUmVjaXBpZW50c0FkZFN0YXRlOwogICAgICAgIHJldHVybiBPYnNlcnZhYmxlLmNvbmNhdChPYnNlcnZhYmxlLm9mKHNlcXVlbmNlUmVjaXBpZW50VXBsb2FkKHsKICAgICAgICAgICAgc2VxdWVuY2U6IHNlcXVlbmNlLAogICAgICAgICAgICBjbG91ZEZpbGU6IHN0YXRlLmNzdiwKICAgICAgICAgICAgZW1haWxIZWFkZXI6IGFjdGlvbi5tZXRhLmVtYWlsLAogICAgICAgICAgICBmYW1pbHlOYW1lSGVhZGVyOiBhY3Rpb24ubWV0YS5mYW1pbHlOYW1lLAogICAgICAgICAgICBnaXZlbk5hbWVIZWFkZXI6IGFjdGlvbi5tZXRhLmdpdmVuTmFtZSwKICAgICAgICB9KSksIE9ic2VydmFibGUub2Yoc2VxdWVuY2VSZWNpcGllbnRIZWFkZXJzQWRkKGFjdGlvbi5tZXRhLCBudWxsKSkpCiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZSkgeyByZXR1cm4gT2JzZXJ2YWJsZS5vZih0b2FzdFNldChlKSk7IH0pOwogICAgfSk7Cn07CnZhciBzZXF1ZW5jZVJlY2lwaWVudFRlbXBVcGRhdGVFcGljID0gZnVuY3Rpb24gKGFjdGlvbiQsIHN0b3JlLCBkZXBzKSB7CiAgICByZXR1cm4gYWN0aW9uJC5vZlR5cGUoU0VRVUVOQ0VfUkVDSVBJRU5UX1RFTVBfVVBEQVRFKQogICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKGFjdGlvbikgeyByZXR1cm4gYWN0aW9uLnN0YXR1cyA9PT0gQWN0aW9uU3RhdHVzLlN0YXJ0ICYmCiAgICAgICAgISFzdG9yZS5nZXRTdGF0ZSgpLnNlbGVjdGVkU2VxdWVuY2UgJiYgISFhY3Rpb24ubWV0YS52YWxpZGF0ZTsgfSkKICAgICAgICAuZmxhdE1hcChmdW5jdGlvbiAoYWN0aW9uKSB7CiAgICAgICAgcmV0dXJuIGRlcHMuc2VxdWVuY2VSZWNpcGllbnRzLnZhbGlkYXRlKHsKICAgICAgICAgICAgZW1haWw6IGFjdGlvbi5tZXRhLnJlY2lwaWVudC5lbWFpbCwKICAgICAgICAgICAgZmFtaWx5TmFtZTogYWN0aW9uLm1ldGEucmVjaXBpZW50LmZhbWlseU5hbWUsCiAgICAgICAgICAgIGdpdmVuTmFtZTogYWN0aW9uLm1ldGEucmVjaXBpZW50LmdpdmVuTmFtZSwKICAgICAgICAgICAgc2VxdWVuY2U6IHN0b3JlLmdldFN0YXRlKCkuc2VsZWN0ZWRTZXF1ZW5jZSwKICAgICAgICAgICAgdmFyaWFibGVzOiBhY3Rpb24ubWV0YS5yZWNpcGllbnQudmFyaWFibGVzLAogICAgICAgIH0pCiAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKHJlc3VsdCkgeyByZXR1cm4gc2VxdWVuY2VSZWNpcGllbnRUZW1wVXBkYXRlKGFjdGlvbi5tZXRhLCByZXN1bHQpOyB9KTsKICAgIH0pOwp9OwpleHBvcnQgZGVmYXVsdCBbCiAgICBzZXF1ZW5jZVJlY2lwaWVudENyZWF0ZUVwaWMsCiAgICBzZXF1ZW5jZVJlY2lwaWVudFVwbG9hZEVwaWMsCiAgICBzZXF1ZW5jZVJlY2lwaWVudExpc3RFcGljLAogICAgc2VxdWVuY2VSZWNpcGllbnREZWxldGVFcGljLAogICAgc2VxdWVuY2VSZWNpcGllbnRVcGRhdGVFcGljLAogICAgc2VxdWVuY2VSZWNpcGllbnRIZWFkZXJzQWRkRXBpYywKICAgIHNlcXVlbmNlUmVjaXBpZW50VGVtcFVwZGF0ZUVwaWMsCiAgICBzZXF1ZW5jZVJlY2lwaWVudFJlYWN0aXZhdGVFcGljLApdOwo="},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/epics/sequenceRecipients.ts","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/epics/sequenceRecipients.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  ActionStatus,\n  Action,\n  StoreState,\n  Resource,\n} from '@src/types';\nimport { SequenceRecipient } from '@src/types/sequences';\nimport { Epic } from 'redux-observable';\nimport { Deps } from '@src/lib/epic';\nimport { Observable } from 'rxjs';\nimport {\n  SEQUENCE_RECIPIENT_LIST, sequenceRecipientList,\n  SEQUENCE_RECIPIENT_DELETE, sequenceRecipientDelete,\n  SEQUENCE_RECIPIENT_UPLOAD, sequenceRecipientUpload,\n  SEQUENCE_RECIPIENT_UPDATE, sequenceRecipientUpdate,\n  sequenceRecipientCreate, SEQUENCE_RECIPIENT_CREATE,\n  SequenceRecipientUploadMeta,\n  SequenceRecipientUpdateMeta,\n  SequenceRecipientUploadPayload,\n  SequenceRecipientListMeta,\n  SequenceRecipientDeleteMeta,\n  SequenceRecipientCreateMeta,\n  SequenceRecipientHeadersAddMeta,\n  SEQUENCE_RECIPIENT_HEADERS_ADD,\n  sequenceRecipientHeadersAdd,\n  SequenceRecipientCreateRecipient,\n  SequenceRecipientTempUpdateMeta,\n  sequenceRecipientTempUpdate,\n  SEQUENCE_RECIPIENT_TEMP_UPDATE,\n  SEQUENCE_RECIPIENT_REACTIVATE,\n  sequenceRecipientReactivate,\n} from '@src/ducks/sequenceRecipients';\nimport { toastSet } from '@src/ducks/toasts';\nimport { ApiError } from '@src/api/base';\nimport { sequenceStageRecipientDelete } from '@src/ducks/sequenceStageRecipients';\nimport { recordEvent, UserEvents } from '@src/lib/analytics';\n\nconst sequenceRecipientListEpic: Epic<Action<\n  SequenceRecipientListMeta, SequenceRecipient[]\n>, StoreState, Deps>\n  = (action$, store, deps) =>\n    action$.ofType(SEQUENCE_RECIPIENT_LIST)\n      .filter(action => action.status === ActionStatus.Start)\n      .flatMap(action =>\n        deps.sequenceRecipients.list(action.meta)\n          .map(result => sequenceRecipientList(action.meta, result))\n          .catch((e: Error) => Observable.of(sequenceRecipientList(action.meta, e))),\n    );\n\nconst sequenceRecipientUploadEpic: Epic<Action<\nSequenceRecipientUploadMeta|Error|null,\nSequenceRecipientUploadPayload|null\n>, StoreState, Deps> = (action$, store, deps) =>\n  action$.ofType(SEQUENCE_RECIPIENT_UPLOAD)\n    .filter(action => action.status === ActionStatus.Start)\n    .flatMap((action: Action<SequenceRecipientUploadMeta, SequenceRecipientUploadPayload>) =>\n      deps.sequenceRecipients.upload(\n        action.meta.sequence,\n        action.meta.cloudFile,\n        action.meta.emailHeader,\n        action.meta.givenNameHeader,\n        action.meta.familyNameHeader,\n      )\n        .flatMap(result =>\n          Observable.merge(\n            Observable.of(sequenceRecipientUpload(action.meta, result)),\n          ),\n        )\n        .catch(error => Observable.merge(\n          Observable.of(toastSet(error)),\n          Observable.of(sequenceRecipientUpload(action.meta, error)),\n        )),\n    );\n\nconst sequenceRecipientCreateEpic: Epic<\n  Action<SequenceRecipientCreateMeta | any, SequenceRecipient[] | any>, StoreState, Deps\n  > = (action$, store, deps) =>\n    action$.ofType(SEQUENCE_RECIPIENT_CREATE)\n      .filter(action => action.status === ActionStatus.Start\n        && !!store.getState().sequenceRecipientsAddState\n        && !!store.getState().sequenceRecipientsAddState!.recipients\n        && !!store.getState().sequenceRecipientsAddState!.headers)\n      .flatMap((action: Action<SequenceRecipientCreateMeta, SequenceRecipient[]>) => {\n        const sequenceRecipientsAddState = store.getState().sequenceRecipientsAddState!;\n        const recipients = sequenceRecipientsAddState.recipients\n          .filter(r => !!r.data)\n          .map((r: Resource<SequenceRecipientCreateRecipient>) => {\n            const variables = {};\n            sequenceRecipientsAddState.headers.forEach((h) => {\n              if (h.toLowerCase() !== 'email' && h.toLowerCase() !== 'last name' &&\n                h.toLowerCase() !== 'first name' && r.data) {\n                variables[h] = r.data.variables ? r.data.variables[h] : '';\n              }\n            });\n\n            return {\n              ...r.data as SequenceRecipientCreateRecipient,\n              paused: action.meta.addAsPaused,\n              variables,\n            };\n          });\n\n        return deps.sequenceRecipients.create({\n          sequence: action.meta.sequence,\n          recipients,\n        })\n        // Log Sequence Recipient Upload events\n          .do(() => {\n            const state = store.getState();\n            const meta = action.meta;\n            recordEvent(UserEvents.SequenceRecipientsUploaded, {\n              sequence: action.meta.sequence,\n              count: recipients.length,\n              team: state.sequences[meta.sequence] &&\n                state.sequences[meta.sequence].data &&\n                state.sequences[meta.sequence].data!.team,\n            });\n          })\n          .map(result => sequenceRecipientCreate(action.meta, result))\n          .catch((e: Error) => Observable.merge(\n            Observable.of(toastSet(e)),\n            Observable.of(sequenceRecipientCreate(action.meta, e)),\n          ));\n      },\n    );\n\nconst sequenceRecipientUpdateEpic: Epic<\nAction<SequenceRecipientUpdateMeta|any, SequenceRecipient|null>, StoreState, Deps\n> = (action$, store, deps) =>\n  action$.ofType(SEQUENCE_RECIPIENT_UPDATE)\n    .filter(action => action.status === ActionStatus.Start)\n    .flatMap((action: Action<SequenceRecipient, SequenceRecipient>) =>\n      deps.sequenceRecipients.update(action.meta)\n        .map(result => sequenceRecipientUpdate(action.meta, result))\n        .catch((e: Error) => Observable.merge(\n          Observable.of(toastSet(e)),\n          Observable.of(sequenceRecipientUpdate(action.meta, e)),\n        )),\n    );\n\nconst sequenceRecipientReactivateEpic: Epic<\nAction<SequenceRecipientUpdateMeta|any, SequenceRecipient|null>, StoreState, Deps\n> = (action$, store, deps) =>\n  action$.ofType(SEQUENCE_RECIPIENT_REACTIVATE)\n    .filter(action => action.status === ActionStatus.Start)\n    .flatMap((action: Action<SequenceRecipient, SequenceRecipient>) =>\n      deps.sequenceRecipients.reactivate(action.meta)\n        .map(result => sequenceRecipientReactivate(action.meta, result))\n        .catch((e: Error) => Observable.merge(\n          Observable.of(toastSet(e)),\n          Observable.of(sequenceRecipientReactivate(action.meta, e)),\n        )),\n    );\n\nconst sequenceRecipientDeleteEpic: Epic<\nAction<SequenceRecipientDeleteMeta|any, null>, StoreState, Deps\n> = (action$, store, deps) =>\n  action$.ofType(SEQUENCE_RECIPIENT_DELETE)\n    .filter(action => action.status === ActionStatus.Start)\n    .flatMap(action =>\n      deps.sequenceRecipients.delete(action.meta)\n        .flatMap(result =>\n          Observable.merge(\n            Observable.of(sequenceRecipientDelete(action.meta, null)),\n            Observable.of(sequenceStageRecipientDelete(action.meta, null)),\n          ),\n        )\n        .catch((e) => {\n          // handle 404 as completion\n          if (e as ApiError && e.code === 404) {\n            return Observable.merge(\n              Observable.of(sequenceRecipientDelete(action.meta, null)),\n              Observable.of(sequenceStageRecipientDelete(action.meta, null)),\n            );\n          }\n\n          throw e;\n        })\n        .catch((e: Error) => Observable.merge(\n          Observable.of(toastSet(e)),\n          Observable.of(sequenceRecipientDelete(action.meta, e)),\n        )),\n    );\n\nconst sequenceRecipientHeadersAddEpic: Epic<Action<\n  SequenceRecipientHeadersAddMeta| SequenceRecipientUploadMeta | Error | null, any\n>, StoreState, Deps> =\n  (action$, store, deps) =>\n    action$.ofType(SEQUENCE_RECIPIENT_HEADERS_ADD)\n      .filter(action => action.status === ActionStatus.Start &&\n        !!store.getState().selectedSequence &&\n        !!store.getState().sequenceRecipientsAddState &&\n        !!store.getState().sequenceRecipientsAddState!.csv)\n      .flatMap((action: Action<SequenceRecipientHeadersAddMeta, null>) => {\n        const sequence = store.getState().selectedSequence!;\n        const state = store.getState().sequenceRecipientsAddState!;\n        return Observable.concat(\n          Observable.of(sequenceRecipientUpload({\n            sequence,\n            cloudFile: state.csv!,\n            emailHeader: action.meta.email,\n            familyNameHeader: action.meta.familyName,\n            givenNameHeader: action.meta.givenName,\n          })),\n          Observable.of(sequenceRecipientHeadersAdd(\n            action.meta, null,\n          )),\n        )\n        .catch((e: Error) => Observable.of(toastSet(e)));\n      });\n\nconst sequenceRecipientTempUpdateEpic: Epic<Action<\n  SequenceRecipientTempUpdateMeta, SequenceRecipient\n>, StoreState, Deps>\n  = (action$, store, deps) =>\n    action$.ofType(SEQUENCE_RECIPIENT_TEMP_UPDATE)\n      .filter(action => action.status === ActionStatus.Start &&\n        !!store.getState().selectedSequence && !!action.meta.validate)\n      .flatMap(action =>\n        deps.sequenceRecipients.validate({\n          email: action.meta.recipient.email,\n          familyName: action.meta.recipient.familyName,\n          givenName: action.meta.recipient.givenName,\n          sequence: store.getState().selectedSequence!,\n          variables: action.meta.recipient.variables,\n        })\n        .map(result => sequenceRecipientTempUpdate(action.meta, result)),\n      );\n\nexport default [\n  sequenceRecipientCreateEpic,\n  sequenceRecipientUploadEpic,\n  sequenceRecipientListEpic,\n  sequenceRecipientDeleteEpic,\n  sequenceRecipientUpdateEpic,\n  sequenceRecipientHeadersAddEpic,\n  sequenceRecipientTempUpdateEpic,\n  sequenceRecipientReactivateEpic,\n];\n"]}]}