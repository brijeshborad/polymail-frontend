{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/RightSidebar/components/Onboarding/Legend/components/OnboardingSectionDetail/OnboardingSectionDetail.tsx","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/RightSidebar/components/Onboarding/Legend/components/OnboardingSectionDetail/OnboardingSectionDetail.tsx","mtime":1675286480570},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewogICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewogICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAogICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKICAgIH07CiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwogICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQogICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKICAgIH07Cn0pKCk7CnZhciBfX2Fzc2lnbiA9ICh0aGlzICYmIHRoaXMuX19hc3NpZ24pIHx8IGZ1bmN0aW9uICgpIHsKICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbih0KSB7CiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7CiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07CiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkKICAgICAgICAgICAgICAgIHRbcF0gPSBzW3BdOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdDsKICAgIH07CiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfTsKaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JzsKaW1wb3J0IHsgU3ByaW5nLCBhbmltYXRlZCwgY29uZmlnIH0gZnJvbSAncmVhY3Qtc3ByaW5nJzsKaW1wb3J0IGNsYXNzbmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7CmltcG9ydCB7IEtleUNvZGUsIE9uYm9hcmRpbmdUeXBlLCB9IGZyb20gJ0BzcmMvdHlwZXMnOwppbXBvcnQgJy4vT25ib2FyZGluZ1NlY3Rpb25EZXRhaWwuc2Nzcyc7CmltcG9ydCB7IEhvdGtleUFjdGlvbiwgaG90a2V5c1R5cGVhaGVhZCwgZ2V0SG90a2V5LCBnZXRIb3RrZXlCeU5hbWUgfSBmcm9tICdAc3JjL2xpYi9ob3RrZXlzJzsKaW1wb3J0IFJvdW5kQ2hlY2ttYXJrIGZyb20gJ0BzcmMvY29tcG9uZW50cy9JY29ucy9Sb3VuZENoZWNrbWFyay5zdmcnOwppbXBvcnQgS2V5Ym9hcmRTeW1ib2wgZnJvbSAnQHNyYy9jb21wb25lbnRzL0Jhc2UvS2V5Ym9hcmRTeW1ib2wvS2V5Ym9hcmRTeW1ib2wnOwppbXBvcnQgeyBpbmRleE9mIH0gZnJvbSAnbG9kYXNoJzsKaW1wb3J0IHsgY3JlYXRlTWFpbFRvRHJhZnQgfSBmcm9tICdAc3JjL2xpYi9kcmFmdCc7CmltcG9ydCB7IGRyYWZ0Q3JlYXRlIH0gZnJvbSAnQHNyYy9kdWNrcy9kcmFmdHMnOwppbXBvcnQgeyBob3RrZXlGb3JPbmJvYXJkaW5nLCByYW5kb21pemVkUmVpbmZvcmNlbWVudCwgb25ib2FyZGluZ1JlcXVpcmVzVGhyZWFkLCBvbmJvYXJkaW5nUmVxdWlyZXNEcmFmdCwgfSBmcm9tICdAc3JjL2xpYi9vbmJvYXJkaW5nJzsKaW1wb3J0IHsgb25ib2FyZGluZ1BhdGNoIH0gZnJvbSAnQHNyYy9kdWNrcy9tZSc7CmltcG9ydCBicm93c2VySGlzdG9yeSBmcm9tICdAc3JjL2xpYi9icm93c2VySGlzdG9yeSc7CmltcG9ydCB7IGdldE9uYm9hcmRpbmdBY3Rpb25zIH0gZnJvbSAnQHNyYy9saWIvT25ib2FyZGluZ0Rpc3BhdGNoZXInOwppbXBvcnQgeyBJU19NQUMgfSBmcm9tICdAc3JjL2xpYi9kZXZpY2UnOwppbXBvcnQgT25ib2FyZGluZ1RpcCwgeyBBbmNob3JQb3NpdGlvbiB9IGZyb20gJ0BzcmMvY29tcG9uZW50cy9PbmJvYXJkaW5nL2NvbXBvbmVudHMvT25ib2FyZGluZ1RpcC9PbmJvYXJkaW5nVGlwJzsKaW1wb3J0IERlbW9WaWRlb1ByZXZpZXcgZnJvbSAnQHNyYy9jb21wb25lbnRzL0RlbW9WaWRlby9EZW1vVmlkZW9QcmV2aWV3JzsKaW1wb3J0IHsgaXNGb2N1c2VkT25FZGl0YWJsZUNvbnRlbnQgfSBmcm9tICdAc3JjL2xpYi91dGlscyc7CmltcG9ydCB7IEFtcGxpdHVkZUV2ZW50cywgbG9nQW1wbGl0dWRlRXZlbnQgfSBmcm9tICdAc3JjL2xpYi9hbXBsaXR1ZGUtYW5hbHl0aWNzJzsKLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aAovLyBUT0RPKFNISU4pOiBJbnRyb2R1Y3Rpb24gKEdldHRpbmcgU3RhcnRlZCBJbmZvcm1hdGlvbikKdmFyIE9uYm9hcmRpbmdTZWN0aW9uRGV0YWlsID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewogICAgX19leHRlbmRzKE9uYm9hcmRpbmdTZWN0aW9uRGV0YWlsLCBfc3VwZXIpOwogICAgZnVuY3Rpb24gT25ib2FyZGluZ1NlY3Rpb25EZXRhaWwocHJvcHMpIHsKICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpczsKICAgICAgICAvLyBIYW5kbGVzIE9ic2VydmluZyBPbmJvYXJkaW5nIEV2ZW50IHRoYXQgYXJlIG1hbnVhbGx5IGNvbXBsZXRlZAogICAgICAgIF90aGlzLm9ic2VydmVPbmJvYXJkaW5nRXZlbnRzID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICBfdGhpcy5vbmJvYXJkaW5nU3Vic2NyaXB0aW9uID0gZ2V0T25ib2FyZGluZ0FjdGlvbnMoKS5zdWJzY3JpYmUoewogICAgICAgICAgICAgICAgbmV4dDogZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgX2EgPSBfdGhpcy5wcm9wcywgYWN0aXZlU3RlcCA9IF9hLmFjdGl2ZVN0ZXAsIGN1cnJlbnRTdGVwID0gX2EuY3VycmVudFN0ZXA7CiAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zaXRpb25BbmltYXRpb24gPSBfdGhpcy5zdGF0ZS50cmFuc2l0aW9uQW5pbWF0aW9uOwogICAgICAgICAgICAgICAgICAgIC8vIERvIG5vdCBvYnNlcnZlIGFjdGlvbnMgaWYgdHJhbnNpdGlvbiBhbmltYXRpb24gYWN0aXZhdGVkCiAgICAgICAgICAgICAgICAgICAgaWYgKHRyYW5zaXRpb25BbmltYXRpb24pIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAvLyBMZXQgZGVmYXVsdCBoYW5kbGluZyBvY2N1ciBpZiBhY3RpdmUgc3RlcCBpcyBlcXVhbCB0byBjdXJyZW50IHN0ZXAKICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aXZlU3RlcCA9PT0gY3VycmVudFN0ZXApIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAvLyBNYXJrIGNvbXBsZXRpb24gaWYgYWN0aXZlIHN0ZXAgaXMgdHJ1ZQogICAgICAgICAgICAgICAgICAgIGlmIChhID09PSBhY3RpdmVTdGVwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhhbmRsZSBzdGF0ZSB1cGRhdGVzIGZvciBtYW51YWwgY29tcGxldGlvbnMKICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNpdGlvbkFuaW1hdGlvbjogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlQWN0aXZhdGVkOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hbnVhbENvbXBsZXRpb25BY3RpdmF0ZWQ6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0pOwogICAgICAgIH07CiAgICAgICAgLy8gQ3VzdG9tIG9ic2VydmF0aW9uIGZvciBrZXkgZXZlbnRzIHRvIHNob3cgaW50ZXJtZWRpYXRlIHN0ZXAgY29tcGxldGlvbnMKICAgICAgICBfdGhpcy5vYnNlcnZlS2V5RG93biA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIHZhciBfYSwgX2IsIF9jLCBfZDsKICAgICAgICAgICAgdmFyIF9lID0gX3RoaXMucHJvcHMsIGFjdGl2ZVN0ZXAgPSBfZS5hY3RpdmVTdGVwLCBpc0RyYWZ0ID0gX2UuaXNEcmFmdCwgaXNUaHJlYWQgPSBfZS5pc1RocmVhZDsKICAgICAgICAgICAgdmFyIHRyYW5zaXRpb25BbmltYXRpb24gPSBfdGhpcy5zdGF0ZS50cmFuc2l0aW9uQW5pbWF0aW9uOwogICAgICAgICAgICB2YXIgaG90a2V5ID0gZ2V0SG90a2V5KGUpOwogICAgICAgICAgICBpZiAoIWFjdGl2ZVN0ZXApIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAodHJhbnNpdGlvbkFuaW1hdGlvbiAmJiBlLmtleUNvZGUgPT09IEtleUNvZGUuRW50ZXIpIHsKICAgICAgICAgICAgICAgIF90aGlzLmhhbmRsZUNvbnRpbnVlKCk7CiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIERvIG5vdCBvYnNlcnZlIGhvdGtleXMgd2hlbiBwcmVyZXF1aXNpdGVzIGhhdmUgbm90IGJlZW4gbWV0CiAgICAgICAgICAgIGlmIChhY3RpdmVTdGVwICYmICF0cmFuc2l0aW9uQW5pbWF0aW9uICYmICFpc1RocmVhZCAmJiBvbmJvYXJkaW5nUmVxdWlyZXNUaHJlYWQoYWN0aXZlU3RlcCkpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBEbyBub3Qgb2JzZXJ2ZSBob3RrZXlzIHdoZW4gcHJlcmVxdWlzaXRlcyBoYXZlIG5vdCBiZWVuIG1ldCwgZXhjZXB0IGZvciBkcmFmdCBjcmVhdGUKICAgICAgICAgICAgaWYgKGFjdGl2ZVN0ZXAgJiYgIXRyYW5zaXRpb25BbmltYXRpb24gJiYgIWlzRHJhZnQgJiYgb25ib2FyZGluZ1JlcXVpcmVzRHJhZnQoYWN0aXZlU3RlcCkpIHsKICAgICAgICAgICAgICAgIC8vIERvbid0IGFjdGl2YXRlIG5ldyBkcmFmdCBpZiBpbiBhIGVkaXRhYmxlIGVsZW1lbnQKICAgICAgICAgICAgICAgIGlmIChpc0ZvY3VzZWRPbkVkaXRhYmxlQ29udGVudCgpKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGFjdGl2ZVN0ZXAgJiYgKGhvdGtleSA9PT0gbnVsbCB8fCBob3RrZXkgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGhvdGtleS5uYW1lKSA9PT0gSG90a2V5QWN0aW9uLk5ld0RyYWZ0KSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGl2ZVN0ZXAgPT09IE9uYm9hcmRpbmdUeXBlLkZvbGxvd1VwUmVtaW5kZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbG9nQW1wbGl0dWRlRXZlbnQoQW1wbGl0dWRlRXZlbnRzLlRvdXJTdGVwVHdvLCB7IHNraXBwZWQ6IGZhbHNlIH0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBfdGhpcy5oYW5kbGVEcmFmdENyZWF0ZSgpOwogICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICB2YXIgYWN0aXZhdGVkSG90a2V5cyA9IF90aGlzLnN0YXRlLmFjdGl2YXRlZEhvdGtleXM7CiAgICAgICAgICAgIC8vIFRPRE8oU0hJTik6IEFjdGl2YXRlIGhvdGtleQogICAgICAgICAgICBzd2l0Y2ggKGFjdGl2ZVN0ZXApIHsKICAgICAgICAgICAgICAgIGNhc2UgT25ib2FyZGluZ1R5cGUuTmV4dFRocmVhZDoKICAgICAgICAgICAgICAgIGNhc2UgT25ib2FyZGluZ1R5cGUuQXJjaGl2ZToKICAgICAgICAgICAgICAgICAgICBpZiAoIWFjdGl2YXRlZEhvdGtleXNbSG90a2V5QWN0aW9uLk5leHRUaHJlYWRdICYmCiAgICAgICAgICAgICAgICAgICAgICAgIFtLZXlDb2RlLkosIEtleUNvZGUuRG93bl0uaW5kZXhPZihlLmtleUNvZGUpID4gLTEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVwZGF0ZWQgPSBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgYWN0aXZhdGVkSG90a2V5cyksIChfYSA9IHt9LCBfYVtIb3RrZXlBY3Rpb24uTmV4dFRocmVhZF0gPSB0cnVlLCBfYSkpOwogICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IGFjdGl2YXRlZEhvdGtleXM6IHVwZGF0ZWQgfSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmICghYWN0aXZhdGVkSG90a2V5c1tIb3RrZXlBY3Rpb24uUHJldmlvdXNUaHJlYWRdICYmCiAgICAgICAgICAgICAgICAgICAgICAgIFtLZXlDb2RlLkssIEtleUNvZGUuVXBdLmluZGV4T2YoZS5rZXlDb2RlKSA+IC0xKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1cGRhdGVkID0gX19hc3NpZ24oX19hc3NpZ24oe30sIGFjdGl2YXRlZEhvdGtleXMpLCAoX2IgPSB7fSwgX2JbSG90a2V5QWN0aW9uLlByZXZpb3VzVGhyZWFkXSA9IHRydWUsIF9iKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsgYWN0aXZhdGVkSG90a2V5czogdXBkYXRlZCB9KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKGhvdGtleSAmJiBhY3RpdmVTdGVwICYmIGhvdGtleUZvck9uYm9hcmRpbmcoYWN0aXZlU3RlcCkgPT09IGhvdGtleS5uYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1cGRhdGVkID0gX19hc3NpZ24oX19hc3NpZ24oe30sIGFjdGl2YXRlZEhvdGtleXMpLCAoX2MgPSB7fSwgX2NbaG90a2V5Lm5hbWVdID0gdHJ1ZSwgX2MpKTsKICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBhY3RpdmF0ZWRIb3RrZXlzOiB1cGRhdGVkIH0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgaWYgKGhvdGtleSAmJiBhY3RpdmVTdGVwICYmIGhvdGtleUZvck9uYm9hcmRpbmcoYWN0aXZlU3RlcCkgPT09IGhvdGtleS5uYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1cGRhdGVkID0gX19hc3NpZ24oX19hc3NpZ24oe30sIGFjdGl2YXRlZEhvdGtleXMpLCAoX2QgPSB7fSwgX2RbaG90a2V5Lm5hbWVdID0gdHJ1ZSwgX2QpKTsKICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBhY3RpdmF0ZWRIb3RrZXlzOiB1cGRhdGVkIH0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlQ29udGludWUgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBtYW51YWxDb21wbGV0aW9uQWN0aXZhdGVkID0gX3RoaXMuc3RhdGUubWFudWFsQ29tcGxldGlvbkFjdGl2YXRlZDsKICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBjb250aW51ZUFjdGl2YXRlZDogdHJ1ZSwgaG90a2V5QWN0aXZhdGVkOiB0cnVlIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dChfdGhpcy50aW1lb3V0KTsKICAgICAgICAgICAgICAgIF90aGlzLnRpbWVvdXQgPSBnbG9iYWwuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2l0aW9uQW5pbWF0aW9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZhdGVkSG90a2V5czoge30sCiAgICAgICAgICAgICAgICAgICAgICAgIG1hbnVhbENvbXBsZXRpb25BY3RpdmF0ZWQ6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1hbnVhbENvbXBsZXRpb25BY3RpdmF0ZWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmhhbmRsZU1hbnVhbE5leHQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSwgMTAwMCk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlQ3JlZGl0Q2xhaW0gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBjbGFpbUNyZWRpdCA9IF90aGlzLnByb3BzLmNsYWltQ3JlZGl0OwogICAgICAgICAgICBjbGFpbUNyZWRpdCh7IGNsYWltZWRDcmVkaXQ6IHRydWUgfSk7CiAgICAgICAgICAgIGxvZ0FtcGxpdHVkZUV2ZW50KEFtcGxpdHVkZUV2ZW50cy5Ub3VyU3RlcEZvdXJ0ZWVuLCB7IHNraXBwZWQ6IGZhbHNlIH0pOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlRG93bmxvYWROYXRpdmVBcHBzID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgZGlzcGF0Y2hBY3Rpb24gPSBfdGhpcy5wcm9wcy5kaXNwYXRjaEFjdGlvbjsKICAgICAgICAgICAgZGlzcGF0Y2hBY3Rpb24ob25ib2FyZGluZ1BhdGNoKHsKICAgICAgICAgICAgICAgIHR5cGU6IHsgZG93bmxvYWROYXRpdmVBcHBzOiB0cnVlIH0sCiAgICAgICAgICAgICAgICBza2lwcGVkOiBmYWxzZSwKICAgICAgICAgICAgfSkpOwogICAgICAgICAgICBsb2dBbXBsaXR1ZGVFdmVudChBbXBsaXR1ZGVFdmVudHMuVG91clN0ZXBUaGlydGVlbiwgeyBza2lwcGVkOiBmYWxzZSB9KTsKICAgICAgICAgICAgZ2V0T25ib2FyZGluZ0FjdGlvbnMoKS5uZXh0KE9uYm9hcmRpbmdUeXBlLkRvd25sb2FkTmF0aXZlQXBwcyk7CiAgICAgICAgICAgIHdpbmRvdy5vcGVuKCdodHRwczovL3BvbHltYWlsLmlvL2Rvd25sb2FkP2Rvd25sb2FkPTEmdXRtX3NvdXJjZT1wb2x5bWFpbCZ1dG1fY2FtcGFpZ249d2ViYXBwJywgJ19ibGFuaycpOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlRHJhZnRDcmVhdGUgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBfYSA9IF90aGlzLnByb3BzLCBwcmVmZXJlbmNlcyA9IF9hLnByZWZlcmVuY2VzLCBkaXNwYXRjaEFjdGlvbiA9IF9hLmRpc3BhdGNoQWN0aW9uLCBhY2NvdW50cyA9IF9hLmFjY291bnRzLCBmZWF0dXJlcyA9IF9hLmZlYXR1cmVzLCBhY3RpdmVTdGVwID0gX2EuYWN0aXZlU3RlcDsKICAgICAgICAgICAgaWYgKHByZWZlcmVuY2VzICYmIGFjdGl2ZVN0ZXAgJiYgYWN0aXZlU3RlcCA9PT0gT25ib2FyZGluZ1R5cGUuU2F2ZUFzVGVtcGxhdGUpIHsKICAgICAgICAgICAgICAgIHZhciBtYWlsVG9TdHJpbmcgPSAnUG9seSBCb3QgPG9uYm9hcmRpbmcrZXh0cmFzQHBvbHltYWlsLmlvPj9zdWJqZWN0PeKaoe+4jyAnCiAgICAgICAgICAgICAgICAgICAgKyAnU2F2aW5nIGEgTWVzc2FnZSBUZW1wbGF0ZSEmYm9keT1IZWxsbyEg8J+Ri/Cfj7xcblxuJwogICAgICAgICAgICAgICAgICAgICsgJ1dlXCdsbCBiZSB1c2luZyB0aGlzIGRyYWZ0IHRvIGNyZWF0ZSBhIHRlbXBsYXRlIGZyb20gYSBtZXNzYWdlIHlvdSBhcmUgY3JlYXRpbmcuJwogICAgICAgICAgICAgICAgICAgICsgJ1xuXG4nCiAgICAgICAgICAgICAgICAgICAgKyAnVHJ5IGZvbGxvd2luZyB0aGUgaW5zdHJ1Y3Rpb25zIG9uIHRoZSByaWdodCB0byBzYXZlIHRoaXMgYXMgYSB0ZW1wbGF0ZSEnOwogICAgICAgICAgICAgICAgYnJvd3Nlckhpc3RvcnkucHVzaCgnL21haWwnKTsKICAgICAgICAgICAgICAgIHZhciBkcmFmdCA9IGNyZWF0ZU1haWxUb0RyYWZ0KGFjY291bnRzWzBdLCBwcmVmZXJlbmNlcywgZmVhdHVyZXMsIG1haWxUb1N0cmluZyk7CiAgICAgICAgICAgICAgICBkaXNwYXRjaEFjdGlvbihkcmFmdENyZWF0ZShkcmFmdCkpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChwcmVmZXJlbmNlcyAmJiBhY3RpdmVTdGVwICYmIGFjdGl2ZVN0ZXAgIT09IE9uYm9hcmRpbmdUeXBlLlNlbmRNZXNzYWdlKSB7CiAgICAgICAgICAgICAgICB2YXIgbWFpbFRvU3RyaW5nID0gJ1BvbHkgQm90IDxvbmJvYXJkaW5nK2V4dHJhc0Bwb2x5bWFpbC5pbz4/c3ViamVjdD3imqHvuI8gJwogICAgICAgICAgICAgICAgICAgICsgJ1NlbmRpbmcgTWVzc2FnZXMgaW4gUG9seW1haWwhJmJvZHk9SGVsbG8hIPCfkYvwn4+8XG5cbicKICAgICAgICAgICAgICAgICAgICArICdMZXRcJ3MgbGVhcm4gc29tZSBvdGhlciBmZWF0dXJlcyB0byBzdXBlcmNoYXJnZSB5b3VyIG1lc3NhZ2VzIGluIFBvbHltYWlsLlxuXG4nCiAgICAgICAgICAgICAgICAgICAgKyAnQ2hlY2sgdGhlIHJpZ2h0IHNpZGViYXIgZm9yIG1vcmUgaW5mb3JtYXRpb24hIC0tLS0tLS0+JzsKICAgICAgICAgICAgICAgIGJyb3dzZXJIaXN0b3J5LnB1c2goJy9tYWlsJyk7CiAgICAgICAgICAgICAgICB2YXIgZHJhZnQgPSBjcmVhdGVNYWlsVG9EcmFmdChhY2NvdW50c1swXSwgcHJlZmVyZW5jZXMsIGZlYXR1cmVzLCBtYWlsVG9TdHJpbmcpOwogICAgICAgICAgICAgICAgZGlzcGF0Y2hBY3Rpb24oZHJhZnRDcmVhdGUoZHJhZnQpKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAocHJlZmVyZW5jZXMpIHsKICAgICAgICAgICAgICAgIHZhciBtYWlsVG9TdHJpbmcgPSAnUG9seSBCb3QgPG9uYm9hcmRpbmdAcG9seW1haWwuaW8+P3N1YmplY3Q94pqh77iPICcKICAgICAgICAgICAgICAgICAgICArICdTZW5kIHlvdXIgZmlyc3QgbWVzc2FnZSB3aXRoIHRyYWNraW5nISZib2R5PUhlbGxvISDwn5GL8J+PvFxuXG4nCiAgICAgICAgICAgICAgICAgICAgKyAnUG9seW1haWwgYXV0b21hdGljYWxseSBnaXZlcyB5b3UgaW5zaWdodHMgb24gdGhlIGVtYWlscyB5b3Ugc2VuZCEnCiAgICAgICAgICAgICAgICAgICAgKyAnXG5cbicKICAgICAgICAgICAgICAgICAgICArICdUcnkgY2xpY2tpbmcgc2VuZCB0byBzZWUgaG93IGl0IHdvcmtzISc7CiAgICAgICAgICAgICAgICBicm93c2VySGlzdG9yeS5wdXNoKCcvbWFpbCcpOwogICAgICAgICAgICAgICAgdmFyIGRyYWZ0ID0gY3JlYXRlTWFpbFRvRHJhZnQoYWNjb3VudHNbMF0sIHByZWZlcmVuY2VzLCBmZWF0dXJlcywgbWFpbFRvU3RyaW5nKTsKICAgICAgICAgICAgICAgIGRpc3BhdGNoQWN0aW9uKGRyYWZ0Q3JlYXRlKGRyYWZ0KSk7CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIC8vIEhhbmRsZXMgc2tpcHBpbmcgc2VjdGlvbnMKICAgICAgICBfdGhpcy5oYW5kbGVTa2lwID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgX2EgPSBfdGhpcy5wcm9wcywgZGlzcGF0Y2hBY3Rpb24gPSBfYS5kaXNwYXRjaEFjdGlvbiwgY3VycmVudFN0ZXAgPSBfYS5jdXJyZW50U3RlcDsKICAgICAgICAgICAgaWYgKGRpc3BhdGNoQWN0aW9uICYmIGN1cnJlbnRTdGVwKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKGN1cnJlbnRTdGVwKSB7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBPbmJvYXJkaW5nVHlwZS5OZXh0VGhyZWFkOgogICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaEFjdGlvbihvbmJvYXJkaW5nUGF0Y2goewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2tpcHBlZDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IHsgc3RlcHM6IHsgbmV4dFRocmVhZDogdHJ1ZSB9IH0sCiAgICAgICAgICAgICAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgICAgICAgICAgICAgbG9nQW1wbGl0dWRlRXZlbnQoQW1wbGl0dWRlRXZlbnRzLlRvdXJTdGVwU2l4LCB7IHNraXBwZWQ6IHRydWUgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLkFyY2hpdmU6CiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoQWN0aW9uKG9uYm9hcmRpbmdQYXRjaCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBza2lwcGVkOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogeyBzdGVwczogeyBhcmNoaXZlOiB0cnVlIH0gfSwKICAgICAgICAgICAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICAgICAgICAgICAgICBsb2dBbXBsaXR1ZGVFdmVudChBbXBsaXR1ZGVFdmVudHMuVG91clN0ZXBTZXZlbiwgeyBza2lwcGVkOiB0cnVlIH0pOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgY2FzZSBPbmJvYXJkaW5nVHlwZS5SZWFkTGF0ZXI6CiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoQWN0aW9uKG9uYm9hcmRpbmdQYXRjaCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBza2lwcGVkOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogeyBzdGVwczogeyByZWFkTGF0ZXI6IHRydWUgfSB9LAogICAgICAgICAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ0FtcGxpdHVkZUV2ZW50KEFtcGxpdHVkZUV2ZW50cy5Ub3VyU3RlcE5pbmUsIHsgc2tpcHBlZDogdHJ1ZSB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIGNhc2UgT25ib2FyZGluZ1R5cGUuVW5kbzoKICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hBY3Rpb24ob25ib2FyZGluZ1BhdGNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNraXBwZWQ6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiB7IHN0ZXBzOiB7IHVuZG86IHRydWUgfSB9LAogICAgICAgICAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ0FtcGxpdHVkZUV2ZW50KEFtcGxpdHVkZUV2ZW50cy5Ub3VyU3RlcEVpZ2h0LCB7IHNraXBwZWQ6IHRydWUgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLlNhdmVBc1RlbXBsYXRlOgogICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaEFjdGlvbihvbmJvYXJkaW5nUGF0Y2goewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2tpcHBlZDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IHsgc3RlcHM6IHsgc2F2ZUFzVGVtcGxhdGU6IHRydWUgfSB9LAogICAgICAgICAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ0FtcGxpdHVkZUV2ZW50KEFtcGxpdHVkZUV2ZW50cy5Ub3VyU3RlcEZpdmUsIHsgc2tpcHBlZDogdHJ1ZSB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIGNhc2UgT25ib2FyZGluZ1R5cGUuU2VuZE1lc3NhZ2U6CiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoQWN0aW9uKG9uYm9hcmRpbmdQYXRjaCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBza2lwcGVkOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogeyBzZW5kTWVzc2FnZTogdHJ1ZSB9LAogICAgICAgICAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ0FtcGxpdHVkZUV2ZW50KEFtcGxpdHVkZUV2ZW50cy5Ub3VyU3RlcE9uZVNlbmQsIHsgc2tpcHBlZDogdHJ1ZSB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIGNhc2UgT25ib2FyZGluZ1R5cGUuU2VuZExhdGVyOgogICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaEFjdGlvbihvbmJvYXJkaW5nUGF0Y2goewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2tpcHBlZDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IHsgc3RlcHM6IHsgc2VuZExhdGVyOiB0cnVlIH0gfSwKICAgICAgICAgICAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICAgICAgICAgICAgICBsb2dBbXBsaXR1ZGVFdmVudChBbXBsaXR1ZGVFdmVudHMuVG91clN0ZXBUd28sIHsgc2tpcHBlZDogdHJ1ZSB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIGNhc2UgT25ib2FyZGluZ1R5cGUuRm9sbG93VXBSZW1pbmRlcjoKICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hBY3Rpb24ob25ib2FyZGluZ1BhdGNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNraXBwZWQ6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiB7IHN0ZXBzOiB7IGZvbGxvd1VwUmVtaW5kZXI6IHRydWUgfSB9LAogICAgICAgICAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ0FtcGxpdHVkZUV2ZW50KEFtcGxpdHVkZUV2ZW50cy5Ub3VyU3RlcFRocmVlLCB7IHNraXBwZWQ6IHRydWUgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLk1lc3NhZ2VUZW1wbGF0ZXM6CiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoQWN0aW9uKG9uYm9hcmRpbmdQYXRjaCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBza2lwcGVkOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogeyBzdGVwczogeyBtZXNzYWdlVGVtcGxhdGVzOiB0cnVlIH0gfSwKICAgICAgICAgICAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICAgICAgICAgICAgICBsb2dBbXBsaXR1ZGVFdmVudChBbXBsaXR1ZGVFdmVudHMuVG91clN0ZXBGb3VyLCB7IHNraXBwZWQ6IHRydWUgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLlNoYXJlVGhyZWFkOgogICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaEFjdGlvbihvbmJvYXJkaW5nUGF0Y2goewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2tpcHBlZDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IHsgc3RlcHM6IHsgc2hhcmVUaHJlYWQ6IHRydWUgfSB9LAogICAgICAgICAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ0FtcGxpdHVkZUV2ZW50KEFtcGxpdHVkZUV2ZW50cy5Ub3VyU3RlcFRlbiwgeyBza2lwcGVkOiB0cnVlIH0pOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgY2FzZSBPbmJvYXJkaW5nVHlwZS5Db21tZW50OgogICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaEFjdGlvbihvbmJvYXJkaW5nUGF0Y2goewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2tpcHBlZDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IHsgc3RlcHM6IHsgY29tbWVudDogdHJ1ZSB9IH0sCiAgICAgICAgICAgICAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgICAgICAgICAgICAgbG9nQW1wbGl0dWRlRXZlbnQoQW1wbGl0dWRlRXZlbnRzLlRvdXJTdGVwRWxldmVuLCB7IHNraXBwZWQ6IHRydWUgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLlNjaGVkdWxpbmc6CiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoQWN0aW9uKG9uYm9hcmRpbmdQYXRjaCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBza2lwcGVkOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogeyBzdGVwczogeyBzY2hlZHVsaW5nOiB0cnVlIH0gfSwKICAgICAgICAgICAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgY2FzZSBPbmJvYXJkaW5nVHlwZS5Eb3dubG9hZE5hdGl2ZUFwcHM6CiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoQWN0aW9uKG9uYm9hcmRpbmdQYXRjaCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBza2lwcGVkOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogeyBkb3dubG9hZE5hdGl2ZUFwcHM6IHRydWUgfSwKICAgICAgICAgICAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICAgICAgICAgICAgICBsb2dBbXBsaXR1ZGVFdmVudChBbXBsaXR1ZGVFdmVudHMuVG91clN0ZXBUaGlydGVlbiwgeyBza2lwcGVkOiB0cnVlIH0pOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgY2FzZSBPbmJvYXJkaW5nVHlwZS5DbGFpbUNyZWRpdDoKICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hBY3Rpb24ob25ib2FyZGluZ1BhdGNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNraXBwZWQ6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiB7IGNsYWltZWRDcmVkaXQ6IHRydWUgfSwKICAgICAgICAgICAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICAgICAgICAgICAgICBsb2dBbXBsaXR1ZGVFdmVudChBbXBsaXR1ZGVFdmVudHMuVG91clN0ZXBGb3VydGVlbiwgeyBza2lwcGVkOiB0cnVlIH0pOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDogcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5yZW5kZXJTdGVwID0gZnVuY3Rpb24gKGgpIHsKICAgICAgICAgICAgdmFyIGFjdGl2YXRlZEhvdGtleXMgPSBfdGhpcy5zdGF0ZS5hY3RpdmF0ZWRIb3RrZXlzOwogICAgICAgICAgICB2YXIgbmF2aWdhdGVJbmJveEFjdGl2YXRpb24gPSBoLm5hbWUgPT09IEhvdGtleUFjdGlvbi5OYXZpZ2F0ZUluYm94ICYmCiAgICAgICAgICAgICAgICBicm93c2VySGlzdG9yeS5sb2NhdGlvbi5wYXRobmFtZS5zdGFydHNXaXRoKCcvbWFpbCcpOwogICAgICAgICAgICByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAic3RlcHMtd3JhcHBlciIsIGtleTogaC5uYW1lICsgIi1vbmJvYXJkaW5nLXN0ZXAiIH0sCiAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImhvdGtleXMiIH0sCiAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6IGNsYXNzbmFtZXMoJ2hvdGtleScsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2YXRlZDogbmF2aWdhdGVJbmJveEFjdGl2YXRpb24gfHwgISEoYWN0aXZhdGVkSG90a2V5c1toLm5hbWVdKSwKICAgICAgICAgICAgICAgICAgICAgICAgfSksIGtleTogaC5uYW1lIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAibmFtZSIgfSwgaC5uYW1lKSwKICAgICAgICAgICAgICAgICAgICAgICAgISFoLm1ldGFLZXkgJiYgUmVhY3QuY3JlYXRlRWxlbWVudChLZXlib2FyZFN5bWJvbCwgeyBjaGFyYWN0ZXI6IEtleUNvZGUuTGVmdFdpbmRvd0tleSB9KSwKICAgICAgICAgICAgICAgICAgICAgICAgISFoLmN0cmxLZXkgJiYgUmVhY3QuY3JlYXRlRWxlbWVudChLZXlib2FyZFN5bWJvbCwgeyBjaGFyYWN0ZXI6IEtleUNvZGUuQ3RybCB9KSwKICAgICAgICAgICAgICAgICAgICAgICAgISFoLnNoaWZ0S2V5ICYmIFJlYWN0LmNyZWF0ZUVsZW1lbnQoS2V5Ym9hcmRTeW1ib2wsIHsgY2hhcmFjdGVyOiBLZXlDb2RlLlNoaWZ0IH0pLAogICAgICAgICAgICAgICAgICAgICAgICAhIWguYWx0S2V5ICYmIFJlYWN0LmNyZWF0ZUVsZW1lbnQoS2V5Ym9hcmRTeW1ib2wsIHsgY2hhcmFjdGVyOiBLZXlDb2RlLkFsdCB9KSwKICAgICAgICAgICAgICAgICAgICAgICAgISFoLmtleUNvZGUgJiYgUmVhY3QuY3JlYXRlRWxlbWVudChLZXlib2FyZFN5bWJvbCwgeyBjaGFyYWN0ZXI6IGgua2V5Q29kZSB9KSwKICAgICAgICAgICAgICAgICAgICAgICAgISFoLmFsdEtleUNvZGUgJiYgUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIG51bGwsICIvIiksCiAgICAgICAgICAgICAgICAgICAgICAgICEhaC5hbHRLZXlDb2RlICYmIFJlYWN0LmNyZWF0ZUVsZW1lbnQoS2V5Ym9hcmRTeW1ib2wsIHsgY2hhcmFjdGVyOiBoLmFsdEtleUNvZGUgfSkpKSkpOwogICAgICAgIH07CiAgICAgICAgX3RoaXMucmVuZGVyU3RlcHMgPSBmdW5jdGlvbiAoc3RlcCkgewogICAgICAgICAgICB2YXIgaG90a2V5OwogICAgICAgICAgICBzd2l0Y2ggKHN0ZXApIHsKICAgICAgICAgICAgICAgIGNhc2UgT25ib2FyZGluZ1R5cGUuTmV4dFRocmVhZDoKICAgICAgICAgICAgICAgICAgICAvLyBJZGVudGlmeSBjb3VudGVyCiAgICAgICAgICAgICAgICAgICAgdmFyIHJlbmRlckFycmF5ID0gW107CiAgICAgICAgICAgICAgICAgICAgdmFyIG5leHRUaHJlYWRBY3Rpb24gPSBob3RrZXlGb3JPbmJvYXJkaW5nKE9uYm9hcmRpbmdUeXBlLk5leHRUaHJlYWQpOwogICAgICAgICAgICAgICAgICAgIGlmIChzdGVwICYmIG5leHRUaHJlYWRBY3Rpb24pIHsKICAgICAgICAgICAgICAgICAgICAgICAgaG90a2V5ID0gaG90a2V5c1R5cGVhaGVhZChuZXh0VGhyZWFkQWN0aW9uKVswXTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhvdGtleSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVyQXJyYXkucHVzaChfdGhpcy5yZW5kZXJTdGVwKGhvdGtleSkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHZhciBwcmV2aW91c1RocmVhZEFjdGlvbiA9IGhvdGtleUZvck9uYm9hcmRpbmcoT25ib2FyZGluZ1R5cGUuUHJldmlvdXNUaHJlYWQpOwogICAgICAgICAgICAgICAgICAgIGlmIChzdGVwICYmIHByZXZpb3VzVGhyZWFkQWN0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGhvdGtleSA9IGhvdGtleXNUeXBlYWhlYWQocHJldmlvdXNUaHJlYWRBY3Rpb24pWzBdOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaG90a2V5KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJBcnJheS5wdXNoKF90aGlzLnJlbmRlclN0ZXAoaG90a2V5KSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlbmRlckFycmF5OwogICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICAvLyBJZGVudGlmeSBjb3VudGVyCiAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IGhvdGtleUZvck9uYm9hcmRpbmcoc3RlcCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHN0ZXAgJiYgYWN0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGhvdGtleSA9IGhvdGtleXNUeXBlYWhlYWQoYWN0aW9uKVswXTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKGhvdGtleSkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMucmVuZGVyU3RlcChob3RrZXkpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9OwogICAgICAgIF90aGlzLnJlbmRlckRyYWZ0Q3JlYXRlU3RlcCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIGNyZWF0ZURyYWZ0ID0gSG90a2V5QWN0aW9uLk5ld0RyYWZ0OwogICAgICAgICAgICB2YXIgY3JlYXRlRHJhZnRIb3RrZXkgPSBnZXRIb3RrZXlCeU5hbWUoY3JlYXRlRHJhZnQpOwogICAgICAgICAgICBpZiAoIWNyZWF0ZURyYWZ0SG90a2V5KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gKF90aGlzLnJlbmRlclN0ZXAoY3JlYXRlRHJhZnRIb3RrZXkpKTsKICAgICAgICB9OwogICAgICAgIF90aGlzLnJlbmRlclByZXJlcXVpc2l0ZVN0ZXAgPSBmdW5jdGlvbiAoc3RlcCkgewogICAgICAgICAgICB2YXIgX2EgPSBfdGhpcy5wcm9wcywgaXNEcmFmdCA9IF9hLmlzRHJhZnQsIGlzVGhyZWFkID0gX2EuaXNUaHJlYWQ7CiAgICAgICAgICAgIC8vIERyYWZ0IFN0ZXAKICAgICAgICAgICAgaWYgKG9uYm9hcmRpbmdSZXF1aXJlc0RyYWZ0KHN0ZXApICYmICFpc0RyYWZ0KSB7CiAgICAgICAgICAgICAgICB2YXIgY3JlYXRlRHJhZnQgPSBIb3RrZXlBY3Rpb24uTmV3RHJhZnQ7CiAgICAgICAgICAgICAgICB2YXIgY3JlYXRlRHJhZnRIb3RrZXkgPSBnZXRIb3RrZXlCeU5hbWUoY3JlYXRlRHJhZnQpOwogICAgICAgICAgICAgICAgaWYgKCFjcmVhdGVEcmFmdEhvdGtleSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIChfdGhpcy5yZW5kZXJTdGVwKGNyZWF0ZURyYWZ0SG90a2V5KSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gUHJlcmVxdWlzaXRlcyBmb3IgaGFuZGxpbmcgdGhyZWFkIGFjdGlvbnMKICAgICAgICAgICAgaWYgKG9uYm9hcmRpbmdSZXF1aXJlc1RocmVhZChzdGVwKSAmJiAhaXNUaHJlYWQpIHsKICAgICAgICAgICAgICAgIHZhciBuYXZpZ2F0ZUluYm94ID0gSG90a2V5QWN0aW9uLk5hdmlnYXRlSW5ib3g7CiAgICAgICAgICAgICAgICB2YXIgbmF2aWdhdGVJbmJveEhvdGtleSA9IGdldEhvdGtleUJ5TmFtZShuYXZpZ2F0ZUluYm94KTsKICAgICAgICAgICAgICAgIGlmICghbmF2aWdhdGVJbmJveEhvdGtleSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdmFyIG5leHRUaHJlYWQgPSBIb3RrZXlBY3Rpb24uTmV4dFRocmVhZDsKICAgICAgICAgICAgICAgIHZhciBuZXh0VGhyZWFkSG90a2V5ID0gZ2V0SG90a2V5QnlOYW1lKG5leHRUaHJlYWQpOwogICAgICAgICAgICAgICAgaWYgKCFuZXh0VGhyZWFkSG90a2V5KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gKFsKICAgICAgICAgICAgICAgICAgICBfdGhpcy5yZW5kZXJTdGVwKG5hdmlnYXRlSW5ib3hIb3RrZXkpLAogICAgICAgICAgICAgICAgICAgIF90aGlzLnJlbmRlclN0ZXAobmV4dFRocmVhZEhvdGtleSksCiAgICAgICAgICAgICAgICBdKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9OwogICAgICAgIF90aGlzLnJlbmRlckNvbW1hbmRDb250cm9sU3RlcCA9IGZ1bmN0aW9uIChzdGVwKSB7CiAgICAgICAgICAgIHZhciBjb3B5ID0gJyc7CiAgICAgICAgICAgIHZhciB0cmFuc2l0aW9uQW5pbWF0aW9uID0gX3RoaXMuc3RhdGUudHJhbnNpdGlvbkFuaW1hdGlvbjsKICAgICAgICAgICAgc3dpdGNoIChzdGVwKSB7CiAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLlNhdmVBc1RlbXBsYXRlOgogICAgICAgICAgICAgICAgICAgIGNvcHkgPSAnU2F2ZSBhcyBUZW1wbGF0ZSc7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLlJlYWRMYXRlcjoKICAgICAgICAgICAgICAgICAgICBjb3B5ID0gJ1RvbW9ycm93IE1vcm5pbmcnOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBPbmJvYXJkaW5nVHlwZS5TaGFyZVRocmVhZDoKICAgICAgICAgICAgICAgICAgICBjb3B5ID0gJ1NoYXJlIENvbnZlcnNhdGlvbic7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLlNlbmRMYXRlcjoKICAgICAgICAgICAgICAgICAgICBjb3B5ID0gJzUgbWlucyc7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLkZvbGxvd1VwUmVtaW5kZXI6CiAgICAgICAgICAgICAgICAgICAgY29weSA9ICcyIGRheXMnOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBPbmJvYXJkaW5nVHlwZS5TY2hlZHVsaW5nOgogICAgICAgICAgICAgICAgICAgIGNvcHkgPSAnTWVldGluZyBUaW1lcyc7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghY29weSkgewogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIChSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogY2xhc3NuYW1lcygnc3RlcHMtd3JhcHBlcicsICdzZWNvbmRhcnknKSwga2V5OiBzdGVwICsgIi1vbmJvYXJkaW5nLXN0ZXAtY29tbWFuZCIgfSwKICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiBjbGFzc25hbWVzKCdob3RrZXlzJykgfSwKICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogY2xhc3NuYW1lcygnaG90a2V5JywgeyBhY3RpdmF0ZWQ6IHRyYW5zaXRpb25BbmltYXRpb24gfSksIGtleTogc3RlcCArICItbmV4dC1zdGVwIiB9LAogICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgeyBjbGFzc05hbWU6ICJuYW1lIiB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlR5cGU6ICIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgeyBjbGFzc05hbWU6ICJib2xkIiB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJcIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29weSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiXCIiKSkpKSkpOwogICAgICAgIH07CiAgICAgICAgX3RoaXMucmVuZGVyVGl0bGUgPSBmdW5jdGlvbiAoaCkgewogICAgICAgICAgICB2YXIgb25ib2FyZGluZyA9IF90aGlzLnByb3BzLm9uYm9hcmRpbmc7CiAgICAgICAgICAgIHZhciBjID0gJ1lvdSBBcmUgVW5zdG9wcGFibGUhIPCfkY8nOwogICAgICAgICAgICBpZiAoaCkgewogICAgICAgICAgICAgICAgc3dpdGNoIChoKSB7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBPbmJvYXJkaW5nVHlwZS5BcmNoaXZlOgogICAgICAgICAgICAgICAgICAgICAgICBjID0gJ01hcmtpbmcgdGhpbmdzIGFzIGRvbmUnOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLlJlYWRMYXRlcjoKICAgICAgICAgICAgICAgICAgICAgICAgYyA9ICdTbm9vemluZyBFbWFpbHMnOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLk5leHRUaHJlYWQ6CiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSAnQmVjb21pbmcgYSBQb2x5bWFpbCBNYXN0ZXIhIPCfkownOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLlVuZG86CiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSAnVW5kb2luZyBBY3Rpb25zJzsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBPbmJvYXJkaW5nVHlwZS5CbG9jazoKICAgICAgICAgICAgICAgICAgICAgICAgYyA9ICdCbG9ja2luZyBTZW5kZXJzJzsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBPbmJvYXJkaW5nVHlwZS5Db21tYW5kTGF0ZXI6CiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSAnVGhlIENvbW1hbmQgQ2VudGVyJzsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgLy8gRHJhZnQgaGFuZGxlcnMKICAgICAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLlNlbmRNZXNzYWdlOgogICAgICAgICAgICAgICAgICAgICAgICBjID0gJ1NlbmQgWW91ciBGaXJzdCBNZXNzYWdlJzsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBPbmJvYXJkaW5nVHlwZS5TZW5kTGF0ZXI6CiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSAnU2NoZWR1bGluZyBFbWFpbHMnOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLkZvbGxvd1VwUmVtaW5kZXI6CiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSAnTmV2ZXIgbWlzcyBhIEZvbGxvdyB1cCEnOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLk1lc3NhZ2VUZW1wbGF0ZXM6CiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSAnTWVzc2FnZSBUZW1wbGF0ZXMnOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLlNhdmVBc1RlbXBsYXRlOgogICAgICAgICAgICAgICAgICAgICAgICBjID0gJ1NhdmUgYXMgVGVtcGxhdGUnOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLkNvbXBsZXRlOgogICAgICAgICAgICAgICAgICAgICAgICBjID0gJ0dldHRpbmcgU3RhcnRlZCEnOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLlNoYXJlVGhyZWFkOgogICAgICAgICAgICAgICAgICAgICAgICBjID0gJ1NoYXJpbmcgQ29udmVyc2F0aW9ucyc7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgT25ib2FyZGluZ1R5cGUuQ29tbWVudDoKICAgICAgICAgICAgICAgICAgICAgICAgYyA9ICdBZGRpbmcgQ29tbWVudHMnOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLkFjdGl2aXR5RmVlZDoKICAgICAgICAgICAgICAgICAgICAgICAgYyA9ICdBY3Rpdml0eSBGZWVkJzsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBPbmJvYXJkaW5nVHlwZS5TY2hlZHVsaW5nOgogICAgICAgICAgICAgICAgICAgICAgICBjID0gJ1NoYXJpbmcgTWVldGluZyBUaW1lcyc7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgT25ib2FyZGluZ1R5cGUuRG93bmxvYWROYXRpdmVBcHBzOgogICAgICAgICAgICAgICAgICAgICAgICBjID0gJ0Rvd25sb2FkIERlc2t0b3AgQXBwJzsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBPbmJvYXJkaW5nVHlwZS5DbGFpbUNyZWRpdDoKICAgICAgICAgICAgICAgICAgICAgICAgYyA9ICdDbGFpbSBZb3VyICQxMCBDcmVkaXQhJzsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9uYm9hcmRpbmcuY2xhaW1lZENyZWRpdCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgYyA9ICdZb3VcJ3ZlIGNsYWltZWQgeW91ciAkMTAgY3JlZGl0IGZvciBQb2x5bWFpbCEnOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSAnU2VjdGlvbiBDb21wbGV0ZSEnOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAiY29weSIgfSwKICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImg1IiwgeyBrZXk6IGMgfSwgYykpKTsKICAgICAgICB9OwogICAgICAgIF90aGlzLnJlbmRlckluZm9TZWN0aW9uID0gZnVuY3Rpb24gKGgpIHsKICAgICAgICAgICAgdmFyIF9hID0gX3RoaXMucHJvcHMsIGlzRHJhZnQgPSBfYS5pc0RyYWZ0LCBpc1RocmVhZCA9IF9hLmlzVGhyZWFkOwogICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bWF4LWxpbmUtbGVuZ3RoCiAgICAgICAgICAgIHZhciBjID0gUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIG51bGwpOwogICAgICAgICAgICBpZiAoaCkgewogICAgICAgICAgICAgICAgc3dpdGNoIChoKSB7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBPbmJvYXJkaW5nVHlwZS5BcmNoaXZlOgogICAgICAgICAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bWF4LWxpbmUtbGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGgKICAgICAgICAgICAgICAgICAgICAgICAgYyA9IFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIiAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJXaGVuIHlvdSdyZSBkb25lIHdpdGggYW4gZW1haWwsIGFsd2F5cyBtYWtlIHN1cmUgdG8gYXJjaGl2ZSBpdC4iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGhpcyBrZWVwcyB5b3VyIGluYm94IGNsZWFuIGFuZCBmdWxsIG9mIG9ubHkgaW1wb3J0YW50IHRhc2tzIGZvciB5b3VyIGRheSEiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQ2hvb3NlIGFueSBlbWFpbCAtLSB3ZSdsbCB0ZWFjaCB5b3UgaG93IHRvIHVuZG8gYW55IGFjdGlvbiBuZXh0ISIpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzVGhyZWFkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bWF4LWxpbmUtbGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjID0gUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkxldCdzIHN0YXJ0IGJ5IGdvaW5nIHRvIHlvdXIgaW5ib3ggYW5kIHNlbGVjdGluZyBhIHRocmVhZCEiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiRmVlbCBmcmVlIHRvIHVzZSB0aGUgc3VnZ2VzdGVkICIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYiIsIG51bGwsICJob3RrZXlzIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiBvciB0aGUgIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiIiwgbnVsbCwgIkNvbW1hbmQgQ2VudGVyIikpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgT25ib2FyZGluZ1R5cGUuUmVhZExhdGVyOgogICAgICAgICAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bWF4LWxpbmUtbGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBSZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiWW91IGNhbiByZWFkIGxhdGVyIGFuIGVtYWlsIHdoZW4geW91IGRvbid0IG5lZWQgdG8gaGFuZGxlIGl0IHRvZGF5LiAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVHJ5IHNldHRpbmcgYW4gZW1haWwgdG8gcmVhZCAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYiIsIG51bGwsICJ0b21vcnJvdyBtb3JuaW5nIikpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLk5leHRUaHJlYWQ6CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGgKICAgICAgICAgICAgICAgICAgICAgICAgYyA9IFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIiAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJMZXQncyB0ZWFjaCB5b3UgaG93IHRvIGdldCBhcm91bmQgUG9seW1haWwgcXVpY2tseSEgIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRhcCBlaXRoZXIgb2YgdGhlIGtleXMgYmVsb3cgdG8gbW92ZSBiZXR3ZWVuIHRocmVhZHMhIik7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgT25ib2FyZGluZ1R5cGUuVW5kbzoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aAogICAgICAgICAgICAgICAgICAgICAgICBjID0gUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiICIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIldhaXQhIFx1RDgzRFx1REU0OCAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiSWYgeW91IHRvb2sgYW4gYWN0aW9uIHlvdSBkaWRuJ3Qgd2FudCwgeW91IGNhbiBhbHdheXMgYnJpbmcgdGhlIG1lc3NhZ2UgYmFjayBieSB0YXBwaW5nIHVuZG8hICIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgVHJ5IHVuZG9pbmcgdGhlIGxhc3QgYWN0aW9uIHlvdSBqdXN0IHRvb2siKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBPbmJvYXJkaW5nVHlwZS5CbG9jazoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aAogICAgICAgICAgICAgICAgICAgICAgICBjID0gUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiICIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIkhhdmUgYW55IGVtYWlscyB5b3Ugd2FudCB0byBzdG9wIHJlY2VpdmluZz8gIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIiBXZSd2ZSBtYWRlIGl0IHNpbXBsZSB0byBibG9jayBvciB1bnN1YnNjcmliZSBmcm9tIGFueW9uZSEiKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBPbmJvYXJkaW5nVHlwZS5Db21tYW5kTGF0ZXI6CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGgKICAgICAgICAgICAgICAgICAgICAgICAgYyA9IFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIiAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJJZiB5b3UgZXZlciBmb3JnZXQgYSBob3RrZXksIHdlIG1ha2UgaXQgZWFzeSB0byBmaW5kIGFueSBhY3Rpb24geW91J2QgbGlrZSB0byBwZXJmb3JtISIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIiAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgVHJ5IHR5cGluZyAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYiIsIG51bGwsICJSZWFkIExhdGVyIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiIGluIHRoZSBDb21tYW5kIENlbnRlciwgdGhlbiBzZXQgYW4gZW1haWwgdG8gcmVhZCAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYiIsIG51bGwsICIzIGRheXMiKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgZnJvbSBub3chIik7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIC8vIERyYWZ0IEFjdGlvbnMKICAgICAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLlNlbmRNZXNzYWdlOgogICAgICAgICAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bWF4LWxpbmUtbGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBSZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiUG9seW1haWwgZ2l2ZXMgeW91IHRvb2xzIHRvIHNhdmUgdGltZSBhbmQgZ2V0IGluc2lnaHRzIGZyb20gdGhlIG1lc3NhZ2VzIHlvdSBzZW5kLiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUcnkgc2VuZGluZyB0aGlzIGV4YW1wbGUgbWVzc2FnZSB0byBzdGFydC4iKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0RyYWZ0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bWF4LWxpbmUtbGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjID0gUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkxldHMgc2VuZCB5b3VyIGZpcnN0IG1lc3NhZ2Ugb24gUG9seW1haWwhIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiBTdGFydCBieSBjcmVhdGluZyBhIG5ldyBtZXNzYWdlISIpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgT25ib2FyZGluZ1R5cGUuU2VuZExhdGVyOgogICAgICAgICAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bWF4LWxpbmUtbGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBSZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiSWYgeW91IHdhbnQgdG8gc2NoZWR1bGUgdG8gc2VuZCBsYXRlciwgeW91IGNhbiBjaG9vc2UgYSBkYXRlIGFuZCB0aW1lIHRvIHNlbmQgaW4gdGhlIGZ1dHVyZS4iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVHJ5IHNjaGVkdWxpbmcgYW4gZW1haWwgZm9yICIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiIiwgbnVsbCwgIjUgbWludXRlcyIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIiBmcm9tIG5vdyIpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzRHJhZnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBSZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiICIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTGVhcm4gaG93IHRvIHN1cGVyY2hhcmdlIHRoZSBlbWFpbHMgeW91IHNlbmQgb3V0ISIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgU3RhcnQgYnkgY3JlYXRpbmcgYW5vdGhlciBtZXNzYWdlISIpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgT25ib2FyZGluZ1R5cGUuRm9sbG93VXBSZW1pbmRlcjoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aAogICAgICAgICAgICAgICAgICAgICAgICBjID0gUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiICIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlNldCBhIGZvbGxvd3VwIHJlbWluZGVyIG9uIGFuIGVtYWlsIHRvIGdldCBub3RpZmllZCB3aGVuIHlvdSBoYXZlbid0IHJlY2VpdmVkIGEgcmVwbHkgd2l0aGluIGEgc2V0IGFtb3VudCBvZiB0aW1lISIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUcnkgc2V0dGluZyBhIGZvbGxvdyB1cCByZW1pbmRlciBmb3IgIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImIiLCBudWxsLCAiMiBkYXlzIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiIGZyb20gbm93ISIpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzRHJhZnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBSZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiICIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTGVhcm4gaG93IHRvIHN1cGVyY2hhcmdlIHRoZSBlbWFpbHMgeW91IHNlbmQgb3V0ISIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgU3RhcnQgYnkgY3JlYXRpbmcgYW5vdGhlciBtZXNzYWdlISIpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgT25ib2FyZGluZ1R5cGUuU2F2ZUFzVGVtcGxhdGU6CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGgKICAgICAgICAgICAgICAgICAgICAgICAgYyA9IFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIiAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJJZiB5b3UgZXZlciB3YW50IHRvIHJldXNlIGEgZHJhZnQgeW91IGNhbiBzYXZlIGl0IGFzIGEgdGVtcGxhdGUhIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiICIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIiBUcnkgb3BlbmluZyB0aGUgQ29tbWFuZCBDZW50ZXIgYW5kIHR5cGUgIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImIiLCBudWxsLCAiU2F2ZSBhcyBUZW1wbGF0ZSIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIiB0byBzYXZlIGEgZHJhZnQgYXMgYSB0ZW1wbGF0ZSEiKTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXBsYXRlUm91dGUgPSBfdGhpcy5wcm9wcy5sb2NhdGlvbi5wYXRobmFtZS5zdGFydHNXaXRoKCcvdGVtcGxhdGVzJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNEcmFmdCAmJiAhdGVtcGxhdGVSb3V0ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYyA9IFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJMZWFybiBob3cgdG8gc3VwZXJjaGFyZ2UgdGhlIGVtYWlscyB5b3Ugc2VuZCBvdXQhIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlN0YXJ0IGJ5IGNyZWF0aW5nIGFub3RoZXIgbWVzc2FnZSEiKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLk1lc3NhZ2VUZW1wbGF0ZXM6CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGgKICAgICAgICAgICAgICAgICAgICAgICAgYyA9IFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIiAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJZb3UgY2FuIGFjY2VzcyBhbnkgTWVzc2FnZSBUZW1wbGF0ZXMgeW91IGhhdmUgY3JlYXRlZCBpbiB0aGUgcGFzdCB0byBhdXRvbWF0aWNhbGx5IGZpbGwgaW4gY29udGVudCBhbmQgZmlsZXMgZm9yIHlvdXIgbmV3IG1lc3NhZ2VzISIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUcnkgc2VsZWN0aW5nIGEgTWVzc2FnZSBUZW1wbGF0ZSB0byBpbnNlcnQgaW50byB0aGlzIGRyYWZ0ISIpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzRHJhZnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBSZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiICIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTGVhcm4gaG93IHRvIHN1cGVyY2hhcmdlIHRoZSBlbWFpbHMgeW91IHNlbmQgb3V0ISIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgU3RhcnQgYnkgY3JlYXRpbmcgYW5vdGhlciBtZXNzYWdlISIpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgT25ib2FyZGluZ1R5cGUuU2hhcmVUaHJlYWQ6CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGgKICAgICAgICAgICAgICAgICAgICAgICAgYyA9IFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIiAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJZb3UgY2FuIHNoYXJlIGEgbGl2ZSBsaW5rIHRvIGFueSBvZiB5b3VyIGNvbnZlcnNhdGlvbnMgdG8gcHJvdmlkZSBjb250ZXh0IHRvIHlvdXIgdGVhbS4iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVHJ5IHR5cGluZyAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYiIsIG51bGwsICJTaGFyZSBDb252ZXJzYXRpb24iKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgaW4gdGhlIENvbW1hbmQgQ2VudGVyIik7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNUaHJlYWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBSZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiICIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTGV0J3Mgc3RhcnQgYnkgZ29pbmcgdG8geW91ciBpbmJveCBhbmQgc2VsZWN0aW5nIGEgdGhyZWFkISIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJGZWVsIGZyZWUgdG8gdXNlIHRoZSBzdWdnZXN0ZWQgIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiIiwgbnVsbCwgImhvdGtleXMiKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiIG9yIHRoZSAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImIiLCBudWxsLCAiQ29tbWFuZCBDZW50ZXIiKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBPbmJvYXJkaW5nVHlwZS5Db21tZW50OgogICAgICAgICAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bWF4LWxpbmUtbGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBSZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTGVhdmUgYSBjb21tZW50IHRvIHByb3ZpZGUgeW91cnNlbGYgb3IgYW55IHRlYW1tYXRlcyB3aXRoIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24gc3Vycm91bmRpbmcgYSBjb252ZXJzYXRpb24uICIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJJdCdzIHVzZWZ1bCBmb3IgY29udGV4dCB3aGVuIHlvdSB2aXNpdCBhIGNvbnZlcnNhdGlvbiBpbiB0aGUgZnV0dXJlISBUcnkgdG8gIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImIiLCBudWxsLCAicG9zdCBhIGNvbW1lbnQiKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgb24gb25lIG9mIHlvdXIgbWVzc2FnZXMiKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc1RocmVhZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYyA9IFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJMZXQncyBzdGFydCBieSBnb2luZyB0byB5b3VyIGluYm94IGFuZCBzZWxlY3RpbmcgYSB0aHJlYWQhIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkZlZWwgZnJlZSB0byB1c2UgdGhlIHN1Z2dlc3RlZCAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImIiLCBudWxsLCAiaG90a2V5cyIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgb3IgdGhlICIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYiIsIG51bGwsICJDb21tYW5kIENlbnRlciIpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLkFjdGl2aXR5RmVlZDoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aAogICAgICAgICAgICAgICAgICAgICAgICBjID0gUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiICIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIllvdSBjYW4gYWxzbyBjaGVjayBvdXQgb3VyIEFjdGl2aXR5IEZlZWQgaW4gdGhlIFJpZ2h0IFNpZGViYXIgdG8gZ2V0IGEgbGl2ZSBmZWVkIG9mIGFsbCB0aGUgaW50ZXJhY3Rpb25zIHdpdGggeW91ciBzZW50IGVtYWlscyBzbyB5b3UgY2FuIGFsd2F5cyBmb2xsb3cgdXAgcHJvbXB0bHkhIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRyeSB0eXBpbmcgIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImIiLCBudWxsLCAiQWN0aXZpdHkgRmVlZCIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIiBpbiB0aGUgIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImIiLCBudWxsLCAiQ29tbWFuZCBDZW50ZXIiKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgT25ib2FyZGluZ1R5cGUuU2NoZWR1bGluZzoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aAogICAgICAgICAgICAgICAgICAgICAgICBjID0gUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIklmIHlvdSdyZSBzZXR0aW5nIHVwIGEgbWVldGluZywgc2hhcmUgeW91ciBjYWxlbmRhciBhdmFpbGFiaWxpdGllcywgc28geW91ciByZWNpcGllbnQgY2FuIGJvb2sgYSBtdXR1YWwgdGltZSB0aGF0IHdvcmtzIGZvciB0aGVtISAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiIFRyeSB0eXBpbmcgIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImIiLCBudWxsLCAiTWVldGluZyBUaW1lcyIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIiBpbiB0aGUgQ29tbWFuZCBDZW50ZXIiKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBPbmJvYXJkaW5nVHlwZS5DbGFpbUNyZWRpdDoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aAogICAgICAgICAgICAgICAgICAgICAgICBjID0gUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIkNvbmdyYXR1bGF0aW9ucywgeW91J3JlIGFsbCBzZXQgdXAgdG8gaGl0IHRoZSBncm91bmQgcnVubmluZyBpbiBQb2x5bWFpbCEiKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBPbmJvYXJkaW5nVHlwZS5Db21wbGV0ZToKICAgICAgICAgICAgICAgICAgICAgICAgYyA9IFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJHcmVhdCBqb2IhIE1vdmluZyBvbnRvIHRoZSBuZXh0IHNlY3Rpb24hIik7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgT25ib2FyZGluZ1R5cGUuRG93bmxvYWROYXRpdmVBcHBzOgogICAgICAgICAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bWF4LWxpbmUtbGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBSZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiRG93bmxvYWQgdGhlIGRlc2t0b3AgY2xpZW50IG9uIFBvbHltYWlsIGZvciB0aGUgYmVzdCBleHBlcmllbmNlISIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJVc2UgUG9seW1haWwgd2l0aCBpbXByb3ZlZCBzZWFyY2gsIG9mZmxpbmUgY2FwYWJpbGl0aWVzLCBhbmQgYmV0dGVyIHBlcmZvcm1hbmNlISIpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgICAgICBjID0gUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiICIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIkdyZWF0IGpvYiEgTm93IHlvdSdyZSByZWFkeSB0byBtYW5hZ2UgeW91ciBpbmJveCBhdCBmdWxsIHNwZWVkISIpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsga2V5OiAiaW5mby0iICsgaCwgY2xhc3NOYW1lOiAiaW5mby1zZWN0aW9uIiB9LAogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJjb3B5IiB9LCBjKSkpOwogICAgICAgIH07CiAgICAgICAgX3RoaXMucmVuZGVyU2Vjb25kSW5mb1NlY3Rpb24gPSBmdW5jdGlvbiAoaCkgewogICAgICAgICAgICB2YXIgYyA9ICcnOwogICAgICAgICAgICBpZiAoaCkgewogICAgICAgICAgICAgICAgc3dpdGNoIChoKSB7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBPbmJvYXJkaW5nVHlwZS5SZWFkTGF0ZXI6CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGgKICAgICAgICAgICAgICAgICAgICAgICAgYyA9IFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJBdCB0aGUgZGF0ZSBhbmQgdGltZSB5b3UgY2hvb3NlLCB3ZSdsbCBwb3AgdGhhdCBlbWFpbCB0byB0aGUgdG9wIG9mIHlvdXIgaW5ib3ghICIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJZb3UgY2FuIGFsc28gZmluZCB0aGVzZSBlbWFpbHMgaW4geW91ciAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYiIsIG51bGwsICJSZWFkIExhdGVyIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiIGZvbGRlci4iKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBPbmJvYXJkaW5nVHlwZS5BcmNoaXZlOgogICAgICAgICAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bWF4LWxpbmUtbGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBSZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiRG9uJ3Qgd29ycnkhIFlvdSBjYW4gZmluZCBhbnkgZW1haWwgeW91IGFyY2hpdmUgYnkgc2VhcmNoaW5nIG9yIGdvaW5nIHRvIHlvdXIgIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImIiLCBudWxsLCAiQXJjaGl2ZSIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIiBmb2xkZXIuIik7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgT25ib2FyZGluZ1R5cGUuTmV4dFRocmVhZDoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gYyA9IDxzcGFuPjxiciAvPkdpdmUgaXQgYSB0cnkhIPCfkYY8L3NwYW4+OwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLlByZXZpb3VzVGhyZWFkOgogICAgICAgICAgICAgICAgICAgICAgICAvLyBjID0gPHNwYW4+PGJyIC8+TGV0J3Mga2VlcCBpdCBnb2luZyEg8J+Pgzwvc3Bhbj47CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgT25ib2FyZGluZ1R5cGUuVW5kbzoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gYyA9IDxzcGFuPjxiciAvPlRyeSB1bmRvaW5nIHRoZSBsYXN0IGFjdGlvbiB0aGF0IHlvdSBqdXN0IHRvb2shIPCflJk8L3NwYW4+OwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLkJsb2NrOgogICAgICAgICAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bWF4LWxpbmUtbGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBSZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVHJ5IGJsb2NraW5nIGFueSBlbWFpbCBhbmQgc2VlIHdoYXQgaGFwcGVucyEgRG9uJ3Qgd29ycnksIHdlJ2xsIGdpdmUgeW91IGEgY2hhbmNlIHRvIGNvbmZpcm0gaWYgeW91IHJlYWxseSB3YW50IHRvIGJsb2NrIHNvbWVvbmUhIFx1RDgzRFx1REU0NSIpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLkNvbW1hbmRMYXRlcjoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aAogICAgICAgICAgICAgICAgICAgICAgICBjID0gUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIllvdSBjYW4gdXNlIHRoZSBjb21tYW5kIGNlbnRlciB0byBmaW5kIGEgaG90a2V5LCBvciB5b3UgY2FuIHR5cGUgYW55IGFjdGlvbiBhbmQgcGVyZm9ybSBpdCBkaXJlY3RseSBmcm9tIHRoZXJlISIpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLlNlbmRMYXRlcjoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aAogICAgICAgICAgICAgICAgICAgICAgICBjID0gUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIiBPbmNlIHlvdSBjaG9vc2UgYSB0aW1lLCB3ZSdsbCBoYW5kbGUgZXZlcnl0aGluZyBvbiBvdXIgZW5kIHRvIG1ha2Ugc3VyZSB5b3VyIG1lc3NhZ2UgZ2V0cyBzZW50IGF0IHRoYXQgcG9pbnQgaW4gdGltZSEiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiWW91IGNhbiBmaW5kIHRoZXNlIGRyYWZ0cyBpbiB5b3VyICIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiIiwgbnVsbCwgIlNlbmQgTGF0ZXIiKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgZm9sZGVyLiIpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLkZvbGxvd1VwUmVtaW5kZXI6CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGgKICAgICAgICAgICAgICAgICAgICAgICAgYyA9IFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIiAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJJZiB5b3UgaGF2ZW4ndCByZWNlaXZlZCBhIHJlcGx5IGJ5IHRoZSB0aW1lIHBlcmlvZCB5b3UgY2hvc2UsIHdlJ2xsIGJyaW5nIHRoaXMgZW1haWwgYmFjayBpbnRvIHlvdXIgaW5ib3ggc28geW91IGNhbiB0YWtlIGFjdGlvbiBvbiBpdCEiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiWW91IGNhbiBmaW5kIHRoZXNlIG1lc3NhZ2VzIGluIHlvdXIgIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImIiLCBudWxsLCAiRm9sbG93IFVwIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiIGZvbGRlciIpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLk1lc3NhZ2VUZW1wbGF0ZXM6CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGgKICAgICAgICAgICAgICAgICAgICAgICAgYyA9IFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIiAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJZb3UgY2FuIHNhdmUgYSB0b24gb2YgdGltZSBieSB1c2luZyBwcmUtd3JpdHRlbiByZXNwb25zZXMgdG8gbWVzc2FnZXMhIik7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgT25ib2FyZGluZ1R5cGUuU2hhcmVUaHJlYWQ6CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGgKICAgICAgICAgICAgICAgICAgICAgICAgYyA9IFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIiAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJZb3UgY2FuIHVwZGF0ZSBwZXJtaXNzaW9ucyB0byBhbnlvbmUgYnkgY2xpY2tpbmcgIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImIiLCBudWxsLCAiTWFuYWdlIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiLiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJiciIsIG51bGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJBbGwgdGhlIGNvbnZlcnNhdGlvbnMgeW91J3ZlIHNoYXJlZCBjYW4gYmUgZm91bmQgaW4gdGhlIExlZnQgc2lkZWJhciB2aWEgIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImIiLCBudWxsLCAiU2hhcmVkIEJ5IE1lIikpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIE9uYm9hcmRpbmdUeXBlLkNsYWltQ3JlZGl0OgogICAgICAgICAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bWF4LWxpbmUtbGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBSZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQ2xhaW0geW91ciBmcmVlICQxMCBjcmVkaXQgZm9yIFBvbHltYWlsIGJlbG93Iik7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAvLyBjYXNlIE9uYm9hcmRpbmdUeXBlLkNvbW1lbnQ6CiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aAogICAgICAgICAgICAgICAgICAgICAgICAvLyAgIGMgPSA8c3Bhbj4gPGJyIC8+VHJ5IHBvc3RpbmcgYSBjb21tZW50IGJlbG93ITwvc3Bhbj47CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgT25ib2FyZGluZ1R5cGUuQ29tcGxldGU6CiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSAnJzsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICAgICAgYyA9ICcnOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsga2V5OiAicy1pbmZvLSIgKyBoLCBjbGFzc05hbWU6IGNsYXNzbmFtZXMoJ2luZm8tc2VjdGlvbicsICdzZWNvbmRhcnknKSB9LAogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJjb3B5IiB9LCBjKSkpOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlQ2xpY2sgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICB2YXIgdGhyZWFkTGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2luZmluaXRlLXRocmVhZC1saXN0Jyk7CiAgICAgICAgICAgIHZhciBlbGVtZW50ID0gdGhyZWFkTGlzdFswXTsKICAgICAgICAgICAgaWYgKGVsZW1lbnQgJiYgZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7CiAgICAgICAgICAgICAgICBlbGVtZW50LmZvY3VzKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIH07CiAgICAgICAgX3RoaXMucmVuZGVyTmV4dFN0ZXBDdGEgPSBmdW5jdGlvbiAoY291bnRlcikgewogICAgICAgICAgICB2YXIgX2EgPSBfdGhpcy5zdGF0ZSwgdHJhbnNpdGlvbkFuaW1hdGlvbiA9IF9hLnRyYW5zaXRpb25BbmltYXRpb24sIGNvbnRpbnVlQWN0aXZhdGVkID0gX2EuY29udGludWVBY3RpdmF0ZWQ7CiAgICAgICAgICAgIGlmICghdHJhbnNpdGlvbkFuaW1hdGlvbikgewogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIChSZWFjdC5jcmVhdGVFbGVtZW50KFNwcmluZywgeyBjb25maWc6IGNvbmZpZy5zbG93LCBkZWxheTogMTAwMCwgZnJvbTogeyBvcGFjaXR5OiAwLCB0OiAwIH0sIHRvOiB7CiAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogISF0cmFuc2l0aW9uQW5pbWF0aW9uID8gMSA6IDAsCiAgICAgICAgICAgICAgICAgICAgdDogISF0cmFuc2l0aW9uQW5pbWF0aW9uID8gMSA6IDAsCiAgICAgICAgICAgICAgICB9IH0sIGZ1bmN0aW9uIChjaGVja0FuaW1hdGlvbikgeyByZXR1cm4gdHJhbnNpdGlvbkFuaW1hdGlvbiAmJiAoUmVhY3QuY3JlYXRlRWxlbWVudChhbmltYXRlZC5kaXYsIHsgY2xhc3NOYW1lOiBjbGFzc25hbWVzKCduZXh0LXNlY3Rpb24tY3RhJywgeyBhY3RpdmF0ZWQ6IGNvbnRpbnVlQWN0aXZhdGVkIH0pLCBzdHlsZTogewogICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IGNoZWNrQW5pbWF0aW9uLm9wYWNpdHksCiAgICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtOiBjaGVja0FuaW1hdGlvbi50LnRvKHsKICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2U6IFswLCAwLjI1LCAuNSwgMC43NSwgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dDogWzAuOCwgMS4wNSwgMS4xLCAxLjA1LCAxLjBdLAogICAgICAgICAgICAgICAgICAgIH0pLnRvKGZ1bmN0aW9uICh4KSB7IHJldHVybiAic2NhbGUoIiArIHggKyAiKSI7IH0pLAogICAgICAgICAgICAgICAgfSB9LAogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJjb3B5IiB9LCByYW5kb21pemVkUmVpbmZvcmNlbWVudChjb3VudGVyKSArICIgVG8gY29udGludWUsIHRhcDoiKSwKICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoS2V5Ym9hcmRTeW1ib2wsIHsgY2hhcmFjdGVyOiBLZXlDb2RlLkVudGVyIH0pKSk7IH0pKTsKICAgICAgICB9OwogICAgICAgIF90aGlzLnJlbmRlclN1Y2Vzc0NoZWNrbWFyayA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIHRyYW5zaXRpb25BbmltYXRpb24gPSBfdGhpcy5zdGF0ZS50cmFuc2l0aW9uQW5pbWF0aW9uOwogICAgICAgICAgICByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoU3ByaW5nLCB7IGNvbmZpZzogY29uZmlnLmdlbnRsZSwgZnJvbTogeyBvcGFjaXR5OiAwLCB0OiAwIH0sIHRvOiB7CiAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogISF0cmFuc2l0aW9uQW5pbWF0aW9uID8gMSA6IDAsCiAgICAgICAgICAgICAgICAgICAgdDogISF0cmFuc2l0aW9uQW5pbWF0aW9uID8gMSA6IDAsCiAgICAgICAgICAgICAgICB9IH0sIGZ1bmN0aW9uIChjaGVja0FuaW1hdGlvbikgeyByZXR1cm4gdHJhbnNpdGlvbkFuaW1hdGlvbiAmJiAoUmVhY3QuY3JlYXRlRWxlbWVudChhbmltYXRlZC5kaXYsIHsgc3R5bGU6IHsKICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiBjaGVja0FuaW1hdGlvbi5vcGFjaXR5LAogICAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogY2hlY2tBbmltYXRpb24udC5pbnRlcnBvbGF0ZSh7CiAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlOiBbMCwgMC4yNSwgLjUsIDAuNzUsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQ6IFswLjUsIDEuMSwgMS4xNSwgMS4xLCAxLjBdLAogICAgICAgICAgICAgICAgICAgIH0pLmludGVycG9sYXRlKGZ1bmN0aW9uICh4KSB7IHJldHVybiAic2NhbGUoIiArIHggKyAiKSI7IH0pLAogICAgICAgICAgICAgICAgfSwgY2xhc3NOYW1lOiAidHJhbnNpdGlvbiIgfSwKICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoUm91bmRDaGVja21hcmssIHsgY2xhc3NOYW1lOiAiY2hlY2siLCBoZWlnaHQ6ICIyMHB4Iiwgd2lkdGg6ICIyMHB4IiB9KSkpIHx8IG51bGw7IH0pKTsKICAgICAgICB9OwogICAgICAgIF90aGlzLmhhbmRsZU1hbnVhbE5leHQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBvbk1hbnVhbE5leHQgPSBfdGhpcy5wcm9wcy5vbk1hbnVhbE5leHQ7CiAgICAgICAgICAgIGlmIChvbk1hbnVhbE5leHQpIHsKICAgICAgICAgICAgICAgIG9uTWFudWFsTmV4dCgpOwogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5oYW5kbGVUaXBDbGVhciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBzaG93T25ib2FyZGluZ1RpcDogZmFsc2UgfSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgdmFyIHRocmVhZExpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdpbmZpbml0ZS10aHJlYWQtbGlzdCcpOwogICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSB0aHJlYWRMaXN0WzBdOwogICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQgJiYgZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7CiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5mb2N1cygpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9OwogICAgICAgIF90aGlzLnJlbmRlclZpZGVvU2VjdGlvbiA9IGZ1bmN0aW9uIChzdGVwKSB7CiAgICAgICAgICAgIHZhciB0cmFuc2l0aW9uQW5pbWF0aW9uID0gX3RoaXMuc3RhdGUudHJhbnNpdGlvbkFuaW1hdGlvbjsKICAgICAgICAgICAgaWYgKHRyYW5zaXRpb25BbmltYXRpb24pIHsKICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHN3aXRjaCAoc3RlcCkgewogICAgICAgICAgICAgICAgY2FzZSBPbmJvYXJkaW5nVHlwZS5TZW5kTWVzc2FnZToKICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoRGVtb1ZpZGVvUHJldmlldywgeyBkZW1vVmlkZW86IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IE9uYm9hcmRpbmdUeXBlLlNlbmRNZXNzYWdlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGh1bWJuYWlsVXJsOiAnaHR0cHM6Ly9pbWFnZS5tdXguY29tL0daQ09EWjAxQWFBNnhsc2dZWjdPaTJZa3JQYjZCVXcwMWlSbjMwMExHalFYQlkvdGh1bWJuYWlsLnBuZz93aWR0aD00MDAmaGVpZ2h0PTI0MCZmaXRfbW9kZT1zbWFydGNyb3AmdGltZT0wMicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bWF4LWxpbmUtbGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICdodHRwczovL3N0cmVhbS5tdXguY29tL0daQ09EWjAxQWFBNnhsc2dZWjdPaTJZa3JQYjZCVXcwMWlSbjMwMExHalFYQlkvbWVkaXVtLm1wNCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXB0aW9uVXJsOiAnaHR0cHM6Ly9zdHJlYW0ubXV4LmNvbS9HWkNPRFowMUFhQTZ4bHNnWVo3T2kyWWtyUGI2QlV3MDFpUm4zMDBMR2pRWEJZL3RleHQvcmZuOWNDMDBuZXhoQ3VlQzQwMDZWTTZaaDAxQmtjN3FyS2ZrMDJPbTJFdzU3cW43bzJtdjZ2cWM1dy52dHQnLAogICAgICAgICAgICAgICAgICAgICAgICB9LCB3aWR0aDogMjAwLCBsYWJlbERpc2Nsb3N1cmU6IHRydWUgfSkpOwogICAgICAgICAgICAgICAgY2FzZSBPbmJvYXJkaW5nVHlwZS5TZW5kTGF0ZXI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChSZWFjdC5jcmVhdGVFbGVtZW50KERlbW9WaWRlb1ByZXZpZXcsIHsgZGVtb1ZpZGVvOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBPbmJvYXJkaW5nVHlwZS5TZW5kTGF0ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWxVcmw6ICdodHRwczovL2ltYWdlLm11eC5jb20vSEFVUzJQeEVnVTJzT2RyMmVibXRwVVMxT2tlYzM1TEE1SERlWkozVGdYby90aHVtYm5haWwucG5nP3dpZHRoPTQwMCZoZWlnaHQ9MjQwJmZpdF9tb2RlPXNtYXJ0Y3JvcCZ0aW1lPTAyJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJ2h0dHBzOi8vc3RyZWFtLm11eC5jb20vSEFVUzJQeEVnVTJzT2RyMmVibXRwVVMxT2tlYzM1TEE1SERlWkozVGdYby9tZWRpdW0ubXA0JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcHRpb25Vcmw6ICdodHRwczovL3N0cmVhbS5tdXguY29tL0hBVVMyUHhFZ1Uyc09kcjJlYm10cFVTMU9rZWMzNUxBNUhEZVpKM1RnWG8vdGV4dC84WktWZldwQmxpTGtJTnBHRzAxSXVVZmxRRnFkbHpEdndETm1LUGN5azc2MTJRNlp4dTN6MDFLdy52dHQnLAogICAgICAgICAgICAgICAgICAgICAgICB9LCB3aWR0aDogMjAwLCBsYWJlbERpc2Nsb3N1cmU6IHRydWUgfSkpOwogICAgICAgICAgICAgICAgY2FzZSBPbmJvYXJkaW5nVHlwZS5SZWFkTGF0ZXI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChSZWFjdC5jcmVhdGVFbGVtZW50KERlbW9WaWRlb1ByZXZpZXcsIHsgZGVtb1ZpZGVvOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBPbmJvYXJkaW5nVHlwZS5SZWFkTGF0ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWxVcmw6ICdodHRwczovL2ltYWdlLm11eC5jb20vRTdPRnU0Vmw0Nk51MDBRSFhCdkdWMDBQZzgwMXFFRjRsRDAxd2hjcncxWDAwS0pzL3RodW1ibmFpbC5wbmc/d2lkdGg9NDAwJmhlaWdodD0yNDAmZml0X21vZGU9c21hcnRjcm9wJnRpbWU9MDInLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnaHR0cHM6Ly9zdHJlYW0ubXV4LmNvbS9FN09GdTRWbDQ2TnUwMFFIWEJ2R1YwMFBnODAxcUVGNGxEMDF3aGNydzFYMDBLSnMvbWVkaXVtLm1wNCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXB0aW9uVXJsOiAnaHR0cHM6Ly9zdHJlYW0ubXV4LmNvbS9FN09GdTRWbDQ2TnUwMFFIWEJ2R1YwMFBnODAxcUVGNGxEMDF3aGNydzFYMDBLSnMvdGV4dC9YMzAySmNpeDZxWXdsUEFteDJIY2xmdDRhSVFoMk9iNHk3eVBXd3hkRFhuY3pwZTdUZ3ZUZjAyUS52dHQnLAogICAgICAgICAgICAgICAgICAgICAgICB9LCB3aWR0aDogMjAwLCBsYWJlbERpc2Nsb3N1cmU6IHRydWUgfSkpOwogICAgICAgICAgICAgICAgY2FzZSBPbmJvYXJkaW5nVHlwZS5TYXZlQXNUZW1wbGF0ZToKICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoRGVtb1ZpZGVvUHJldmlldywgeyBkZW1vVmlkZW86IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IE9uYm9hcmRpbmdUeXBlLlNhdmVBc1RlbXBsYXRlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGh1bWJuYWlsVXJsOiAnaHR0cHM6Ly9pbWFnZS5tdXguY29tL0JKZDhPZXJFaDNvRk44SnBnU0JmVDFWTTRYWWRGNjNtajRiZzAxYVo2czVZL3RodW1ibmFpbC5wbmc/d2lkdGg9NDAwJmhlaWdodD0yNDAmZml0X21vZGU9c21hcnRjcm9wJnRpbWU9MDInLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnaHR0cHM6Ly9zdHJlYW0ubXV4LmNvbS9CSmQ4T2VyRWgzb0ZOOEpwZ1NCZlQxVk00WFlkRjYzbWo0YmcwMWFaNnM1WS9tZWRpdW0ubXA0JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcHRpb25Vcmw6ICdodHRwczovL3N0cmVhbS5tdXguY29tL0JKZDhPZXJFaDNvRk44SnBnU0JmVDFWTTRYWWRGNjNtajRiZzAxYVo2czVZL3RleHQvT1hjNkEyNVEwMlZTWTAwV2VtUWp1MVYwMUxDMDFkeklmeGdtaExTWWQ3Q2NiakFQZnpFcGZhbk9yZy52dHQnLAogICAgICAgICAgICAgICAgICAgICAgICB9LCB3aWR0aDogMjAwLCBsYWJlbERpc2Nsb3N1cmU6IHRydWUgfSkpOwogICAgICAgICAgICAgICAgY2FzZSBPbmJvYXJkaW5nVHlwZS5NZXNzYWdlVGVtcGxhdGVzOgogICAgICAgICAgICAgICAgICAgIHJldHVybiAoUmVhY3QuY3JlYXRlRWxlbWVudChEZW1vVmlkZW9QcmV2aWV3LCB7IGRlbW9WaWRlbzogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogT25ib2FyZGluZ1R5cGUuTWVzc2FnZVRlbXBsYXRlcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRodW1ibmFpbFVybDogJ2h0dHBzOi8vaW1hZ2UubXV4LmNvbS9WWnVMbnUxSTAwRVBVUjlsbGhMYWI1MjZNeDRTSzUwMnFZUzJqVzFZclVmdmcvdGh1bWJuYWlsLnBuZz93aWR0aD00MDAmaGVpZ2h0PTI0MCZmaXRfbW9kZT1zbWFydGNyb3AnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnaHR0cHM6Ly9zdHJlYW0ubXV4LmNvbS9WWnVMbnUxSTAwRVBVUjlsbGhMYWI1MjZNeDRTSzUwMnFZUzJqVzFZclVmdmcvbWVkaXVtLm1wNCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXB0aW9uVXJsOiAnaHR0cHM6Ly9zdHJlYW0ubXV4LmNvbS9WWnVMbnUxSTAwRVBVUjlsbGhMYWI1MjZNeDRTSzUwMnFZUzJqVzFZclVmdmcvdGV4dC9HMDFWYWJ1ekFmRUxzYW1XcHNEOEhNSlFreHZqT0dXVXcwMFNsNTM2bzdTekd4R2MwMHJaRlBVVVEudnR0JywKICAgICAgICAgICAgICAgICAgICAgICAgfSwgd2lkdGg6IDIwMCwgbGFiZWxEaXNjbG9zdXJlOiB0cnVlIH0pKTsKICAgICAgICAgICAgICAgIGNhc2UgT25ib2FyZGluZ1R5cGUuU2NoZWR1bGluZzoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoRGVtb1ZpZGVvUHJldmlldywgeyBkZW1vVmlkZW86IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IE9uYm9hcmRpbmdUeXBlLlNjaGVkdWxpbmcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWxVcmw6ICdodHRwczovL2ltYWdlLm11eC5jb20vdmhhSWlSVFpDdVZ3Z3EzeldMdHV2WTAyZktpNmdMS1Z2c3p5aDRsMDF3cG0wMC90aHVtYm5haWwucG5nP3dpZHRoPTQwMCZoZWlnaHQ9MjQwJmZpdF9tb2RlPXNtYXJ0Y3JvcCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICdodHRwczovL3N0cmVhbS5tdXguY29tL3ZoYUlpUlRaQ3VWd2dxM3pXTHR1dlkwMmZLaTZnTEtWdnN6eWg0bDAxd3BtMDAvbWVkaXVtLm1wNCcsCiAgICAgICAgICAgICAgICAgICAgICAgIH0sIHdpZHRoOiAyMDAsIGxhYmVsRGlzY2xvc3VyZTogdHJ1ZSB9KSk7CiAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5zdGF0ZSA9IHsKICAgICAgICAgICAgaG90a2V5VHlwZTogcHJvcHMucHJlZmVyZW5jZXMuaG90a2V5cywKICAgICAgICAgICAgdHJhbnNpdGlvbkFuaW1hdGlvbjogZmFsc2UsCiAgICAgICAgICAgIGhvdGtleUFjdGl2YXRlZDogZmFsc2UsCiAgICAgICAgICAgIGNvbnRpbnVlQWN0aXZhdGVkOiBmYWxzZSwKICAgICAgICAgICAgbWFudWFsQ29tcGxldGlvbkFjdGl2YXRlZDogZmFsc2UsCiAgICAgICAgICAgIGFjdGl2YXRlZEhvdGtleXM6IHt9LAogICAgICAgIH07CiAgICAgICAgcmV0dXJuIF90aGlzOwogICAgfQogICAgLy8gT2JzZXJ2ZXMgZmlyaW5nIG9mIG9uYm9hcmRpbmcgZXZlbnRzIHRocm91Z2ggZGlzcGF0Y2hlciBtZWNoYW5pc20gKHNpbmNlIHVubmVlZGVkIGJ5IHJlZHV4KQogICAgT25ib2FyZGluZ1NlY3Rpb25EZXRhaWwucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50ID0gZnVuY3Rpb24gKCkgewogICAgICAgIHRoaXMuc2V0U3RhdGUoeyB0cmFuc2l0aW9uQW5pbWF0aW9uOiBmYWxzZSB9KTsKICAgICAgICBkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLm9ic2VydmVLZXlEb3duKTsKICAgICAgICBpZiAodGhpcy5wcm9wcy5jdXJyZW50U3RlcCA9PT0gT25ib2FyZGluZ1R5cGUuU2VuZE1lc3NhZ2UpIHsKICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHNob3dPbmJvYXJkaW5nVGlwOiB0cnVlIH0pOwogICAgICAgIH0KICAgICAgICB0aGlzLm9ic2VydmVPbmJvYXJkaW5nRXZlbnRzKCk7CiAgICB9OwogICAgLy8gVW5tb3VudHMgc3Vic2NyaXB0aW9ucyBhbmQgcmVtb3ZlcyBldmVudCBsaXN0ZW5lcnMKICAgIE9uYm9hcmRpbmdTZWN0aW9uRGV0YWlsLnByb3RvdHlwZS5jb21wb25lbnRXaWxsVW5tb3VudCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB0aGlzLm9uYm9hcmRpbmdTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTsKICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLm9ic2VydmVLZXlEb3duKTsKICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lb3V0KTsKICAgIH07CiAgICBPbmJvYXJkaW5nU2VjdGlvbkRldGFpbC5wcm90b3R5cGUuY29tcG9uZW50RGlkVXBkYXRlID0gZnVuY3Rpb24gKG9sZFByb3BzLCBvbGRTdGF0ZSkgewogICAgICAgIGlmIChvbGRQcm9wcyAhPT0gdGhpcy5wcm9wcykgewogICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgIGhvdGtleVR5cGU6IHRoaXMucHJvcHMucHJlZmVyZW5jZXMuaG90a2V5cywKICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIHZhciBuZXh0T25ib2FyZGluZyA9IHRoaXMucHJvcHMuY3VycmVudFN0ZXA7CiAgICAgICAgaWYgKG5leHRPbmJvYXJkaW5nICE9PSBvbGRQcm9wcy5jdXJyZW50U3RlcCkgewogICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgIHRyYW5zaXRpb25BbmltYXRpb246IHRydWUsIGNvbnRpbnVlQWN0aXZhdGVkOiBmYWxzZSwKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICB9OwogICAgT25ib2FyZGluZ1NlY3Rpb25EZXRhaWwucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgX2EgPSB0aGlzLnByb3BzLCBjdXJyZW50U3RlcCA9IF9hLmN1cnJlbnRTdGVwLCBpc0RyYWZ0ID0gX2EuaXNEcmFmdCwgYWN0aXZlU3RlcCA9IF9hLmFjdGl2ZVN0ZXAsIGlzVGhyZWFkID0gX2EuaXNUaHJlYWQsIGFsbFN0ZXBzID0gX2EuYWxsU3RlcHMsIG9uYm9hcmRpbmcgPSBfYS5vbmJvYXJkaW5nOwogICAgICAgIHZhciBfYiA9IHRoaXMuc3RhdGUsIHRyYW5zaXRpb25BbmltYXRpb24gPSBfYi50cmFuc2l0aW9uQW5pbWF0aW9uLCBtYW51YWxDb21wbGV0aW9uQWN0aXZhdGVkID0gX2IubWFudWFsQ29tcGxldGlvbkFjdGl2YXRlZCwgc2hvd09uYm9hcmRpbmdUaXAgPSBfYi5zaG93T25ib2FyZGluZ1RpcDsKICAgICAgICB2YXIgZGlzcGxheWVkU3RlcCA9IGFjdGl2ZVN0ZXAgfHwgY3VycmVudFN0ZXA7CiAgICAgICAgdmFyIGNvdW50ZXIgPSAwOwogICAgICAgIHZhciBzdGVwOwogICAgICAgIC8vIElkZW50aWZ5IGNvdW50ZXIKICAgICAgICB2YXIgc3RlcHNMZW5ndGggPSBhbGxTdGVwcy5sZW5ndGg7CiAgICAgICAgLy8gU2V0IGNvdW50ZXIgZm9yIHdoYXQgc3RlcCB3ZSdyZSBvbgogICAgICAgIGNvdW50ZXIgPSBkaXNwbGF5ZWRTdGVwID8gaW5kZXhPZihhbGxTdGVwcywgZGlzcGxheWVkU3RlcCkgOiAtMTsKICAgICAgICAvLyBJZiBzdGFuZGFyZCBwcm9ncmVzc2lvbiwgc3VidHJhY3Qgb25lIGZyb20gY3VycmVudCBPbmJvYXJkaW5nIHdoaWxlIGluIGEgdHJhbnNpdGlvbiBzdGVwLgogICAgICAgIGlmICghbWFudWFsQ29tcGxldGlvbkFjdGl2YXRlZCAmJiB0cmFuc2l0aW9uQW5pbWF0aW9uKSB7CiAgICAgICAgICAgIGNvdW50ZXIgPSBjb3VudGVyIC0gMTsKICAgICAgICB9CiAgICAgICAgLy8gTWF0Y2ggaG90a2V5CiAgICAgICAgc3RlcCA9IGFsbFN0ZXBzW2NvdW50ZXJdOwogICAgICAgIC8vIElkZW50aWZ5IGlmIHByZXJlcXVpc2l0ZXMgZm9yIHN0ZXAgaGF2ZSB0byBiZSBmaWxsZWQKICAgICAgICB2YXIgaGlkZUNvcHkgPSBmYWxzZTsKICAgICAgICBpZiAoIXRyYW5zaXRpb25BbmltYXRpb24pIHsKICAgICAgICAgICAgaWYgKG9uYm9hcmRpbmdSZXF1aXJlc0RyYWZ0KHN0ZXApICYmICFpc0RyYWZ0KSB7CiAgICAgICAgICAgICAgICBoaWRlQ29weSA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZiAob25ib2FyZGluZ1JlcXVpcmVzVGhyZWFkKHN0ZXApICYmICFpc1RocmVhZCkgewogICAgICAgICAgICAgICAgaGlkZUNvcHkgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIC8vIERlZmF1bHQgc3RhdGUKICAgICAgICBpZiAoIXN0ZXApIHsKICAgICAgICAgICAgc3RlcCA9IE9uYm9hcmRpbmdUeXBlLkNvbXBsZXRlOwogICAgICAgIH0KICAgICAgICAvLyBNZXNzYWdlIGZvciBPbmJvYXJkaW5nIFRpcAogICAgICAgIHZhciBvbmJvYXJkaW5nTWVzc2FnZSA9IChSZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgbnVsbCwKICAgICAgICAgICAgIldlJ2xsIGJlIHNoYXJpbmcgc3RlcHMgaGVyZSB0byBoZWxwIHlvdSBsZWFybiBob3cgdG8gdXNlIFBvbHltYWlsIG1vc3QgZWZmZWN0aXZlbHkhIiwKICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgICAgIkNvbXBsZXRlIGFsbCB0aGUgc3RlcHMgYW5kIHlvdSdsbCByZWNlaXZlIGEgJDEwIGNyZWRpdCB0byBhbnkgcGFpZCBwbGFuISIpKTsKICAgICAgICByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAib25ib2FyZGluZy1zZWN0aW9uLWRldGFpbCIgfSwKICAgICAgICAgICAgc2hvd09uYm9hcmRpbmdUaXAgJiYgKFJlYWN0LmNyZWF0ZUVsZW1lbnQoT25ib2FyZGluZ1RpcCwgeyB0aXRsZTogIkxlYXJuIEhvdyB0byBVc2UgUG9seW1haWwiLCBtZXNzYWdlOiBvbmJvYXJkaW5nTWVzc2FnZSwgcmlnaHQ6ICIyNzRweCIsIGFuY2hvclBvc2l0aW9uOiBBbmNob3JQb3NpdGlvbi5SaWdodCwgb25OZXh0OiB0aGlzLmhhbmRsZVRpcENsZWFyIH0pKSwKICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0aXRsZSIgfSwgdGhpcy5yZW5kZXJUaXRsZShzdGVwKSksCiAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAicHJvZ3Jlc3MiIH0sCiAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogInRvcCIgfSwKICAgICAgICAgICAgICAgICAgICBjb3VudGVyID4gLTEgJiYKICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJjb3B5IiB9LCBjb3VudGVyICsgIiBvZiAiICsgKHN0ZXBzTGVuZ3RoIHx8IDApICsgIiBjb21wbGV0ZWQiKSwKICAgICAgICAgICAgICAgICAgICBjb3VudGVyID09PSAtMSAmJgogICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImNvcHkiIH0sICJHcmVhdCBqb2IhIE1vdmluZyBvbiIpLAogICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyU3VjZXNzQ2hlY2ttYXJrKCkpLAogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJwcm9ncmVzcy1iYXIiIH0sCiAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBzdHlsZTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDEwMC4wICogY291bnRlciAvIHN0ZXBzTGVuZ3RoICsgIiUiLAogICAgICAgICAgICAgICAgICAgICAgICB9LCBjbGFzc05hbWU6ICJwcm9ncmVzcy1iYXItY29tcGxldGVkIiB9KSkpLAogICAgICAgICAgICB0aGlzLnJlbmRlckluZm9TZWN0aW9uKHN0ZXApLAogICAgICAgICAgICAhaGlkZUNvcHkgJiYKICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyU3RlcHMoc3RlcCksCiAgICAgICAgICAgICFoaWRlQ29weSAmJiB0aGlzLnJlbmRlckNvbW1hbmRDb250cm9sU3RlcChzdGVwKSwKICAgICAgICAgICAgIXRyYW5zaXRpb25BbmltYXRpb24gJiYgIW9uYm9hcmRpbmcuY2xhaW1lZENyZWRpdCAmJgogICAgICAgICAgICAgICAgYWN0aXZlU3RlcCA9PT0gT25ib2FyZGluZ1R5cGUuQ2xhaW1DcmVkaXQgJiYgLy8gU2hvdyBjcmVhdGUgZHJhZnQgYnV0dG9uCiAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJidXR0b24iLCB7IG9uQ2xpY2s6IHRoaXMuaGFuZGxlQ3JlZGl0Q2xhaW0sIGNsYXNzTmFtZTogImNyZWF0ZS1kcmFmdCIgfSwgIkNsYWltIENyZWRpdCIpLAogICAgICAgICAgICAhdHJhbnNpdGlvbkFuaW1hdGlvbiAmJgogICAgICAgICAgICAgICAgYWN0aXZlU3RlcCA9PT0gT25ib2FyZGluZ1R5cGUuRG93bmxvYWROYXRpdmVBcHBzICYmIC8vIFNob3cgY3JlYXRlIGRyYWZ0IGJ1dHRvbgogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnV0dG9uIiwgeyBvbkNsaWNrOiB0aGlzLmhhbmRsZURvd25sb2FkTmF0aXZlQXBwcywgY2xhc3NOYW1lOiAiY3JlYXRlLWRyYWZ0IiB9LCBJU19NQUMgPyAnRG93bmxvYWQgTWFjIEFwcCcgOiAnRG93bmxvYWQgV2luZG93cyBBcHAnKSwKICAgICAgICAgICAgaGlkZUNvcHkgJiYgLy8gU2hvdyBjcmVhdGUgZHJhZnQgYnV0dG9uCiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlclByZXJlcXVpc2l0ZVN0ZXAoc3RlcCksCiAgICAgICAgICAgICFoaWRlQ29weSAmJiB0cmFuc2l0aW9uQW5pbWF0aW9uICYmIC8vIERvIG5vdCBzaG93IHdoZW4gZHJhZnQgaXMgbm90IG9wZW4gYW5kIGRyYWZ0IHNlY3Rpb24KICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyU2Vjb25kSW5mb1NlY3Rpb24oc3RlcCksCiAgICAgICAgICAgIHRoaXMucmVuZGVyTmV4dFN0ZXBDdGEoY291bnRlciksCiAgICAgICAgICAgIHRoaXMucmVuZGVyVmlkZW9TZWN0aW9uKHN0ZXApLAogICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImRpc2Nsb3N1cmUtYXJlYSIgfSwKICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIsIHsgb25DbGljazogdGhpcy5wcm9wcy5vbkxlZ2VuZENsaWNrIH0sICJTZWUgcHJldmlvdXMgc3RlcHMiKSwKICAgICAgICAgICAgICAgIGN1cnJlbnRTdGVwID09PSBhY3RpdmVTdGVwICYmIChSZWFjdC5jcmVhdGVFbGVtZW50KCJidXR0b24iLCB7IGNsYXNzTmFtZTogY2xhc3NuYW1lcygnc2tpcC1idXR0b24nLCB7IGhpZGU6IHRyYW5zaXRpb25BbmltYXRpb24gfSksIG9uQ2xpY2s6IHRoaXMuaGFuZGxlU2tpcCB9LCAiU2tpcCBTdGVwIikpKSkpOwogICAgfTsKICAgIHJldHVybiBPbmJvYXJkaW5nU2VjdGlvbkRldGFpbDsKfShSZWFjdC5QdXJlQ29tcG9uZW50KSk7CmV4cG9ydCBkZWZhdWx0IE9uYm9hcmRpbmdTZWN0aW9uRGV0YWlsOwo="},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/RightSidebar/components/Onboarding/Legend/components/OnboardingSectionDetail/OnboardingSectionDetail.tsx","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/RightSidebar/components/Onboarding/Legend/components/OnboardingSectionDetail/OnboardingSectionDetail.tsx"],"names":[],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Spring, animated, config } from 'react-spring';\nimport classnames from 'classnames';\nimport {\n  Hotkeys, Preferences,\n  KeyCode, OnboardingType, Action, Features, Account, Onboarding,\n} from '@src/types';\nimport './OnboardingSectionDetail.scss';\nimport { Hotkey, HotkeyCode, HotkeyAction, hotkeysTypeahead, getHotkey, getHotkeyByName } from '@src/lib/hotkeys';\nimport RoundCheckmark from '@src/components/Icons/RoundCheckmark.svg';\nimport KeyboardSymbol from '@src/components/Base/KeyboardSymbol/KeyboardSymbol';\nimport { indexOf } from 'lodash';\nimport { createMailToDraft } from '@src/lib/draft';\nimport { draftCreate } from '@src/ducks/drafts';\nimport {\n  hotkeyForOnboarding,\n  randomizedReinforcement, onboardingRequiresThread,\n  onboardingRequiresDraft,\n} from '@src/lib/onboarding';\nimport { onboardingPatch } from '@src/ducks/me';\nimport { RouteComponentProps } from 'react-router';\nimport browserHistory from '@src/lib/browserHistory';\nimport { getOnboardingActions } from '@src/lib/OnboardingDispatcher';\nimport { Subscription } from 'rxjs';\nimport { IS_MAC } from '@src/lib/device';\nimport OnboardingTip, { AnchorPosition } from '@src/components/Onboarding/components/OnboardingTip/OnboardingTip';\nimport DemoVideoPreview from '@src/components/DemoVideo/DemoVideoPreview';\nimport { isFocusedOnEditableContent } from '@src/lib/utils';\nimport { AmplitudeEvents, logAmplitudeEvent } from '@src/lib/amplitude-analytics';\n\nexport interface StateProps {\n  accounts: Account[];\n  features: Features;\n  preferences: Preferences;\n  onboarding: Onboarding;\n  isDraft?: boolean;\n  isThread?: boolean;\n  allSteps: OnboardingType[];\n}\n\ninterface State {\n  hotkeyType: Hotkeys;\n  transitionAnimation: boolean;\n  hotkeyActivated: boolean;\n  continueActivated: boolean;\n  manualCompletionActivated: boolean;\n  showOnboardingTip?: boolean;\n  activatedHotkeys: {\n    [key: string]: boolean,\n  };\n}\n\nexport interface DispatchProps {\n  updatePreferences: (preferences: Preferences) => void;\n  dispatchAction: (action: Action<any, any>) => void;\n  claimCredit: (action: Partial<Onboarding>) => void;\n  toggleMute: (action: boolean) => void;\n}\n\nexport interface Props {\n  currentStep?: OnboardingType;\n  activeStep?: OnboardingType;\n  onManualNext?: () => void;\n  onLegendClick: () => void;\n}\n\n// tslint:disable-next-line:max-line-length\n// TODO(SHIN): Introduction (Getting Started Information)\nclass OnboardingSectionDetail extends React.PureComponent<\n  Props & StateProps & DispatchProps & RouteComponentProps<any>, State\n> {\n\n  timeout: NodeJS.Timer;\n\n  onboardingSubscription: Subscription;\n\n  constructor(props: Props & StateProps & DispatchProps & RouteComponentProps<any>) {\n    super(props);\n\n    this.state = {\n      hotkeyType: props.preferences.hotkeys,\n      transitionAnimation: false,\n      hotkeyActivated: false,\n      continueActivated: false,\n      manualCompletionActivated: false,\n      activatedHotkeys: {},\n    };\n  }\n\n  // Observes firing of onboarding events through dispatcher mechanism (since unneeded by redux)\n  componentDidMount() {\n    this.setState({ transitionAnimation: false });\n    document.body.addEventListener('keydown', this.observeKeyDown);\n\n    if (this.props.currentStep === OnboardingType.SendMessage) {\n      this.setState({ showOnboardingTip: true });\n    }\n\n    this.observeOnboardingEvents();\n  }\n\n  // Unmounts subscriptions and removes event listeners\n  componentWillUnmount() {\n    this.onboardingSubscription.unsubscribe();\n    document.body.removeEventListener('keydown', this.observeKeyDown);\n    clearTimeout(this.timeout);\n  }\n\n  // Handles Observing Onboarding Event that are manually completed\n  observeOnboardingEvents = () => {\n    this.onboardingSubscription = getOnboardingActions().subscribe({\n      next: (a) => {\n        const { activeStep, currentStep } = this.props;\n        const { transitionAnimation } = this.state;\n\n        // Do not observe actions if transition animation activated\n        if (transitionAnimation) {\n          return;\n        }\n\n        // Let default handling occur if active step is equal to current step\n        if (activeStep === currentStep) {\n          return;\n        }\n\n        // Mark completion if active step is true\n        if (a === activeStep) {\n          // Handle state updates for manual completions\n          this.setState({\n            transitionAnimation: true,\n            continueActivated: false,\n            manualCompletionActivated: true,\n          });\n        }\n      },\n    });\n  }\n\n  // Custom observation for key events to show intermediate step completions\n  observeKeyDown = (e: KeyboardEvent) => {\n    const { activeStep, isDraft, isThread } = this.props;\n    const { transitionAnimation } = this.state;\n    const hotkey = getHotkey(e);\n    if (!activeStep) {\n      return;\n    }\n\n    if (transitionAnimation && e.keyCode === KeyCode.Enter) {\n      this.handleContinue();\n      e.stopPropagation();\n      e.preventDefault();\n    }\n\n    // Do not observe hotkeys when prerequisites have not been met\n    if (activeStep && !transitionAnimation && !isThread && onboardingRequiresThread(activeStep)) {\n      return;\n    }\n\n    // Do not observe hotkeys when prerequisites have not been met, except for draft create\n    if (activeStep && !transitionAnimation && !isDraft && onboardingRequiresDraft(activeStep)) {\n\n      // Don't activate new draft if in a editable element\n      if (isFocusedOnEditableContent()) {\n        return;\n      }\n\n      if (activeStep && hotkey?.name === HotkeyAction.NewDraft) {\n        if (activeStep === OnboardingType.FollowUpReminder) {\n          logAmplitudeEvent(AmplitudeEvents.TourStepTwo, { skipped: false });\n        }\n\n        this.handleDraftCreate();\n        e.stopPropagation();\n        e.preventDefault();\n        return;\n      }\n    }\n\n    const { activatedHotkeys } = this.state;\n\n    // TODO(SHIN): Activate hotkey\n    switch (activeStep) {\n      case OnboardingType.NextThread:\n      case OnboardingType.Archive:\n        if (\n          !activatedHotkeys[HotkeyAction.NextThread] &&\n          [KeyCode.J, KeyCode.Down].indexOf(e.keyCode) > -1\n        ) {\n          const updated = {\n            ...activatedHotkeys,\n            [HotkeyAction.NextThread]: true,\n          };\n          this.setState({ activatedHotkeys: updated });\n        }\n\n        if (!activatedHotkeys[HotkeyAction.PreviousThread] &&\n          [KeyCode.K, KeyCode.Up].indexOf(e.keyCode) > -1\n        ) {\n          const updated = {\n            ...activatedHotkeys,\n            [HotkeyAction.PreviousThread]: true,\n          };\n          this.setState({ activatedHotkeys: updated });\n        }\n\n        if (hotkey && activeStep && hotkeyForOnboarding(activeStep) === hotkey.name) {\n          const updated = {\n            ...activatedHotkeys,\n            [hotkey.name]: true,\n          };\n          this.setState({ activatedHotkeys: updated });\n        }\n\n        break;\n      default:\n        if (hotkey && activeStep && hotkeyForOnboarding(activeStep) === hotkey.name) {\n          const updated = {\n            ...activatedHotkeys,\n            [hotkey.name]: true,\n          };\n          this.setState({ activatedHotkeys: updated });\n        }\n    }\n  }\n\n  componentDidUpdate(oldProps: Props & StateProps & DispatchProps, oldState: State) {\n    if (oldProps !== this.props) {\n      this.setState({\n        hotkeyType: this.props.preferences.hotkeys,\n      });\n    }\n\n    const nextOnboarding = this.props.currentStep;\n    if (nextOnboarding !== oldProps.currentStep) {\n      this.setState({\n        transitionAnimation: true, continueActivated: false,\n      }); return;\n    }\n  }\n\n  handleContinue = () => {\n    const { manualCompletionActivated } = this.state;\n    this.setState({ continueActivated: true, hotkeyActivated: true }, () => {\n      clearTimeout(this.timeout);\n      this.timeout = global.setTimeout(\n        () => {\n          this.setState(\n            {\n              transitionAnimation: false,\n              activatedHotkeys: {},\n              manualCompletionActivated: false,\n            },\n            () => {\n              if (manualCompletionActivated) {\n                this.handleManualNext();\n              }\n            },\n          );\n        },\n        1000,\n      );\n    });\n  }\n\n  handleCreditClaim = () => {\n    const { claimCredit } = this.props;\n    claimCredit({ claimedCredit: true });\n    logAmplitudeEvent(AmplitudeEvents.TourStepFourteen, { skipped: false });\n  }\n\n  handleDownloadNativeApps = () => {\n    const { dispatchAction } = this.props;\n    dispatchAction(onboardingPatch({\n      type: { downloadNativeApps: true },\n      skipped: false,\n    }));\n    logAmplitudeEvent(AmplitudeEvents.TourStepThirteen, { skipped: false });\n    getOnboardingActions().next(OnboardingType.DownloadNativeApps);\n    window.open('https://polymail.io/download?download=1&utm_source=polymail&utm_campaign=webapp', '_blank');\n  }\n\n  handleDraftCreate = () => {\n    const { preferences, dispatchAction, accounts, features, activeStep } = this.props;\n\n    if (preferences && activeStep && activeStep === OnboardingType.SaveAsTemplate) {\n      const mailToString = 'Poly Bot <onboarding+extras@polymail.io>?subject=⚡️ '\n        + 'Saving a Message Template!&body=Hello! 👋🏼\\n\\n'\n        + 'We\\'ll be using this draft to create a template from a message you are creating.'\n        + '\\n\\n'\n        + 'Try following the instructions on the right to save this as a template!';\n      browserHistory.push('/mail');\n      const draft = createMailToDraft(accounts[0], preferences, features, mailToString);\n      dispatchAction(draftCreate(draft));\n      return;\n    }\n\n    if (preferences && activeStep && activeStep !== OnboardingType.SendMessage) {\n      const mailToString = 'Poly Bot <onboarding+extras@polymail.io>?subject=⚡️ '\n        + 'Sending Messages in Polymail!&body=Hello! 👋🏼\\n\\n'\n        + 'Let\\'s learn some other features to supercharge your messages in Polymail.\\n\\n'\n        + 'Check the right sidebar for more information! ------->';\n      browserHistory.push('/mail');\n      const draft = createMailToDraft(accounts[0], preferences, features, mailToString);\n      dispatchAction(draftCreate(draft));\n      return;\n    }\n\n    if (preferences) {\n      const mailToString = 'Poly Bot <onboarding@polymail.io>?subject=⚡️ '\n        + 'Send your first message with tracking!&body=Hello! 👋🏼\\n\\n'\n        + 'Polymail automatically gives you insights on the emails you send!'\n        + '\\n\\n'\n        + 'Try clicking send to see how it works!';\n      browserHistory.push('/mail');\n      const draft = createMailToDraft(accounts[0], preferences, features, mailToString);\n      dispatchAction(draftCreate(draft));\n    }\n  }\n\n  // Handles skipping sections\n  handleSkip = () => {\n    const { dispatchAction, currentStep } = this.props;\n    if (dispatchAction && currentStep) {\n      switch (currentStep) {\n        case OnboardingType.NextThread:\n          dispatchAction(onboardingPatch({\n            skipped: true,\n            type: { steps: { nextThread: true } },\n          }));\n          logAmplitudeEvent(AmplitudeEvents.TourStepSix, { skipped: true });\n          return;\n        case OnboardingType.Archive:\n          dispatchAction(onboardingPatch({\n            skipped: true,\n            type: { steps: { archive: true } },\n          }));\n          logAmplitudeEvent(AmplitudeEvents.TourStepSeven, { skipped: true });\n          return;\n        case OnboardingType.ReadLater:\n          dispatchAction(onboardingPatch({\n            skipped: true,\n            type: { steps: { readLater: true } },\n          }));\n          logAmplitudeEvent(AmplitudeEvents.TourStepNine, { skipped: true });\n          return;\n        case OnboardingType.Undo:\n          dispatchAction(onboardingPatch({\n            skipped: true,\n            type: { steps: { undo: true } },\n          }));\n          logAmplitudeEvent(AmplitudeEvents.TourStepEight, { skipped: true });\n          return;\n        case OnboardingType.SaveAsTemplate:\n          dispatchAction(onboardingPatch({\n            skipped: true,\n            type: { steps: { saveAsTemplate: true } },\n          }));\n          logAmplitudeEvent(AmplitudeEvents.TourStepFive, { skipped: true });\n          return;\n        case OnboardingType.SendMessage:\n          dispatchAction(onboardingPatch({\n            skipped: true,\n            type: { sendMessage: true },\n          }));\n          logAmplitudeEvent(AmplitudeEvents.TourStepOneSend, { skipped: true });\n          return;\n        case OnboardingType.SendLater:\n          dispatchAction(onboardingPatch({\n            skipped: true,\n            type: { steps: { sendLater: true } },\n          }));\n          logAmplitudeEvent(AmplitudeEvents.TourStepTwo, { skipped: true });\n          return;\n        case OnboardingType.FollowUpReminder:\n          dispatchAction(onboardingPatch({\n            skipped: true,\n            type: { steps: { followUpReminder: true } },\n          }));\n          logAmplitudeEvent(AmplitudeEvents.TourStepThree, { skipped: true });\n          return;\n        case OnboardingType.MessageTemplates:\n          dispatchAction(onboardingPatch({\n            skipped: true,\n            type: { steps: { messageTemplates: true } },\n          }));\n          logAmplitudeEvent(AmplitudeEvents.TourStepFour, { skipped: true });\n          return;\n        case OnboardingType.ShareThread:\n          dispatchAction(onboardingPatch({\n            skipped: true,\n            type: { steps: { shareThread: true } },\n          }));\n          logAmplitudeEvent(AmplitudeEvents.TourStepTen, { skipped: true });\n          return;\n        case OnboardingType.Comment:\n          dispatchAction(onboardingPatch({\n            skipped: true,\n            type: { steps: { comment: true } },\n          }));\n          logAmplitudeEvent(AmplitudeEvents.TourStepEleven, { skipped: true });\n          return;\n        case OnboardingType.Scheduling:\n          dispatchAction(onboardingPatch({\n            skipped: true,\n            type: { steps: { scheduling: true } },\n          }));\n          return;\n        case OnboardingType.DownloadNativeApps:\n          dispatchAction(onboardingPatch({\n            skipped: true,\n            type: { downloadNativeApps: true },\n          }));\n          logAmplitudeEvent(AmplitudeEvents.TourStepThirteen, { skipped: true });\n          return;\n        case OnboardingType.ClaimCredit:\n          dispatchAction(onboardingPatch({\n            skipped: true,\n            type: { claimedCredit: true },\n          }));\n          logAmplitudeEvent(AmplitudeEvents.TourStepFourteen, { skipped: true });\n          return;\n        default: return;\n      }\n    }\n  }\n\n  renderStep = (h: Hotkey & HotkeyCode) => {\n    const { activatedHotkeys } = this.state;\n    const navigateInboxActivation = h.name === HotkeyAction.NavigateInbox &&\n      browserHistory.location.pathname.startsWith('/mail');\n    return (\n      <div\n        className=\"steps-wrapper\"\n        key={`${h.name}-onboarding-step`}\n      >\n        <div\n          className=\"hotkeys\"\n        >\n          <div\n            className={\n              classnames('hotkey', {\n                activated: navigateInboxActivation || !!(activatedHotkeys[h.name]),\n              })\n            }\n            key={h.name}\n          >\n            <div className=\"name\">{h.name}</div>\n            {!!h.metaKey && <KeyboardSymbol character={KeyCode.LeftWindowKey} />}\n            {!!h.ctrlKey && <KeyboardSymbol character={KeyCode.Ctrl} />}\n            {!!h.shiftKey && <KeyboardSymbol character={KeyCode.Shift} />}\n            {!!h.altKey && <KeyboardSymbol character={KeyCode.Alt} />}\n            {!!h.keyCode && <KeyboardSymbol character={h.keyCode} />}\n            {!!h.altKeyCode && <span>/</span>}\n            {!!h.altKeyCode && <KeyboardSymbol character={h.altKeyCode} />}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  renderSteps = (step: OnboardingType) => {\n    let hotkey: Hotkey & HotkeyCode | undefined;\n\n    switch (step) {\n      case OnboardingType.NextThread:\n        // Identify counter\n        const renderArray = [];\n        const nextThreadAction = hotkeyForOnboarding(OnboardingType.NextThread);\n        if (step && nextThreadAction) {\n          hotkey = hotkeysTypeahead(nextThreadAction)[0] as Hotkey & HotkeyCode;\n          if (hotkey) {\n            renderArray.push(this.renderStep(hotkey));\n          }\n        }\n\n        const previousThreadAction = hotkeyForOnboarding(OnboardingType.PreviousThread);\n        if (step && previousThreadAction) {\n          hotkey = hotkeysTypeahead(previousThreadAction)[0] as Hotkey & HotkeyCode;\n          if (hotkey) {\n            renderArray.push(this.renderStep(hotkey));\n          }\n        }\n\n        return renderArray;\n\n      default:\n\n        // Identify counter\n        const action = hotkeyForOnboarding(step);\n        if (step && action) {\n          hotkey = hotkeysTypeahead(action)[0] as Hotkey & HotkeyCode;\n        }\n\n        if (hotkey) {\n          return this.renderStep(hotkey);\n        }\n    }\n\n    return null;\n  }\n\n  renderDraftCreateStep = () => {\n    const createDraft = HotkeyAction.NewDraft;\n    const createDraftHotkey = getHotkeyByName(createDraft);\n    if (!createDraftHotkey) { return null; }\n    return (\n      this.renderStep(createDraftHotkey as Hotkey & HotkeyCode)\n    );\n  }\n\n  renderPrerequisiteStep = (step: OnboardingType) => {\n    const { isDraft, isThread } = this.props;\n\n    // Draft Step\n    if (onboardingRequiresDraft(step) && !isDraft) {\n      const createDraft = HotkeyAction.NewDraft;\n      const createDraftHotkey = getHotkeyByName(createDraft);\n      if (!createDraftHotkey) { return null; }\n      return (\n        this.renderStep(createDraftHotkey as Hotkey & HotkeyCode)\n      );\n    }\n\n    // Prerequisites for handling thread actions\n    if (onboardingRequiresThread(step) && !isThread) {\n      const navigateInbox = HotkeyAction.NavigateInbox;\n      const navigateInboxHotkey = getHotkeyByName(navigateInbox);\n      if (!navigateInboxHotkey) { return null; }\n\n      const nextThread = HotkeyAction.NextThread;\n      const nextThreadHotkey = getHotkeyByName(nextThread);\n      if (!nextThreadHotkey) { return null; }\n      return (\n        [\n          this.renderStep(navigateInboxHotkey as Hotkey & HotkeyCode),\n          this.renderStep(nextThreadHotkey as Hotkey & HotkeyCode),\n        ]\n      );\n    }\n\n    return null;\n  }\n\n  renderCommandControlStep = (step: OnboardingType) => {\n    let copy = '';\n    const { transitionAnimation } = this.state;\n    switch (step) {\n      case OnboardingType.SaveAsTemplate:\n        copy = 'Save as Template';\n        break;\n      case OnboardingType.ReadLater:\n        copy = 'Tomorrow Morning';\n        break;\n      case OnboardingType.ShareThread:\n        copy = 'Share Conversation';\n        break;\n      case OnboardingType.SendLater:\n        copy = '5 mins';\n        break;\n      case OnboardingType.FollowUpReminder:\n        copy = '2 days';\n        break;\n      case OnboardingType.Scheduling:\n        copy = 'Meeting Times';\n        break;\n      default:\n        break;\n    }\n\n    if (!copy) {\n      return null;\n    }\n\n    return (\n      <div\n        className={classnames('steps-wrapper', 'secondary')}\n        key={`${step}-onboarding-step-command`}\n      >\n        <div\n          className={classnames('hotkeys')}\n        >\n          <div\n            className={classnames('hotkey', { activated: transitionAnimation })}\n            key={`${step}-next-step`}\n          >\n            <span className=\"name\">Type: <span className=\"bold\">\"{copy}\"</span></span>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  renderTitle = (h: OnboardingType | undefined) => {\n    const { onboarding } = this.props;\n    let c = 'You Are Unstoppable! 👏';\n    if (h) {\n      switch (h) {\n        case OnboardingType.Archive:\n          c = 'Marking things as done';\n          break;\n        case OnboardingType.ReadLater:\n          c = 'Snoozing Emails';\n          break;\n        case OnboardingType.NextThread:\n          c = 'Becoming a Polymail Master! 💌';\n          break;\n        case OnboardingType.Undo:\n          c = 'Undoing Actions';\n          break;\n        case OnboardingType.Block:\n          c = 'Blocking Senders';\n          break;\n        case OnboardingType.CommandLater:\n          c = 'The Command Center';\n          break;\n\n        // Draft handlers\n\n        case OnboardingType.SendMessage:\n          c = 'Send Your First Message';\n          break;\n\n        case OnboardingType.SendLater:\n          c = 'Scheduling Emails';\n          break;\n        case OnboardingType.FollowUpReminder:\n          c = 'Never miss a Follow up!';\n          break;\n        case OnboardingType.MessageTemplates:\n          c = 'Message Templates';\n          break;\n        case OnboardingType.SaveAsTemplate:\n          c = 'Save as Template';\n          break;\n        case OnboardingType.Complete:\n          c = 'Getting Started!';\n          break;\n\n        case OnboardingType.ShareThread:\n          c = 'Sharing Conversations';\n          break;\n\n        case OnboardingType.Comment:\n          c = 'Adding Comments';\n          break;\n\n        case OnboardingType.ActivityFeed:\n          c = 'Activity Feed';\n          break;\n\n        case OnboardingType.Scheduling:\n          c = 'Sharing Meeting Times';\n          break;\n\n        case OnboardingType.DownloadNativeApps:\n          c = 'Download Desktop App';\n          break;\n\n        case OnboardingType.ClaimCredit:\n          c = 'Claim Your $10 Credit!';\n          if (onboarding.claimedCredit) {\n            c = 'You\\'ve claimed your $10 credit for Polymail!';\n          }\n          break;\n\n        default:\n          c = 'Section Complete!';\n          break;\n      }\n    }\n    return (\n      <div className=\"copy\">\n        <h5 key={c}>{c}</h5>\n      </div>\n    );\n  }\n\n  renderInfoSection = (h: OnboardingType | undefined) => {\n    const { isDraft, isThread } = this.props;\n    // tslint:disable-next-line:max-line-length\n    let c: string | JSX.Element = <span />;\n    if (h) {\n      switch (h) {\n        case OnboardingType.Archive:\n          // tslint:disable-next-line:max-line-length\n          // tslint:disable-next-line:max-line-length\n          c = <span> <br />When you're done with an email, always make sure to archive it.<br /><br />This keeps your inbox clean and full of only important tasks for your day!<br/><br/>Choose any email -- we'll teach you how to undo any action next!</span>;\n          if (!isThread) {\n            // tslint:disable-next-line:max-line-length\n            c = <span> <br />Let's start by going to your inbox and selecting a thread!<br/><br/>Feel free to use the suggested <b>hotkeys</b> or the <b>Command Center</b></span>;\n          }\n          break;\n        case OnboardingType.ReadLater:\n          // tslint:disable-next-line:max-line-length\n          c = <span> <br />You can read later an email when you don't need to handle it today. <br /><br />Try setting an email to read <b>tomorrow morning</b></span>;\n          break;\n        case OnboardingType.NextThread:\n          // tslint:disable-next-line:max-line-length\n          c = <span> <br />Let's teach you how to get around Polymail quickly! <br /><br />Tap either of the keys below to move between threads!</span>;\n          break;\n        case OnboardingType.Undo:\n          // tslint:disable-next-line:max-line-length\n          c = <span> <br />Wait! 🙈 <br /><br />If you took an action you didn't want, you can always bring the message back by tapping undo! <br/><br/> Try undoing the last action you just took</span>;\n          break;\n        case OnboardingType.Block:\n          // tslint:disable-next-line:max-line-length\n          c = <span> <br />Have any emails you want to stop receiving? <br /><br /> We've made it simple to block or unsubscribe from anyone!</span>;\n          break;\n        case OnboardingType.CommandLater:\n          // tslint:disable-next-line:max-line-length\n          c = <span> <br />If you ever forget a hotkey, we make it easy to find any action you'd like to perform!<br /> <br /> Try typing <b>Read Later</b> in the Command Center, then set an email to read <b>3 days</b> from now!</span>;\n          break;\n\n        // Draft Actions\n        case OnboardingType.SendMessage:\n          // tslint:disable-next-line:max-line-length\n          c = <span> <br />Polymail gives you tools to save time and get insights from the messages you send.<br/><br/>Try sending this example message to start.</span>;\n          if (!isDraft) {\n            // tslint:disable-next-line:max-line-length\n            c = <span> <br />Lets send your first message on Polymail!<br /><br /> Start by creating a new message!</span>;\n          }\n          break;\n\n        case OnboardingType.SendLater:\n          // tslint:disable-next-line:max-line-length\n          c = <span> <br />If you want to schedule to send later, you can choose a date and time to send in the future.<br /><br />Try scheduling an email for <b>5 minutes</b> from now</span>;\n          if (!isDraft) {\n            // tslint:disable-next-line:max-line-length\n            c = <span> <br />Learn how to supercharge the emails you send out!<br /><br /> Start by creating another message!</span>;\n          }\n          break;\n        case OnboardingType.FollowUpReminder:\n          // tslint:disable-next-line:max-line-length\n          c = <span> <br />Set a followup reminder on an email to get notified when you haven't received a reply within a set amount of time!<br /><br />Try setting a follow up reminder for <b>2 days</b> from now!</span>;\n          if (!isDraft) {\n            // tslint:disable-next-line:max-line-length\n            c = <span> <br />Learn how to supercharge the emails you send out!<br /><br /> Start by creating another message!</span>;\n          }\n          break;\n        case OnboardingType.SaveAsTemplate:\n          // tslint:disable-next-line:max-line-length\n          c = <span> <br />If you ever want to reuse a draft you can save it as a template!<br /> <br /> Try opening the Command Center and type <b>Save as Template</b> to save a draft as a template!</span>;\n          const templateRoute = this.props.location.pathname.startsWith('/templates');\n          if (!isDraft && !templateRoute) {\n            // tslint:disable-next-line:max-line-length\n            c = <span> <br />Learn how to supercharge the emails you send out!<br /><br />Start by creating another message!</span>;\n          }\n          break;\n        case OnboardingType.MessageTemplates:\n          // tslint:disable-next-line:max-line-length\n          c = <span> <br />You can access any Message Templates you have created in the past to automatically fill in content and files for your new messages!<br/><br/>Try selecting a Message Template to insert into this draft!</span>;\n          if (!isDraft) {\n            // tslint:disable-next-line:max-line-length\n            c = <span> <br />Learn how to supercharge the emails you send out!<br /><br /> Start by creating another message!</span>;\n          }\n          break;\n        case OnboardingType.ShareThread:\n          // tslint:disable-next-line:max-line-length\n          c = <span> <br />You can share a live link to any of your conversations to provide context to your team.<br /><br />Try typing <b>Share Conversation</b> in the Command Center</span>;\n          if (!isThread) {\n            // tslint:disable-next-line:max-line-length\n            c = <span> <br />Let's start by going to your inbox and selecting a thread!<br/><br/>Feel free to use the suggested <b>hotkeys</b> or the <b>Command Center</b></span>;\n          }\n          break;\n\n        case OnboardingType.Comment:\n          // tslint:disable-next-line:max-line-length\n          c = <span> <br />Leave a comment to provide yourself or any teammates with additional information surrounding a conversation. <br /><br />It's useful for context when you visit a conversation in the future! Try to <b>post a comment</b> on one of your messages</span>;\n          if (!isThread) {\n            // tslint:disable-next-line:max-line-length\n            c = <span> <br />Let's start by going to your inbox and selecting a thread!<br/><br/>Feel free to use the suggested <b>hotkeys</b> or the <b>Command Center</b></span>;\n          }\n          break;\n\n        case OnboardingType.ActivityFeed:\n          // tslint:disable-next-line:max-line-length\n          c = <span> <br />You can also check out our Activity Feed in the Right Sidebar to get a live feed of all the interactions with your sent emails so you can always follow up promptly!<br /><br />Try typing <b>Activity Feed</b> in the <b>Command Center</b></span>;\n          break;\n\n        case OnboardingType.Scheduling:\n          // tslint:disable-next-line:max-line-length\n          c = <span><br />If you're setting up a meeting, share your calendar availabilities, so your recipient can book a mutual time that works for them! <br/> <br /> Try typing <b>Meeting Times</b> in the Command Center</span>;\n          break;\n\n        case OnboardingType.ClaimCredit:\n          // tslint:disable-next-line:max-line-length\n          c = <span><br />Congratulations, you're all set up to hit the ground running in Polymail!</span>;\n          break;\n\n        case OnboardingType.Complete:\n          c = <span><br />Great job! Moving onto the next section!</span>;\n          break;\n\n        case OnboardingType.DownloadNativeApps:\n          // tslint:disable-next-line:max-line-length\n          c = <span><br />Download the desktop client on Polymail for the best experience!<br/><br />Use Polymail with improved search, offline capabilities, and better performance!</span>;\n          break;\n\n        default:\n          c = <span> <br />Great job! Now you're ready to manage your inbox at full speed!</span>;\n          break;\n      }\n    }\n    return (\n      <div\n        key={`info-${h}`}\n        className=\"info-section\"\n      >\n        <div className=\"copy\">\n          {c}\n        </div>\n      </div>\n    );\n  }\n\n  renderSecondInfoSection = (h: OnboardingType | undefined) => {\n    let c: JSX.Element | string = '';\n    if (h) {\n      switch (h) {\n        case OnboardingType.ReadLater:\n          // tslint:disable-next-line:max-line-length\n          c = <span><br />At the date and time you choose, we'll pop that email to the top of your inbox! <br/><br/>You can also find these emails in your <b>Read Later</b> folder.</span>;\n          break;\n        case OnboardingType.Archive:\n          // tslint:disable-next-line:max-line-length\n          c = <span> <br />Don't worry! You can find any email you archive by searching or going to your <b>Archive</b> folder.</span>;\n          break;\n        case OnboardingType.NextThread:\n          // c = <span><br />Give it a try! 👆</span>;\n          break;\n        case OnboardingType.PreviousThread:\n          // c = <span><br />Let's keep it going! 🏃</span>;\n          break;\n        case OnboardingType.Undo:\n          // c = <span><br />Try undoing the last action that you just took! 🔙</span>;\n          break;\n        case OnboardingType.Block:\n          // tslint:disable-next-line:max-line-length\n          c = <span><br />Try blocking any email and see what happens! Don't worry, we'll give you a chance to confirm if you really want to block someone! 🙅</span>;\n          break;\n        case OnboardingType.CommandLater:\n          // tslint:disable-next-line:max-line-length\n          c = <span><br />You can use the command center to find a hotkey, or you can type any action and perform it directly from there!</span>;\n          break;\n        case OnboardingType.SendLater:\n          // tslint:disable-next-line:max-line-length\n          c = <span><br /> Once you choose a time, we'll handle everything on our end to make sure your message gets sent at that point in time!<br /><br />You can find these drafts in your <b>Send Later</b> folder.</span>;\n          break;\n        case OnboardingType.FollowUpReminder:\n          // tslint:disable-next-line:max-line-length\n          c = <span> <br />If you haven't received a reply by the time period you chose, we'll bring this email back into your inbox so you can take action on it!<br/> <br/>You can find these messages in your <b>Follow Up</b> folder</span>;\n          break;\n\n        case OnboardingType.MessageTemplates:\n          // tslint:disable-next-line:max-line-length\n          c = <span> <br />You can save a ton of time by using pre-written responses to messages!</span>;\n          break;\n        case OnboardingType.ShareThread:\n          // tslint:disable-next-line:max-line-length\n          c = <span> <br />You can update permissions to anyone by clicking <b>Manage</b>.<br /><br />All the conversations you've shared can be found in the Left sidebar via <b>Shared By Me</b></span>;\n          break;\n\n        case OnboardingType.ClaimCredit:\n          // tslint:disable-next-line:max-line-length\n          c = <span><br />Claim your free $10 credit for Polymail below</span>;\n          break;\n\n        // case OnboardingType.Comment:\n        //   // tslint:disable-next-line:max-line-length\n        //   c = <span> <br />Try posting a comment below!</span>;\n          break;\n        case OnboardingType.Complete:\n          c = '';\n          break;\n        default:\n          c = '';\n          break;\n      }\n    }\n    return (\n      <div\n        key={`s-info-${h}`}\n        className={classnames('info-section', 'secondary')}\n      >\n        <div className=\"copy\">\n          {c}\n        </div>\n      </div>\n    );\n  }\n\n  handleClick = (e: React.MouseEvent<HTMLElement>) => {\n    const threadList = document.getElementsByClassName('infinite-thread-list');\n    const element = threadList[0];\n    if (element && element instanceof HTMLElement) {\n      element.focus();\n    }\n    e.stopPropagation();\n    e.preventDefault();\n  }\n\n  renderNextStepCta = (counter: number) => {\n    const { transitionAnimation, continueActivated } = this.state;\n    if (!transitionAnimation) {\n      return null;\n    }\n\n    return (\n      <Spring\n        config={config.slow}\n        delay={1000}\n        from={{ opacity: 0, t: 0 }}\n        to={{\n          opacity: !!transitionAnimation ? 1 : 0,\n          t: !!transitionAnimation ? 1 : 0,\n        }}\n      >\n        {checkAnimation => transitionAnimation && (\n          <animated.div\n            className={classnames('next-section-cta', { activated: continueActivated })}\n            style={{\n              opacity: checkAnimation.opacity,\n              transform: checkAnimation.t.to({\n                range: [0, 0.25, .5, 0.75, 1],\n                output: [0.8, 1.05, 1.1, 1.05, 1.0],\n              }).to(x => `scale(${x})`),\n            }}\n          >\n            <div className=\"copy\">\n              {`${randomizedReinforcement(counter)} To continue, tap:`}\n            </div>\n            <KeyboardSymbol character={KeyCode.Enter} />\n          </animated.div>\n        )}\n      </Spring>\n    );\n  }\n\n  renderSucessCheckmark = () => {\n    const { transitionAnimation } = this.state;\n    return (\n      <Spring\n        config={config.gentle}\n        from={{ opacity: 0, t: 0 }}\n        to={{\n          opacity: !!transitionAnimation ? 1 : 0,\n          t: !!transitionAnimation ? 1 : 0,\n        }}\n      >\n        {checkAnimation => transitionAnimation && (\n          <animated.div\n            style={{\n              opacity: checkAnimation.opacity,\n              transform: checkAnimation.t.interpolate({\n                range: [0, 0.25, .5, 0.75, 1],\n                output: [0.5, 1.1, 1.15, 1.1, 1.0],\n              }).interpolate(x => `scale(${x})`),\n            }}\n            className=\"transition\"\n          >\n            <RoundCheckmark className=\"check\" height=\"20px\" width=\"20px\" />\n          </animated.div>\n        ) || null}\n      </Spring>\n    );\n  }\n\n  handleManualNext = () => {\n    const { onManualNext } = this.props;\n    if (onManualNext) {\n      onManualNext();\n    }\n  }\n\n  handleTipClear = () => {\n    this.setState(\n      { showOnboardingTip: false },\n      () => {\n        const threadList = document.getElementsByClassName('infinite-thread-list');\n        const element = threadList[0];\n        if (element && element instanceof HTMLElement) {\n          element.focus();\n        }\n      });\n  }\n\n  renderVideoSection = (step: OnboardingType) => {\n    const { transitionAnimation } = this.state;\n    if (transitionAnimation) {\n      return null;\n    }\n\n    switch (step) {\n      case OnboardingType.SendMessage:\n        return (\n          <DemoVideoPreview\n            demoVideo={{\n              name: OnboardingType.SendMessage,\n              thumbnailUrl: 'https://image.mux.com/GZCODZ01AaA6xlsgYZ7Oi2YkrPb6BUw01iRn300LGjQXBY/thumbnail.png?width=400&height=240&fit_mode=smartcrop&time=02',\n              // tslint:disable-next-line:max-line-length\n              url: 'https://stream.mux.com/GZCODZ01AaA6xlsgYZ7Oi2YkrPb6BUw01iRn300LGjQXBY/medium.mp4',\n              captionUrl: 'https://stream.mux.com/GZCODZ01AaA6xlsgYZ7Oi2YkrPb6BUw01iRn300LGjQXBY/text/rfn9cC00nexhCueC4006VM6Zh01Bkc7qrKfk02Om2Ew57qn7o2mv6vqc5w.vtt',\n            }}\n            width={200}\n            labelDisclosure\n          />\n        );\n      case OnboardingType.SendLater:\n        return (\n          <DemoVideoPreview\n            demoVideo={{\n              name: OnboardingType.SendLater,\n              thumbnailUrl: 'https://image.mux.com/HAUS2PxEgU2sOdr2ebmtpUS1Okec35LA5HDeZJ3TgXo/thumbnail.png?width=400&height=240&fit_mode=smartcrop&time=02',\n              // tslint:disable-next-line:max-line-length\n              url: 'https://stream.mux.com/HAUS2PxEgU2sOdr2ebmtpUS1Okec35LA5HDeZJ3TgXo/medium.mp4',\n              captionUrl: 'https://stream.mux.com/HAUS2PxEgU2sOdr2ebmtpUS1Okec35LA5HDeZJ3TgXo/text/8ZKVfWpBliLkINpGG01IuUflQFqdlzDvwDNmKPcyk7612Q6Zxu3z01Kw.vtt',\n            }}\n            width={200}\n            labelDisclosure\n          />\n        );\n      case OnboardingType.ReadLater:\n        return (\n          <DemoVideoPreview\n            demoVideo={{\n              name: OnboardingType.ReadLater,\n              thumbnailUrl: 'https://image.mux.com/E7OFu4Vl46Nu00QHXBvGV00Pg801qEF4lD01whcrw1X00KJs/thumbnail.png?width=400&height=240&fit_mode=smartcrop&time=02',\n              // tslint:disable-next-line:max-line-length\n              url: 'https://stream.mux.com/E7OFu4Vl46Nu00QHXBvGV00Pg801qEF4lD01whcrw1X00KJs/medium.mp4',\n              captionUrl: 'https://stream.mux.com/E7OFu4Vl46Nu00QHXBvGV00Pg801qEF4lD01whcrw1X00KJs/text/X302Jcix6qYwlPAmx2Hclft4aIQh2Ob4y7yPWwxdDXnczpe7TgvTf02Q.vtt',\n            }}\n            width={200}\n            labelDisclosure\n          />\n        );\n      case OnboardingType.SaveAsTemplate:\n        return (\n          <DemoVideoPreview\n            demoVideo={{\n              name: OnboardingType.SaveAsTemplate,\n              thumbnailUrl: 'https://image.mux.com/BJd8OerEh3oFN8JpgSBfT1VM4XYdF63mj4bg01aZ6s5Y/thumbnail.png?width=400&height=240&fit_mode=smartcrop&time=02',\n              // tslint:disable-next-line:max-line-length\n              url: 'https://stream.mux.com/BJd8OerEh3oFN8JpgSBfT1VM4XYdF63mj4bg01aZ6s5Y/medium.mp4',\n              captionUrl: 'https://stream.mux.com/BJd8OerEh3oFN8JpgSBfT1VM4XYdF63mj4bg01aZ6s5Y/text/OXc6A25Q02VSY00WemQju1V01LC01dzIfxgmhLSYd7CcbjAPfzEpfanOrg.vtt',\n            }}\n            width={200}\n            labelDisclosure\n          />\n        );\n      case OnboardingType.MessageTemplates:\n        return (\n          <DemoVideoPreview\n            demoVideo={{\n              name: OnboardingType.MessageTemplates,\n              thumbnailUrl: 'https://image.mux.com/VZuLnu1I00EPUR9llhLab526Mx4SK502qYS2jW1YrUfvg/thumbnail.png?width=400&height=240&fit_mode=smartcrop',\n              // tslint:disable-next-line:max-line-length\n              url: 'https://stream.mux.com/VZuLnu1I00EPUR9llhLab526Mx4SK502qYS2jW1YrUfvg/medium.mp4',\n              captionUrl: 'https://stream.mux.com/VZuLnu1I00EPUR9llhLab526Mx4SK502qYS2jW1YrUfvg/text/G01VabuzAfELsamWpsD8HMJQkxvjOGWUw00Sl536o7SzGxGc00rZFPUUQ.vtt',\n            }}\n            width={200}\n            labelDisclosure\n          />\n        );\n\n      case OnboardingType.Scheduling:\n        return (\n          <DemoVideoPreview\n            demoVideo={{\n              name: OnboardingType.Scheduling,\n              thumbnailUrl: 'https://image.mux.com/vhaIiRTZCuVwgq3zWLtuvY02fKi6gLKVvszyh4l01wpm00/thumbnail.png?width=400&height=240&fit_mode=smartcrop',\n              url: 'https://stream.mux.com/vhaIiRTZCuVwgq3zWLtuvY02fKi6gLKVvszyh4l01wpm00/medium.mp4',\n            }}\n            width={200}\n            labelDisclosure\n          />\n        );\n      default:\n        return null;\n    }\n  }\n\n  render() {\n    const {\n      currentStep, isDraft, activeStep, isThread, allSteps, onboarding,\n    } = this.props;\n    const { transitionAnimation, manualCompletionActivated, showOnboardingTip } = this.state;\n\n    const displayedStep = activeStep || currentStep;\n    let counter = 0;\n    let step: OnboardingType | undefined;\n\n    // Identify counter\n    const stepsLength = allSteps.length;\n\n    // Set counter for what step we're on\n    counter = displayedStep ? indexOf(allSteps, displayedStep) : -1;\n\n    // If standard progression, subtract one from current Onboarding while in a transition step.\n    if (!manualCompletionActivated && transitionAnimation) {\n      counter = counter - 1;\n    }\n\n    // Match hotkey\n    step = allSteps[counter];\n\n    // Identify if prerequisites for step have to be filled\n    let hideCopy = false;\n    if (!transitionAnimation) {\n      if (onboardingRequiresDraft(step) && !isDraft) {\n        hideCopy = true;\n      } else if (onboardingRequiresThread(step) && !isThread) {\n        hideCopy = true;\n      }\n    }\n\n    // Default state\n    if (!step) {\n      step = OnboardingType.Complete;\n    }\n\n    // Message for Onboarding Tip\n    const onboardingMessage = (\n      <span>\n        We'll be sharing steps here to help you learn how to use Polymail most effectively!\n        <br/>\n        <br/>\n        Complete all the steps and you'll receive a $10 credit to any paid plan!\n      </span>\n    );\n\n    return (\n      <div className=\"onboarding-section-detail\">\n        {showOnboardingTip && (\n          <OnboardingTip\n            title=\"Learn How to Use Polymail\"\n            message={onboardingMessage}\n            right=\"274px\"\n            anchorPosition={AnchorPosition.Right}\n            onNext={this.handleTipClear}\n          />\n        )}\n        <div className=\"title\">\n          {this.renderTitle(step)}\n        </div>\n        <div className=\"progress\">\n          <div className=\"top\">\n            {counter > -1 &&\n              <div className=\"copy\">\n                {`${counter} of ${stepsLength || 0} completed`}\n              </div>\n            }\n            {counter === -1 &&\n              <div className=\"copy\">\n                {`Great job! Moving on`}\n              </div>\n            }\n            {this.renderSucessCheckmark()}\n          </div>\n          <div className=\"progress-bar\">\n            <div\n              style={{\n                width: `${ 100.0 * counter / stepsLength}%`,\n              }}\n              className=\"progress-bar-completed\"\n            />\n          </div>\n        </div>\n        {this.renderInfoSection(step)}\n        {!hideCopy &&\n          this.renderSteps(step)\n        }\n        {!hideCopy && this.renderCommandControlStep(step)}\n        {!transitionAnimation && !onboarding.claimedCredit &&\n          activeStep === OnboardingType.ClaimCredit && // Show create draft button\n          <button onClick={this.handleCreditClaim} className=\"create-draft\">\n            Claim Credit\n          </button>\n        }\n        {!transitionAnimation &&\n          activeStep === OnboardingType.DownloadNativeApps && // Show create draft button\n          <button onClick={this.handleDownloadNativeApps} className=\"create-draft\">\n            {IS_MAC ? 'Download Mac App' : 'Download Windows App'}\n          </button>\n        }\n        {hideCopy && // Show create draft button\n          this.renderPrerequisiteStep(step)\n        }\n        {!hideCopy && transitionAnimation && // Do not show when draft is not open and draft section\n          this.renderSecondInfoSection(step)\n        }\n        {this.renderNextStepCta(counter)}\n        {\n          this.renderVideoSection(step)\n        }\n        <div className=\"disclosure-area\">\n          <button onClick={this.props.onLegendClick}>\n            See previous steps\n          </button>\n          {currentStep === activeStep && (\n            <button\n              className={classnames('skip-button', { hide: transitionAnimation })}\n              onClick={this.handleSkip}\n            >\n              Skip Step\n            </button>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default OnboardingSectionDetail;\n"]}]}