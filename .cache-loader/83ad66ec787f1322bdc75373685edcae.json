{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Threads/components/ThreadList/components/InfiniteThreadList/ThreadCell/ThreadCell.tsx","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Threads/components/ThreadList/components/InfiniteThreadList/ThreadCell/ThreadCell.tsx","mtime":1675280254117},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewogICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewogICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAogICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKICAgIH07CiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwogICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQogICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKICAgIH07Cn0pKCk7CmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7CmltcG9ydCBjbGFzc25hbWVzIGZyb20gJ2NsYXNzbmFtZXMnOwppbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7CmltcG9ydCB7IGxhc3QsIGluZGV4T2YgfSBmcm9tICdsb2Rhc2gnOwppbXBvcnQgeyBEcmFnZ2FibGVDb3JlIH0gZnJvbSAncmVhY3QtZHJhZ2dhYmxlJzsKaW1wb3J0IHsgc2hvd01vc3RSZWNlbnQsIFRPT0xUSVBfRk9STUFUIH0gZnJvbSAnQHNyYy9saWIvZGF0ZXRpbWUnOwppbXBvcnQgeyBnZXREaXNwbGF5TmFtZSwgZ2V0Rmlyc3ROYW1lIH0gZnJvbSAnQHNyYy9saWIvYWRkcmVzcyc7CmltcG9ydCB7IGlzRWxlY3Ryb24gfSBmcm9tICdAc3JjL2xpYi9lbGVjdHJvbic7CmltcG9ydCAnLi9UaHJlYWRDZWxsLnNjc3MnOwppbXBvcnQgeyBUaHJlYWRBY3Rpb25Db2xvciwgUmVzb3VyY2VTdGF0dXMsIENvbnRhY3RUeXBlLCBTd2lwZSwgfSBmcm9tICdAc3JjL3R5cGVzJzsKaW1wb3J0IFRyYWNraW5nUG9wb3ZlciBmcm9tICdAc3JjL3JvdXRlcy9UaHJlYWRzL2NvbXBvbmVudHMvVHJhY2tpbmdQb3BvdmVyJzsKaW1wb3J0IEFyY2hpdmUgZnJvbSAnQHNyYy9jb21wb25lbnRzL0ljb25zL0FyY2hpdmUuc3ZnJzsKaW1wb3J0IExpc3QgZnJvbSAnQHNyYy9jb21wb25lbnRzL0ljb25zL0xhYmVsLnN2Zyc7CmltcG9ydCBTbm9vemUgZnJvbSAnQHNyYy9jb21wb25lbnRzL0ljb25zL0Nsb2NrLnN2Zyc7CmltcG9ydCBUcmFzaCBmcm9tICdAc3JjL2NvbXBvbmVudHMvSWNvbnMvVHJhc2guc3ZnJzsKaW1wb3J0IFN0YXIgZnJvbSAnQHNyYy9jb21wb25lbnRzL0ljb25zL1N0YXIuc3ZnJzsKaW1wb3J0IFRyYWNrIGZyb20gJ0BzcmMvY29tcG9uZW50cy9JY29ucy9UcmFjay5zdmcnOwppbXBvcnQgRm9sbG93VXAgZnJvbSAnQHNyYy9jb21wb25lbnRzL0ljb25zL0ZvbGxvd1VwLnN2Zyc7CmltcG9ydCBVbnJlYWQgZnJvbSAnQHNyYy9jb21wb25lbnRzL0ljb25zL1VucmVhZC5zdmcnOwppbXBvcnQgQXR0YWNobWVudCBmcm9tICdAc3JjL2NvbXBvbmVudHMvSWNvbnMvQXR0YWNobWVudC5zdmcnOwppbXBvcnQgSW5ib3ggZnJvbSAnQHNyYy9jb21wb25lbnRzL0ljb25zL0luYm94LnN2Zyc7CmltcG9ydCBDb250YWN0cyBmcm9tICdAc3JjL2NvbXBvbmVudHMvSWNvbnMvQ29udGFjdHMuc3ZnJzsKaW1wb3J0IHsgZ2V0Rm9sbG93VXBSZW1pbmRlckRpc3BsYXlTdHJpbmcgfSBmcm9tICdAc3JjL2xpYi90aHJlYWQnOwppbXBvcnQgeyBjYXB0dXJlTWVzc2FnZSwgd2l0aFNjb3BlIH0gZnJvbSAnQHNlbnRyeS9icm93c2VyJzsKdmFyIEFDVElPTl9QUk9QRVJUSUVTID0gewogICAgYXJjaGl2ZTogewogICAgICAgIGNvbG9yOiBUaHJlYWRBY3Rpb25Db2xvci5BcmNoaXZlLAogICAgICAgIGljb246IEFyY2hpdmUsCiAgICB9LAogICAgbGlzdDogewogICAgICAgIGNvbG9yOiBUaHJlYWRBY3Rpb25Db2xvci5MaXN0LAogICAgICAgIGljb246IExpc3QsCiAgICB9LAogICAgbGF0ZXI6IHsKICAgICAgICBjb2xvcjogVGhyZWFkQWN0aW9uQ29sb3IuU25vb3plLAogICAgICAgIGljb246IFNub296ZSwKICAgIH0sCiAgICB0cmFzaDogewogICAgICAgIGNvbG9yOiBUaHJlYWRBY3Rpb25Db2xvci5UcmFzaCwKICAgICAgICBpY29uOiBUcmFzaCwKICAgIH0sCiAgICBzcGFtOiB7CiAgICAgICAgY29sb3I6IFRocmVhZEFjdGlvbkNvbG9yLlRyYXNoLAogICAgICAgIGljb246IFRyYXNoLAogICAgfSwKICAgIGluYm94OiB7CiAgICAgICAgY29sb3I6IFRocmVhZEFjdGlvbkNvbG9yLkluYm94LAogICAgICAgIGljb246IEluYm94LAogICAgfSwKICAgIHVucmVhZDogewogICAgICAgIGNvbG9yOiBUaHJlYWRBY3Rpb25Db2xvci5VbnJlYWQsCiAgICAgICAgaWNvbjogVW5yZWFkLAogICAgfSwKICAgIHN0YXI6IHsKICAgICAgICBjb2xvcjogVGhyZWFkQWN0aW9uQ29sb3IuU3RhciwKICAgICAgICBpY29uOiBTdGFyLAogICAgfSwKICAgIG5vbmU6IHsKICAgICAgICBjb2xvcjogVGhyZWFkQWN0aW9uQ29sb3IuTm9uZSwKICAgICAgICBpY29uOiB1bmRlZmluZWQsCiAgICB9LAp9Owp2YXIgSUNPTl9TSVpFID0gMjA7CnZhciBJQ09OX01BUkdJTiA9IDE4Owp2YXIgU1RBUlRfTEVGVCA9IC0xICogKElDT05fU0laRSArIDQwKTsKLy8gSFRNTCBJRCB1c2VkIGZvciBUaHJlYWRDZWxsCmV4cG9ydCB2YXIgdGhyZWFkQ2VsbElkZW50aWZpZXIgPSBmdW5jdGlvbiAocmVzb3VyY2VJZCkgewogICAgcmV0dXJuICJwbS10aHJlYWQtIiArIHJlc291cmNlSWQ7Cn07CnZhciBTd2lwZVBoYXNlOwooZnVuY3Rpb24gKFN3aXBlUGhhc2UpIHsKICAgIFN3aXBlUGhhc2VbIlN3aXBpbmciXSA9ICJTd2lwaW5nIjsKICAgIFN3aXBlUGhhc2VbIkNvbXBsZXRlZCJdID0gIkNvbXBsZXRlZCI7CiAgICBTd2lwZVBoYXNlWyJOb25lIl0gPSAiTm9uZSI7Cn0pKFN3aXBlUGhhc2UgfHwgKFN3aXBlUGhhc2UgPSB7fSkpOwp2YXIgVGhyZWFkQ2VsbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhUaHJlYWRDZWxsLCBfc3VwZXIpOwogICAgZnVuY3Rpb24gVGhyZWFkQ2VsbCgpIHsKICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzOwogICAgICAgIF90aGlzLnN3aXBlUGhhc2UgPSBTd2lwZVBoYXNlLk5vbmU7CiAgICAgICAgX3RoaXMuZ2V0QWN0aW9uRnJvbVBvc2l0aW9uID0gZnVuY3Rpb24gKHgpIHsKICAgICAgICAgICAgdmFyIGFjdGlvbjsKICAgICAgICAgICAgdmFyIGFjdGlvbnMgPSBfdGhpcy5wcm9wcy5hY3Rpb25zOwogICAgICAgICAgICB2YXIgbG93ZXJUaHJlc2hvbGQgPSA3MDsKICAgICAgICAgICAgdmFyIHVwcGVyVGhyZXNob2xkID0gMTYwOwogICAgICAgICAgICBpZiAoeCA8IFNUQVJUX0xFRlQgJiYgeCA8IHVwcGVyVGhyZXNob2xkICogLTEgKyBTVEFSVF9MRUZUKSB7CiAgICAgICAgICAgICAgICBhY3Rpb24gPSBhY3Rpb25zWzJdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgaWYgKHggPCBTVEFSVF9MRUZUICYmIHggPCBsb3dlclRocmVzaG9sZCAqIC0xICsgU1RBUlRfTEVGVCkgewogICAgICAgICAgICAgICAgYWN0aW9uID0gYWN0aW9uc1szXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIGlmICh4ID4gU1RBUlRfTEVGVCAmJiB4ID4gdXBwZXJUaHJlc2hvbGQgKyBTVEFSVF9MRUZUKSB7CiAgICAgICAgICAgICAgICBhY3Rpb24gPSBhY3Rpb25zWzFdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgaWYgKHggPiBTVEFSVF9MRUZUICYmIHggPiBsb3dlclRocmVzaG9sZCArIFNUQVJUX0xFRlQpIHsKICAgICAgICAgICAgICAgIGFjdGlvbiA9IGFjdGlvbnNbMF07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGFjdGlvbjsKICAgICAgICB9OwogICAgICAgIF90aGlzLmdldE1vdGlvblN0b3BQb3NpdGlvbiA9IGZ1bmN0aW9uICh4KSB7CiAgICAgICAgICAgIHZhciBjZWxsV2lkdGggPSBfdGhpcy5wcm9wcy5jZWxsV2lkdGg7CiAgICAgICAgICAgIHZhciBsYXN0UG9zaXRpb24gPSBTVEFSVF9MRUZUOwogICAgICAgICAgICB2YXIgdGhyZXNob2xkID0gNzA7CiAgICAgICAgICAgIGlmICh4IDwgU1RBUlRfTEVGVCAmJiB4IDwgdGhyZXNob2xkICogLTEgKyBTVEFSVF9MRUZUKSB7CiAgICAgICAgICAgICAgICBsYXN0UG9zaXRpb24gPSAoY2VsbFdpZHRoICsgKElDT05fU0laRSAqIDIpICsgSUNPTl9NQVJHSU4pICogLTE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZiAoeCA+IFNUQVJUX0xFRlQgJiYgeCA+IHRocmVzaG9sZCArIFNUQVJUX0xFRlQpIHsKICAgICAgICAgICAgICAgIGxhc3RQb3NpdGlvbiA9IGNlbGxXaWR0aDsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gbGFzdFBvc2l0aW9uOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlRHJhZ1N0YXJ0ID0gZnVuY3Rpb24gKGUsIGRhdGEpIHsKICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBpbml0aWFsWDogZGF0YS54LCBkaXNhYmxlQW5pbWF0aW9uOiB0cnVlIH0pOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlRHJhZyA9IGZ1bmN0aW9uIChlLCBkYXRhKSB7CiAgICAgICAgICAgIHZhciBkcmFnWCA9IGRhdGEueCArIFNUQVJUX0xFRlQgLSBfdGhpcy5zdGF0ZS5pbml0aWFsWDsKICAgICAgICAgICAgLy8gSGFuZGxlIHNjcm9sbCBwcmV2ZW50aW9ucwogICAgICAgICAgICBpZiAoIV90aGlzLnNob3VsZFN3aXBlTGVmdCgpICYmIGRyYWdYIDwgU1RBUlRfTEVGVCkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghX3RoaXMuc2hvdWxkU3dpcGVSaWdodCgpICYmIGRyYWdYID4gU1RBUlRfTEVGVCkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgIHg6IGRyYWdYLAogICAgICAgICAgICAgICAgYWN0aW9uOiBfdGhpcy5nZXRBY3Rpb25Gcm9tUG9zaXRpb24oZHJhZ1gpLAogICAgICAgICAgICB9KTsKICAgICAgICB9OwogICAgICAgIF90aGlzLmhhbmRsZURyYWdTdG9wID0gZnVuY3Rpb24gKGUsIGRhdGEpIHsKICAgICAgICAgICAgdmFyIGRyYWdYID0gZGF0YS54ICsgU1RBUlRfTEVGVCAtIF90aGlzLnN0YXRlLmluaXRpYWxYOwogICAgICAgICAgICB2YXIgYWN0aW9uID0gX3RoaXMuc3RhdGUuYWN0aW9uOwogICAgICAgICAgICB2YXIgY29tcGxldGVkOwogICAgICAgICAgICBzd2l0Y2ggKGFjdGlvbikgewogICAgICAgICAgICAgICAgY2FzZSBTd2lwZS5BcmNoaXZlOgogICAgICAgICAgICAgICAgY2FzZSBTd2lwZS5JbmJveDoKICAgICAgICAgICAgICAgIGNhc2UgU3dpcGUuVHJhc2g6CiAgICAgICAgICAgICAgICAgICAgY29tcGxldGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gSGFuZGxlIHJlc2V0IGlmIHNldHRpbmcgdG8gTm9uZSB2YWx1ZQogICAgICAgICAgICB2YXIgc3RvcFBvc2l0aW9uID0gX3RoaXMuZ2V0TW90aW9uU3RvcFBvc2l0aW9uKGRyYWdYKTsKICAgICAgICAgICAgaWYgKCFhY3Rpb24gfHwgYWN0aW9uID09PSBTd2lwZS5Ob25lKSB7CiAgICAgICAgICAgICAgICBzdG9wUG9zaXRpb24gPSBTVEFSVF9MRUZUOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChhY3Rpb24pIHsKICAgICAgICAgICAgICAgIF90aGlzLnN3aXBlUGhhc2UgPSBTd2lwZVBoYXNlLkNvbXBsZXRlZDsKICAgICAgICAgICAgfQogICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICB4OiBzdG9wUG9zaXRpb24sCiAgICAgICAgICAgICAgICBkaXNhYmxlQW5pbWF0aW9uOiBmYWxzZSwKICAgICAgICAgICAgICAgIGNvbXBsZXRlZDogY29tcGxldGVkLAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgLy8gSGFuZGxlIEFjdGlvbgogICAgICAgICAgICBpZiAoYWN0aW9uKSB7CiAgICAgICAgICAgICAgICBfdGhpcy5wcm9wcy5vblRocmVhZE1vdmUoX3RoaXMucHJvcHMudGhyZWFkLCBhY3Rpb24pOwogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5oYW5kbGVTY3JvbGxUb3VjaEJlZ2luID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICBfdGhpcy50cmFja2luZyA9IHRydWU7CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5oYW5kbGVTY3JvbGxTdG9wID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgYWN0aW9uID0gX3RoaXMuc3RhdGUuYWN0aW9uOwogICAgICAgICAgICBfdGhpcy50cmFja2luZyA9IGZhbHNlOwogICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICB4OiBfdGhpcy5nZXRNb3Rpb25TdG9wUG9zaXRpb24oX3RoaXMuc3RhdGUueCksCiAgICAgICAgICAgICAgICBkaXNhYmxlQW5pbWF0aW9uOiBmYWxzZSwKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGlmIChfdGhpcy5zd2lwZVBoYXNlICE9PSBTd2lwZVBoYXNlLlN3aXBpbmcpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICB2YXIgZHJhZ1ggPSBfdGhpcy5zdGF0ZS54ICsgU1RBUlRfTEVGVCAtIF90aGlzLnN0YXRlLmluaXRpYWxYOwogICAgICAgICAgICB2YXIgY29tcGxldGVkOwogICAgICAgICAgICBpZiAoYWN0aW9uKSB7CiAgICAgICAgICAgICAgICBfdGhpcy5zd2lwZVBoYXNlID0gU3dpcGVQaGFzZS5Db21wbGV0ZWQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgc3dpdGNoIChhY3Rpb24pIHsKICAgICAgICAgICAgICAgIGNhc2UgU3dpcGUuQXJjaGl2ZToKICAgICAgICAgICAgICAgIGNhc2UgU3dpcGUuSW5ib3g6CiAgICAgICAgICAgICAgICBjYXNlIFN3aXBlLlRyYXNoOgogICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIEhhbmRsZSByZXNldCBpZiBzZXR0aW5nIHRvIE5vbmUgdmFsdWUKICAgICAgICAgICAgdmFyIHN0b3BQb3NpdGlvbiA9IF90aGlzLmdldE1vdGlvblN0b3BQb3NpdGlvbihkcmFnWCk7CiAgICAgICAgICAgIGlmICghYWN0aW9uIHx8IGFjdGlvbiA9PT0gU3dpcGUuTm9uZSkgewogICAgICAgICAgICAgICAgc3RvcFBvc2l0aW9uID0gU1RBUlRfTEVGVDsKICAgICAgICAgICAgfQogICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICB4OiBzdG9wUG9zaXRpb24sCiAgICAgICAgICAgICAgICBkaXNhYmxlQW5pbWF0aW9uOiBmYWxzZSwKICAgICAgICAgICAgICAgIGNvbXBsZXRlZDogY29tcGxldGVkLAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgLy8gSGFuZGxlIEFjdGlvbgogICAgICAgICAgICBpZiAoYWN0aW9uKSB7CiAgICAgICAgICAgICAgICBfdGhpcy5wcm9wcy5vblRocmVhZE1vdmUoX3RoaXMucHJvcHMudGhyZWFkLCBhY3Rpb24pOwogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5oYW5kbGVTY3JvbGwgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICB2YXIgZGVsdGEgPSAoZS5kZWx0YVggLyAzKTsKICAgICAgICAgICAgdmFyIGRlbHRhV2l0aFNldHRpbmdzID0gd2luZG93LlBNRWxlY3Ryb25CcmlkZ2UgJiYgd2luZG93LlBNRWxlY3Ryb25CcmlkZ2Uuc3dpcGVJbnZlcnRlZAogICAgICAgICAgICAgICAgPyAtZGVsdGEKICAgICAgICAgICAgICAgIDogZGVsdGE7CiAgICAgICAgICAgIHZhciB4ID0gX3RoaXMuc3RhdGUueCArIGRlbHRhV2l0aFNldHRpbmdzOwogICAgICAgICAgICAvLyBJZ25vcmUgeS1heGlzIHNjcm9sbHMKICAgICAgICAgICAgaWYgKE1hdGguYWJzKGUuZGVsdGFZKSA+IE1hdGguYWJzKGUuZGVsdGFYKSkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIEhhbmRsZSBzY3JvbGwgcHJldmVudGlvbnMKICAgICAgICAgICAgaWYgKCFfdGhpcy5zaG91bGRTd2lwZUxlZnQoKSAmJiB4IDwgU1RBUlRfTEVGVCkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghX3RoaXMuc2hvdWxkU3dpcGVSaWdodCgpICYmIHggPiBTVEFSVF9MRUZUKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKF90aGlzLnN3aXBlUGhhc2UgPT09IFN3aXBlUGhhc2UuTm9uZSkgewogICAgICAgICAgICAgICAgX3RoaXMuc3dpcGVQaGFzZSA9IFN3aXBlUGhhc2UuU3dpcGluZzsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoX3RoaXMuc3dpcGVQaGFzZSA9PT0gU3dpcGVQaGFzZS5Db21wbGV0ZWQgfHwgIV90aGlzLnRyYWNraW5nKSB7CiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgIHg6IHgsCiAgICAgICAgICAgICAgICBkaXNhYmxlQW5pbWF0aW9uOiB0cnVlLAogICAgICAgICAgICAgICAgYWN0aW9uOiBfdGhpcy5nZXRBY3Rpb25Gcm9tUG9zaXRpb24oeCksCiAgICAgICAgICAgIH0pOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlVHJhY2tFbnRlciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIF9hID0gX3RoaXMucHJvcHMsIHRocmVhZCA9IF9hLnRocmVhZCwgdHJhY2sgPSBfYS50cmFjaywgZmV0Y2hUcmFjayA9IF9hLmZldGNoVHJhY2s7CiAgICAgICAgICAgIHZhciB0cmFja051bWJlck1pc21hdGNoID0gdHJhY2sgJiYgdHJhY2suZGF0YSAmJgogICAgICAgICAgICAgICAgT2JqZWN0LmtleXModHJhY2suZGF0YS5hY3Rpb25zKS5sZW5ndGggIT09IHRocmVhZC50cmFja3M7CiAgICAgICAgICAgIHZhciBub1RyYWNrUmV0cmlldmVkID0gISF0aHJlYWQudHJhY2tzICYmICF0cmFjazsKICAgICAgICAgICAgaWYgKHRyYWNrTnVtYmVyTWlzbWF0Y2ggfHwgbm9UcmFja1JldHJpZXZlZCkgewogICAgICAgICAgICAgICAgdmFyIGxhc3RTZW50ID0gbGFzdCh0aHJlYWQubWVzc2FnZXMuZmlsdGVyKGZ1bmN0aW9uIChtZXNzYWdlKSB7IHJldHVybiBtZXNzYWdlLnNlbnQ7IH0pKTsKICAgICAgICAgICAgICAgIGZldGNoVHJhY2sodGhyZWFkLmlkLCBsYXN0U2VudC5pZCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHRocmVhZC50cmFja2VkKSB7CiAgICAgICAgICAgICAgICBfdGhpcy5wb3BvdmVyLnNob3coKTsKICAgICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlVHJhY2tMZWF2ZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIHRocmVhZCA9IF90aGlzLnByb3BzLnRocmVhZDsKICAgICAgICAgICAgaWYgKHRocmVhZC50cmFja2VkKSB7CiAgICAgICAgICAgICAgICBfdGhpcy5wb3BvdmVyLmhpZGUoKTsKICAgICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlUmVmID0gZnVuY3Rpb24gKHJlZikgewogICAgICAgICAgICBfdGhpcy5wb3BvdmVyID0gcmVmOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlQ2xpY2sgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICByZXR1cm4gX3RoaXMucHJvcHMub25DbGljayhlLCBfdGhpcy5wcm9wcy50aHJlYWQpOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuc2hvdWxkU3dpcGVMZWZ0ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgYWN0aW9ucyA9IF90aGlzLnByb3BzLmFjdGlvbnM7CiAgICAgICAgICAgIHJldHVybiAhKGFjdGlvbnNbMl0gPT09IFN3aXBlLk5vbmUgJiYgYWN0aW9uc1szXSA9PT0gU3dpcGUuTm9uZSk7CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5zaG91bGRTd2lwZVJpZ2h0ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgYWN0aW9ucyA9IF90aGlzLnByb3BzLmFjdGlvbnM7CiAgICAgICAgICAgIHJldHVybiAhKGFjdGlvbnNbMF0gPT09IFN3aXBlLk5vbmUgJiYgYWN0aW9uc1sxXSA9PT0gU3dpcGUuTm9uZSk7CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5zdGF0ZSA9IHsKICAgICAgICAgICAgaW5pdGlhbFg6IDAsCiAgICAgICAgICAgIHg6IFNUQVJUX0xFRlQsCiAgICAgICAgICAgIGRpc2FibGVBbmltYXRpb246IGZhbHNlLAogICAgICAgIH07CiAgICAgICAgcmV0dXJuIF90aGlzOwogICAgfQogICAgVGhyZWFkQ2VsbC5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgICB2YXIgX2EgPSB0aGlzLnByb3BzLCBzZW5kZXIgPSBfYS5zZW5kZXIsIGdldENvbnRhY3QgPSBfYS5nZXRDb250YWN0LCB0aHJlYWQgPSBfYS50aHJlYWQsIGNlbGxXaWR0aCA9IF9hLmNlbGxXaWR0aDsKICAgICAgICBpZiAoc2VuZGVyICYmIHNlbmRlci50eXBlID09PSBDb250YWN0VHlwZS5EZWZhdWx0ICYmICF0aGlzLnByb3BzLmNvbXBhY3QpIHsKICAgICAgICAgICAgZ2V0Q29udGFjdChsYXN0KHRocmVhZC5tZXNzYWdlcykuZnJvbSk7CiAgICAgICAgfQogICAgICAgIGlmICh0aGlzLnByb3BzLmFjdGlvblRvUGVyZm9ybSkgewogICAgICAgICAgICAvLyBIYW5kbGUgZGlzbWlzc2FsIGltbWVkaWF0ZWx5IGlmIGZsYWdzIGhhdmUgY2hhbmdlZAogICAgICAgICAgICBpZiAoIXRoaXMucHJvcHMuYWN0aW9uVG9QZXJmb3JtLnBheWxvYWQuYm94KSB7CiAgICAgICAgICAgICAgICB0aGlzLnByb3BzLm9uQW5pbWF0aW9uQ29tcGxldGUodGhpcy5wcm9wcy50aHJlYWQuaWQpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHZhciBtYXRjaCA9IGluZGV4T2YodGhpcy5wcm9wcy5hY3Rpb25zLCB0aGlzLnByb3BzLmFjdGlvblRvUGVyZm9ybS5wYXlsb2FkLmJveCk7CiAgICAgICAgICAgIHZhciB4ID0gdGhpcy5zdGF0ZS5pbml0aWFsWDsKICAgICAgICAgICAgc3dpdGNoIChtYXRjaCkgewogICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgICAgIHggPSBjZWxsV2lkdGg7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAgICAgeCA9IC1jZWxsV2lkdGg7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgIHggPSBjZWxsV2lkdGg7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gVE9ETyhTSElOKTogRmlndXJlIG91dCBub24tc2V0dGltZW91dCB3YXkgdG8gcGVyZm9ybSBhbmltYXRpb24KICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICBhY3Rpb246IHRoaXMucHJvcHMuYWN0aW9uVG9QZXJmb3JtLnBheWxvYWQuYm94LAogICAgICAgICAgICAgICAgeDogeCwKICAgICAgICAgICAgICAgIGNvbXBsZXRlZDogdHJ1ZSwKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHZhciBhY3Rpb25UaHJlYWRfMSA9IHRoaXMucHJvcHMudGhyZWFkOwogICAgICAgICAgICB0aGlzLnRpbWVvdXQgPSBnbG9iYWwuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5wcm9wcy5vbkFuaW1hdGlvbkNvbXBsZXRlKGFjdGlvblRocmVhZF8xLmlkKTsgfSwgNjAwKTsKICAgICAgICB9CiAgICAgICAgLy8gU2V0IHN3aXBlIGxpc3RlbmVycyBpZiBFbGVjdHJvbgogICAgICAgIGlmIChpc0VsZWN0cm9uKSB7CiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwtdG91Y2gtZW5kJywgdGhpcy5oYW5kbGVTY3JvbGxTdG9wKTsKICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbC10b3VjaC1iZWdpbicsIHRoaXMuaGFuZGxlU2Nyb2xsVG91Y2hCZWdpbik7CiAgICAgICAgfQogICAgfTsKICAgIC8vIEltbWVkaWF0ZWx5IHByb2Nlc3MgYW5pbWF0aW9uIGNvbXBsZXRlIGlmIGNlbGwgd2FzIHVubW91bnRlZCBkdWUgdG8KICAgIC8vIChoaXN0b3J5IGV2ZW50IGJlZm9yZSBhbmltYXRpb24gY29tcGxldGlvbiBvbiBzZW5kIGFuZCBhcmNoaXZlKQogICAgVGhyZWFkQ2VsbC5wcm90b3R5cGUuY29tcG9uZW50V2lsbFVubW91bnQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKHRoaXMudGltZW91dCkgewogICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lb3V0KTsKICAgICAgICB9CiAgICAgICAgaWYgKHRoaXMucHJvcHMuYWN0aW9uVG9QZXJmb3JtICYmCiAgICAgICAgICAgIHRoaXMucHJvcHMuYWN0aW9uVG9QZXJmb3JtLnBheWxvYWQgJiYKICAgICAgICAgICAgdGhpcy5wcm9wcy5hY3Rpb25Ub1BlcmZvcm0ucGF5bG9hZC5ib3gpIHsKICAgICAgICAgICAgdGhpcy5wcm9wcy5vbkFuaW1hdGlvbkNvbXBsZXRlKHRoaXMucHJvcHMudGhyZWFkLmlkKTsKICAgICAgICB9CiAgICAgICAgLy8gUmVtb3ZlIHN3aXBlIGxpc3RlbmVycyBpZiBlbGVjdHJvbgogICAgICAgIGlmIChpc0VsZWN0cm9uKSB7CiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdzY3JvbGwtdG91Y2gtZW5kJywgdGhpcy5oYW5kbGVTY3JvbGxTdG9wKTsKICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Njcm9sbC10b3VjaC1iZWdpbicsIHRoaXMuaGFuZGxlU2Nyb2xsVG91Y2hCZWdpbik7CiAgICAgICAgfQogICAgfTsKICAgIFRocmVhZENlbGwucHJvdG90eXBlLlVOU0FGRV9jb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzID0gZnVuY3Rpb24gKG5leHRQcm9wcykgewogICAgICAgIHZhciB0aHJlYWQgPSBuZXh0UHJvcHMudGhyZWFkLCBzZW5kZXIgPSBuZXh0UHJvcHMuc2VuZGVyLCBnZXRDb250YWN0ID0gbmV4dFByb3BzLmdldENvbnRhY3QsIHJlc2V0Q291bnRlciA9IG5leHRQcm9wcy5yZXNldENvdW50ZXIsIGNlbGxXaWR0aCA9IG5leHRQcm9wcy5jZWxsV2lkdGg7CiAgICAgICAgdmFyIGNvbXBsZXRlZCA9IHRoaXMuc3RhdGUuY29tcGxldGVkOwogICAgICAgIC8vIEhhbmRsZXMgcmVzZXR0aW5nIGFuaW1hdGlvbnMgaWYgbmVjZXNzYXJ5CiAgICAgICAgaWYgKHJlc2V0Q291bnRlciAhPT0gdGhpcy5wcm9wcy5yZXNldENvdW50ZXIgJiYgIWNvbXBsZXRlZCkgewogICAgICAgICAgICB0aGlzLnN3aXBlUGhhc2UgPSBTd2lwZVBoYXNlLk5vbmU7CiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgaW5pdGlhbFg6IDAsCiAgICAgICAgICAgICAgICB4OiBTVEFSVF9MRUZULAogICAgICAgICAgICAgICAgZGlzYWJsZUFuaW1hdGlvbjogZmFsc2UsCiAgICAgICAgICAgICAgICBhY3Rpb246IHVuZGVmaW5lZCwKICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIGlmIChzZW5kZXIgJiYgdGhyZWFkLm1lc3NhZ2VzICE9PSB0aGlzLnByb3BzLnRocmVhZC5tZXNzYWdlcwogICAgICAgICAgICAmJiBzZW5kZXIudHlwZSA9PT0gQ29udGFjdFR5cGUuRGVmYXVsdCAmJiAhdGhpcy5wcm9wcy5jb21wYWN0KSB7CiAgICAgICAgICAgIGdldENvbnRhY3QobGFzdCh0aHJlYWQubWVzc2FnZXMpLmZyb20pOwogICAgICAgIH0KICAgICAgICAvLyBJZiBuZXcgYWN0aW9uIHBhc3NlZCBpbiwgdGhlbiBhbmltYXRlIGFuZCBwZXJmb3JtIGFjdGlvbgogICAgICAgIGlmIChuZXh0UHJvcHMuYWN0aW9uVG9QZXJmb3JtICYmIG5leHRQcm9wcy5hY3Rpb25Ub1BlcmZvcm0gIT09IHRoaXMucHJvcHMuYWN0aW9uVG9QZXJmb3JtKSB7CiAgICAgICAgICAgIC8vIEhhbmRsZSBkaXNtaXNzYWwgaW1tZWRpYXRlbHkgaWYgZmxhZ3MgaGF2ZSBjaGFuZ2VkCiAgICAgICAgICAgIGlmICghbmV4dFByb3BzLmFjdGlvblRvUGVyZm9ybS5wYXlsb2FkLmJveCkgewogICAgICAgICAgICAgICAgbmV4dFByb3BzLm9uQW5pbWF0aW9uQ29tcGxldGUodGhpcy5wcm9wcy50aHJlYWQuaWQpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHZhciBtYXRjaCA9IGluZGV4T2YobmV4dFByb3BzLmFjdGlvbnMsIG5leHRQcm9wcy5hY3Rpb25Ub1BlcmZvcm0ucGF5bG9hZC5ib3gpOwogICAgICAgICAgICB2YXIgeCA9IHRoaXMuc3RhdGUuaW5pdGlhbFg7CiAgICAgICAgICAgIHN3aXRjaCAobWF0Y2gpIHsKICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgICAgICB4ID0gY2VsbFdpZHRoOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgIHggPSAtY2VsbFdpZHRoOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICB4ID0gY2VsbFdpZHRoOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIFRPRE8oU0hJTik6IEZpZ3VyZSBvdXQgbm9uLXNldHRpbWVvdXQgd2F5IHRvIHBlcmZvcm0gYW5pbWF0aW9uCiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgYWN0aW9uOiBuZXh0UHJvcHMuYWN0aW9uVG9QZXJmb3JtLnBheWxvYWQuYm94LAogICAgICAgICAgICAgICAgeDogeCwKICAgICAgICAgICAgICAgIGNvbXBsZXRlZDogdHJ1ZSwKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHZhciBhY3Rpb25UaHJlYWRfMiA9IHRoaXMucHJvcHMudGhyZWFkOwogICAgICAgICAgICB0aGlzLnRpbWVvdXQgPSBnbG9iYWwuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHJldHVybiBuZXh0UHJvcHMub25BbmltYXRpb25Db21wbGV0ZShhY3Rpb25UaHJlYWRfMi5pZCk7IH0sIDYwMCk7CiAgICAgICAgfQogICAgfTsKICAgIFRocmVhZENlbGwucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgX2EgPSB0aGlzLnByb3BzLCB0aHJlYWQgPSBfYS50aHJlYWQsIGFjdGlvbnMgPSBfYS5hY3Rpb25zLCBzZWxlY3RlZCA9IF9hLnNlbGVjdGVkLCB0cmFjayA9IF9hLnRyYWNrLCBtZSA9IF9hLm1lLCBmZWF0dXJlcyA9IF9hLmZlYXR1cmVzLCBzaGFyZWRUaHJlYWQgPSBfYS5zaGFyZWRUaHJlYWQsIG1lbWJlciA9IF9hLm1lbWJlciwgY29tcGFjdCA9IF9hLmNvbXBhY3Q7CiAgICAgICAgdmFyIF9iID0gdGhpcy5zdGF0ZSwgeCA9IF9iLngsIGRpc2FibGVBbmltYXRpb24gPSBfYi5kaXNhYmxlQW5pbWF0aW9uLCBhY3Rpb24gPSBfYi5hY3Rpb24sIGNvbXBsZXRlZCA9IF9iLmNvbXBsZXRlZDsKICAgICAgICB2YXIgbWVzc2FnZXMgPSB0aHJlYWQubWVzc2FnZXMsIHN1YmplY3QgPSB0aHJlYWQuc3ViamVjdCwgc25pcHBldCA9IHRocmVhZC5zbmlwcGV0LCBzdGFycmVkID0gdGhyZWFkLnN0YXJyZWQ7CiAgICAgICAgdmFyIGJhY2tncm91bmRDb2xvciA9IGFjdGlvbiA/IEFDVElPTl9QUk9QRVJUSUVTW2FjdGlvbl0uY29sb3IgOiAndHJhbnNwYXJlbnQnOwogICAgICAgIHZhciBoaWRlQ2VsbCA9ICEhKCFkaXNhYmxlQW5pbWF0aW9uICYmIGFjdGlvbiAmJiBjb21wbGV0ZWQpOwogICAgICAgIHZhciBMZWZ0SWNvbiA9IGFjdGlvbiAmJiBhY3Rpb25zCiAgICAgICAgICAgICYmIEFDVElPTl9QUk9QRVJUSUVTW2FjdGlvbl0uaWNvbiB8fCBBcmNoaXZlOwogICAgICAgIHZhciBSaWdodEljb24gPSBhY3Rpb24gJiYgYWN0aW9ucwogICAgICAgICAgICAmJiBBQ1RJT05fUFJPUEVSVElFU1thY3Rpb25dLmljb24gfHwgU25vb3plOwogICAgICAgIHZhciBsYXN0TWVzc2FnZSA9IGxhc3QobWVzc2FnZXMpOwogICAgICAgIHZhciBsYXN0U2VudCA9IGxhc3RNZXNzYWdlICYmIGxhc3RNZXNzYWdlLmludGVybmFsOwogICAgICAgIHZhciByZWNpcGllbnRzID0gbGFzdE1lc3NhZ2UKICAgICAgICAgICAgJiYgbGFzdE1lc3NhZ2UudG8uY29uY2F0KGxhc3RNZXNzYWdlLmNjKS5jb25jYXQobGFzdE1lc3NhZ2UuYmNjKSB8fCBbXTsKICAgICAgICAvLyBSZWNpcGllbnRzCiAgICAgICAgdmFyIHJlY2lwaWVudFN0cmluZyA9ICcnOwogICAgICAgIHZhciBtYXhOYW1lQ291bnQgPSAzOwogICAgICAgIGlmIChyZWNpcGllbnRzLmxlbmd0aCA9PT0gMSkgewogICAgICAgICAgICByZWNpcGllbnRTdHJpbmcgPSBnZXRGaXJzdE5hbWUocmVjaXBpZW50c1swXSwgbWUpOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChyZWNpcGllbnRzLmxlbmd0aCA8PSBtYXhOYW1lQ291bnQpIHsKICAgICAgICAgICAgcmVjaXBpZW50U3RyaW5nID0gcmVjaXBpZW50cy5tYXAoZnVuY3Rpb24gKHJlY2lwaWVudCkgeyByZXR1cm4gZ2V0Rmlyc3ROYW1lKHJlY2lwaWVudCwgbWUpOyB9KS5qb2luKCcsICcpOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChyZWNpcGllbnRzLmxlbmd0aCA+IG1heE5hbWVDb3VudCkgewogICAgICAgICAgICB2YXIgbmFtZVN0cmluZyA9IHJlY2lwaWVudHMKICAgICAgICAgICAgICAgIC5zbGljZSgwLCBtYXhOYW1lQ291bnQpCiAgICAgICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChyZWNpcGllbnQpIHsgcmV0dXJuIGdldEZpcnN0TmFtZShyZWNpcGllbnQsIG1lKTsgfSkuam9pbignLCAnKTsKICAgICAgICAgICAgdmFyIG90aGVyQ291bnQgPSByZWNpcGllbnRzLmxlbmd0aCAtIG1heE5hbWVDb3VudDsKICAgICAgICAgICAgdmFyIG90aGVyU3RyaW5nID0gb3RoZXJDb3VudCA9PT0gMSA/ICdvdGhlcicgOiAnb3RoZXJzJzsKICAgICAgICAgICAgcmVjaXBpZW50U3RyaW5nID0gbmFtZVN0cmluZyArICgiICYgIiArIG90aGVyQ291bnQgKyAiICIpICsgb3RoZXJTdHJpbmc7CiAgICAgICAgfQogICAgICAgIC8vIFNldCBwYXJ0aWNpcGFudHMKICAgICAgICB2YXIgcGFydGljaXBhbnRzU3RyaW5nID0gIiI7CiAgICAgICAgaWYgKGxhc3RNZXNzYWdlKSB7CiAgICAgICAgICAgIHBhcnRpY2lwYW50c1N0cmluZyA9IGdldERpc3BsYXlOYW1lKGxhc3RNZXNzYWdlLmZyb20sIG1lKTsKICAgICAgICAgICAgaWYgKGxhc3RNZXNzYWdlLnNlbnQgfHwgcmVjaXBpZW50cy5sZW5ndGggPiAxKSB7CiAgICAgICAgICAgICAgICBwYXJ0aWNpcGFudHNTdHJpbmcgPSBnZXRGaXJzdE5hbWUobGFzdE1lc3NhZ2UuZnJvbSwgbWUpOwogICAgICAgICAgICAgICAgcGFydGljaXBhbnRzU3RyaW5nICs9ICIgdG8gIiArIHJlY2lwaWVudFN0cmluZzsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB2YXIgbm93ID0gbmV3IERhdGUoKTsKICAgICAgICB2YXIgZm9sbG93VXAgPSBnZXRGb2xsb3dVcFJlbWluZGVyRGlzcGxheVN0cmluZyh0aHJlYWQpOwogICAgICAgIHZhciBub3RlOwogICAgICAgIHZhciByZWFkTGF0ZXI7CiAgICAgICAgaWYgKCFmb2xsb3dVcCkgewogICAgICAgICAgICAvLyBMb2cgd2VpcmQgZWRnZWNhc2UgdGhhdCBzaG91bGQgbmV2ZXIgaGFwcGVuCiAgICAgICAgICAgIGlmICghdGhyZWFkLmJveCkgewogICAgICAgICAgICAgICAgd2l0aFNjb3BlKGZ1bmN0aW9uIChzY29wZSkgewogICAgICAgICAgICAgICAgICAgIHNjb3BlLnNldEV4dHJhKCd0aHJlYWQnLCB0aHJlYWQpOwogICAgICAgICAgICAgICAgICAgIGNhcHR1cmVNZXNzYWdlKCdHb3QgYSB0aHJlYWQgd2l0aCBubyBib3ggaW4gVGhyZWFkQ2VsbCcpOwogICAgICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTogbm8tY29uc29sZQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0dvdCBhIHRocmVhZCB3aXRoIG5vIGJveCBpbiBUaHJlYWRDZWxsJywgdGhyZWFkKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJlYWRMYXRlciA9IHRocmVhZC5ib3gudmFsdWVPZigpID09PSBTd2lwZS5MYXRlciAmJiB0aHJlYWQud2hlbiA/CiAgICAgICAgICAgICAgICBtb21lbnQodGhyZWFkLndoZW4pLmZvcm1hdChub3cuZ2V0RnVsbFllYXIoKSA9PT0gdGhyZWFkLndoZW4uZ2V0RnVsbFllYXIoKSA/CiAgICAgICAgICAgICAgICAgICAgJ2RkZCwgTU1NIEQgW2F0XSBoOm1tIGEnIDogJ2RkZCwgTU1NIEQgWVlZWSBbYXRdIGg6bW0gYScpIDogdW5kZWZpbmVkOwogICAgICAgIH0KICAgICAgICBpZiAoIXJlYWRMYXRlciAmJiAhZm9sbG93VXApIHsKICAgICAgICAgICAgbm90ZSA9IHRoaXMucHJvcHMubm90ZTsKICAgICAgICB9CiAgICAgICAgdmFyIHNob3dCb2R5ID0gIXJlYWRMYXRlciAmJiAhZm9sbG93VXAgJiYgIW5vdGU7CiAgICAgICAgdmFyIHJlYWRMYXRlclRyaWdnZXJlZCA9IHRocmVhZC53aGVuID8gdGhyZWFkLndoZW4gPD0gbm93IDogZmFsc2U7CiAgICAgICAgdmFyIGZvbGxvd1VwVHJpZ2dlcmVkID0gdGhyZWFkLndhaXRpbmcgPyB0aHJlYWQud2FpdGluZy53aGVuIDw9IG5vdyA6IGZhbHNlOwogICAgICAgIHZhciBzaG93VW5yZWFkID0gIXRocmVhZC5yZWFkIHx8IHJlYWRMYXRlclRyaWdnZXJlZCB8fCBmb2xsb3dVcFRyaWdnZXJlZDsKICAgICAgICB2YXIgbWF4VG91Y2hQb2ludHMgPSBuYXZpZ2F0b3IubXNNYXhUb3VjaFBvaW50cyB8fCBuYXZpZ2F0b3IubWF4VG91Y2hQb2ludHMgfHwgMDsKICAgICAgICB2YXIgZGlzYWJsZURyYWdnYWJsZSA9IG1heFRvdWNoUG9pbnRzID4gMDsKICAgICAgICB2YXIgZGV0YWlsZWRMYXN0U2VudCA9IGxhc3RTZW50ICYmIG1vbWVudChsYXN0U2VudCkuZm9ybWF0KFRPT0xUSVBfRk9STUFUKSB8fCAnJzsKICAgICAgICAvLyBIQUNLKFNISU4pOiBIVE1MIElEIHVzZWQgdG8gY2hlY2sgaWYgVGhyZWFkQ2VsbCBpcyByZW5kZXJlZCBpbiBET00KICAgICAgICAvLyBIQUNLKFNISU4pOiBUdXJuIG9mZiBkcmFnZ2FibGVDb3JlIGVuYWJsZVVzZXJTZWxlY3RIYWNrIHByb3AgYmVjYXVzZSBjb21wb3NlcgogICAgICAgIC8vIGN1cnNvciBzZWxlY3Rpb24gZ2V0cyBsb3N0IG9uIHVubW91bnQuCiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL216YWJyaXNraWUvcmVhY3QtZHJhZ2dhYmxlL2lzc3Vlcy8zMTUKICAgICAgICByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgaWQ6IHRocmVhZENlbGxJZGVudGlmaWVyKHRocmVhZC5pZCksIGNsYXNzTmFtZTogY2xhc3NuYW1lcygndGhyZWFkLWNlbGwnLCB7CiAgICAgICAgICAgICAgICBoaWRlOiBoaWRlQ2VsbCwKICAgICAgICAgICAgICAgIHNlbGVjdGVkOiBzZWxlY3RlZCwKICAgICAgICAgICAgICAgIGNvbXBhY3Q6IGNvbXBhY3QsCiAgICAgICAgICAgICAgICB1bnJlYWQ6ICF0aHJlYWQucmVhZCwKICAgICAgICAgICAgICAgICdyZWFkLWxhdGVyJzogISFyZWFkTGF0ZXJUcmlnZ2VyZWQsCiAgICAgICAgICAgICAgICAnZm9sbG93LXVwJzogISFmb2xsb3dVcFRyaWdnZXJlZCwKICAgICAgICAgICAgfSksIHN0eWxlOiB7IGJhY2tncm91bmRDb2xvcjogYmFja2dyb3VuZENvbG9yIH0sIG9uV2hlZWw6IGlzRWxlY3Ryb24gPyB0aGlzLmhhbmRsZVNjcm9sbCA6IHVuZGVmaW5lZCwgdGFiSW5kZXg6IC0xIH0sCiAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoRHJhZ2dhYmxlQ29yZSwgeyBvblN0YXJ0OiB0aGlzLmhhbmRsZURyYWdTdGFydCwgb25EcmFnOiB0aGlzLmhhbmRsZURyYWcsIG9uU3RvcDogdGhpcy5oYW5kbGVEcmFnU3RvcCwgZW5hYmxlVXNlclNlbGVjdEhhY2s6IGZhbHNlLCBkaXNhYmxlZDogZGlzYWJsZURyYWdnYWJsZSB9LAogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6IGNsYXNzbmFtZXMoJ2NlbGwtY29udGFpbmVyJywgewogICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRlOiAhZGlzYWJsZUFuaW1hdGlvbiwKICAgICAgICAgICAgICAgICAgICAgICAgJ3BlcmZvcm1pbmctYWN0aW9uJzogISFhY3Rpb24sCiAgICAgICAgICAgICAgICAgICAgfSksIHN0eWxlOiB7IGxlZnQ6IHggfSB9LAogICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoTGVmdEljb24sIHsgY2xhc3NOYW1lOiAiaWNvbiIsIGhlaWdodDogSUNPTl9TSVpFICsgInB4Iiwgd2lkdGg6IElDT05fU0laRSArICJweCIgfSksCiAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnV0dG9uIiwgeyBjbGFzc05hbWU6ICJjZWxsIiwgb25DbGljazogdGhpcy5oYW5kbGVDbGljayB9LAogICAgICAgICAgICAgICAgICAgICAgICBzdGFycmVkICYmIFJlYWN0LmNyZWF0ZUVsZW1lbnQoU3RhciwgeyBjbGFzc05hbWU6ICJzdGFyLWljb24iIH0pLAogICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogInRvcC1yb3ciIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdGhpcy5wcm9wcy5jb21wYWN0ICYmIHRoaXMucHJvcHMuc2VuZGVyICYmCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiaW1nIiwgeyBjbGFzc05hbWU6ICJhdmF0YXIiLCBzcmM6IHRoaXMucHJvcHMuc2VuZGVyLnBob3RvVXJsIH0pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgic21hbGwiLCBudWxsLCBwYXJ0aWNpcGFudHNTdHJpbmcpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJkZXNjIiB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VzLmxlbmd0aCA+IDEgJiYgUmVhY3QuY3JlYXRlRWxlbWVudCgic21hbGwiLCBudWxsLCBtZXNzYWdlcy5sZW5ndGgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VzLmxlbmd0aCA+IDEgJiYgbGFzdFNlbnQgJiYgUmVhY3QuY3JlYXRlRWxlbWVudCgic21hbGwiLCB7IGNsYXNzTmFtZTogIm1pZGRvdCIgfSwgIlx1MDBCNyIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RTZW50ICYmIFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNtYWxsIiwgeyB0aXRsZTogZGV0YWlsZWRMYXN0U2VudCB9LCBzaG93TW9zdFJlY2VudChsYXN0U2VudCkpKSksCiAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAic3ViamVjdCIgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3dVbnJlYWQgJiYgUmVhY3QuY3JlYXRlRWxlbWVudChVbnJlYWQsIHsgY2xhc3NOYW1lOiAidW5yZWFkIiB9KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImg1IiwgbnVsbCwgc3ViamVjdCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAodGhyZWFkLnRyYWNrZWQgfHwgdGhyZWFkLnRyYWNrcyA+IDAgfHwgKHRyYWNrICYmIHRyYWNrLmRhdGEpKSAmJgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAidHJhY2siLCBvbk1vdXNlRW50ZXI6IHRoaXMuaGFuZGxlVHJhY2tFbnRlciwgb25Nb3VzZUxlYXZlOiB0aGlzLmhhbmRsZVRyYWNrTGVhdmUgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHRocmVhZC50cmFja2VkIHx8ICh0cmFjayAmJiB0cmFjay5kYXRhKSkgJiYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoVHJhY2ssIHsgY2xhc3NOYW1lOiBjbGFzc25hbWVzKCd0cmFjay1pY29uJywgeyB0cmFja3M6IHRocmVhZC50cmFja3MgPiAwIH0pIH0pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmZWF0dXJlcy50cmFja1JlY2lwaWVudHMgJiYgdGhyZWFkLnRyYWNrcyA+IDAgJiYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCB7IGNsYXNzTmFtZTogInRyYWNrcyIgfSwgdGhyZWFkLnRyYWNrcyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoVHJhY2tpbmdQb3BvdmVyLCB7IHRyYWNrOiB0cmFjayAmJiB0cmFjay5kYXRhLCByZWY6IHRoaXMuaGFuZGxlUmVmLCBwZW5kaW5nOiB0cmFjayAmJiAodHJhY2suc3RhdHVzID09PSBSZXNvdXJjZVN0YXR1cy5QZW5kaW5nIHx8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhY2suc3RhdHVzID09PSBSZXNvdXJjZVN0YXR1cy5Mb2FkaW5nKSB8fCBmYWxzZSwgZmVhdHVyZXM6IGZlYXR1cmVzIH0pKSksCiAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiBjbGFzc25hbWVzKCdzbmlwcGV0JywgeyBjb21tZW50OiAhIW1lbWJlciB9KSB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgISFyZWFkTGF0ZXIgJiYgWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoU25vb3plLCB7IGtleTogImljb24iLCBoZWlnaHQ6ICIxNHB4Iiwgd2lkdGg6ICIxNHB4IiB9KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgeyBjbGFzc05hbWU6ICJyZWFkLWxhdGVyIiwga2V5OiAidGV4dCIgfSwgcmVhZExhdGVyKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhIWZvbGxvd1VwICYmIFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KEZvbGxvd1VwLCB7IGtleTogImljb24iIH0pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCB7IGNsYXNzTmFtZTogImZvbGxvdy11cCIsIGtleTogInRleHQiIH0sIGZvbGxvd1VwKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhIW5vdGUgJiYgWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoQ29udGFjdHMsIHsga2V5OiAiaWNvbiIgfSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIHsgY2xhc3NOYW1lOiAibm90ZSIsIGtleTogInRleHQiIH0sIG5vdGUuYm9keSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0JvZHkgJiYgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6IGNsYXNzbmFtZXMoJ3ByZXZpZXctc25pcHBldCcsIHsgY29tbWVudDogISFtZW1iZXIgfSkgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZW1iZXIgJiYgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJhdmF0YXIiIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImltZyIsIHsgc3JjOiBtZW1iZXIucGhvdG9VcmwgfSkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNtYWxsIiwgbnVsbCwgc2hhcmVkVGhyZWFkID8gc2hhcmVkVGhyZWFkLnNuaXBwZXQgOiBzbmlwcGV0KSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJlYWQuaGFzQXR0YWNobWVudHMgJiYgUmVhY3QuY3JlYXRlRWxlbWVudChBdHRhY2htZW50LCB7IGNsYXNzTmFtZTogImF0dGFjaG1lbnQiIH0pKSksCiAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChSaWdodEljb24sIHsgY2xhc3NOYW1lOiAiaWNvbiIsIGhlaWdodDogSUNPTl9TSVpFICsgInB4Iiwgd2lkdGg6IElDT05fU0laRSArICJweCIgfSkpKSkpOwogICAgfTsKICAgIHJldHVybiBUaHJlYWRDZWxsOwp9KFJlYWN0LlB1cmVDb21wb25lbnQpKTsKZXhwb3J0IGRlZmF1bHQgVGhyZWFkQ2VsbDsK"},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Threads/components/ThreadList/components/InfiniteThreadList/ThreadCell/ThreadCell.tsx","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Threads/components/ThreadList/components/InfiniteThreadList/ThreadCell/ThreadCell.tsx"],"names":[],"mappings":"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","sourcesContent":["import React from 'react';\nimport classnames from 'classnames';\nimport moment from 'moment';\nimport { last, indexOf } from 'lodash';\nimport { DraggableCore, DraggableData } from 'react-draggable';\nimport { showMostRecent, TOOLTIP_FORMAT } from '@src/lib/datetime';\nimport { getDisplayName, getFirstName } from '@src/lib/address';\nimport { isElectron } from '@src/lib/electron';\n\nimport './ThreadCell.scss';\nimport {\n  Thread,\n  ThreadActionColor,\n  Message,\n  ContactNote,\n  Contact,\n  Track as TrackType,\n  Resource,\n  ResourceStatus,\n  Commit,\n  Me,\n  ContactType,\n  Features,\n  Swipe,\n  TeamMember,\n} from '@src/types';\nimport {\n  SharedThread,\n} from '@src/types/sharedThreads';\nimport TrackingPopover from '@src/routes/Threads/components/TrackingPopover';\nimport Archive from '@src/components/Icons/Archive.svg';\nimport List from '@src/components/Icons/Label.svg';\nimport Snooze from '@src/components/Icons/Clock.svg';\nimport Trash from '@src/components/Icons/Trash.svg';\nimport Star from '@src/components/Icons/Star.svg';\nimport Track from '@src/components/Icons/Track.svg';\nimport FollowUp from '@src/components/Icons/FollowUp.svg';\nimport Unread from '@src/components/Icons/Unread.svg';\nimport Attachment from '@src/components/Icons/Attachment.svg';\nimport Inbox from '@src/components/Icons/Inbox.svg';\nimport Contacts from '@src/components/Icons/Contacts.svg';\nimport { getFollowUpReminderDisplayString } from '@src/lib/thread';\nimport { captureMessage, withScope } from '@sentry/browser';\n\nexport interface Props {\n  thread: Thread;\n  selected: boolean;\n  note?: ContactNote;\n  resetCounter?: number;\n\n  actionToPerform?: Commit;\n  onClick: (e: React.MouseEvent<HTMLElement>, thread: Thread) => void;\n  onThreadMove: (thread: Thread, action: Swipe) => void;\n  onAnimationComplete: (id: string) => void;\n}\n\nexport interface StateProps {\n  features: Features;\n  actions: Swipe[];\n  sender?: Contact;\n  track?: Resource<TrackType>;\n  me?: Me;\n  cellWidth: number;\n  sharedThread?: SharedThread;\n  member?: TeamMember;\n  compact?: boolean;\n}\n\nexport interface DispatchProps {\n  fetchTrack: (threadId: string, messageId: string) => void;\n  getContact: (email: string) => void;\n}\n\ninterface State {\n  initialX: number;\n  x: number;\n  disableAnimation: boolean;\n  action?: Swipe;\n  completed?: boolean;\n}\n\nconst ACTION_PROPERTIES = {\n  archive: {\n    color: ThreadActionColor.Archive,\n    icon: Archive,\n  },\n  list: {\n    color: ThreadActionColor.List,\n    icon: List,\n  },\n  later: {\n    color: ThreadActionColor.Snooze,\n    icon: Snooze,\n  },\n  trash: {\n    color: ThreadActionColor.Trash,\n    icon: Trash,\n  },\n  spam: {\n    color: ThreadActionColor.Trash,\n    icon: Trash,\n  },\n  inbox: {\n    color: ThreadActionColor.Inbox,\n    icon: Inbox,\n  },\n  unread: {\n    color: ThreadActionColor.Unread,\n    icon: Unread,\n  },\n  star: {\n    color: ThreadActionColor.Star,\n    icon: Star,\n  },\n  none: {\n    color: ThreadActionColor.None,\n    icon: undefined,\n  },\n};\n\nconst ICON_SIZE = 20;\nconst ICON_MARGIN = 18;\nconst START_LEFT = -1 * (ICON_SIZE + 40);\n\n// HTML ID used for ThreadCell\nexport const threadCellIdentifier = (resourceId: string) => {\n  return `pm-thread-${resourceId}`;\n};\n\nenum SwipePhase {\n  Swiping = 'Swiping',\n  Completed = 'Completed',\n  None = 'None',\n}\n\nclass ThreadCell extends React.PureComponent<Props & StateProps & DispatchProps, State> {\n  private timeout: NodeJS.Timer;\n  private popover: TrackingPopover;\n  private swipePhase: SwipePhase = SwipePhase.None;\n  private tracking: boolean;\n\n  constructor() {\n    super();\n\n    this.state = {\n      initialX: 0,\n      x: START_LEFT,\n      disableAnimation: false,\n    };\n  }\n\n  componentDidMount() {\n    const { sender, getContact, thread, cellWidth } = this.props;\n\n    if (sender && sender.type === ContactType.Default && !this.props.compact) {\n      getContact(last(thread.messages)!.from);\n    }\n\n    if (this.props.actionToPerform) {\n      // Handle dismissal immediately if flags have changed\n      if (!this.props.actionToPerform.payload.box) {\n        this.props.onAnimationComplete(this.props.thread.id);\n      }\n\n      const match = indexOf(this.props.actions, this.props.actionToPerform.payload.box);\n\n      let x = this.state.initialX;\n\n      switch (match) {\n        case 0:\n        case 1:\n          x = cellWidth;\n          break;\n        case 2:\n        case 3:\n          x = -cellWidth;\n          break;\n        default:\n          x = cellWidth;\n          break;\n      }\n\n      // TODO(SHIN): Figure out non-settimeout way to perform animation\n      this.setState({\n        action: this.props.actionToPerform.payload.box,\n        x,\n        completed: true,\n      });\n      const actionThread = this.props.thread;\n      this.timeout = global.setTimeout(\n        () => this.props.onAnimationComplete(actionThread.id),\n        600,\n      );\n    }\n\n    // Set swipe listeners if Electron\n    if (isElectron) {\n      window.addEventListener('scroll-touch-end', this.handleScrollStop);\n      window.addEventListener('scroll-touch-begin', this.handleScrollTouchBegin);\n    }\n  }\n\n  // Immediately process animation complete if cell was unmounted due to\n  // (history event before animation completion on send and archive)\n  componentWillUnmount() {\n    if (this.timeout) {\n      clearTimeout(this.timeout);\n    }\n\n    if (this.props.actionToPerform &&\n      this.props.actionToPerform.payload &&\n      this.props.actionToPerform.payload.box\n    ) {\n      this.props.onAnimationComplete(this.props.thread.id);\n    }\n\n    // Remove swipe listeners if electron\n    if (isElectron) {\n      window.removeEventListener('scroll-touch-end', this.handleScrollStop);\n      window.removeEventListener('scroll-touch-begin', this.handleScrollTouchBegin);\n    }\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps: Props & StateProps & DispatchProps) {\n    const { thread, sender, getContact, resetCounter, cellWidth } = nextProps;\n    const { completed } = this.state;\n\n    // Handles resetting animations if necessary\n    if (resetCounter !== this.props.resetCounter && !completed) {\n      this.swipePhase = SwipePhase.None;\n      this.setState({\n        initialX: 0,\n        x: START_LEFT,\n        disableAnimation: false,\n        action: undefined,\n      });\n    }\n\n    if (sender && thread.messages !== this.props.thread.messages\n      && sender.type === ContactType.Default && !this.props.compact) {\n      getContact(last(thread.messages)!.from);\n    }\n\n    // If new action passed in, then animate and perform action\n    if (nextProps.actionToPerform && nextProps.actionToPerform !== this.props.actionToPerform) {\n      // Handle dismissal immediately if flags have changed\n      if (!nextProps.actionToPerform.payload.box) {\n        nextProps.onAnimationComplete(this.props.thread.id);\n      }\n\n      const match = indexOf(nextProps.actions, nextProps.actionToPerform.payload.box);\n\n      let x = this.state.initialX;\n\n      switch (match) {\n        case 0:\n        case 1:\n          x = cellWidth;\n          break;\n        case 2:\n        case 3:\n          x = -cellWidth;\n          break;\n        default:\n          x = cellWidth;\n          break;\n      }\n\n      // TODO(SHIN): Figure out non-settimeout way to perform animation\n      this.setState({\n        action: nextProps.actionToPerform.payload.box,\n        x,\n        completed: true,\n      });\n      const actionThread = this.props.thread;\n      this.timeout = global.setTimeout(\n        () => nextProps.onAnimationComplete(actionThread.id),\n        600,\n      );\n    }\n  }\n\n  getActionFromPosition = (x: number) => {\n    let action;\n    const { actions } = this.props;\n    const lowerThreshold = 70;\n    const upperThreshold = 160;\n\n    if (x < START_LEFT && x < upperThreshold * -1 + START_LEFT) {\n      action = actions[2];\n    } else if (x < START_LEFT && x < lowerThreshold * -1 + START_LEFT) {\n      action = actions[3];\n    } else if (x > START_LEFT && x > upperThreshold + START_LEFT) {\n      action = actions[1];\n    } else if (x > START_LEFT && x > lowerThreshold + START_LEFT) {\n      action = actions[0];\n    }\n\n    return action;\n  }\n\n  getMotionStopPosition = (x: number) => {\n    const { cellWidth } = this.props;\n    let lastPosition = START_LEFT;\n    const threshold = 70;\n\n    if (x < START_LEFT && x < threshold * -1 + START_LEFT) {\n      lastPosition = (cellWidth + (ICON_SIZE * 2) + ICON_MARGIN) * -1;\n    } else if (x > START_LEFT && x > threshold + START_LEFT) {\n      lastPosition = cellWidth;\n    }\n\n    return lastPosition;\n  }\n\n  handleDragStart = (e: MouseEvent, data: DraggableData) => {\n    this.setState({ initialX: data.x, disableAnimation: true });\n  }\n\n  handleDrag = (e: MouseEvent, data: DraggableData) => {\n    const dragX = data.x + START_LEFT - this.state.initialX;\n\n    // Handle scroll preventions\n    if (!this.shouldSwipeLeft() && dragX < START_LEFT) {\n      return;\n    }\n    if (!this.shouldSwipeRight() && dragX > START_LEFT) {\n      return;\n    }\n\n    this.setState({\n      x: dragX,\n      action: this.getActionFromPosition(dragX),\n    });\n  }\n\n  handleDragStop = (e: MouseEvent, data: DraggableData) => {\n    const dragX = data.x + START_LEFT - this.state.initialX;\n    const { action } = this.state;\n    let completed: boolean | undefined;\n\n    switch (action) {\n      case Swipe.Archive:\n      case Swipe.Inbox:\n      case Swipe.Trash:\n        completed = true;\n        break;\n      default:\n        break;\n    }\n\n    // Handle reset if setting to None value\n    let stopPosition = this.getMotionStopPosition(dragX);\n    if (!action || action === Swipe.None) {\n      stopPosition = START_LEFT;\n    }\n\n    if (action) {\n      this.swipePhase = SwipePhase.Completed;\n    }\n\n    this.setState({\n      x: stopPosition,\n      disableAnimation: false,\n      completed,\n    });\n\n    // Handle Action\n    if (action) {\n      this.props.onThreadMove(this.props.thread, action);\n    }\n  }\n\n  handleScrollTouchBegin = () => {\n    this.tracking = true;\n  }\n\n  handleScrollStop = () => {\n    const { action } = this.state;\n    this.tracking = false;\n\n    this.setState({\n      x: this.getMotionStopPosition(this.state.x),\n      disableAnimation: false,\n    });\n\n    if (this.swipePhase !== SwipePhase.Swiping) {\n      return;\n    }\n\n    const dragX = this.state.x + START_LEFT - this.state.initialX;\n    let completed: boolean | undefined;\n    if (action) {\n      this.swipePhase = SwipePhase.Completed;\n    }\n\n    switch (action) {\n      case Swipe.Archive:\n      case Swipe.Inbox:\n      case Swipe.Trash:\n        completed = true;\n        break;\n      default:\n        break;\n    }\n\n    // Handle reset if setting to None value\n    let stopPosition = this.getMotionStopPosition(dragX);\n    if (!action || action === Swipe.None) {\n      stopPosition = START_LEFT;\n    }\n\n    this.setState({\n      x: stopPosition,\n      disableAnimation: false,\n      completed,\n    });\n\n    // Handle Action\n    if (action) {\n      this.props.onThreadMove(this.props.thread, action);\n    }\n  }\n\n  handleScroll = (e: any) => {\n    const delta = (e.deltaX / 3);\n    const deltaWithSettings = window.PMElectronBridge && window.PMElectronBridge.swipeInverted\n      ? -delta\n      : delta;\n    const x = this.state.x + deltaWithSettings;\n\n    // Ignore y-axis scrolls\n    if (Math.abs(e.deltaY) > Math.abs(e.deltaX)) {\n      return;\n    }\n\n    // Handle scroll preventions\n    if (!this.shouldSwipeLeft() && x < START_LEFT) {\n      return;\n    }\n    if (!this.shouldSwipeRight() && x > START_LEFT) {\n      return;\n    }\n\n    if (this.swipePhase === SwipePhase.None) {\n      this.swipePhase = SwipePhase.Swiping;\n    }\n\n    if (this.swipePhase === SwipePhase.Completed || !this.tracking) {\n      e.preventDefault();\n      e.stopPropagation();\n      return;\n    }\n\n    this.setState({\n      x,\n      disableAnimation: true,\n      action: this.getActionFromPosition(x),\n    });\n  }\n\n  handleTrackEnter = () => {\n    const { thread, track, fetchTrack } = this.props;\n\n    const trackNumberMismatch = track && track.data &&\n      Object.keys(track.data.actions).length !== thread.tracks;\n    const noTrackRetrieved = !!thread.tracks && !track;\n\n    if (trackNumberMismatch || noTrackRetrieved) {\n      const lastSent = last(thread.messages.filter((message: Message) => message.sent));\n      fetchTrack(thread.id, lastSent!.id);\n    }\n\n    if (thread.tracked) {\n      this.popover.show();\n    }\n  }\n\n  handleTrackLeave = () => {\n    const { thread } = this.props;\n\n    if (thread.tracked) {\n      this.popover.hide();\n    }\n  }\n\n  handleRef = (ref: TrackingPopover) => {\n    this.popover = ref;\n  }\n\n  handleClick = (e: React.MouseEvent<HTMLElement>) => {\n    return this.props.onClick(e, this.props.thread);\n  }\n\n  shouldSwipeLeft = (): boolean => {\n    const { actions } = this.props;\n    return !(actions[2] === Swipe.None && actions[3] === Swipe.None);\n  }\n\n  shouldSwipeRight = (): boolean => {\n    const { actions } = this.props;\n    return !(actions[0] === Swipe.None && actions[1] === Swipe.None);\n  }\n\n  render() {\n    const {\n      thread, actions, selected, track, me,\n      features, sharedThread, member, compact,\n    } = this.props;\n    const { x, disableAnimation, action, completed } = this.state;\n    const { messages, subject, snippet, starred } = thread;\n    const backgroundColor = action ? ACTION_PROPERTIES[action].color : 'transparent';\n    const hideCell = !!(!disableAnimation && action && completed);\n    const LeftIcon = action && actions\n      && ACTION_PROPERTIES[action].icon || Archive;\n    const RightIcon = action && actions\n      && ACTION_PROPERTIES[action].icon || Snooze;\n    const lastMessage: Message | undefined = last(messages);\n    const lastSent = lastMessage && lastMessage.internal;\n    const recipients = lastMessage\n      && lastMessage.to.concat(lastMessage.cc).concat(lastMessage.bcc) || [];\n\n    // Recipients\n    let recipientString = '';\n    const maxNameCount = 3;\n    if (recipients.length === 1) {\n      recipientString = getFirstName(recipients[0], me);\n    } else if (recipients.length <= maxNameCount) {\n      recipientString = recipients.map(recipient => getFirstName(recipient, me)).join(', ');\n    } else if (recipients.length > maxNameCount) {\n      const nameString = recipients\n        .slice(0, maxNameCount)\n        .map(recipient => getFirstName(recipient, me)).join(', ');\n      const otherCount = recipients.length - maxNameCount;\n      const otherString = otherCount === 1 ? 'other' : 'others';\n      recipientString = nameString + ` & ${otherCount} ` + otherString;\n    }\n\n    // Set participants\n    let participantsString = ``;\n    if (lastMessage) {\n      participantsString = getDisplayName(lastMessage.from, me);\n      if (lastMessage.sent || recipients.length > 1) {\n        participantsString = getFirstName(lastMessage.from, me);\n        participantsString += ` to ${recipientString}`;\n      }\n    }\n\n    const now = new Date();\n    const followUp = getFollowUpReminderDisplayString(thread);\n\n    let note;\n    let readLater;\n\n    if (!followUp) {\n      // Log weird edgecase that should never happen\n      if (!thread.box) {\n        withScope((scope) => {\n          scope.setExtra('thread', thread);\n          captureMessage('Got a thread with no box in ThreadCell');\n          // tslint:disable-next-line: no-console\n          console.error('Got a thread with no box in ThreadCell', thread);\n        });\n      }\n\n      readLater = thread.box.valueOf() === Swipe.Later && thread.when ?\n        moment(thread.when).format(\n          now.getFullYear() === thread.when.getFullYear() ?\n          'ddd, MMM D [at] h:mm a' : 'ddd, MMM D YYYY [at] h:mm a',\n        ) : undefined;\n    }\n\n    if (!readLater && !followUp) {\n      note = this.props.note;\n    }\n\n    const showBody = !readLater && !followUp && !note;\n    const readLaterTriggered = thread.when ? thread.when <= now : false;\n    const followUpTriggered = thread.waiting ? thread.waiting.when <= now : false;\n    const showUnread = !thread.read || readLaterTriggered || followUpTriggered;\n    const maxTouchPoints = navigator.msMaxTouchPoints || navigator.maxTouchPoints || 0;\n    const disableDraggable = maxTouchPoints > 0;\n    const detailedLastSent = lastSent && moment(lastSent).format(TOOLTIP_FORMAT) || '';\n\n    // HACK(SHIN): HTML ID used to check if ThreadCell is rendered in DOM\n    // HACK(SHIN): Turn off draggableCore enableUserSelectHack prop because composer\n    // cursor selection gets lost on unmount.\n    // https://github.com/mzabriskie/react-draggable/issues/315\n    return (\n      <div\n        id={threadCellIdentifier(thread.id)}\n        className={classnames('thread-cell', {\n          hide: hideCell,\n          selected,\n          compact,\n          unread: !thread.read,\n          'read-later': !!readLaterTriggered,\n          'follow-up': !!followUpTriggered,\n        })}\n        style={{ backgroundColor }}\n        onWheel={isElectron ? this.handleScroll : undefined}\n        tabIndex={-1}\n      >\n        <DraggableCore\n          onStart={this.handleDragStart}\n          onDrag={this.handleDrag}\n          onStop={this.handleDragStop}\n          enableUserSelectHack={false}\n          disabled={disableDraggable}\n        >\n          <div\n            className={classnames('cell-container', {\n              animate: !disableAnimation,\n              'performing-action': !!action,\n            })}\n            style={{ left: x }}\n          >\n            <LeftIcon\n              className=\"icon\"\n              height={`${ICON_SIZE}px`}\n              width={`${ICON_SIZE}px`}\n            />\n            <button className=\"cell\" onClick={this.handleClick}>\n              {starred && <Star className=\"star-icon\" />}\n              <div className=\"top-row\">\n                {!this.props.compact && this.props.sender &&\n                  <img className=\"avatar\"src={this.props.sender.photoUrl}/>\n                }\n                <small>{participantsString}</small>\n                <div className=\"desc\">\n                  {messages.length > 1 && <small>{messages.length}</small>}\n                  {messages.length > 1 && lastSent && <small className=\"middot\">&#183;</small>}\n                  {lastSent && <small title={detailedLastSent}>{showMostRecent(lastSent)}</small>}\n                </div>\n              </div>\n              <div className=\"subject\">\n                {showUnread && <Unread className=\"unread\"/>}\n                <h5>{subject}</h5>\n                {(thread.tracked || thread.tracks > 0 || (track && track.data)) &&\n                  <div\n                    className=\"track\"\n                    onMouseEnter={this.handleTrackEnter}\n                    onMouseLeave={this.handleTrackLeave}\n                  >\n                    {(thread.tracked || (track && track.data)) &&\n                      <Track className={classnames('track-icon', { tracks: thread.tracks > 0 })} />}\n                    {features.trackRecipients && thread.tracks > 0 &&\n                      <span className=\"tracks\">{thread.tracks}</span>}\n                    <TrackingPopover\n                      track={track && track.data}\n                      ref={this.handleRef}\n                      pending={track && (track.status === ResourceStatus.Pending ||\n                        track.status === ResourceStatus.Loading) || false}\n                      features={features}\n                    />\n                  </div>\n                }\n              </div>\n              <div className={classnames('snippet', { comment: !!member })}>\n                {!!readLater && [\n                  <Snooze key=\"icon\" height=\"14px\" width=\"14px\"/>,\n                  <span className=\"read-later\" key=\"text\">{readLater}</span>,\n                ]}\n                {!!followUp && [\n                  <FollowUp key=\"icon\"/>,\n                  <span className=\"follow-up\" key=\"text\">{followUp}</span>,\n                ]}\n                {!!note && [\n                  <Contacts key=\"icon\" />,\n                  <span className=\"note\" key=\"text\">{note.body}</span>,\n                ]}\n                {showBody && <div className={classnames('preview-snippet', { comment: !!member })}>\n                  {member && <div className=\"avatar\">\n                    <img src={member.photoUrl} />\n                  </div>}\n                  <small>\n                    {sharedThread ? sharedThread.snippet : snippet}\n                  </small>\n                </div>}\n                {thread.hasAttachments && <Attachment className=\"attachment\"/>}\n              </div>\n            </button>\n            <RightIcon\n              className=\"icon\"\n              height={`${ICON_SIZE}px`}\n              width={`${ICON_SIZE}px`}\n            />\n          </div>\n        </DraggableCore>\n      </div>\n    );\n  }\n}\n\nexport default ThreadCell;\n"]}]}