{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/ducks/sharedThreads.ts","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/ducks/sharedThreads.ts","mtime":1675280254052},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF9hLCBfYiwgX2MsIF9kLCBfZSwgX2YsIF9nLCBfaCwgX2osIF9rLCBfbCwgX20sIF9vLCBfcCwgX3E7CmltcG9ydCB1cGRhdGUgZnJvbSAnaW1tdXRhYmlsaXR5LWhlbHBlcic7CmltcG9ydCB7IGNyZWF0ZSB9IGZyb20gJ0BzcmMvbGliL3JlZHV4JzsKaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnOwppbXBvcnQgeyBSZXNvdXJjZVN0YXR1cyB9IGZyb20gJ0BzcmMvdHlwZXMnOwppbXBvcnQgeyBTaGFyZWRUaHJlYWRBY3Rpdml0eVR5cGUsIFNoYXJlZFRocmVhZEZpbHRlck1vZGUsIH0gZnJvbSAnQHNyYy90eXBlcy9zaGFyZWRUaHJlYWRzJzsKaW1wb3J0IHsgb3JkZXJCeSwgZmlsdGVyLCBrZXlCeSwgbGFzdCB9IGZyb20gJ2xvZGFzaCc7CmltcG9ydCB7IGNyZWF0ZVNlbGVjdG9yIH0gZnJvbSAnQHNyYy9saWIvc2VsZWN0b3InOwppbXBvcnQgeyByZXNvdXJjZU9rLCByZXNvdXJjZUZhaWxlZCwgcmVzb3VyY2VMb2FkaW5nIH0gZnJvbSAnQHNyYy9saWIvcmVzb3VyY2UnOwppbXBvcnQgeyBmbnYxYTMyIH0gZnJvbSAnQHNyYy9saWIvY3J5cHQnOwppbXBvcnQgeyBzZWxlY3RDb21tZW50cyB9IGZyb20gJy4vY29tbWVudHMnOwpleHBvcnQgdmFyIFNIQVJFRF9USFJFQURfRFJBRlRTX0xJU1QgPSAoX2EgPSBjcmVhdGUoJ1NIQVJFRF9USFJFQURfRFJBRlRTX0xJU1QnLCB7CiAgICBzdWNjZXNzOiBmdW5jdGlvbiAoc3RhdGUsIG1ldGEsIHBheWxvYWQpIHsKICAgICAgICB2YXIgX2E7CiAgICAgICAgcmV0dXJuIHVwZGF0ZShzdGF0ZSwgewogICAgICAgICAgICBzaGFyZWRUaHJlYWREcmFmdHM6IChfYSA9IHt9LAogICAgICAgICAgICAgICAgX2FbbWV0YV0gPSB7CiAgICAgICAgICAgICAgICAgICAgJHNldDogcGF5bG9hZCwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBfYSksCiAgICAgICAgfSk7CiAgICB9LAp9KSwgX2EudHlwZSksIHNoYXJlZFRocmVhZERyYWZ0c0xpc3QgPSBfYS5hY3Rpb24sIHNoYXJlZFRocmVhZERyYWZ0c0xpc3RSZWR1Y2VyID0gX2EucmVkdWNlcjsKZXhwb3J0IHZhciBTSEFSRURfVEhSRUFEX0RSQUZUX0ZFVENIID0gKF9iID0gY3JlYXRlKCdTSEFSRURfVEhSRUFEX0RSQUZUX0ZFVENIJywgewogICAgc3VjY2VzczogZnVuY3Rpb24gKHN0YXRlLCBtZXRhLCBwYXlsb2FkKSB7CiAgICAgICAgdmFyIF9hOwogICAgICAgIHJldHVybiB1cGRhdGUoc3RhdGUsIHsKICAgICAgICAgICAgc2hhcmVkVGhyZWFkRHJhZnRzOiAoX2EgPSB7fSwKICAgICAgICAgICAgICAgIF9hW21ldGEuc2hhcmVkVGhyZWFkXSA9IHsKICAgICAgICAgICAgICAgICAgICAkc2V0OiBwYXlsb2FkLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIF9hKSwKICAgICAgICB9KTsKICAgIH0sCn0pLCBfYi50eXBlKSwgc2hhcmVkVGhyZWFkRHJhZnRGZXRjaCA9IF9iLmFjdGlvbiwgc2hhcmVkVGhyZWFkRHJhZnRGZXRjaFJlZHVjZXIgPSBfYi5yZWR1Y2VyOwpleHBvcnQgdmFyIFNIQVJFRF9USFJFQURfQ1JFQVRFID0gKF9jID0gY3JlYXRlKCdTSEFSRURfVEhSRUFEX0NSRUFURScsIHsKICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChzdGF0ZSwgbWV0YSwgcGF5bG9hZCkgewogICAgICAgIHZhciBfYTsKICAgICAgICByZXR1cm4gdXBkYXRlKHN0YXRlLCB7CiAgICAgICAgICAgIHNoYXJlZFRocmVhZHM6IChfYSA9IHt9LAogICAgICAgICAgICAgICAgX2FbcGF5bG9hZC5pZF0gPSB7CiAgICAgICAgICAgICAgICAgICAgJHNldDogcmVzb3VyY2VPayhwYXlsb2FkKSwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBfYSksCiAgICAgICAgfSk7CiAgICB9LAp9KSwgX2MudHlwZSksIHNoYXJlZFRocmVhZENyZWF0ZSA9IF9jLmFjdGlvbiwgc2hhcmVkVGhyZWFkQ3JlYXRlUmVkdWNlciA9IF9jLnJlZHVjZXI7Ci8vIFNlbGVjdHMgYSBTaGFyZWQgVGhyZWFkIFJlc291cmNlIHRocm91Z2ggYSBjb3JyZXNwb25kaW5nIHVzZXIgdGhyZWFkIGlkLgpleHBvcnQgdmFyIFNIQVJFRF9USFJFQURfU0VMRUNUX0JZX1RIUkVBRCA9IChfZCA9IGNyZWF0ZSgnU0hBUkVEX1RIUkVBRF9TRUxFQ1RfQllfVEhSRUFEJywge30pLCBfZC50eXBlKSwgc2hhcmVkVGhyZWFkU2VsZWN0QnlUaHJlYWQgPSBfZC5hY3Rpb24sIHNoYXJlZFRocmVhZFNlbGVjdEJ5VGhyZWFkUmVkdWNlciA9IF9kLnJlZHVjZXI7CmV4cG9ydCB2YXIgU0hBUkVEX1RIUkVBRF9TRUxFQ1QgPSAoX2UgPSBjcmVhdGUoJ1NIQVJFRF9USFJFQURfU0VMRUNUJywgewogICAgc3RhcnQ6IGZ1bmN0aW9uIChzdGF0ZSwgbWV0YSkgewogICAgICAgIHJldHVybiB1cGRhdGUoc3RhdGUsIHsKICAgICAgICAgICAgc2VsZWN0ZWRTaGFyZWRUaHJlYWQ6IHsgJHNldDogbWV0YSA9PT0gbnVsbCA/IHVuZGVmaW5lZCA6IG1ldGEgfSwKICAgICAgICB9KTsKICAgIH0sCiAgICBzdWNjZXNzOiBmdW5jdGlvbiAoc3RhdGUsIG1ldGEsIHBheWxvYWQpIHsKICAgICAgICB2YXIgX2EsIF9iOwogICAgICAgIHZhciBfYzsKICAgICAgICBpZiAoIW1ldGEpIHsKICAgICAgICAgICAgcmV0dXJuIHN0YXRlOwogICAgICAgIH0KICAgICAgICAvLyBJZGVudGlmeSBpZiBjYWNoZWQgZHJhZnQgc2hvdWxkIGJlIHJlbW92ZWQgaWYgdGhlIHBlcm1pc3Npb24gaGFzIGNoYW5nZWQKICAgICAgICB2YXIgZHJhZnRFbmFibGVkID0gISEoKF9jID0gcGF5bG9hZC5kcmFmdHMpID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYy5sZW5ndGgpOwogICAgICAgIHJldHVybiB1cGRhdGUoc3RhdGUsIHsKICAgICAgICAgICAgc2hhcmVkVGhyZWFkczogKF9hID0ge30sCiAgICAgICAgICAgICAgICBfYVtwYXlsb2FkLmlkXSA9IHsgJHNldDogcmVzb3VyY2VPayhwYXlsb2FkKSB9LAogICAgICAgICAgICAgICAgX2EpLAogICAgICAgICAgICBzaGFyZWRUaHJlYWREcmFmdHM6IChfYiA9IHt9LAogICAgICAgICAgICAgICAgX2JbcGF5bG9hZC5pZF0gPSB7ICRzZXQ6IGRyYWZ0RW5hYmxlZCA/IHN0YXRlLnNoYXJlZFRocmVhZERyYWZ0c1twYXlsb2FkLmlkXSA6IHVuZGVmaW5lZCB9LAogICAgICAgICAgICAgICAgX2IpLAogICAgICAgIH0pOwogICAgfSwKICAgIGZhaWx1cmU6IGZ1bmN0aW9uIChzdGF0ZSwgbWV0YSwgZXJyb3IpIHsKICAgICAgICB2YXIgX2E7CiAgICAgICAgaWYgKCFtZXRhKSB7CiAgICAgICAgICAgIHJldHVybiBzdGF0ZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHVwZGF0ZShzdGF0ZSwgewogICAgICAgICAgICBzaGFyZWRUaHJlYWRzOiAoX2EgPSB7fSwKICAgICAgICAgICAgICAgIF9hW21ldGFdID0gewogICAgICAgICAgICAgICAgICAgICRzZXQ6IHJlc291cmNlRmFpbGVkKGVycm9yKSwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBfYSksCiAgICAgICAgfSk7CiAgICB9LAp9KSwgX2UudHlwZSksIHNoYXJlZFRocmVhZFNlbGVjdCA9IF9lLmFjdGlvbiwgc2hhcmVkVGhyZWFkU2VsZWN0UmVkdWNlciA9IF9lLnJlZHVjZXI7CmV4cG9ydCB2YXIgU0hBUkVEX1RIUkVBRF9ERUxFVEUgPSAoX2YgPSBjcmVhdGUoJ1NIQVJFRF9USFJFQURfREVMRVRFJywgewogICAgc3VjY2VzczogZnVuY3Rpb24gKHN0YXRlLCBtZXRhLCBwYXlsb2FkKSB7CiAgICAgICAgcmV0dXJuIHVwZGF0ZShzdGF0ZSwgewogICAgICAgICAgICBzaGFyZWRUaHJlYWRzOiB7ICR1bnNldDogW21ldGFdIH0sCiAgICAgICAgfSk7CiAgICB9LAp9KSwgX2YudHlwZSksIHNoYXJlZFRocmVhZERlbGV0ZSA9IF9mLmFjdGlvbiwgc2hhcmVkVGhyZWFkRGVsZXRlUmVkdWNlciA9IF9mLnJlZHVjZXI7CmV4cG9ydCB2YXIgU0hBUkVEX1RIUkVBRF9VUERBVEUgPSAoX2cgPSBjcmVhdGUoJ1NIQVJFRF9USFJFQURfVVBEQVRFJywgewogICAgc3VjY2VzczogZnVuY3Rpb24gKHN0YXRlLCBtZXRhLCBwYXlsb2FkKSB7CiAgICAgICAgdmFyIF9hOwogICAgICAgIHJldHVybiB1cGRhdGUoc3RhdGUsIHsKICAgICAgICAgICAgc2hhcmVkVGhyZWFkczogKF9hID0ge30sCiAgICAgICAgICAgICAgICBfYVtwYXlsb2FkLmlkXSA9IHsgJHNldDogcmVzb3VyY2VPayhwYXlsb2FkKSB9LAogICAgICAgICAgICAgICAgX2EpLAogICAgICAgIH0pOwogICAgfSwKfSksIF9nLnR5cGUpLCBzaGFyZWRUaHJlYWRVcGRhdGUgPSBfZy5hY3Rpb24sIHNoYXJlZFRocmVhZFVwZGF0ZVJlZHVjZXIgPSBfZy5yZWR1Y2VyOwpleHBvcnQgdmFyIFNIQVJFRF9USFJFQURfTElTVCA9IChfaCA9IGNyZWF0ZSgnU0hBUkVEX1RIUkVBRF9MSVNUJywgewogICAgc3VjY2VzczogZnVuY3Rpb24gKHN0YXRlLCBtZXRhLCBwYXlsb2FkKSB7CiAgICAgICAgcmV0dXJuIHVwZGF0ZShzdGF0ZSwgewogICAgICAgICAgICBzaGFyZWRUaHJlYWRzOiB7CiAgICAgICAgICAgICAgICAkbWVyZ2U6IGtleUJ5KHBheWxvYWQubWFwKGZ1bmN0aW9uIChzdCkgeyByZXR1cm4gcmVzb3VyY2VPayhzdCk7IH0pLCBmdW5jdGlvbiAoc3QpIHsgcmV0dXJuIHN0LmRhdGEuaWQ7IH0pLAogICAgICAgICAgICB9LAogICAgICAgICAgICBzaGFyZWRUaHJlYWRzU3RhdHVzOiB7CiAgICAgICAgICAgICAgICAkc2V0OiBSZXNvdXJjZVN0YXR1cy5PaywKICAgICAgICAgICAgfSwKICAgICAgICB9KTsKICAgIH0sCn0pLCBfaC50eXBlKSwgc2hhcmVkVGhyZWFkTGlzdCA9IF9oLmFjdGlvbiwgc2hhcmVkVGhyZWFkTGlzdFJlZHVjZXIgPSBfaC5yZWR1Y2VyOwpleHBvcnQgdmFyIFNIQVJFRF9USFJFQURfT1JJR0lOQUxfRkVUQ0ggPSAoX2ogPSBjcmVhdGUoJ1NIQVJFRF9USFJFQURfT1JJR0lOQUxfRkVUQ0gnLCB7fSksIF9qLnR5cGUpLCBzaGFyZWRUaHJlYWRPcmlnaW5hbEZldGNoID0gX2ouYWN0aW9uLCBzaGFyZWRUaHJlYWRPcmlnaW5hbEZldGNoUmVkdWNlciA9IF9qLnJlZHVjZXI7CmV4cG9ydCB2YXIgU0hBUkVEX1RIUkVBRF9VU0VSX0ZJTFRFUiA9IChfayA9IGNyZWF0ZSgnU0hBUkVEX1RIUkVBRF9VU0VSX0ZJTFRFUicsIHsKICAgIHN0YXJ0OiBmdW5jdGlvbiAoc3RhdGUsIG1ldGEpIHsKICAgICAgICByZXR1cm4gdXBkYXRlKHN0YXRlLCB7CiAgICAgICAgICAgIHNoYXJlZFRocmVhZFVzZXJGaWx0ZXI6IHsgJHNldDogbWV0YSB9LAogICAgICAgIH0pOwogICAgfSwKfSksIF9rLnR5cGUpLCBzaGFyZWRUaHJlYWRVc2VyRmlsdGVyID0gX2suYWN0aW9uLCBzaGFyZWRUaHJlYWRVc2VyRmlsdGVyUmVkdWNlciA9IF9rLnJlZHVjZXI7CmV4cG9ydCB2YXIgU0hBUkVEX1RIUkVBRF9GSUxURVIgPSAoX2wgPSBjcmVhdGUoJ1NIQVJFRF9USFJFQURfRklMVEVSJywgewogICAgc3RhcnQ6IGZ1bmN0aW9uIChzdGF0ZSwgbWV0YSkgewogICAgICAgIHJldHVybiB1cGRhdGUoc3RhdGUsIHsKICAgICAgICAgICAgc2hhcmVkVGhyZWFkRmlsdGVyOiB7ICRzZXQ6IG1ldGEgfSwKICAgICAgICB9KTsKICAgIH0sCn0pLCBfbC50eXBlKSwgc2hhcmVkVGhyZWFkRmlsdGVyID0gX2wuYWN0aW9uLCBzaGFyZWRUaHJlYWRGaWx0ZXJSZWR1Y2VyID0gX2wucmVkdWNlcjsKZXhwb3J0IHZhciBTSEFSRURfVEhSRUFEX0FTQU5BX1RBU0tfTElTVCA9IChfbSA9IGNyZWF0ZSgnU0hBUkVEX1RIUkVBRF9BU0FOQV9UQVNLX0xJU1QnLCB7CiAgICBzZXR1cDogZnVuY3Rpb24gKHN0YXRlLCBtZXRhKSB7CiAgICAgICAgdmFyIF9hOwogICAgICAgIGlmIChzdGF0ZS5hc2FuYSAmJiBzdGF0ZS5hc2FuYS50YXNrc1ttZXRhXSkgewogICAgICAgICAgICByZXR1cm4gc3RhdGU7CiAgICAgICAgfQogICAgICAgIHJldHVybiB1cGRhdGUoc3RhdGUsIHsKICAgICAgICAgICAgYXNhbmE6IHsKICAgICAgICAgICAgICAgIHRhc2tzOiB7CiAgICAgICAgICAgICAgICAgICAgJHNldDogKF9hID0ge30sIF9hW21ldGFdID0gcmVzb3VyY2VMb2FkaW5nKCksIF9hKSwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0sCiAgICAgICAgfSk7CiAgICB9LAogICAgc3RhcnQ6IGZ1bmN0aW9uIChzdGF0ZSwgbWV0YSkgewogICAgICAgIHZhciBfYTsKICAgICAgICByZXR1cm4gdXBkYXRlKHN0YXRlLCB7CiAgICAgICAgICAgIGFzYW5hOiB7CiAgICAgICAgICAgICAgICB0YXNrczogKF9hID0ge30sCiAgICAgICAgICAgICAgICAgICAgX2FbbWV0YV0gPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogeyAkc2V0OiBSZXNvdXJjZVN0YXR1cy5Mb2FkaW5nIH0sCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBfYSksCiAgICAgICAgICAgIH0sCiAgICAgICAgfSk7CiAgICB9LAogICAgc3VjY2VzczogZnVuY3Rpb24gKHN0YXRlLCBtZXRhLCBwYXlsb2FkKSB7CiAgICAgICAgdmFyIF9hOwogICAgICAgIHJldHVybiB1cGRhdGUoc3RhdGUsIHsKICAgICAgICAgICAgYXNhbmE6IHsKICAgICAgICAgICAgICAgIHRhc2tzOiAoX2EgPSB7fSwKICAgICAgICAgICAgICAgICAgICBfYVttZXRhXSA9IHsgJHNldDogcmVzb3VyY2VPayhwYXlsb2FkKSB9LAogICAgICAgICAgICAgICAgICAgIF9hKSwKICAgICAgICAgICAgfSwKICAgICAgICB9KTsKICAgIH0sCn0pLCBfbS50eXBlKSwgc2hhcmVkVGhyZWFkQXNhbmFUYXNrTGlzdCA9IF9tLmFjdGlvbiwgc2hhcmVkVGhyZWFkQXNhbmFUYXNrTGlzdFJlZHVjZXIgPSBfbS5yZWR1Y2VyOwpleHBvcnQgdmFyIFNIQVJFRF9USFJFQURfQVNBTkFfVEFTS19DUkVBVEUgPSAoX28gPSBjcmVhdGUoJ1NIQVJFRF9USFJFQURfQVNBTkFfVEFTS19DUkVBVEUnLCB7fSksIF9vLnR5cGUpLCBzaGFyZWRUaHJlYWRBc2FuYVRhc2tDcmVhdGUgPSBfby5hY3Rpb24sIHNoYXJlZFRocmVhZEFzYW5hVGFza0NyZWF0ZVJlZHVjZXIgPSBfby5yZWR1Y2VyOwpleHBvcnQgdmFyIFBJTkdfSU5URVJWQUwgPSAxMDAwICogNTsKZXhwb3J0IHZhciBUVEwgPSA4OyAvLyBpbiBzZWNvbmRzCmV4cG9ydCB2YXIgU0hBUkVEX1RIUkVBRF9BQ1RJVklUWV9DUkVBVEUgPSAoX3AgPSBjcmVhdGUoJ1NIQVJFRF9USFJFQURfQUNUSVZJVFlfQ1JFQVRFJywgewogICAgc3VjY2VzczogZnVuY3Rpb24gKHN0YXRlLCBtZXRhLCBwYXlsb2FkKSB7CiAgICAgICAgdmFyIF9hLCBfYjsKICAgICAgICBpZiAocGF5bG9hZCA9PT0gbnVsbCB8fAogICAgICAgICAgICBwYXlsb2FkLnNoYXJlZFRocmVhZCAhPT0gc3RhdGUuc2VsZWN0ZWRTaGFyZWRUaHJlYWQgfHwKICAgICAgICAgICAgbW9tZW50KHBheWxvYWQudGltZXN0YW1wKS5pc0JlZm9yZShtb21lbnQoKS5zdWJ0cmFjdChUVEwsICdzZWNvbmRzJykpKSB7CiAgICAgICAgICAgIHJldHVybiBzdGF0ZTsKICAgICAgICB9CiAgICAgICAgLy8gY2hlY2sgaWYgbGFzdCBjb21tZW50IHdhcyByZWNlbnQgYW5kIGJ5IHRoaXMgY29tbWVudGVyCiAgICAgICAgaWYgKHBheWxvYWQudHlwZSA9PT0gU2hhcmVkVGhyZWFkQWN0aXZpdHlUeXBlLkNvbW1lbnQpIHsKICAgICAgICAgICAgdmFyIGNvbW1lbnRzID0gc2VsZWN0Q29tbWVudHMoc3RhdGUsIHBheWxvYWQuc2hhcmVkVGhyZWFkKTsKICAgICAgICAgICAgdmFyIGxhc3RDb21tZW50ID0gbGFzdChjb21tZW50cyk7CiAgICAgICAgICAgIGlmIChsYXN0Q29tbWVudCAmJiBsYXN0Q29tbWVudC51c2VyID09PSBwYXlsb2FkLnVzZXJJZAogICAgICAgICAgICAgICAgJiYgbW9tZW50KGxhc3RDb21tZW50LmNyZWF0ZWQpLmlzQWZ0ZXIobW9tZW50KCkuc3VidHJhY3QoVFRMLCAnc2Vjb25kcycpKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIHN0YXRlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIC8vIEFjdGl2aXR5IGNoZWNrCiAgICAgICAgdmFyIGlzT3duZXIgPSBzdGF0ZS5tZS5kYXRhICYmIHN0YXRlLm1lLmRhdGEuaWQgPT09IHBheWxvYWQudXNlcklkOwogICAgICAgIHZhciBpc1JlcGx5ID0gcGF5bG9hZC50eXBlID09PSBTaGFyZWRUaHJlYWRBY3Rpdml0eVR5cGUuUmVwbHk7CiAgICAgICAgaWYgKGlzT3duZXIgJiYgIWlzUmVwbHkpIHsKICAgICAgICAgICAgcmV0dXJuIHN0YXRlOwogICAgICAgIH0KICAgICAgICBzd2l0Y2ggKHBheWxvYWQudHlwZSkgewogICAgICAgICAgICBjYXNlIFNoYXJlZFRocmVhZEFjdGl2aXR5VHlwZS5Db21tZW50OgogICAgICAgICAgICBjYXNlIFNoYXJlZFRocmVhZEFjdGl2aXR5VHlwZS5WaWV3OgogICAgICAgICAgICBjYXNlIFNoYXJlZFRocmVhZEFjdGl2aXR5VHlwZS5SZXBseToKICAgICAgICAgICAgICAgIHJldHVybiB1cGRhdGUoc3RhdGUsIHsKICAgICAgICAgICAgICAgICAgICBzaGFyZWRUaHJlYWRBY3Rpdml0eTogKF9hID0ge30sCiAgICAgICAgICAgICAgICAgICAgICAgIF9hW3BheWxvYWQudHlwZV0gPSAoX2IgPSB7fSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9iW3BheWxvYWQudXNlcklkXSA9IHsgJHNldDogcGF5bG9hZCB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2IpLAogICAgICAgICAgICAgICAgICAgICAgICBfYSksCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHJldHVybiBzdGF0ZTsKICAgICAgICB9CiAgICB9LAp9KSwgX3AudHlwZSksIHNoYXJlZFRocmVhZEFjdGl2aXR5Q3JlYXRlID0gX3AuYWN0aW9uLCBzaGFyZWRUaHJlYWRBY3Rpdml0eUNyZWF0ZVJlZHVjZXIgPSBfcC5yZWR1Y2VyOwpleHBvcnQgdmFyIFNIQVJFRF9USFJFQURfQUNUSVZJVFlfQ0xFQVIgPSAoX3EgPSBjcmVhdGUoJ1NIQVJFRF9USFJFQURfQUNUSVZJVFlfQ0xFQVInLCB7CiAgICBzdGFydDogZnVuY3Rpb24gKHN0YXRlLCBtZXRhKSB7CiAgICAgICAgcmV0dXJuIHVwZGF0ZShzdGF0ZSwgewogICAgICAgICAgICBzaGFyZWRUaHJlYWRBY3Rpdml0eTogewogICAgICAgICAgICAgICAgY29tbWVudDogeyAkc2V0OiB7fSB9LAogICAgICAgICAgICAgICAgdmlldzogeyAkc2V0OiB7fSB9LAogICAgICAgICAgICAgICAgcmVwbHk6IHsgJHNldDoge30gfSwKICAgICAgICAgICAgfSwKICAgICAgICB9KTsKICAgIH0sCn0pLCBfcS50eXBlKSwgc2hhcmVkVGhyZWFkQWN0aXZpdHlDbGVhciA9IF9xLmFjdGlvbiwgc2hhcmVkVGhyZWFkQWN0aXZpdHlDbGVhclJlZHVjZXIgPSBfcS5yZWR1Y2VyOwpleHBvcnQgdmFyIHNlbGVjdFVzZXJTaGFyZWRUaHJlYWRzID0gY3JlYXRlU2VsZWN0b3IoWwogICAgZnVuY3Rpb24gKHN0YXRlKSB7IHJldHVybiBzdGF0ZS5zaGFyZWRUaHJlYWRzOyB9LAogICAgZnVuY3Rpb24gKHN0YXRlKSB7IHJldHVybiBzdGF0ZS5tZS5kYXRhOyB9LApdLCBmdW5jdGlvbiAoc2hhcmVkVGhyZWFkcywgbWUsIGYpIHsKICAgIHZhciBhcmNoaXZlT25seSA9IGYubW9kZSA9PT0gU2hhcmVkVGhyZWFkRmlsdGVyTW9kZS5BcmNoaXZlOwogICAgdmFyIGNvbW1lbnRzT25seSA9IGYubW9kZSA9PT0gU2hhcmVkVGhyZWFkRmlsdGVyTW9kZS5Db21tZW50czsKICAgIHZhciBzaG93QWxsID0gZi5tb2RlID09PSBTaGFyZWRUaHJlYWRGaWx0ZXJNb2RlLkFsbDsKICAgIHJldHVybiBvcmRlckJ5KGZpbHRlcihzaGFyZWRUaHJlYWRzLCBmdW5jdGlvbiAocmVzb3VyY2UpIHsKICAgICAgICB2YXIgbWF0Y2hlZCA9IHJlc291cmNlLnN0YXR1cyA9PT0gUmVzb3VyY2VTdGF0dXMuT2s7CiAgICAgICAgaWYgKG1hdGNoZWQgJiYgcmVzb3VyY2UuZGF0YSkgewogICAgICAgICAgICB2YXIgdXNlck1hdGNoID0gbWUgJiYgbWUuaWQgPT09IHJlc291cmNlLmRhdGEudXNlciB8fCBmYWxzZTsKICAgICAgICAgICAgbWF0Y2hlZCA9IHVzZXJNYXRjaDsKICAgICAgICB9CiAgICAgICAgdmFyIGlzQXJjaGl2ZWQgPSAhIXJlc291cmNlLmRhdGEgJiYgcmVzb3VyY2UuZGF0YS5hcmNoaXZlZDsKICAgICAgICBpZiAoYXJjaGl2ZU9ubHkgJiYgbWUgJiYgbWF0Y2hlZCkgewogICAgICAgICAgICBtYXRjaGVkID0gbWF0Y2hlZCAmJiBpc0FyY2hpdmVkOwogICAgICAgIH0KICAgICAgICAvLyBIYW5kbGUgQ29tbWVudHMgT25seSBzZWxlY3Rpb24KICAgICAgICBpZiAoY29tbWVudHNPbmx5ICYmIG1hdGNoZWQgJiYgcmVzb3VyY2UuZGF0YSkgewogICAgICAgICAgICBtYXRjaGVkID0gcmVzb3VyY2UuZGF0YS5jb21tZW50Q291bnQgPiAwOwogICAgICAgIH0KICAgICAgICAvLyBkaXNyZWdhcmQgdW5yZWFkIGZpbHRlciBmb3Igc2VhcmNoCiAgICAgICAgaWYgKGYucXVlcnkgJiYgbWF0Y2hlZCAmJiAhIXJlc291cmNlLmRhdGEpIHsKICAgICAgICAgICAgdmFyIHF1ZXJ5TG93ZXJDYXNlZCA9IGYucXVlcnkudG9Mb3dlckNhc2UoKTsKICAgICAgICAgICAgdmFyIHN1YmplY3RTdHJpbmcgPSByZXNvdXJjZS5kYXRhICYmIHJlc291cmNlLmRhdGEuc3ViamVjdCB8fCAnJzsKICAgICAgICAgICAgdmFyIHNuaXBwZXRTdHJpbmcgPSByZXNvdXJjZS5kYXRhICYmIHJlc291cmNlLmRhdGEuc25pcHBldCB8fCAnJzsKICAgICAgICAgICAgdmFyIHBhcnRpY2lwYW50c1N0cmluZyA9IHJlc291cmNlLmRhdGEgJiYgcmVzb3VyY2UuZGF0YS5wYXJ0aWNpcGFudHMuam9pbignICcpOwogICAgICAgICAgICB2YXIgZnVsbFNlYXJjaFN0cmluZyA9IHN1YmplY3RTdHJpbmcgKyBzbmlwcGV0U3RyaW5nICsgcGFydGljaXBhbnRzU3RyaW5nOwogICAgICAgICAgICBtYXRjaGVkID0gISFmdWxsU2VhcmNoU3RyaW5nLmluY2x1ZGVzKHF1ZXJ5TG93ZXJDYXNlZCk7CiAgICAgICAgICAgIHJldHVybiBtYXRjaGVkOwogICAgICAgIH0KICAgICAgICAvLyBBcmNoaXZlIG9ubHkgZmlsdGVyCiAgICAgICAgaWYgKCFzaG93QWxsICYmICFhcmNoaXZlT25seSAmJiBpc0FyY2hpdmVkKSB7CiAgICAgICAgICAgIG1hdGNoZWQgPSBmYWxzZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG1hdGNoZWQ7CiAgICB9KS5tYXAoZnVuY3Rpb24gKHJlc291cmNlKSB7IHJldHVybiByZXNvdXJjZS5kYXRhOyB9KSwgWydzb3J0J10sIFsnZGVzYyddKTsKfSwgZnVuY3Rpb24gKHNoYXJlZFRocmVhZHMsIG1lLCBmKSB7CiAgICByZXR1cm4gZm52MWEzMigidXNlci0iICsgZi5tb2RlICsgIi0iICsgKGYucXVlcnkgPyBmLnF1ZXJ5IDogJycpKTsKfSwgWydzaGFyZWRUaHJlYWRzJ10pOwovLyBUT0RPKFNISU4pOiBSZWFsbHkgc2xvdyBwZXJmb3JtYW5jZSBzaW5jZSB1c2VyIHNoYXJlZCB0aHJlYWRzIGFsd2F5cyBicm91Z2h0CmV4cG9ydCB2YXIgc2VsZWN0U2hhcmVkVGhyZWFkcyA9IGNyZWF0ZVNlbGVjdG9yKFsKICAgIGZ1bmN0aW9uIChzdGF0ZSkgeyByZXR1cm4gc3RhdGUuc2hhcmVkVGhyZWFkczsgfSwKICAgIGZ1bmN0aW9uIChzdGF0ZSkgeyByZXR1cm4gc3RhdGUubWUuZGF0YTsgfSwKXSwgZnVuY3Rpb24gKHNoYXJlZFRocmVhZHMsIG1lLCBmKSB7CiAgICB2YXIgYXJjaGl2ZU9ubHkgPSBmLm1vZGUgPT09IFNoYXJlZFRocmVhZEZpbHRlck1vZGUuQXJjaGl2ZTsKICAgIHZhciB1bnJlYWRPbmx5ID0gZi5tb2RlID09PSBTaGFyZWRUaHJlYWRGaWx0ZXJNb2RlLlVucmVhZDsKICAgIHJldHVybiBvcmRlckJ5KGZpbHRlcihzaGFyZWRUaHJlYWRzLCBmdW5jdGlvbiAocmVzb3VyY2UpIHsKICAgICAgICB2YXIgbWF0Y2hlZCA9IHJlc291cmNlLnN0YXR1cyA9PT0gUmVzb3VyY2VTdGF0dXMuT2s7CiAgICAgICAgdmFyIGlzQXJjaGl2ZWQgPSAhIXJlc291cmNlLmRhdGEgJiYgcmVzb3VyY2UuZGF0YS5hcmNoaXZlZDsKICAgICAgICAvLyBTZXQgbWVudGlvbmVkIHdoZW4geW91IGFyZSB0aGUgb3duZXIgYW5kIGFueW9uZSBjb21tZW50cwogICAgICAgIGlmICghIW1lKSB7CiAgICAgICAgICAgIHZhciBtZW50aW9uZWRNYXRjaCA9ICEhcmVzb3VyY2UuZGF0YSAmJgogICAgICAgICAgICAgICAgISFyZXNvdXJjZS5kYXRhLm1lbnRpb25lZCAmJgogICAgICAgICAgICAgICAgISFyZXNvdXJjZS5kYXRhLm1lbnRpb25lZC5maW5kKGZ1bmN0aW9uIChtKSB7IHJldHVybiBtID09PSBtZS5pZDsgfSk7CiAgICAgICAgICAgIHZhciBjb21tZW50Q291bnQgPSByZXNvdXJjZS5kYXRhICYmIHJlc291cmNlLmRhdGEuY29tbWVudENvdW50IHx8IDA7CiAgICAgICAgICAgIHZhciBvd25lckNvbW1lbnRDb3VudCA9IHJlc291cmNlLmRhdGEgJiYgcmVzb3VyY2UuZGF0YS5vd25lckNvbW1lbnRDb3VudCB8fCAwOwogICAgICAgICAgICB2YXIgY29tbWVudE1hdGNoID0gISFyZXNvdXJjZS5kYXRhICYmIHJlc291cmNlLmRhdGEudXNlciA9PT0gbWUuaWQgJiYKICAgICAgICAgICAgICAgIChjb21tZW50Q291bnQgLSBvd25lckNvbW1lbnRDb3VudCkgPiAwOwogICAgICAgICAgICBtYXRjaGVkID0gbWF0Y2hlZCAmJiAobWVudGlvbmVkTWF0Y2ggfHwgY29tbWVudE1hdGNoKTsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAoIW1lKSB7CiAgICAgICAgICAgIG1hdGNoZWQgPSBmYWxzZTsKICAgICAgICB9CiAgICAgICAgaWYgKGFyY2hpdmVPbmx5ICYmIG1lKSB7CiAgICAgICAgICAgIG1hdGNoZWQgPSBtYXRjaGVkICYmIGlzQXJjaGl2ZWQ7CiAgICAgICAgfQogICAgICAgIC8vIGRpc3JlZ2FyZCB1bnJlYWQgZmlsdGVyIGZvciBzZWFyY2gKICAgICAgICBpZiAoZi5xdWVyeSAmJiBtYXRjaGVkICYmICEhcmVzb3VyY2UuZGF0YSkgewogICAgICAgICAgICB2YXIgcXVlcnlMb3dlckNhc2VkID0gZi5xdWVyeS50b0xvd2VyQ2FzZSgpOwogICAgICAgICAgICB2YXIgc3ViamVjdFN0cmluZyA9IHJlc291cmNlLmRhdGEgJiYgcmVzb3VyY2UuZGF0YS5zdWJqZWN0IHx8ICcnOwogICAgICAgICAgICB2YXIgc25pcHBldFN0cmluZyA9IHJlc291cmNlLmRhdGEgJiYgcmVzb3VyY2UuZGF0YS5zbmlwcGV0IHx8ICcnOwogICAgICAgICAgICB2YXIgcGFydGljaXBhbnRzU3RyaW5nID0gcmVzb3VyY2UuZGF0YSAmJiByZXNvdXJjZS5kYXRhLnBhcnRpY2lwYW50cy5qb2luKCcgJyk7CiAgICAgICAgICAgIHZhciBmdWxsU2VhcmNoU3RyaW5nID0gc3ViamVjdFN0cmluZyArIHNuaXBwZXRTdHJpbmcgKyBwYXJ0aWNpcGFudHNTdHJpbmc7CiAgICAgICAgICAgIG1hdGNoZWQgPSAhIWZ1bGxTZWFyY2hTdHJpbmcuaW5jbHVkZXMocXVlcnlMb3dlckNhc2VkKTsKICAgICAgICAgICAgcmV0dXJuIG1hdGNoZWQ7CiAgICAgICAgfQogICAgICAgIC8vIGRpc3JlZ2FyZCB1bnJlYWQgZmlsdGVyIGZvciBhcmNoaXZlT25seQogICAgICAgIGlmIChhcmNoaXZlT25seSkgewogICAgICAgICAgICByZXR1cm4gbWF0Y2hlZDsKICAgICAgICB9CiAgICAgICAgaWYgKHVucmVhZE9ubHkpIHsKICAgICAgICAgICAgbWF0Y2hlZCA9IG1hdGNoZWQgJiYgISFyZXNvdXJjZS5kYXRhICYmCiAgICAgICAgICAgICAgICAhcmVzb3VyY2UuZGF0YS5yZWFkOwogICAgICAgIH0KICAgICAgICBpZiAoIWFyY2hpdmVPbmx5ICYmIGlzQXJjaGl2ZWQpIHsKICAgICAgICAgICAgbWF0Y2hlZCA9IGZhbHNlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbWF0Y2hlZDsKICAgIH0pLm1hcChmdW5jdGlvbiAocmVzb3VyY2UpIHsgcmV0dXJuIHJlc291cmNlLmRhdGE7IH0pLCBbJ3NvcnQnXSwgWydkZXNjJ10pOwp9LCBmdW5jdGlvbiAoc2hhcmVkVGhyZWFkcywgbWUsIGYpIHsKICAgIHJldHVybiBmbnYxYTMyKGYubW9kZSArICItIiArIChmLnF1ZXJ5ID8gZi5xdWVyeSA6ICcnKSk7Cn0sIFsnc2hhcmVkVGhyZWFkcyddKTsKZXhwb3J0IHZhciBzZWxlY3RTaGFyZWRUaHJlYWQgPSBjcmVhdGVTZWxlY3RvcihbZnVuY3Rpb24gKHN0YXRlKSB7IHJldHVybiBzdGF0ZS5zaGFyZWRUaHJlYWRzOyB9XSwgZnVuY3Rpb24gKHNoYXJlZFRocmVhZHMsIGlkKSB7CiAgICBpZiAoaWQgJiYgc2hhcmVkVGhyZWFkc1tpZF0gJiYgc2hhcmVkVGhyZWFkc1tpZF0uZGF0YSkgewogICAgICAgIHJldHVybiBzaGFyZWRUaHJlYWRzW2lkXS5kYXRhOwogICAgfQogICAgcmV0dXJuIHVuZGVmaW5lZDsKfSwgZnVuY3Rpb24gKHNoYXJlZFRocmVhZHMsIGlkKSB7IHJldHVybiBmbnYxYTMyKGlkKTsgfSwgWydzaGFyZWRUaHJlYWRzJ10pOwpleHBvcnQgdmFyIHNlbGVjdFNoYXJlZFRocmVhZEJ5VGhyZWFkID0gY3JlYXRlU2VsZWN0b3IoW2Z1bmN0aW9uIChzdGF0ZSkgeyByZXR1cm4gc3RhdGUuc2hhcmVkVGhyZWFkczsgfV0sIGZ1bmN0aW9uIChzaGFyZWRUaHJlYWRzLCB0aHJlYWQpIHsKICAgIGlmICh0aHJlYWQpIHsKICAgICAgICB2YXIgbWF0Y2hlZCA9IGZpbHRlcihzaGFyZWRUaHJlYWRzLCBmdW5jdGlvbiAoc3QpIHsgcmV0dXJuICEhc3QuZGF0YSAmJiBzdC5kYXRhLnRocmVhZCA9PT0gdGhyZWFkOyB9KTsKICAgICAgICByZXR1cm4gbWF0Y2hlZC5sZW5ndGggPyBtYXRjaGVkWzBdLmRhdGEgOiB1bmRlZmluZWQ7CiAgICB9CiAgICByZXR1cm4gdW5kZWZpbmVkOwp9LCBmdW5jdGlvbiAoc2hhcmVkVGhyZWFkcywgdGhyZWFkKSB7IHJldHVybiBmbnYxYTMyKHRocmVhZCk7IH0sIFsnc2hhcmVkVGhyZWFkcyddKTsKZXhwb3J0IGRlZmF1bHQgWwogICAgc2hhcmVkVGhyZWFkQ3JlYXRlUmVkdWNlciwKICAgIHNoYXJlZFRocmVhZFNlbGVjdEJ5VGhyZWFkUmVkdWNlciwKICAgIHNoYXJlZFRocmVhZFNlbGVjdFJlZHVjZXIsCiAgICBzaGFyZWRUaHJlYWREZWxldGVSZWR1Y2VyLAogICAgc2hhcmVkVGhyZWFkVXBkYXRlUmVkdWNlciwKICAgIHNoYXJlZFRocmVhZExpc3RSZWR1Y2VyLAogICAgc2hhcmVkVGhyZWFkRmlsdGVyUmVkdWNlciwKICAgIHNoYXJlZFRocmVhZEFzYW5hVGFza0xpc3RSZWR1Y2VyLAogICAgc2hhcmVkVGhyZWFkQWN0aXZpdHlDcmVhdGVSZWR1Y2VyLAogICAgc2hhcmVkVGhyZWFkQWN0aXZpdHlDbGVhclJlZHVjZXIsCiAgICBzaGFyZWRUaHJlYWRVc2VyRmlsdGVyUmVkdWNlciwKICAgIHNoYXJlZFRocmVhZERyYWZ0RmV0Y2hSZWR1Y2VyLAogICAgc2hhcmVkVGhyZWFkRHJhZnRzTGlzdFJlZHVjZXIsCl07Cg=="},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/ducks/sharedThreads.ts","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/ducks/sharedThreads.ts"],"names":[],"mappings":"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","sourcesContent":["import update from 'immutability-helper';\nimport { create } from '@src/lib/redux';\nimport moment from 'moment';\nimport { Resource, ResourceStatus, Thread, Me, Attachment, Draft } from '@src/types';\nimport {\n  SharedThread,\n  SharedThreadActivityType,\n  SharedThreadActivity,\n  Comment,\n  SharedThreadFilter,\n  SharedThreadFilterMode,\n  SharedThreadPermission,\n} from '@src/types/sharedThreads';\nimport { orderBy, filter, keyBy, last } from 'lodash';\nimport { createSelector } from '@src/lib/selector';\nimport { resourceOk, resourceFailed, resourceLoading } from '@src/lib/resource';\nimport { fnv1a32 } from '@src/lib/crypt';\nimport { AsanaTask } from '@src/types/asana';\nimport { selectComments } from './comments';\n\nexport interface PendingComment {\n  rfcId: string;\n  body: string;\n  attachments: Attachment[];\n}\n\nexport interface SharedThreadCreateMeta {\n  comments?: PendingComment[];\n  permissions: SharedThreadPermission;\n\n  // Either one of thread or draft has to be specified\n  thread?: string;\n  draft?: string;\n  message?: string;\n}\n\nexport const {\n  type: SHARED_THREAD_DRAFTS_LIST,\n  action: sharedThreadDraftsList,\n  reducer: sharedThreadDraftsListReducer,\n} = create<string, Draft>('SHARED_THREAD_DRAFTS_LIST', {\n  success: (state, meta, payload) => update(state, {\n    sharedThreadDrafts: {\n      [meta]: {\n        $set: payload,\n      },\n    },\n  }),\n});\n\nexport interface SharedThreadDraftFetchMeta {\n  draft: string;\n  sharedThread: string;\n}\n\nexport const {\n  type: SHARED_THREAD_DRAFT_FETCH,\n  action: sharedThreadDraftFetch,\n  reducer: sharedThreadDraftFetchReducer,\n} = create<SharedThreadDraftFetchMeta, Draft>('SHARED_THREAD_DRAFT_FETCH', {\n  success: (state, meta, payload) => update(state, {\n    sharedThreadDrafts: {\n      [meta.sharedThread]: {\n        $set: payload,\n      },\n    },\n  }),\n});\n\nexport const {\n  type: SHARED_THREAD_CREATE,\n  action: sharedThreadCreate,\n  reducer: sharedThreadCreateReducer,\n} = create<SharedThreadCreateMeta, SharedThread>('SHARED_THREAD_CREATE', {\n  success: (state, meta, payload) => update(state, {\n    sharedThreads: {\n      [payload.id]: {\n        $set: resourceOk(payload),\n      },\n    },\n  }),\n});\n\n// Selects a Shared Thread Resource through a corresponding user thread id.\nexport const {\n  type: SHARED_THREAD_SELECT_BY_THREAD,\n  action: sharedThreadSelectByThread,\n  reducer: sharedThreadSelectByThreadReducer,\n} = create<string, string|null>('SHARED_THREAD_SELECT_BY_THREAD', {});\n\nexport const {\n  type: SHARED_THREAD_SELECT,\n  action: sharedThreadSelect,\n  reducer: sharedThreadSelectReducer,\n} = create<string|null, SharedThread>('SHARED_THREAD_SELECT', {\n  start: (state, meta) => {\n    return update(state, {\n      selectedSharedThread: { $set: meta === null ? undefined : meta },\n    });\n  },\n\n  success: (state, meta, payload) => {\n    if (!meta) {\n      return state;\n    }\n\n    // Identify if cached draft should be removed if the permission has changed\n    const draftEnabled = !!payload.drafts?.length;\n    return update(state, {\n      sharedThreads: {\n        [payload.id]: { $set: resourceOk(payload) },\n      },\n      sharedThreadDrafts: {\n        [payload.id]: { $set: draftEnabled ? state.sharedThreadDrafts[payload.id] : undefined },\n      },\n    });\n  },\n  failure: (state, meta, error) => {\n    if (!meta) {\n      return state;\n    }\n\n    return update(state, {\n      sharedThreads: {\n        [meta]: {\n          $set: resourceFailed(error),\n        },\n      },\n    });\n  },\n});\n\nexport const {\n  type: SHARED_THREAD_DELETE,\n  action: sharedThreadDelete,\n  reducer: sharedThreadDeleteReducer,\n} = create<string, null>('SHARED_THREAD_DELETE', {\n  success: (state, meta, payload) =>\n    update(state, {\n      sharedThreads: { $unset: [meta] },\n    }),\n});\n\nexport const {\n  type: SHARED_THREAD_UPDATE,\n  action: sharedThreadUpdate,\n  reducer: sharedThreadUpdateReducer,\n} = create<SharedThread, SharedThread>('SHARED_THREAD_UPDATE', {\n  success: (state, meta, payload) =>\n    update(state, {\n      sharedThreads: {\n        [payload.id]: { $set: resourceOk(payload) },\n      },\n    }),\n});\n\nexport const {\n  type: SHARED_THREAD_LIST,\n  action: sharedThreadList,\n  reducer: sharedThreadListReducer,\n} = create<null, SharedThread[]>('SHARED_THREAD_LIST', {\n  success: (state, meta, payload) =>\n    update(state, {\n      sharedThreads: {\n        $merge: keyBy(\n          payload.map(st => resourceOk(st)),\n          st => st.data!.id,\n        ),\n      },\n      sharedThreadsStatus: {\n        $set: ResourceStatus.Ok,\n      },\n    }),\n});\n\nexport const {\n  type: SHARED_THREAD_ORIGINAL_FETCH,\n  action: sharedThreadOriginalFetch,\n  reducer: sharedThreadOriginalFetchReducer,\n} = create<string, Thread>('SHARED_THREAD_ORIGINAL_FETCH', {});\n\nexport const {\n  type: SHARED_THREAD_USER_FILTER,\n  action: sharedThreadUserFilter,\n  reducer: sharedThreadUserFilterReducer,\n} = create<SharedThreadFilter, null>('SHARED_THREAD_USER_FILTER', {\n  start: (state, meta) =>\n    update(state, {\n      sharedThreadUserFilter: { $set: meta },\n    }),\n});\n\nexport const {\n  type: SHARED_THREAD_FILTER,\n  action: sharedThreadFilter,\n  reducer: sharedThreadFilterReducer,\n} = create<SharedThreadFilter, null>('SHARED_THREAD_FILTER', {\n  start: (state, meta) =>\n    update(state, {\n      sharedThreadFilter: { $set: meta },\n    }),\n});\n\nexport const {\n  type: SHARED_THREAD_ASANA_TASK_LIST,\n  action: sharedThreadAsanaTaskList,\n  reducer: sharedThreadAsanaTaskListReducer,\n} = create<string, AsanaTask[]>('SHARED_THREAD_ASANA_TASK_LIST', {\n  setup: (state, meta) => {\n    if (state.asana && state.asana.tasks[meta]) {\n      return state;\n    }\n\n    return update(state, {\n      asana: {\n        tasks: {\n          $set: { [meta]: resourceLoading() },\n        },\n      },\n    });\n  },\n  start: (state, meta) => {\n    return update(state, {\n      asana: {\n        tasks: {\n          [meta]: {\n            status: { $set: ResourceStatus.Loading },\n          },\n        },\n      },\n    });\n  },\n  success: (state, meta, payload) => {\n    return update(state, {\n      asana: {\n        tasks: {\n          [meta]: { $set: resourceOk(payload) },\n        },\n      },\n    });\n  },\n});\n\nexport interface SharedThreadAsanaTaskCreateBody {\n  name: string;\n  notes?: string;\n  projects?: string[];\n  assignee?: string;\n  dueOn?: string; // format example: 2012-03-26\n}\n\nexport interface SharedThreadAsanaTaskCreateMeta {\n  sharedThread: string;\n  task: SharedThreadAsanaTaskCreateBody;\n}\n\nexport const {\n  type: SHARED_THREAD_ASANA_TASK_CREATE,\n  action: sharedThreadAsanaTaskCreate,\n  reducer: sharedThreadAsanaTaskCreateReducer,\n} = create<SharedThreadAsanaTaskCreateMeta, AsanaTask>('SHARED_THREAD_ASANA_TASK_CREATE', {});\n\nexport interface SharedThreadActivityCreateMeta {\n  sharedThread: string;\n  type: SharedThreadActivityType;\n}\n\nexport const PING_INTERVAL = 1000 * 5;\nexport const TTL = 8; // in seconds\n\nexport const {\n  type: SHARED_THREAD_ACTIVITY_CREATE,\n  action: sharedThreadActivityCreate,\n  reducer: sharedThreadActivityCreateReducer,\n} = create<SharedThreadActivityCreateMeta, SharedThreadActivity|null>(\n  'SHARED_THREAD_ACTIVITY_CREATE', {\n    success: (state, meta, payload) => {\n      if (payload === null ||\n        payload.sharedThread !== state.selectedSharedThread ||\n        moment(payload.timestamp).isBefore(moment().subtract(TTL, 'seconds'))) {\n        return state;\n      }\n\n      // check if last comment was recent and by this commenter\n      if (payload.type === SharedThreadActivityType.Comment) {\n        const comments = selectComments(state, payload.sharedThread);\n        const lastComment: Comment | undefined = last(comments);\n        if (lastComment && lastComment.user === payload.userId\n          && moment(lastComment.created).isAfter(moment().subtract(TTL, 'seconds'))) {\n          return state;\n        }\n      }\n\n      // Activity check\n      const isOwner = state.me.data && state.me.data.id === payload.userId;\n      const isReply = payload.type === SharedThreadActivityType.Reply;\n      if (isOwner && !isReply) {\n        return state;\n      }\n\n      switch (payload.type) {\n        case SharedThreadActivityType.Comment:\n        case SharedThreadActivityType.View:\n        case SharedThreadActivityType.Reply:\n          return update(state, {\n            sharedThreadActivity: {\n              [payload.type]: {\n                [payload.userId]: { $set: payload },\n              },\n            },\n          });\n        default:\n          return state;\n      }\n    },\n  });\n\nexport const {\n  type: SHARED_THREAD_ACTIVITY_CLEAR,\n  action: sharedThreadActivityClear,\n  reducer: sharedThreadActivityClearReducer,\n} = create<null, null>('SHARED_THREAD_ACTIVITY_CLEAR', {\n  start: (state, meta) =>\n    update(state, {\n      sharedThreadActivity: {\n        comment: { $set: {} },\n        view: { $set: {} },\n        reply: { $set: {} },\n      },\n    }),\n});\n\nexport const selectUserSharedThreads =\n  createSelector<\n    SharedThreadFilter, { [id: string]: Resource<SharedThread> }|Me|undefined, SharedThread[]>(\n    [\n      state => state.sharedThreads,\n      state => state.me.data,\n    ],\n    (\n      sharedThreads: { [id: string]: Resource<SharedThread> },\n      me: Me | undefined,\n      f: SharedThreadFilter,\n    ) => {\n      const archiveOnly = f.mode === SharedThreadFilterMode.Archive;\n      const commentsOnly = f.mode === SharedThreadFilterMode.Comments;\n      const showAll = f.mode === SharedThreadFilterMode.All;\n\n      return orderBy(\n        filter(\n          sharedThreads,\n          (resource) => {\n            let matched = resource.status === ResourceStatus.Ok;\n            if (matched && resource.data) {\n              const userMatch = me && me.id === resource.data.user || false;\n              matched = userMatch;\n            }\n            const isArchived = !!resource.data && resource.data.archived;\n\n            if (archiveOnly && me && matched) {\n              matched = matched && isArchived;\n            }\n\n            // Handle Comments Only selection\n            if (commentsOnly && matched && resource.data) {\n              matched = resource.data.commentCount > 0;\n            }\n\n            // disregard unread filter for search\n            if (f.query && matched && !!resource.data) {\n              const queryLowerCased = f.query.toLowerCase();\n              const subjectString = resource.data && resource.data.subject || '';\n              const snippetString = resource.data && resource.data.snippet || '';\n              const participantsString = resource.data && resource.data.participants.join(' ');\n              const fullSearchString = subjectString + snippetString + participantsString;\n              matched = !!fullSearchString.includes(queryLowerCased);\n\n              return matched;\n            }\n\n            // Archive only filter\n            if (!showAll && !archiveOnly && isArchived) {\n              matched = false;\n            }\n\n            return matched;\n          },\n        ).map(resource => resource.data!),\n        ['sort'],\n        ['desc'],\n      );\n    },\n    (\n      sharedThreads: { [id: string]: Resource<SharedThread> },\n      me: Me | undefined,\n      f: SharedThreadFilter,\n    ) => {\n      return fnv1a32(`user-${f.mode}-${f.query ? f.query : ''}`);\n    },\n    ['sharedThreads'],\n    );\n\n// TODO(SHIN): Really slow performance since user shared threads always brought\nexport const selectSharedThreads =\n  createSelector<\n    SharedThreadFilter, { [id: string]: Resource<SharedThread> } | Me | undefined, SharedThread[]>(\n    [\n      state => state.sharedThreads,\n      state => state.me.data,\n    ],\n    (\n      sharedThreads: { [id: string]: Resource<SharedThread> },\n      me: Me | undefined,\n      f: SharedThreadFilter,\n    ) => {\n      const archiveOnly = f.mode === SharedThreadFilterMode.Archive;\n      const unreadOnly = f.mode === SharedThreadFilterMode.Unread;\n      return orderBy(\n        filter(\n          sharedThreads,\n          (resource) => {\n            let matched = resource.status === ResourceStatus.Ok;\n            const isArchived = !!resource.data && resource.data.archived;\n\n            // Set mentioned when you are the owner and anyone comments\n            if (!!me) {\n              const mentionedMatch = !!resource.data &&\n                !!resource.data.mentioned &&\n                !!resource.data.mentioned.find(m => m === me.id);\n              const commentCount = resource.data && resource.data.commentCount || 0;\n              const ownerCommentCount = resource.data && resource.data.ownerCommentCount || 0;\n              const commentMatch = !!resource.data && resource.data.user === me.id &&\n                (commentCount - ownerCommentCount) > 0;\n              matched = matched && (mentionedMatch || commentMatch);\n            } else if (!me) {\n              matched = false;\n            }\n\n            if (archiveOnly && me) {\n              matched = matched && isArchived;\n            }\n\n            // disregard unread filter for search\n            if (f.query && matched && !!resource.data) {\n              const queryLowerCased = f.query.toLowerCase();\n              const subjectString = resource.data && resource.data.subject || '';\n              const snippetString = resource.data && resource.data.snippet || '';\n              const participantsString = resource.data && resource.data.participants.join(' ');\n              const fullSearchString = subjectString + snippetString + participantsString;\n              matched = !!fullSearchString.includes(queryLowerCased);\n\n              return matched;\n            }\n\n            // disregard unread filter for archiveOnly\n            if (archiveOnly) {\n              return matched;\n            }\n\n            if (unreadOnly) {\n              matched = matched && !!resource.data &&\n                !resource.data.read;\n            }\n\n            if (!archiveOnly && isArchived) {\n              matched = false;\n            }\n\n            return matched;\n          },\n        ).map(resource => resource.data!),\n        ['sort'],\n        ['desc'],\n      );\n    },\n    (\n      sharedThreads: { [id: string]: Resource<SharedThread> },\n      me: Me | undefined,\n      f: SharedThreadFilter,\n    ) =>\n      fnv1a32(`${f.mode}-${f.query ? f.query : ''}`),\n    ['sharedThreads'],\n  );\n\nexport const selectSharedThread =\n  createSelector<string, { [id: string]: Resource<SharedThread> }, SharedThread|undefined>(\n    [state => state.sharedThreads],\n    (sharedThreads: { [id: string]: Resource<SharedThread> }, id: string) => {\n      if (id && sharedThreads[id] && sharedThreads[id].data) {\n        return sharedThreads[id].data;\n      }\n\n      return undefined;\n    },\n    (sharedThreads: { [id: string]: Resource<SharedThread> }, id: string) => fnv1a32(id),\n    ['sharedThreads'],\n  );\n\nexport const selectSharedThreadByThread =\n  createSelector<string, { [id: string]: Resource<SharedThread> }, SharedThread|undefined>(\n    [state => state.sharedThreads],\n    (sharedThreads: { [id: string]: Resource<SharedThread> }, thread: string) => {\n      if (thread) {\n        const matched = filter(sharedThreads, st => !!st.data && st.data.thread === thread);\n        return matched.length ? matched[0].data : undefined;\n      }\n\n      return undefined;\n    },\n    (sharedThreads: { [id: string]: Resource<SharedThread> }, thread: string) => fnv1a32(thread),\n    ['sharedThreads'],\n  );\n\nexport default [\n  sharedThreadCreateReducer,\n  sharedThreadSelectByThreadReducer,\n  sharedThreadSelectReducer,\n  sharedThreadDeleteReducer,\n  sharedThreadUpdateReducer,\n  sharedThreadListReducer,\n  sharedThreadFilterReducer,\n  sharedThreadAsanaTaskListReducer,\n  sharedThreadActivityCreateReducer,\n  sharedThreadActivityClearReducer,\n  sharedThreadUserFilterReducer,\n  sharedThreadDraftFetchReducer,\n  sharedThreadDraftsListReducer,\n];\n"]}]}