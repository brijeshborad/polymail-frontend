{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/CalendarScheduling/CalendarScheduling.tsx","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/CalendarScheduling/CalendarScheduling.tsx","mtime":1675280254074},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewogICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewogICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAogICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKICAgIH07CiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwogICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQogICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKICAgIH07Cn0pKCk7CmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7CmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50LXRpbWV6b25lJzsKaW1wb3J0IEN1c3RvbUxvYWRlciBmcm9tICdyZWFjdC1sb2FkZXJzJzsKaW1wb3J0IGNsYXNzbmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7CmltcG9ydCAnLi9DYWxlbmRhclNjaGVkdWxpbmcuc2Nzcyc7Ci8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGgKaW1wb3J0IFNjaGVkdWxpbmdDb2x1bW5TY3JvbGwgZnJvbSAnQHNyYy9yb3V0ZXMvQ2FsZW5kYXJTY2hlZHVsaW5nL2NvbXBvbmVudHMvU2NoZWR1bGluZ0NvbHVtblNjcm9sbCc7CmltcG9ydCBTY2hlZHVsaW5nQ29sdW1uIGZyb20gJ0BzcmMvcm91dGVzL0NhbGVuZGFyU2NoZWR1bGluZy9jb21wb25lbnRzL1NjaGVkdWxpbmdDb2x1bW4nOwppbXBvcnQgeyB2YWx1ZXMsIHBpY2tCeSwgZmxhdHRlbiB9IGZyb20gJ2xvZGFzaCc7Ci8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGgKaW1wb3J0IENhbGVuZGFyU2NoZWR1bGluZ0RldGFpbCBmcm9tICdAc3JjL3JvdXRlcy9DYWxlbmRhclNjaGVkdWxpbmcvY29tcG9uZW50cy9DYWxlbmRhclNjaGVkdWxpbmdEZXRhaWwnOwppbXBvcnQgeyBTdWJqZWN0IH0gZnJvbSAncnhqcyc7Ci8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGgKaW1wb3J0IFNjaGVkdWxpbmdDb25maXJtYXRpb24gZnJvbSAnQHNyYy9yb3V0ZXMvQ2FsZW5kYXJTY2hlZHVsaW5nL2NvbXBvbmVudHMvU2NoZWR1bGluZ0NvbmZpcm1hdGlvbic7CmltcG9ydCB7IFJlc291cmNlU3RhdHVzIH0gZnJvbSAnQHNyYy90eXBlcyc7CmltcG9ydCBFcnJvclBhZ2UgZnJvbSAnQHNyYy9jb21wb25lbnRzL0Jhc2UvRXJyb3JQYWdlJzsKaW1wb3J0IGxvZ29Ob3RpZmljYXRpb24gZnJvbSAnQHNyYy9jb21wb25lbnRzL0ljb25zL0xvZ29Ob3RpZmljYXRpb25AM3gucG5nJzsKaW1wb3J0IHsgQW1wbGl0dWRlRXZlbnRzLCBsb2dBbXBsaXR1ZGVFdmVudCB9IGZyb20gJ0BzcmMvbGliL2FtcGxpdHVkZS1hbmFseXRpY3MnOwp2YXIgTUFYX1JFVFJZX0FUVEVNUFRTID0gMzsKLy8gVE9ETyhTSElOKTogSW1wbGVtZW50IERpc3BhdGNoUHJvcHMgZm9yIGZldGNoaW5nIG5leHQgc2V0IG9mIGRhdGVzLiBPciBkbyB0aGlzIGluc2lkZSBjb21wb25lbnQKLy8gVE9ETyhTSElOKTogSGFuZGxlIGNhbmNlbGxpbmcgY2FsbHMgZm9yIGFkZGl0aW9uYWwgdGltZXNsb3RzCi8vIFRPRE8oU0hJTik6IEhhbmRsZSBjYWNoaW5nIG9mIGRhdGEgd2hlbiBzY3JvbGxpbmcgdGhyb3VnaCBkYXRlcyBxdWlja2x5Ci8vIFRPRE8oU0hJTik6IEdldCBTY2hlZHVsaW5nIFB1YmxpYyBmcm9tIHJvdXRlcyBvbmNlIG5ldyB1cmwgY29uZmlnIGlzIGJyb3VnaHQgaW4KLy8gVE9ETyhTSElOKTogUmVtb3ZlIFNjaGVkdWxpbmcgZmV0Y2ggdG8gcmVwbGFjZSB3aXRoIHJvdXRlIGZldGNoIGJhc2VkIG9mZiBvZiBwcm9wcwovLyBUT0RPKFNISU4pOiBNYWtlIHN1cmUgdGhhdCBkaWZmZXJlbnQgdGltZXpvbmVzIGRpc3BsYXkgcHJvcGVybHkKdmFyIENhbGVuZGFyU2NoZWR1bGluZyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhDYWxlbmRhclNjaGVkdWxpbmcsIF9zdXBlcik7CiAgICBmdW5jdGlvbiBDYWxlbmRhclNjaGVkdWxpbmcoKSB7CiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpczsKICAgICAgICBfdGhpcy5pc01vYmlsZSA9IHdpbmRvdy5pbm5lcldpZHRoIDwgNDgwOwogICAgICAgIF90aGlzLnJldHJ5QXR0ZW1wdHMgPSAwOwogICAgICAgIF90aGlzLmluaXRpYWxSZW5kZXJlZCA9IGZhbHNlOwogICAgICAgIF90aGlzLmZldGNoVGltZXNsb3RzID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgX2EgPSBfdGhpcy5wcm9wcywgc2NoZWR1bGluZ1B1YmxpYyA9IF9hLnNjaGVkdWxpbmdQdWJsaWMsIGZldGNoVGltZVNsb3RzID0gX2EuZmV0Y2hUaW1lU2xvdHM7CiAgICAgICAgICAgIGlmIChzY2hlZHVsaW5nUHVibGljICYmIHNjaGVkdWxpbmdQdWJsaWMuZGF0YSkgewogICAgICAgICAgICAgICAgZmV0Y2hUaW1lU2xvdHMoewogICAgICAgICAgICAgICAgICAgIHN0YXJ0OiBfdGhpcy5zdGF0ZS5zdGFydFRpbWUsCiAgICAgICAgICAgICAgICAgICAgZW5kOiBfdGhpcy5zdGF0ZS5lbmRUaW1lLAogICAgICAgICAgICAgICAgICAgIHVzZXJTbHVnOiBfdGhpcy5wcm9wcy51c2VyU2x1ZywKICAgICAgICAgICAgICAgICAgICBzbHVnOiBfdGhpcy5wcm9wcy5zbHVnLAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIF90aGlzLmhhbmRsZVNjcm9sbEZvcndhcmQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBkYXlzVG9GZXRjaCA9IF90aGlzLmlzTW9iaWxlID8gMSA6IDc7CiAgICAgICAgICAgIHZhciBuZXdTdGFydCA9IG1vbWVudChfdGhpcy5zdGF0ZS5zdGFydFRpbWUpCiAgICAgICAgICAgICAgICAuc3RhcnRPZignZGF5JykuYWRkKGRheXNUb0ZldGNoLCAnZGF5cycpLnRvRGF0ZSgpOwogICAgICAgICAgICB2YXIgbmV3RW5kID0gbW9tZW50KF90aGlzLnN0YXRlLmVuZFRpbWUpCiAgICAgICAgICAgICAgICAuZW5kT2YoJ2RheScpLmFkZChkYXlzVG9GZXRjaCwgJ2RheXMnKS50b0RhdGUoKTsKICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgc3RhcnRUaW1lOiBuZXdTdGFydCwKICAgICAgICAgICAgICAgIGVuZFRpbWU6IG5ld0VuZCwKICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuZmV0Y2hUaW1lc2xvdHMoKTsgfSk7CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5oYW5kbGVTY3JvbGxCYWNrd2FyZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIGRheXNUb0ZldGNoID0gX3RoaXMuaXNNb2JpbGUgPyAxIDogNzsKICAgICAgICAgICAgdmFyIG5ld1N0YXJ0ID0gbW9tZW50KF90aGlzLnN0YXRlLnN0YXJ0VGltZSkKICAgICAgICAgICAgICAgIC5zdGFydE9mKCdkYXknKS5zdWJ0cmFjdChkYXlzVG9GZXRjaCwgJ2RheXMnKS50b0RhdGUoKTsKICAgICAgICAgICAgdmFyIG5ld0VuZCA9IG1vbWVudChfdGhpcy5zdGF0ZS5lbmRUaW1lKQogICAgICAgICAgICAgICAgLmVuZE9mKCdkYXknKS5zdWJ0cmFjdChkYXlzVG9GZXRjaCwgJ2RheXMnKS50b0RhdGUoKTsKICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgc3RhcnRUaW1lOiBuZXdTdGFydCwKICAgICAgICAgICAgICAgIGVuZFRpbWU6IG5ld0VuZCwKICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuZmV0Y2hUaW1lc2xvdHMoKTsgfSk7CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5oYW5kbGVUaW1lU2xvdFNlbGVjdCA9IGZ1bmN0aW9uICh0aW1lc2xvdCkgewogICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICBzZWxlY3RlZFRpbWVTbG90OiB0aW1lc2xvdCwKICAgICAgICAgICAgfSk7CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5oYW5kbGVTbG90Q2FuY2VsID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IHNlbGVjdGVkVGltZVNsb3Q6IHVuZGVmaW5lZCB9KTsKICAgICAgICB9OwogICAgICAgIF90aGlzLnJhbmdlQnlEYXRlcyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIF9hID0gX3RoaXMuc3RhdGUsIHN0YXJ0VGltZSA9IF9hLnN0YXJ0VGltZSwgZW5kVGltZSA9IF9hLmVuZFRpbWU7CiAgICAgICAgICAgIHZhciBzdGFydCA9IG1vbWVudChzdGFydFRpbWUpLnN0YXJ0T2YoJ2RheScpOwogICAgICAgICAgICB2YXIgZW5kID0gbW9tZW50KGVuZFRpbWUpOwogICAgICAgICAgICB2YXIga2V5cyA9IFtdOwogICAgICAgICAgICB3aGlsZSAoc3RhcnQgPCBlbmQpIHsKICAgICAgICAgICAgICAgIGtleXMucHVzaChzdGFydC50b1N0cmluZygpKTsKICAgICAgICAgICAgICAgIHN0YXJ0ID0gc3RhcnQuYWRkKDEsICdkYXlzJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGtleXM7CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5yZW5kZXJFcnJvciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIChSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImNhbGVuZGFyLXNjaGVkdWxpbmciIH0sCiAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImhlYWRlciIgfSwKICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogY2xhc3NuYW1lcygndGl0bGUtc2VjdGlvbicsIHsgaGlkZGVuOiB0cnVlIH0pIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAidGl0bGUiIH0sICJDYWxlbmRhciBTY2hlZHVsaW5nIikpLAogICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAiYnJhbmRpbmctc2VjdGlvbiIgfSwKICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJjb3B5IiB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0aXRsZSIgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiR2V0IHlvdXIgb3duIGNhbGVuZGFyIHBhZ2Ugd2l0aCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIHsgY2xhc3NOYW1lOiAiYm9sZGVkIiB9LCAiIFBvbHltYWlsIikpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYSIsIHsgaHJlZjogImh0dHBzOi8vcG9seW1haWwuaW8/dXRtX2NhbXBhaWduPXNjaGVkdWxpbmciLCB0YXJnZXQ6ICJfYmxhbmsiLCBjbGFzc05hbWU6ICJkZXNjcmlwdGlvbiIgfSwgIlRyeSBQb2x5bWFpbCBmb3IgZnJlZSBhbmQgc2NoZWR1bGUgbWVldGluZ3MgZmFzdGVyIikpLAogICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImljb24iIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJhIiwgeyBocmVmOiAiaHR0cHM6Ly9wb2x5bWFpbC5pbz91dG1fY2FtcGFpZ249c2NoZWR1bGluZyIsIHRhcmdldDogIl9ibGFuayIgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJpbWciLCB7IHNyYzogbG9nb05vdGlmaWNhdGlvbiwgaGVpZ2h0OiAiMzBweCIsIHdpZHRoOiAiMzBweCIgfSkpKSkpLAogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChFcnJvclBhZ2UsIG51bGwpKSk7CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5yZW5kZXJUaW1lc2xvdHNFcnJvciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIChSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImNhbGVuZGFyLXNjaGVkdWxpbmciIH0sCiAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImhlYWRlciIgfSwKICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogY2xhc3NuYW1lcygndGl0bGUtc2VjdGlvbicsIHsgaGlkZGVuOiB0cnVlIH0pIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAidGl0bGUiIH0sICJDYWxlbmRhciBTY2hlZHVsaW5nIikpLAogICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAiYnJhbmRpbmctc2VjdGlvbiIgfSwKICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJjb3B5IiB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0aXRsZSIgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiR2V0IHlvdXIgb3duIGNhbGVuZGFyIHBhZ2Ugd2l0aCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIHsgY2xhc3NOYW1lOiAiYm9sZGVkIiB9LCAiIFBvbHltYWlsIikpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYSIsIHsgaHJlZjogImh0dHBzOi8vcG9seW1haWwuaW8/dXRtX2NhbXBhaWduPXNjaGVkdWxpbmciLCB0YXJnZXQ6ICJfYmxhbmsiLCBjbGFzc05hbWU6ICJkZXNjcmlwdGlvbiIgfSwgIlRyeSBQb2x5bWFpbCBmb3IgZnJlZSBhbmQgc2NoZWR1bGUgbWVldGluZ3MgZmFzdGVyIikpLAogICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImljb24iIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJhIiwgeyBocmVmOiAiaHR0cHM6Ly9wb2x5bWFpbC5pbz91dG1fY2FtcGFpZ249c2NoZWR1bGluZyIsIHRhcmdldDogIl9ibGFuayIgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJpbWciLCB7IHNyYzogbG9nb05vdGlmaWNhdGlvbiwgaGVpZ2h0OiAiMzBweCIsIHdpZHRoOiAiMzBweCIgfSkpKSkpLAogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChFcnJvclBhZ2UsIHsgdGl0bGU6ICJXZSByYW4gaW50byBhIHByb2JsZW0gZmV0Y2hpbmcgYXZhaWxhYmlsaXRpZXMiLCBkZXNjcmlwdGlvbjogIlBsZWFzZSB0cnkgYWdhaW4gaW4gYSBmZXcgbWludXRlcyEiIH0pKSk7CiAgICAgICAgfTsKICAgICAgICB2YXIgc3RhcnRUaW1lOwogICAgICAgIHZhciBlbmRUaW1lOwogICAgICAgIGlmIChfdGhpcy5pc01vYmlsZSkgewogICAgICAgICAgICBzdGFydFRpbWUgPSBtb21lbnQoKS5zdGFydE9mKCdkYXknKS50b0RhdGUoKTsKICAgICAgICAgICAgZW5kVGltZSA9IG1vbWVudCgpLmVuZE9mKCdkYXknKS50b0RhdGUoKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHN0YXJ0VGltZSA9IG1vbWVudCgpLnN0YXJ0T2YoJ3dlZWsnKS5zdGFydE9mKCdkYXknKS50b0RhdGUoKTsKICAgICAgICAgICAgZW5kVGltZSA9IG1vbWVudCgpLnN0YXJ0T2YoJ3dlZWsnKS5lbmRPZignZGF5JykuYWRkKDYsICdkYXlzJykudG9EYXRlKCk7CiAgICAgICAgfQogICAgICAgIC8vIEltbWVkaWF0ZWx5IGNhbGN1bGF0ZSBkYXkgcmFuZ2VzCiAgICAgICAgX3RoaXMuc3RhdGUgPSB7CiAgICAgICAgICAgIGR1cmF0aW9uOiAzMCwKICAgICAgICAgICAgc3RhcnRUaW1lOiBzdGFydFRpbWUsCiAgICAgICAgICAgIGVuZFRpbWU6IGVuZFRpbWUsCiAgICAgICAgICAgIHRpbWVzbG90czogW10sCiAgICAgICAgfTsKICAgICAgICBfdGhpcy50aW1lc2xvdHNTdWJqZWN0ID0gbmV3IFN1YmplY3QoKTsKICAgICAgICByZXR1cm4gX3RoaXM7CiAgICB9CiAgICBDYWxlbmRhclNjaGVkdWxpbmcucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50ID0gZnVuY3Rpb24gKCkgewogICAgICAgIGxvZ0FtcGxpdHVkZUV2ZW50KEFtcGxpdHVkZUV2ZW50cy5WaWV3Q2FsZW5kYXJNZWV0aW5nVGltZXMpOwogICAgICAgIHZhciBfYSA9IHRoaXMucHJvcHMsIHVzZXJTbHVnID0gX2EudXNlclNsdWcsIHNsdWcgPSBfYS5zbHVnLCBnZXRQdWJsaWMgPSBfYS5nZXRQdWJsaWM7CiAgICAgICAgZ2V0UHVibGljKHsKICAgICAgICAgICAgdXNlclNsdWc6IHVzZXJTbHVnLAogICAgICAgICAgICBzbHVnOiBzbHVnLAogICAgICAgIH0pOwogICAgfTsKICAgIENhbGVuZGFyU2NoZWR1bGluZy5wcm90b3R5cGUuY29tcG9uZW50RGlkVXBkYXRlID0gZnVuY3Rpb24gKG9sZFByb3BzKSB7CiAgICAgICAgdmFyIF9hID0gdGhpcy5wcm9wcywgbG9hZGluZyA9IF9hLmxvYWRpbmcsIHNjaGVkdWxpbmdQdWJsaWMgPSBfYS5zY2hlZHVsaW5nUHVibGljLCB0aW1lU2xvdHMgPSBfYS50aW1lU2xvdHM7CiAgICAgICAgdmFyIG9sZFRpbWVTbG90cyA9IG9sZFByb3BzLnRpbWVTbG90czsKICAgICAgICBpZiAob2xkUHJvcHMuc2NoZWR1bGluZ1B1YmxpYyAhPT0gdGhpcy5wcm9wcy5zY2hlZHVsaW5nUHVibGljKSB7CiAgICAgICAgICAgIHRoaXMuZmV0Y2hUaW1lc2xvdHMoKTsKICAgICAgICB9CiAgICAgICAgdmFyIHRpbWVzbG90cyA9IGZsYXR0ZW4oT2JqZWN0LnZhbHVlcyh0aGlzLnByb3BzLnRpbWVTbG90cykpLmZpbHRlcihmdW5jdGlvbiAocykgeyByZXR1cm4gIXMuYmxvY2tpbmc7IH0pOwogICAgICAgIGlmICghbG9hZGluZyAmJiAhdGhpcy5pbml0aWFsUmVuZGVyZWQgJiYgISFzY2hlZHVsaW5nUHVibGljICYmIG9sZFRpbWVTbG90cyAhPT0gdGltZVNsb3RzKSB7CiAgICAgICAgICAgIHZhciByZXRyeUF0dGVtcHRzT2sgPSB0aGlzLnJldHJ5QXR0ZW1wdHMgPCBNQVhfUkVUUllfQVRURU1QVFM7CiAgICAgICAgICAgIGlmICh0aW1lc2xvdHMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgICAgICBpZiAoIXJldHJ5QXR0ZW1wdHNPaykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5pdGlhbFJlbmRlcmVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlU2Nyb2xsRm9yd2FyZCgpOwogICAgICAgICAgICAgICAgdGhpcy5yZXRyeUF0dGVtcHRzID0gdGhpcy5yZXRyeUF0dGVtcHRzICsgMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIHRoaXMuaW5pdGlhbFJlbmRlcmVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHRoaXMucmV0cnlBdHRlbXB0cyA9IDA7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9OwogICAgQ2FsZW5kYXJTY2hlZHVsaW5nLnByb3RvdHlwZS5jb21wb25lbnRXaWxsVW5tb3VudCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB0aGlzLnRpbWVzbG90c1N1YmplY3QudW5zdWJzY3JpYmUoKTsKICAgIH07CiAgICBDYWxlbmRhclNjaGVkdWxpbmcucHJvdG90eXBlLnJlbmRlck1haW4gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgICB2YXIgX2EgPSB0aGlzLnByb3BzLCB0aW1lU2xvdHMgPSBfYS50aW1lU2xvdHMsIHNjaGVkdWxpbmdQdWJsaWMgPSBfYS5zY2hlZHVsaW5nUHVibGljOwogICAgICAgIHZhciBzY2hlZHVsaW5nUHVibGljRGF0YSA9IHNjaGVkdWxpbmdQdWJsaWMgJiYgc2NoZWR1bGluZ1B1YmxpYy5kYXRhOwogICAgICAgIHZhciBub1RpbWVzbG90cyA9IGZsYXR0ZW4odmFsdWVzKHRpbWVTbG90cykpLmZpbHRlcihmdW5jdGlvbiAocykgeyByZXR1cm4gIXMuYmxvY2tpbmc7IH0pLmxlbmd0aCA9PT0gMDsKICAgICAgICB2YXIgYXJyYXlPZkRhdGVzID0gdGhpcy5yYW5nZUJ5RGF0ZXMoKTsKICAgICAgICB2YXIgZmlsdGVyZWRUaW1lU2xvdHMgPSBwaWNrQnkodGltZVNsb3RzLCAoZnVuY3Rpb24gKHZhbHVlLCBrZXkpIHsKICAgICAgICAgICAgcmV0dXJuIGFycmF5T2ZEYXRlcy5pbmRleE9mKGtleSkgIT09IC0xOwogICAgICAgIH0pKTsKICAgICAgICB2YXIgYWxsVGltZVNsb3RzID0gZmxhdHRlbihPYmplY3QudmFsdWVzKGZpbHRlcmVkVGltZVNsb3RzKSk7CiAgICAgICAgLy8gQ2FsY3VsYXRlIHdoaWNoIHRpbWVzIGFyZSBjb21wbGV0ZWx5IGVtcHR5IGZvciBhbGwgZGF0ZXMKICAgICAgICB2YXIgaWdub3JlU3RhcnRDb3VudHMgPSBhbGxUaW1lU2xvdHMucmVkdWNlKGZ1bmN0aW9uIChzdW1tYXJ5LCBuZXh0KSB7CiAgICAgICAgICAgIHZhciBzdGFydFRpbWVTdHJpbmcgPSBtb21lbnQobmV4dC5zdGFydFRpbWUpLmZvcm1hdCgnSEhtbScpOwogICAgICAgICAgICBpZiAoIW5leHQuYmxvY2tpbmcpIHsKICAgICAgICAgICAgICAgIHJldHVybiBzdW1tYXJ5OwogICAgICAgICAgICB9CiAgICAgICAgICAgIHN1bW1hcnlbc3RhcnRUaW1lU3RyaW5nXSA9IChzdW1tYXJ5W3N0YXJ0VGltZVN0cmluZ10gfHwgMCkgKyAxOwogICAgICAgICAgICByZXR1cm4gc3VtbWFyeTsKICAgICAgICB9LCB7fSk7CiAgICAgICAgdmFyIGRheXNDb2xsZWN0ZWQgPSBPYmplY3Qua2V5cyh0aW1lU2xvdHMpLmxlbmd0aDsKICAgICAgICB2YXIgaWdub3JlVGltZXMgPSBwaWNrQnkoaWdub3JlU3RhcnRDb3VudHMsIGZ1bmN0aW9uICh2YWwsIGtleSkgewogICAgICAgICAgICByZXR1cm4gdmFsID09PSBkYXlzQ29sbGVjdGVkICYmIHZhbCA+IDA7CiAgICAgICAgfSk7CiAgICAgICAgdmFyIGxvbmdlc3RTbG90cyA9IHZhbHVlcyhmaWx0ZXJlZFRpbWVTbG90cykuc29ydChmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gYi5sZW5ndGggLSBhLmxlbmd0aDsgfSlbMF07CiAgICAgICAgdmFyIGxvbmdlc3RDb2x1bW5TbG90TGVuZ3RoID0gbG9uZ2VzdFNsb3RzICYmIGxvbmdlc3RTbG90cy5sZW5ndGggfHwgMTsKICAgICAgICB2YXIgY29sdW1uSGVpZ2h0ID0gKCg3NSAqIChsb25nZXN0Q29sdW1uU2xvdExlbmd0aCArIDEpKSArIDkpOwogICAgICAgIHZhciBjYWxlbmRhck5hbWUgPSBzY2hlZHVsaW5nUHVibGljRGF0YSAmJiBzY2hlZHVsaW5nUHVibGljRGF0YS5ldmVudE5hbWU7CiAgICAgICAgdmFyIHRpbWVab25lID0gbW9tZW50LnR6Lmd1ZXNzKCk7CiAgICAgICAgdmFyIG9yZ2FuaXplck5hbWUgPSBzY2hlZHVsaW5nUHVibGljRGF0YSAmJiBzY2hlZHVsaW5nUHVibGljRGF0YS5vcmdhbml6ZXJOYW1lIHx8ICcnOwogICAgICAgIHZhciBhYmJyZXZpYXRpb24gPSB0aW1lWm9uZSAmJiBtb21lbnQudHoodGltZVpvbmUpLmZvcm1hdCgneicpOwogICAgICAgIHZhciBkYXlzVG9GZXRjaCA9IHRoaXMuaXNNb2JpbGUgPyAxIDogNzsKICAgICAgICB2YXIgYWxsb3dCYWNrID0gbW9tZW50KHRoaXMuc3RhdGUuZW5kVGltZSkuc3VidHJhY3QoZGF5c1RvRmV0Y2gsICdkYXlzJykgPiBtb21lbnQoKTsKICAgICAgICB2YXIgYWxsb3dGb3J3YXJkID0gc2NoZWR1bGluZ1B1YmxpY0RhdGEgJiYKICAgICAgICAgICAgbW9tZW50KCkuYWRkKHNjaGVkdWxpbmdQdWJsaWNEYXRhLnJvbGxpbmdEYXlzLCAnZGF5cycpID4KICAgICAgICAgICAgICAgIG1vbWVudCh0aGlzLnN0YXRlLnN0YXJ0VGltZSkuYWRkKGRheXNUb0ZldGNoLCAnZGF5cycpIHx8IGZhbHNlOwogICAgICAgIHZhciBtb250aEtleXMgPSB7fTsKICAgICAgICB2YXIgZmlyc3RPZk1vbnRocyA9IE9iamVjdC5rZXlzKHRpbWVTbG90cykucmVkdWNlKGZ1bmN0aW9uIChkaWN0LCBkYXRlKSB7CiAgICAgICAgICAgIHZhciBtb250aFN0cmluZyA9IG1vbWVudChkYXRlKS5tb250aCgpOwogICAgICAgICAgICBpZiAoIW1vbnRoS2V5c1ttb250aFN0cmluZ10pIHsKICAgICAgICAgICAgICAgIGRpY3RbZGF0ZV0gPSB0cnVlOwogICAgICAgICAgICAgICAgbW9udGhLZXlzW21vbnRoU3RyaW5nXSA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBkaWN0W2RhdGVdID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGRpY3Q7CiAgICAgICAgfSwge30pOwogICAgICAgIHJldHVybiAoUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJjYWxlbmRhci1zY2hlZHVsaW5nIiB9LAogICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImhlYWRlciIgfSwKICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiBjbGFzc25hbWVzKCd0aXRsZS1zZWN0aW9uJywgeyBoaWRkZW46ICFzY2hlZHVsaW5nUHVibGljIH0pIH0sCiAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0aXRsZSIgfSwgb3JnYW5pemVyTmFtZSArICIncyBDYWxlbmRhcjogIiwKICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIHsgY2xhc3NOYW1lOiAiY2FsZW5kYXItbmFtZSIgfSwgY2FsZW5kYXJOYW1lKSksCiAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJkZXNjcmlwdGlvbiIgfSwgIlRvIGJvb2sgYSBtZWV0aW5nIHdpdGggbWUsIHBsZWFzZSBjaG9vc2UgYSB0aW1lIGJlbG93LiIpKSwKICAgICAgICAgICAgICAgIHNjaGVkdWxpbmdQdWJsaWNEYXRhICYmICFzY2hlZHVsaW5nUHVibGljRGF0YS5oaWRlQnJhbmRpbmcgJiYKICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImJyYW5kaW5nLXNlY3Rpb24iIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAiY29weSIgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAidGl0bGUiIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkdldCB5b3VyIG93biBjYWxlbmRhciBwYWdlIHdpdGgiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCB7IGNsYXNzTmFtZTogImJvbGRlZCIgfSwgIiBQb2x5bWFpbCIpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImEiLCB7IGhyZWY6ICJodHRwczovL3BvbHltYWlsLmlvP3V0bV9jYW1wYWlnbj1zY2hlZHVsaW5nIiwgdGFyZ2V0OiAiX2JsYW5rIiwgY2xhc3NOYW1lOiAiZGVzY3JpcHRpb24iIH0sICJUcnkgUG9seW1haWwgZm9yIGZyZWUgYW5kIHNjaGVkdWxlIG1lZXRpbmdzIGZhc3RlciIpKSwKICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJpY29uIiB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYSIsIHsgaHJlZjogImh0dHBzOi8vcG9seW1haWwuaW8/dXRtX2NhbXBhaWduPXNjaGVkdWxpbmciLCB0YXJnZXQ6ICJfYmxhbmsiIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiaW1nIiwgeyBzcmM6IGxvZ29Ob3RpZmljYXRpb24sIGhlaWdodDogIjMwcHgiLCB3aWR0aDogIjMwcHgiIH0pKSkpKSwKICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0aW1lem9uZSIgfSwKICAgICAgICAgICAgICAgIGFiYnJldmlhdGlvbiwKICAgICAgICAgICAgICAgICIgLSAiLAogICAgICAgICAgICAgICAgdGltZVpvbmUgJiYgdGltZVpvbmUucmVwbGFjZSgnXycsICcgJykpLAogICAgICAgICAgICBzY2hlZHVsaW5nUHVibGljRGF0YSAmJgogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJjb2x1bW5zIiB9LAogICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMubG9hZGluZyAmJgogICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImNhbGVuZGFyLWxvYWRpbmciIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KEN1c3RvbUxvYWRlciwgeyB0eXBlOiAibGluZS1zY2FsZS1wdWxzZS1vdXQtcmFwaWQiLCBpbm5lckNsYXNzTmFtZTogImN1c3RvbS1sb2FkZXItaW5uZXIiLCBhY3RpdmU6IHRydWUgfSkpLAogICAgICAgICAgICAgICAgICAgICF0aGlzLnByb3BzLmxvYWRpbmcgJiYgbm9UaW1lc2xvdHMgJiYKICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJjYWxlbmRhci1lbXB0eSIgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAidGl0bGUiIH0sICJObyBtZWV0aW5nIHRpbWVzIGF2YWlsYWJsZSBmb3IgdGhpcyB3ZWVrIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImRlc2NyaXB0aW9uIiB9LCAiVHJ5IGNoZWNraW5nIGF2YWlsYWJpbGl0aWVzIGZvciBuZXh0IHdlZWsiKSksCiAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChTY2hlZHVsaW5nQ29sdW1uU2Nyb2xsLCB7IG1vdmVGb3J3YXJkOiBmYWxzZSwgaGVpZ2h0OiBjb2x1bW5IZWlnaHQsIG9uQ2xpY2s6IHRoaXMuaGFuZGxlU2Nyb2xsQmFja3dhcmQsIGRpc2FibGVkOiAhYWxsb3dCYWNrIH0pLAogICAgICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKGZpbHRlcmVkVGltZVNsb3RzKS5tYXAoZnVuY3Rpb24gKGtleSkgeyByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoU2NoZWR1bGluZ0NvbHVtbiwgeyBrZXk6IGtleSwgbW9udGg6IG1vbWVudChrZXkpLmZvcm1hdCgnTU1NTScpLCB3ZWVrZGF5OiBtb21lbnQoa2V5KS5mb3JtYXQoJ2RkZGQnKSwgZGF5OiBwYXJzZUludChtb21lbnQoa2V5KS5mb3JtYXQoJ0QnKSwgMTApLCBoaWRlTW9udGg6ICFmaXJzdE9mTW9udGhzW2tleV0sIHRpbWVzbG90czogZmlsdGVyZWRUaW1lU2xvdHNba2V5XSwgZHVyYXRpb246IHNjaGVkdWxpbmdQdWJsaWNEYXRhLmR1cmF0aW9uTWludXRlcywgaGVpZ2h0OiBjb2x1bW5IZWlnaHQsIGhpZGVUaW1lczogaWdub3JlVGltZXMsIG9uU2VsZWN0OiBfdGhpcy5oYW5kbGVUaW1lU2xvdFNlbGVjdCB9KSk7IH0pLAogICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoU2NoZWR1bGluZ0NvbHVtblNjcm9sbCwgeyBtb3ZlRm9yd2FyZDogdHJ1ZSwgaGVpZ2h0OiBjb2x1bW5IZWlnaHQsIG9uQ2xpY2s6IHRoaXMuaGFuZGxlU2Nyb2xsRm9yd2FyZCwgZGlzYWJsZWQ6ICFhbGxvd0ZvcndhcmQgfSkpKSk7CiAgICB9OwogICAgQ2FsZW5kYXJTY2hlZHVsaW5nLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIF9hID0gdGhpcy5wcm9wcywgc2NoZWR1bGluZ1B1YmxpYyA9IF9hLnNjaGVkdWxpbmdQdWJsaWMsIGNyZWF0ZWRFdmVudCA9IF9hLmNyZWF0ZWRFdmVudCwgdXNlclNsdWcgPSBfYS51c2VyU2x1Zywgc2x1ZyA9IF9hLnNsdWcsIHRpbWVzbG90c0Vycm9yID0gX2EudGltZXNsb3RzRXJyb3I7CiAgICAgICAgdmFyIHNlbGVjdGVkVGltZVNsb3QgPSB0aGlzLnN0YXRlLnNlbGVjdGVkVGltZVNsb3Q7CiAgICAgICAgdmFyIHNjaGVkdWxpbmdQdWJsaWNEYXRhID0gc2NoZWR1bGluZ1B1YmxpYyAmJiBzY2hlZHVsaW5nUHVibGljLmRhdGE7CiAgICAgICAgLy8gUmVuZGVyIGZvciBFcnJvciBQYWdlCiAgICAgICAgaWYgKHNjaGVkdWxpbmdQdWJsaWMgJiYgc2NoZWR1bGluZ1B1YmxpYy5lcnJvcikgewogICAgICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXJFcnJvcigpOwogICAgICAgIH0KICAgICAgICAvLyBSZW5kZXIgdGltZXNsb3RzIGVycm9yCiAgICAgICAgaWYgKHRpbWVzbG90c0Vycm9yKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbmRlclRpbWVzbG90c0Vycm9yKCk7CiAgICAgICAgfQogICAgICAgIC8vIFJlbmRlcnMgZm9yIENvbmZpcm1hdGlvbiBhbmQgZGV0YWlsIHBhZ2UKICAgICAgICBpZiAoISFzZWxlY3RlZFRpbWVTbG90ICYmIHNjaGVkdWxpbmdQdWJsaWNEYXRhKSB7CiAgICAgICAgICAgIGlmIChjcmVhdGVkRXZlbnQgJiYgY3JlYXRlZEV2ZW50LmRhdGEpIHsKICAgICAgICAgICAgICAgIHJldHVybiAoUmVhY3QuY3JlYXRlRWxlbWVudChTY2hlZHVsaW5nQ29uZmlybWF0aW9uLCB7IHNjaGVkdWxpbmdQdWJsaWM6IHNjaGVkdWxpbmdQdWJsaWNEYXRhLCB0aW1lU2xvdDogc2VsZWN0ZWRUaW1lU2xvdCwgZXZlbnQ6IGNyZWF0ZWRFdmVudC5kYXRhIH0pKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoQ2FsZW5kYXJTY2hlZHVsaW5nRGV0YWlsLCB7IHVzZXJTbHVnOiB1c2VyU2x1Zywgc2x1Zzogc2x1Zywgc2NoZWR1bGluZ1B1YmxpYzogc2NoZWR1bGluZ1B1YmxpY0RhdGEsIHRpbWVTbG90OiBzZWxlY3RlZFRpbWVTbG90LCBvbkNhbmNlbDogdGhpcy5oYW5kbGVTbG90Q2FuY2VsLCBjcmVhdGlvbkVycm9yOiBjcmVhdGVkRXZlbnQgJiYgY3JlYXRlZEV2ZW50LmVycm9yLCBwZW5kaW5nUmVxdWVzdDogY3JlYXRlZEV2ZW50ICYmIGNyZWF0ZWRFdmVudC5zdGF0dXMgPT09IFJlc291cmNlU3RhdHVzLlBlbmRpbmcgfSkpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXJNYWluKCk7CiAgICB9OwogICAgcmV0dXJuIENhbGVuZGFyU2NoZWR1bGluZzsKfShSZWFjdC5QdXJlQ29tcG9uZW50KSk7CmV4cG9ydCBkZWZhdWx0IENhbGVuZGFyU2NoZWR1bGluZzsK"},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/CalendarScheduling/CalendarScheduling.tsx","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/CalendarScheduling/CalendarScheduling.tsx"],"names":[],"mappings":"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","sourcesContent":["import React from 'react';\nimport moment from 'moment-timezone';\nimport CustomLoader from 'react-loaders';\nimport classnames from 'classnames';\n\nimport './CalendarScheduling.scss';\nimport { SchedulingPublic, TimeSlot } from '@src/types/scheduling';\n\n// tslint:disable-next-line:max-line-length\nimport SchedulingColumnScroll from '@src/routes/CalendarScheduling/components/SchedulingColumnScroll';\nimport SchedulingColumn from '@src/routes/CalendarScheduling/components/SchedulingColumn';\nimport { values, pickBy, flatten } from 'lodash';\n// tslint:disable-next-line:max-line-length\nimport CalendarSchedulingDetail from '@src/routes/CalendarScheduling/components/CalendarSchedulingDetail';\nimport { Subject } from 'rxjs';\nimport { TimeSlotMeta, SchedulingPublicMeta } from '@src/ducks/scheduling';\n// tslint:disable-next-line:max-line-length\nimport SchedulingConfirmation from '@src/routes/CalendarScheduling/components/SchedulingConfirmation';\nimport { Resource, CalendarEvent, ResourceStatus } from '@src/types';\nimport ErrorPage from '@src/components/Base/ErrorPage';\nimport logoNotification from '@src/components/Icons/LogoNotification@3x.png';\nimport { RouteComponentProps } from 'react-router';\nimport { AmplitudeEvents, logAmplitudeEvent } from '@src/lib/amplitude-analytics';\n\nexport interface StateProps {\n  userSlug: string;\n  slug: string;\n  loading: boolean;\n  timeSlots: {\n    [dayString: string]: TimeSlot[];\n  };\n  createdEvent?: Resource<CalendarEvent>;\n  schedulingPublic?: Resource<SchedulingPublic>;\n  timeslotsError?: boolean;\n}\n\nexport interface DispatchProps {\n  fetchTimeSlots: (meta: TimeSlotMeta) => void;\n  getPublic: (meta: SchedulingPublicMeta) => void;\n}\n\ninterface State {\n  duration: number;\n  startTime: Date;\n  endTime: Date;\n  timeslots: TimeSlot[];\n  selectedTimeSlot?: TimeSlot;\n}\n\nconst MAX_RETRY_ATTEMPTS = 3;\n\n// TODO(SHIN): Implement DispatchProps for fetching next set of dates. Or do this inside component\n// TODO(SHIN): Handle cancelling calls for additional timeslots\n// TODO(SHIN): Handle caching of data when scrolling through dates quickly\n// TODO(SHIN): Get Scheduling Public from routes once new url config is brought in\n// TODO(SHIN): Remove Scheduling fetch to replace with route fetch based off of props\n// TODO(SHIN): Make sure that different timezones display properly\nclass CalendarScheduling extends React.PureComponent<\n  StateProps & DispatchProps & RouteComponentProps<any>, State\n> {\n  timeslotsSubject: Subject<boolean>;\n  isMobile = window.innerWidth < 480;\n\n  retryAttempts = 0;\n  initialRendered = false;\n\n  constructor() {\n    super();\n\n    let startTime: Date;\n    let endTime: Date;\n\n    if (this.isMobile) {\n      startTime = moment().startOf('day').toDate();\n      endTime = moment().endOf('day').toDate();\n    } else {\n      startTime = moment().startOf('week').startOf('day').toDate();\n      endTime = moment().startOf('week').endOf('day').add(6, 'days').toDate();\n    }\n\n    // Immediately calculate day ranges\n    this.state = {\n      duration: 30,\n      startTime,\n      endTime,\n      timeslots: [],\n    };\n\n    this.timeslotsSubject = new Subject();\n  }\n\n  componentDidMount() {\n    logAmplitudeEvent(AmplitudeEvents.ViewCalendarMeetingTimes);\n    const { userSlug, slug, getPublic } = this.props;\n    getPublic({\n      userSlug,\n      slug,\n    });\n  }\n\n  componentDidUpdate(oldProps: StateProps) {\n    const { loading, schedulingPublic, timeSlots } = this.props;\n    const oldTimeSlots = oldProps.timeSlots;\n    if (oldProps.schedulingPublic !== this.props.schedulingPublic) {\n      this.fetchTimeslots();\n    }\n\n    const timeslots = flatten(Object.values(this.props.timeSlots)).filter(s => !s.blocking);\n    if (!loading && !this.initialRendered && !!schedulingPublic && oldTimeSlots !== timeSlots) {\n      const retryAttemptsOk = this.retryAttempts < MAX_RETRY_ATTEMPTS;\n      if (timeslots.length === 0) {\n        if (!retryAttemptsOk) {\n          this.initialRendered = true;\n        }\n\n        this.handleScrollForward();\n        this.retryAttempts = this.retryAttempts + 1;\n\n      } else {\n        this.initialRendered = true;\n        this.retryAttempts = 0;\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    this.timeslotsSubject.unsubscribe();\n  }\n\n  fetchTimeslots = () => {\n    const { schedulingPublic, fetchTimeSlots } = this.props;\n\n    if (schedulingPublic && schedulingPublic.data) {\n      fetchTimeSlots({\n        start: this.state.startTime,\n        end: this.state.endTime,\n        userSlug: this.props.userSlug,\n        slug: this.props.slug,\n      });\n    }\n  }\n\n  handleScrollForward = () => {\n    const daysToFetch = this.isMobile ? 1 : 7;\n    const newStart = moment(this.state.startTime)\n      .startOf('day').add(daysToFetch, 'days').toDate();\n    const newEnd = moment(this.state.endTime)\n      .endOf('day').add(daysToFetch, 'days').toDate();\n    this.setState(\n      {\n        startTime: newStart,\n        endTime: newEnd,\n      },\n      () => this.fetchTimeslots(),\n    );\n  }\n\n  handleScrollBackward = () => {\n    const daysToFetch = this.isMobile ? 1 : 7;\n    const newStart = moment(this.state.startTime)\n      .startOf('day').subtract(daysToFetch, 'days').toDate();\n    const newEnd = moment(this.state.endTime)\n      .endOf('day').subtract(daysToFetch, 'days').toDate();\n    this.setState(\n      {\n        startTime: newStart,\n        endTime: newEnd,\n      },\n      () => this.fetchTimeslots(),\n    );\n  }\n\n  handleTimeSlotSelect = (timeslot: TimeSlot) => {\n    this.setState({\n      selectedTimeSlot: timeslot,\n    });\n  }\n\n  handleSlotCancel = () => {\n    this.setState({ selectedTimeSlot: undefined });\n  }\n\n  rangeByDates = (): string[] => {\n    const { startTime, endTime } = this.state;\n    let start = moment(startTime).startOf('day');\n    const end = moment(endTime);\n    const keys = [];\n    while (start < end) {\n      keys.push(start.toString());\n      start = start.add(1, 'days');\n    }\n\n    return keys;\n  }\n\n  renderMain() {\n    const { timeSlots, schedulingPublic } = this.props;\n    const schedulingPublicData = schedulingPublic && schedulingPublic.data;\n\n    const noTimeslots = flatten(values(timeSlots)).filter(s => !s.blocking).length === 0;\n    const arrayOfDates = this.rangeByDates();\n    const filteredTimeSlots: { [key: string]: TimeSlot[] } = pickBy(timeSlots, ((value, key) => {\n      return arrayOfDates.indexOf(key) !== -1;\n    }));\n\n    const allTimeSlots = flatten(Object.values(filteredTimeSlots));\n\n    // Calculate which times are completely empty for all dates\n    const ignoreStartCounts: { [key: string]: number } = allTimeSlots.reduce(\n      (summary, next) => {\n        const startTimeString = moment(next.startTime).format('HHmm');\n        if (!next.blocking) {\n          return summary;\n        }\n\n        summary[startTimeString] = (summary[startTimeString] || 0) + 1;\n        return summary;\n      },\n      {},\n    );\n    const daysCollected = Object.keys(timeSlots).length;\n    const ignoreTimes: { [key: string]: number } = pickBy(ignoreStartCounts, (val, key) => {\n      return val === daysCollected && val > 0;\n    });\n\n    const longestSlots = values(filteredTimeSlots).sort((a, b) => b.length - a.length)[0];\n    const longestColumnSlotLength = longestSlots && longestSlots.length || 1;\n    const columnHeight = ((75 * (longestColumnSlotLength + 1)) + 9);\n\n    const calendarName = schedulingPublicData && schedulingPublicData.eventName;\n    const timeZone = moment.tz.guess();\n    const organizerName = schedulingPublicData && schedulingPublicData.organizerName || '';\n    const abbreviation = timeZone && moment.tz(timeZone).format('z');\n\n    const daysToFetch = this.isMobile ? 1 : 7;\n    const allowBack = moment(this.state.endTime).subtract(daysToFetch, 'days') > moment();\n    const allowForward = schedulingPublicData &&\n      moment().add(schedulingPublicData.rollingDays, 'days') >\n      moment(this.state.startTime).add(daysToFetch, 'days') || false;\n\n    const monthKeys: { [key: string]: boolean } = {};\n    const firstOfMonths = Object.keys(timeSlots).reduce(\n      (dict, date) => {\n        const monthString = moment(date).month();\n        if (!monthKeys[monthString]) {\n          dict[date] = true;\n          monthKeys[monthString] = true;\n        } else {\n          dict[date] = false;\n        }\n        return dict;\n      },\n      {},\n    );\n\n    return (\n      <div className=\"calendar-scheduling\">\n        <div className=\"header\">\n          <div\n            className={classnames('title-section', { hidden: !schedulingPublic })}\n          >\n            <div className=\"title\">\n              {`${organizerName}'s Calendar: `}\n              <span className=\"calendar-name\">\n                {calendarName}\n              </span>\n            </div>\n            <div className=\"description\">\n              To book a meeting with me, please choose a time below.\n            </div>\n          </div>\n          {schedulingPublicData && !schedulingPublicData.hideBranding &&\n            <div className=\"branding-section\">\n              <div className=\"copy\">\n                <div className=\"title\">\n                  Get your own calendar page with\n                  <span className=\"bolded\"> Polymail</span>\n                </div>\n                <a\n                  href=\"https://polymail.io?utm_campaign=scheduling\"\n                  target=\"_blank\"\n                  className=\"description\"\n                >\n                  Try Polymail for free and schedule meetings faster\n                </a>\n              </div>\n              <div className=\"icon\">\n                <a href=\"https://polymail.io?utm_campaign=scheduling\" target=\"_blank\">\n                  <img src={logoNotification} height=\"30px\" width=\"30px\" />\n                </a>\n              </div>\n            </div>\n          }\n        </div>\n        <div className=\"timezone\">\n          {abbreviation} - {timeZone && timeZone.replace('_', ' ')}\n        </div>\n        {schedulingPublicData &&\n          <div className=\"columns\">\n            {this.props.loading &&\n              <div className=\"calendar-loading\">\n                <CustomLoader\n                  type=\"line-scale-pulse-out-rapid\"\n                  innerClassName=\"custom-loader-inner\"\n                  active\n                />\n              </div>\n            }\n            {!this.props.loading && noTimeslots &&\n              <div className=\"calendar-empty\">\n                <div className=\"title\">\n                  No meeting times available for this week\n                </div>\n                <div className=\"description\">\n                  Try checking availabilities for next week\n                </div>\n              </div>\n            }\n            <SchedulingColumnScroll\n              moveForward={false}\n              height={columnHeight}\n              onClick={this.handleScrollBackward}\n              disabled={!allowBack}\n            />\n            {Object.keys(filteredTimeSlots).map(key => (\n              <SchedulingColumn\n                key={key}\n                month={moment(key).format('MMMM')}\n                weekday={moment(key).format('dddd')}\n                day={parseInt(moment(key).format('D'), 10)}\n                hideMonth={!firstOfMonths[key]}\n                timeslots={filteredTimeSlots[key]}\n                duration={schedulingPublicData.durationMinutes}\n                height={columnHeight}\n                hideTimes={ignoreTimes}\n                onSelect={this.handleTimeSlotSelect}\n              />\n            ))}\n            <SchedulingColumnScroll\n              moveForward={true}\n              height={columnHeight}\n              onClick={this.handleScrollForward}\n              disabled={!allowForward}\n            />\n          </div>}\n      </div>\n    );\n  }\n\n  renderError = () => {\n    return (\n      <div className=\"calendar-scheduling\">\n        <div className=\"header\">\n          <div\n            className={classnames('title-section', { hidden: true })}\n          >\n            <div className=\"title\">\n              Calendar Scheduling\n          </div>\n          </div>\n          <div className=\"branding-section\">\n            <div className=\"copy\">\n              <div className=\"title\">\n                Get your own calendar page with\n                  <span className=\"bolded\"> Polymail</span>\n              </div>\n              <a\n                href=\"https://polymail.io?utm_campaign=scheduling\"\n                target=\"_blank\"\n                className=\"description\"\n              >\n                Try Polymail for free and schedule meetings faster\n              </a>\n            </div>\n            <div className=\"icon\">\n              <a href=\"https://polymail.io?utm_campaign=scheduling\" target=\"_blank\">\n                <img src={logoNotification} height=\"30px\" width=\"30px\" />\n              </a>\n            </div>\n          </div>\n        </div>\n        <ErrorPage />\n      </div>\n    );\n  }\n\n  renderTimeslotsError = () => {\n    return (\n      <div className=\"calendar-scheduling\">\n        <div className=\"header\">\n          <div\n            className={classnames('title-section', { hidden: true })}\n          >\n            <div className=\"title\">\n              Calendar Scheduling\n          </div>\n          </div>\n          <div className=\"branding-section\">\n            <div className=\"copy\">\n              <div className=\"title\">\n                Get your own calendar page with\n                  <span className=\"bolded\"> Polymail</span>\n              </div>\n              <a\n                href=\"https://polymail.io?utm_campaign=scheduling\"\n                target=\"_blank\"\n                className=\"description\"\n              >\n                Try Polymail for free and schedule meetings faster\n              </a>\n            </div>\n            <div className=\"icon\">\n              <a href=\"https://polymail.io?utm_campaign=scheduling\" target=\"_blank\">\n                <img src={logoNotification} height=\"30px\" width=\"30px\" />\n              </a>\n            </div>\n          </div>\n        </div>\n        <ErrorPage\n          title=\"We ran into a problem fetching availabilities\"\n          description=\"Please try again in a few minutes!\"\n        />\n      </div>\n    );\n  }\n\n  render() {\n    const { schedulingPublic, createdEvent, userSlug, slug, timeslotsError } = this.props;\n    const { selectedTimeSlot } = this.state;\n    const schedulingPublicData = schedulingPublic && schedulingPublic.data;\n\n    // Render for Error Page\n    if (schedulingPublic && schedulingPublic.error) {\n      return this.renderError();\n    }\n\n    // Render timeslots error\n    if (timeslotsError) {\n      return this.renderTimeslotsError();\n    }\n\n    // Renders for Confirmation and detail page\n    if (!!selectedTimeSlot && schedulingPublicData) {\n      if (createdEvent && createdEvent.data) {\n        return (\n          <SchedulingConfirmation\n            schedulingPublic={schedulingPublicData}\n            timeSlot={selectedTimeSlot}\n            event={createdEvent.data}\n          />\n        );\n      }\n\n      return (\n        <CalendarSchedulingDetail\n          userSlug={userSlug}\n          slug={slug}\n          schedulingPublic={schedulingPublicData}\n          timeSlot={selectedTimeSlot}\n          onCancel={this.handleSlotCancel}\n          creationError={createdEvent && createdEvent.error}\n          pendingRequest={createdEvent && createdEvent.status === ResourceStatus.Pending}\n        />\n      );\n    }\n\n    return this.renderMain();\n  }\n}\n\nexport default CalendarScheduling;\n"]}]}