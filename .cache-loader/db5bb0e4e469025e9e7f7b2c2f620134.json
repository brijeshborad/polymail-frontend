{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Mentions/Mentions.tsx","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Mentions/Mentions.tsx","mtime":1675280254081},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewogICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewogICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAogICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKICAgIH07CiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwogICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQogICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKICAgIH07Cn0pKCk7CnZhciBfX2Fzc2lnbiA9ICh0aGlzICYmIHRoaXMuX19hc3NpZ24pIHx8IGZ1bmN0aW9uICgpIHsKICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbih0KSB7CiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7CiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07CiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkKICAgICAgICAgICAgICAgIHRbcF0gPSBzW3BdOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdDsKICAgIH07CiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfTsKaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JzsKaW1wb3J0IExlZnRTaWRlYmFyIGZyb20gJ0BzcmMvY29tcG9uZW50cy9MZWZ0U2lkZWJhcic7CmltcG9ydCB7IFBhZ2UsIFJpZ2h0U2lkZWJhclRhYiB9IGZyb20gJ0BzcmMvdHlwZXMvcmlnaHRTaWRlYmFyJzsKaW1wb3J0IFJpZ2h0U2lkZWJhciBmcm9tICdAc3JjL2NvbXBvbmVudHMvUmlnaHRTaWRlYmFyJzsKaW1wb3J0ICcuL01lbnRpb25zLnNjc3MnOwppbXBvcnQgU2hhcmVkVGhyZWFkTGlzdCBmcm9tICcuL2NvbXBvbmVudHMvU2hhcmVkVGhyZWFkTGlzdCc7CmltcG9ydCBUaHJlYWREZXRhaWwgZnJvbSAnQHNyYy9jb21wb25lbnRzL1RocmVhZERldGFpbCc7CmltcG9ydCB7IE5hdmJhclRhYiB9IGZyb20gJ0BzcmMvdHlwZXMvbGVmdFNpZGViYXInOwppbXBvcnQgU2hhcmVkVGhyZWFkc09uYm9hcmRpbmcgZnJvbSAnLi9jb21wb25lbnRzL1NoYXJlZFRocmVhZHNPbmJvYXJkaW5nL1NoYXJlZFRocmVhZHNPbmJvYXJkaW5nJzsKaW1wb3J0IHsgVGhyZWFkQm94LCBLZXlDb2RlLCBDb21tYW5kQ29udHJvbFR5cGUsIE1haWxib3hUeXBlLCBVbnN1YnNjcmliZUJlaGF2aW9yLCBCbG9ja0NvbnRhY3RBY3Rpb25UeXBlLCB9IGZyb20gJ0BzcmMvdHlwZXMnOwppbXBvcnQgeyBIb3RrZXlBY3Rpb24sIGdldEhvdGtleSwgY2hlY2tOZXh0SG90a2V5Q2hhbmdlLCB9IGZyb20gJ0BzcmMvbGliL2hvdGtleXMnOwppbXBvcnQgQ29tbWFuZENvbnRyb2wgZnJvbSAnQHNyYy9jb21wb25lbnRzL0NvbW1hbmRDb250cm9sJzsKaW1wb3J0IGJyb3dzZXJIaXN0b3J5IGZyb20gJ0BzcmMvbGliL2Jyb3dzZXJIaXN0b3J5JzsKaW1wb3J0IHsgcmVjb3JkRXZlbnQsIFVzZXJFdmVudHMgfSBmcm9tICdAc3JjL2xpYi9hbmFseXRpY3MnOwppbXBvcnQgeyBob3RrZXlVcGRhdGUgfSBmcm9tICdAc3JjL2R1Y2tzL2hvdGtleXMnOwppbXBvcnQgVG9hc3QgZnJvbSAnQHNyYy9jb21wb25lbnRzL0Jhc2UvVG9hc3QnOwppbXBvcnQgeyBTaGFyZWRUaHJlYWRzTW9kZSB9IGZyb20gJ0BzcmMvdHlwZXMvc2hhcmVkVGhyZWFkcyc7CmltcG9ydCB7IGZpbHRlckRlbGV0ZSwgZmlsdGVyU2V0LCBmaWx0ZXJCbG9ja0NyZWF0ZSB9IGZyb20gJ0BzcmMvZHVja3MvZmlsdGVycyc7CmltcG9ydCB7IGxhc3QsIHN0YXJ0Q2FzZSB9IGZyb20gJ2xvZGFzaCc7CmltcG9ydCB7IGFkZHJlc3NUb0VtYWlsIH0gZnJvbSAnQHNyYy9saWIvYWRkcmVzcyc7CmltcG9ydCBDb25maXJtIGZyb20gJ0BzcmMvY29tcG9uZW50cy9CYXNlL0NvbmZpcm0nOwppbXBvcnQgQmxvY2tDb25maXJtIGZyb20gJ0BzcmMvY29tcG9uZW50cy9CYXNlL0Jsb2NrQ29uZmlybS9CbG9ja0NvbmZpcm0nOwppbXBvcnQgeyBjb21tYW5kQ29udHJvbFNob3cgfSBmcm9tICdAc3JjL2R1Y2tzL2NvbW1hbmRDb250cm9sJzsKaW1wb3J0IHsgbGVmdFNpZGViYXJUb2dnbGUgfSBmcm9tICdAc3JjL2R1Y2tzL2xlZnRTaWRlYmFyJzsKaW1wb3J0IHsgcmlnaHRTaWRlYmFyVGFiU2VsZWN0IH0gZnJvbSAnQHNyYy9kdWNrcy9yaWdodFNpZGViYXInOwppbXBvcnQgQ29udGFjdFN1cHBvcnQgZnJvbSAnQHNyYy9jb21wb25lbnRzL0NvbnRhY3RTdXBwb3J0JzsKaW1wb3J0IHsgQW1wbGl0dWRlRXZlbnRzLCBsb2dBbXBsaXR1ZGVFdmVudCB9IGZyb20gJ0BzcmMvbGliL2FtcGxpdHVkZS1hbmFseXRpY3MnOwp2YXIgTWVudGlvbnMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoTWVudGlvbnMsIF9zdXBlcik7CiAgICBmdW5jdGlvbiBNZW50aW9ucygpIHsKICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzOwogICAgICAgIF90aGlzLmdldFBhdGhBbmRMb2dFdmVudCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgLy8gb3RoZXJ3aXNlIHRoaXMgZ2V0cyBjYWxsZWQgdHdpY2Ugd2hlbiBuYXZpZ2F0aW5nIHRvIHNoYXJlZCBieSBtZQogICAgICAgICAgICBpZiAod2luZG93LmxvY2F0aW9uLnBhdGhuYW1lID09PSAnL21lbnRpb25zJykgewogICAgICAgICAgICAgICAgbG9nQW1wbGl0dWRlRXZlbnQoQW1wbGl0dWRlRXZlbnRzLlZpZXdUZWFtTWVudGlvbnMpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICh3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUgPT09ICcvc2hhcmVkVGhyZWFkcycpIHsKICAgICAgICAgICAgICAgIGxvZ0FtcGxpdHVkZUV2ZW50KEFtcGxpdHVkZUV2ZW50cy5WaWV3U2hhcmVkQnlNZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIF90aGlzLmhhbmRsZVVuc3Vic2NyaWJlID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgX2EgPSBfdGhpcy5wcm9wcywgc2VsZWN0ZWRUaHJlYWQgPSBfYS5zZWxlY3RlZFRocmVhZCwgdW5zdWJzY3JpYmVMaW5rID0gX2EudW5zdWJzY3JpYmVMaW5rLCBwcmVmZXJlbmNlcyA9IF9hLnByZWZlcmVuY2VzLCBzdWJtaXRDb21taXRNZXRhID0gX2Euc3VibWl0Q29tbWl0TWV0YTsKICAgICAgICAgICAgaWYgKHNlbGVjdGVkVGhyZWFkICYmIHVuc3Vic2NyaWJlTGluayAmJiBwcmVmZXJlbmNlcykgewogICAgICAgICAgICAgICAgd2luZG93Lm9wZW4odW5zdWJzY3JpYmVMaW5rLCAnX2JsYW5rJyk7CiAgICAgICAgICAgICAgICByZWNvcmRFdmVudChVc2VyRXZlbnRzLlVuc3Vic2NyaWJlZCk7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKHByZWZlcmVuY2VzLnVuc3Vic2NyaWJlQmVoYXZpb3IpIHsKICAgICAgICAgICAgICAgICAgICBjYXNlIFVuc3Vic2NyaWJlQmVoYXZpb3IuQXJjaGl2ZToKICAgICAgICAgICAgICAgICAgICAgICAgc3VibWl0Q29tbWl0TWV0YSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaW5nbGVSZXNvdXJjZTogc2VsZWN0ZWRUaHJlYWQuaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3g6IFRocmVhZEJveC5BcmNoaXZlLAogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBVbnN1YnNjcmliZUJlaGF2aW9yLlRyYXNoOgogICAgICAgICAgICAgICAgICAgICAgICBzdWJtaXRDb21taXRNZXRhKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpbmdsZVJlc291cmNlOiBzZWxlY3RlZFRocmVhZC5pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJveDogVGhyZWFkQm94LlRyYXNoLAogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIF90aGlzLmhhbmRsZUhvdGtleUFjdGlvbnNDaGFuZ2UgPSBmdW5jdGlvbiAob2xkQWN0aW9ucywgbmV3QWN0aW9ucykgewogICAgICAgICAgICB2YXIgX2EgPSBfdGhpcy5wcm9wcywgZGlzcGF0Y2hBY3Rpb24gPSBfYS5kaXNwYXRjaEFjdGlvbiwgc2VsZWN0ZWRUaHJlYWQgPSBfYS5zZWxlY3RlZFRocmVhZCwgcHJlZmVyZW5jZXMgPSBfYS5wcmVmZXJlbmNlcywgc3VibWl0Q29tbWl0TWV0YSA9IF9hLnN1Ym1pdENvbW1pdE1ldGEsIGJsb2NrRmlsdGVyID0gX2EuYmxvY2tGaWx0ZXIsIHVuc3Vic2NyaWJlTGluayA9IF9hLnVuc3Vic2NyaWJlTGluazsKICAgICAgICAgICAgLy8gSGFuZGxlIFVuYmxvY2sgdG9nZ2xlCiAgICAgICAgICAgIGlmIChjaGVja05leHRIb3RrZXlDaGFuZ2UoSG90a2V5QWN0aW9uLlVuYmxvY2tTZW5kZXIsIG5ld0FjdGlvbnMsIG9sZEFjdGlvbnMpKSB7CiAgICAgICAgICAgICAgICBpZiAoYmxvY2tGaWx0ZXIpIHsKICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaEFjdGlvbihmaWx0ZXJEZWxldGUoYmxvY2tGaWx0ZXIuaWQpKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gSGFuZGxlIEJsb2NrIHRvZ2dsZQogICAgICAgICAgICBpZiAoY2hlY2tOZXh0SG90a2V5Q2hhbmdlKEhvdGtleUFjdGlvbi5CbG9ja1NlbmRlciwgbmV3QWN0aW9ucywgb2xkQWN0aW9ucykpIHsKICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZFRocmVhZCkgewogICAgICAgICAgICAgICAgICAgIHZhciBzZW5kZXJMYXN0TWVzc2FnZSA9IGxhc3Qoc2VsZWN0ZWRUaHJlYWQubWVzc2FnZXMpOwogICAgICAgICAgICAgICAgICAgIGlmICghc2VuZGVyTGFzdE1lc3NhZ2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoIXByZWZlcmVuY2VzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLy8gSGFuZGxlIHNldHRpbmcgYmxvY2sKICAgICAgICAgICAgICAgICAgICB2YXIgc2VuZGVyXzEgPSBhZGRyZXNzVG9FbWFpbChzZW5kZXJMYXN0TWVzc2FnZS5mcm9tKS50b0xvd2VyQ2FzZSgpOwogICAgICAgICAgICAgICAgICAgIHZhciBibG9ja0NvbmZpcm1Qcm9wcyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICJCbG9jayAiICsgc2VuZGVyXzEsCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGgKICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogIk1lc3NhZ2VzIHJlY2VpdmVkIGZyb20gdGhpcyBzZW5kZXIgd2lsbCBiZSBibG9ja2VkIGFuZCBhdXRvbWF0aWNhbGx5IG1vdmVkIHRvICIgKyBzdGFydENhc2UocHJlZmVyZW5jZXMuYmxvY2tDb250YWN0QWN0aW9uKSArICIuIiwKICAgICAgICAgICAgICAgICAgICAgICAgaGFzVW5zdWJzY3JpYmU6ICEhdW5zdWJzY3JpYmVMaW5rLAogICAgICAgICAgICAgICAgICAgICAgICBvblVuc3Vic2NyaWJlQ2xpY2s6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhhbmRsZSB1bnN1YnNjcmliZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBibG9ja0NvbmZpcm1Qcm9wczogdW5kZWZpbmVkIH0sIGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmhhbmRsZVVuc3Vic2NyaWJlKCk7IH0pOwogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBvbkNvbmZpcm06IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEJsb2NrIGZpbHRlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hBY3Rpb24oZmlsdGVyU2V0KGZpbHRlckJsb2NrQ3JlYXRlKHNlbmRlcl8xKSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSGFuZGxlIHNlbmRpbmcgdG8gcHJvcGVyIGRlc3RpbmF0aW9uIGJveAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChwcmVmZXJlbmNlcy5ibG9ja0NvbnRhY3RBY3Rpb24pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIEJsb2NrQ29udGFjdEFjdGlvblR5cGUuQXJjaGl2ZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJsb2NrQXJjaGl2ZUNvbW1pdCA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpbmdsZVJlc291cmNlOiBzZWxlY3RlZFRocmVhZC5pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJveDogVGhyZWFkQm94LkFyY2hpdmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Ym1pdENvbW1pdE1ldGEoYmxvY2tBcmNoaXZlQ29tbWl0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBCbG9ja0NvbnRhY3RBY3Rpb25UeXBlLlRyYXNoOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYmxvY2tUcmFzaENvbW1pdCA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpbmdsZVJlc291cmNlOiBzZWxlY3RlZFRocmVhZC5pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJveDogVGhyZWFkQm94LlRyYXNoLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJtaXRDb21taXRNZXRhKGJsb2NrVHJhc2hDb21taXQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OiBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBjb25maXJtUHJvcHMKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsgYmxvY2tDb25maXJtUHJvcHM6IHVuZGVmaW5lZCB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgb25DYW5jZWw6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsgYmxvY2tDb25maXJtUHJvcHM6IHVuZGVmaW5lZCB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIC8vIFNldCBDb25maXJtUHJvcHMgdG8gY29uZmlybSBibG9jawogICAgICAgICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsgYmxvY2tDb25maXJtUHJvcHM6IGJsb2NrQ29uZmlybVByb3BzIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5oYW5kbGVGb2N1cyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgaWYgKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgJiYgZG9jdW1lbnQuYWN0aXZlRWxlbWVudC50YWdOYW1lLnRvTG93ZXJDYXNlKCkgIT09ICdib2R5JykgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHZhciBzZWxlY3RlZFRocmVhZCA9IF90aGlzLnByb3BzLnNlbGVjdGVkVGhyZWFkOwogICAgICAgICAgICB2YXIgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnc2hhcmVkLXRocmVhZC1saXN0LW1haW4nKTsKICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBzZWxlY3RlZFRocmVhZCAmJiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChzZWxlY3RlZFRocmVhZC5pZCk7CiAgICAgICAgICAgIGlmIChlbGVtZW50KSB7CiAgICAgICAgICAgICAgICBlbGVtZW50LmZvY3VzKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZiAoY29udGFpbmVyICYmIGNvbnRhaW5lci5sZW5ndGgpIHsKICAgICAgICAgICAgICAgIGNvbnRhaW5lclswXS5mb2N1cygpOwogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5oYW5kbGVLZXlEb3duID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgdmFyIF9hID0gX3RoaXMucHJvcHMsIHNlbGVjdGVkVGhyZWFkID0gX2Euc2VsZWN0ZWRUaHJlYWQsIGRpc3BhdGNoQWN0aW9uID0gX2EuZGlzcGF0Y2hBY3Rpb24sIHN1Ym1pdENvbW1pdE1ldGEgPSBfYS5zdWJtaXRDb21taXRNZXRhLCBkcmFmdCA9IF9hLmRyYWZ0LCBoaWRlQWN0aW9ucyA9IF9hLmhpZGVBY3Rpb25zLCByaWdodFNpZGViYXJDb2xsYXBzZWQgPSBfYS5yaWdodFNpZGViYXJDb2xsYXBzZWQsIHJpZ2h0U2lkZWJhclRhYiA9IF9hLnJpZ2h0U2lkZWJhclRhYiwgY29sbGFwc2VSaWdodFNpZGViYXIgPSBfYS5jb2xsYXBzZVJpZ2h0U2lkZWJhciwgcHJlZmVyZW5jZXMgPSBfYS5wcmVmZXJlbmNlcywgdW5zdWJzY3JpYmVMaW5rID0gX2EudW5zdWJzY3JpYmVMaW5rLCBzY2hlZHVsaW5nVXJsID0gX2Euc2NoZWR1bGluZ1VybCwgYmxvY2tGaWx0ZXIgPSBfYS5ibG9ja0ZpbHRlcjsKICAgICAgICAgICAgdmFyIGhhbmRsZWQgPSBmYWxzZTsKICAgICAgICAgICAgaWYgKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgJiYgKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQudGFnTmFtZSA9PT0gJ0lOUFVUJyB8fAogICAgICAgICAgICAgICAgZG9jdW1lbnQuYWN0aXZlRWxlbWVudC50YWdOYW1lID09PSAnVEVYVEFSRUEnKSkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHZhciBob3RrZXkgPSBnZXRIb3RrZXkoZSk7CiAgICAgICAgICAgIHN3aXRjaCAoaG90a2V5ICYmIGhvdGtleS5uYW1lKSB7CiAgICAgICAgICAgICAgICBjYXNlIEhvdGtleUFjdGlvbi5OYXZpZ2F0aW9uQ2VudGVyOgogICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgICAgICAgICAgICAgIF90aGlzLnByb3BzLmRpc3BhdGNoQWN0aW9uKGNvbW1hbmRDb250cm9sU2hvdyhDb21tYW5kQ29udHJvbFR5cGUuTmF2aWdhdGlvbikpOwogICAgICAgICAgICAgICAgICAgIGhhbmRsZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBIb3RrZXlBY3Rpb24uVG9nZ2xlQ29tbWFuZENvbnRyb2w6CiAgICAgICAgICAgICAgICAgICAgaWYgKGhvdGtleSAmJiBob3RrZXkuYWN0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0eXBlID0gX3RoaXMucHJvcHMuZHJhZnQKICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gQ29tbWFuZENvbnRyb2xUeXBlLkRyYWZ0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IENvbW1hbmRDb250cm9sVHlwZS5UaHJlYWQ7CiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoQWN0aW9uKGhvdGtleS5hY3Rpb24odHlwZSkpOwogICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIEhvdGtleUFjdGlvbi5Db3B5U2NoZWR1bGluZ1VybDoKICAgICAgICAgICAgICAgICAgICBpZiAoIXNjaGVkdWxpbmdVcmwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYnJvd3Nlckhpc3RvcnkucHVzaCgnL3NldHRpbmdzL2NhbGVuZGFyJyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaEFjdGlvbihob3RrZXlVcGRhdGUoSG90a2V5QWN0aW9uLkNvcHlTY2hlZHVsaW5nVXJsKSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGhhbmRsZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBIb3RrZXlBY3Rpb24uQ29tbWVudDoKICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWRUaHJlYWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucHJvcHMudXBkYXRlSG90a2V5KEhvdGtleUFjdGlvbi5Db21tZW50KTsKICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBIb3RrZXlBY3Rpb24uU2VhcmNoOgogICAgICAgICAgICAgICAgICAgIGhhbmRsZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoQWN0aW9uKGhvdGtleVVwZGF0ZShIb3RrZXlBY3Rpb24uU2VhcmNoKSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghc2VsZWN0ZWRUaHJlYWQgfHwgaGlkZUFjdGlvbnMpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBzd2l0Y2ggKGhvdGtleSAmJiBob3RrZXkubmFtZSB8fCBlLmtleUNvZGUpIHsKICAgICAgICAgICAgICAgIGNhc2UgSG90a2V5QWN0aW9uLktleWJvYXJkU2hvcnRjdXRHdWlkZToKICAgICAgICAgICAgICAgICAgICBpZiAoaG90a2V5ICYmIGhvdGtleS5hY3Rpb24gJiYgcmlnaHRTaWRlYmFyVGFiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoQWN0aW9uKGhvdGtleS5hY3Rpb24ocmlnaHRTaWRlYmFyVGFiKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgSG90a2V5QWN0aW9uLk5ld0RyYWZ0OgogICAgICAgICAgICAgICAgICAgIGlmIChob3RrZXkgJiYgaG90a2V5LmFjdGlvbikgewogICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaEFjdGlvbihob3RrZXkuYWN0aW9uKTsKICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgLy8gVUkgVG9nZ2xlCiAgICAgICAgICAgICAgICBjYXNlIEhvdGtleUFjdGlvbi5Ub2dnbGVMU0I6CiAgICAgICAgICAgICAgICAgICAgaGFuZGxlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hBY3Rpb24obGVmdFNpZGViYXJUb2dnbGUodHJ1ZSkpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBIb3RrZXlBY3Rpb24uVG9nZ2xlUlNCOgogICAgICAgICAgICAgICAgICAgIGhhbmRsZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIGNvbGxhcHNlUmlnaHRTaWRlYmFyKCFyaWdodFNpZGViYXJDb2xsYXBzZWQpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgLy8gRHJhZnRzCiAgICAgICAgICAgICAgICBjYXNlIEhvdGtleUFjdGlvbi5SZXBseToKICAgICAgICAgICAgICAgIGNhc2UgSG90a2V5QWN0aW9uLlJlcGx5QWxsOgogICAgICAgICAgICAgICAgY2FzZSBIb3RrZXlBY3Rpb24uRm9yd2FyZDoKICAgICAgICAgICAgICAgIGNhc2UgSG90a2V5QWN0aW9uLlJlYWRMYXRlcjoKICAgICAgICAgICAgICAgIGNhc2UgSG90a2V5QWN0aW9uLkxhYmVsOgogICAgICAgICAgICAgICAgICAgIGlmIChob3RrZXkgJiYgaG90a2V5LmFjdGlvbiAmJiBzZWxlY3RlZFRocmVhZCkgewogICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaEFjdGlvbihob3RrZXkuYWN0aW9uKTsKICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgLy8gTmF2aWdhdGlvbgogICAgICAgICAgICAgICAgY2FzZSBIb3RrZXlBY3Rpb24uTmF2aWdhdGVJbmJveDoKICAgICAgICAgICAgICAgIGNhc2UgSG90a2V5QWN0aW9uLk5hdmlnYXRlU3RhcnJlZDoKICAgICAgICAgICAgICAgIGNhc2UgSG90a2V5QWN0aW9uLk5hdmlnYXRlUmVhZExhdGVyOgogICAgICAgICAgICAgICAgY2FzZSBIb3RrZXlBY3Rpb24uTmF2aWdhdGVBcmNoaXZlOgogICAgICAgICAgICAgICAgY2FzZSBIb3RrZXlBY3Rpb24uTmF2aWdhdGVUcmFzaDoKICAgICAgICAgICAgICAgIGNhc2UgSG90a2V5QWN0aW9uLk5hdmlnYXRlRm9sbG93VXA6CiAgICAgICAgICAgICAgICBjYXNlIEhvdGtleUFjdGlvbi5OYXZpZ2F0ZVNlbnQ6CiAgICAgICAgICAgICAgICBjYXNlIEhvdGtleUFjdGlvbi5OYXZpZ2F0ZVNlbmRMYXRlcjoKICAgICAgICAgICAgICAgIGNhc2UgSG90a2V5QWN0aW9uLk5hdmlnYXRlRHJhZnQ6CiAgICAgICAgICAgICAgICAgICAgaWYgKGhvdGtleSAmJiBob3RrZXkucm91dGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5ld01haWxib3ggPSB7IHR5cGU6IE1haWxib3hUeXBlLkFueSB9OwogICAgICAgICAgICAgICAgICAgICAgICBicm93c2VySGlzdG9yeS5wdXNoKGhvdGtleS5yb3V0ZShuZXdNYWlsYm94KSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgSG90a2V5QWN0aW9uLlVuYmxvY2tTZW5kZXI6CiAgICAgICAgICAgICAgICBjYXNlIEhvdGtleUFjdGlvbi5CbG9ja1NlbmRlcjoKICAgICAgICAgICAgICAgICAgICBpZiAoYmxvY2tGaWx0ZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hBY3Rpb24oaG90a2V5VXBkYXRlKEhvdGtleUFjdGlvbi5VbmJsb2NrU2VuZGVyKSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaEFjdGlvbihob3RrZXlVcGRhdGUoSG90a2V5QWN0aW9uLkJsb2NrU2VuZGVyKSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIGNhc2UgSG90a2V5QWN0aW9uLk11dGVDb252ZXJzYXRpb246CiAgICAgICAgICAgICAgICBjYXNlIEhvdGtleUFjdGlvbi5Vbm11dGVDb252ZXJzYXRpb246CiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkVGhyZWFkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtdXRlQ29tbWl0TWV0YSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpbmdsZVJlc291cmNlOiBzZWxlY3RlZFRocmVhZC5pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG11dGVkOiAhc2VsZWN0ZWRUaHJlYWQubXV0ZWQsCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIHN1Ym1pdENvbW1pdE1ldGEobXV0ZUNvbW1pdE1ldGEpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICBjYXNlIEhvdGtleUFjdGlvbi5NZXNzYWdlVGVtcGxhdGVzOgogICAgICAgICAgICAgICAgY2FzZSBIb3RrZXlBY3Rpb24uQ2FsZW5kYXJJbnZpdGU6CiAgICAgICAgICAgICAgICAgICAgaGFuZGxlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgaWYgKGhvdGtleSAmJiBob3RrZXkuYWN0aW9uICYmIGRyYWZ0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoQWN0aW9uKGhvdGtleS5hY3Rpb24pOwogICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIEhvdGtleUFjdGlvbi5JbmJveDoKICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWRUaHJlYWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc3VibWl0Q29tbWl0TWV0YSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaW5nbGVSZXNvdXJjZTogc2VsZWN0ZWRUaHJlYWQuaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3g6IFRocmVhZEJveC5JbmJveCwKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgSG90a2V5QWN0aW9uLkFyY2hpdmU6CiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkVGhyZWFkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN1Ym1pdENvbW1pdE1ldGEoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2luZ2xlUmVzb3VyY2U6IHNlbGVjdGVkVGhyZWFkLmlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYm94OiBUaHJlYWRCb3guQXJjaGl2ZSwKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBIb3RrZXlBY3Rpb24uVHJhc2g6CiAgICAgICAgICAgICAgICBjYXNlIEtleUNvZGUuRXh0ZW5kZWREZWxldGU6CiAgICAgICAgICAgICAgICBjYXNlIEtleUNvZGUuRGVsZXRlOgogICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZFRocmVhZCkgewogICAgICAgICAgICAgICAgICAgICAgICBzdWJtaXRDb21taXRNZXRhKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpbmdsZVJlc291cmNlOiBzZWxlY3RlZFRocmVhZC5pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJveDogVGhyZWFkQm94LkluYm94LAogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIEhvdGtleUFjdGlvbi5EaXNjYXJkOgogICAgICAgICAgICAgICAgICAgIGlmIChkcmFmdCAmJiBob3RrZXkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucHJvcHMudXBkYXRlSG90a2V5KEhvdGtleUFjdGlvbi5EaXNjYXJkKTsKICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBIb3RrZXlBY3Rpb24uVG9nZ2xlVW5yZWFkOgogICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZFRocmVhZCkgewogICAgICAgICAgICAgICAgICAgICAgICBzdWJtaXRDb21taXRNZXRhKHsgcmVhZDogIXNlbGVjdGVkVGhyZWFkLnJlYWQgfSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGhhbmRsZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBIb3RrZXlBY3Rpb24uVG9nZ2xlU3RhcjoKICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWRUaHJlYWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc3VibWl0Q29tbWl0TWV0YSh7IHN0YXJyZWQ6ICFzZWxlY3RlZFRocmVhZC5zdGFycmVkIH0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBoYW5kbGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgSG90a2V5QWN0aW9uLlVuc3Vic2NyaWJlOgogICAgICAgICAgICAgICAgICAgIC8vIEhhbmRsZSByZW1vdmluZyBmcm9tIGxpc3QgYnkgZGlzcGF0Y2hpbmcgYWN0aW9uCiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkVGhyZWFkICYmIHVuc3Vic2NyaWJlTGluayAmJiBwcmVmZXJlbmNlcykgewogICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cub3Blbih1bnN1YnNjcmliZUxpbmssICdfYmxhbmsnKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmVjb3JkRXZlbnQoVXNlckV2ZW50cy5VbnN1YnNjcmliZWQpOwogICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHByZWZlcmVuY2VzLnVuc3Vic2NyaWJlQmVoYXZpb3IpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgVW5zdWJzY3JpYmVCZWhhdmlvci5BcmNoaXZlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Ym1pdENvbW1pdE1ldGEoeyBzaW5nbGVSZXNvdXJjZTogc2VsZWN0ZWRUaHJlYWQuaWQsIGJveDogVGhyZWFkQm94LkFyY2hpdmUgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFVuc3Vic2NyaWJlQmVoYXZpb3IuVHJhc2g6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VibWl0Q29tbWl0TWV0YSh7IHNpbmdsZVJlc291cmNlOiBzZWxlY3RlZFRocmVhZC5pZCwgYm94OiBUaHJlYWRCb3guVHJhc2ggfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE9wZW4gdW5zdWJzY3JpYmUgd2luZG93CiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgSG90a2V5QWN0aW9uLk9wZW5DYWxlbmRhcjoKICAgICAgICAgICAgICAgICAgICBfdGhpcy5wcm9wcy5kaXNwYXRjaEFjdGlvbihjb21tYW5kQ29udHJvbFNob3coQ29tbWFuZENvbnRyb2xUeXBlLkNhbGVuZGFyKSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgY2FzZSBIb3RrZXlBY3Rpb24uT3BlbkNhbGVuZGFyUnNiOgogICAgICAgICAgICAgICAgICAgIF90aGlzLnByb3BzLmRpc3BhdGNoQWN0aW9uKHJpZ2h0U2lkZWJhclRhYlNlbGVjdCh7CiAgICAgICAgICAgICAgICAgICAgICAgIHJzYlRhYjogUmlnaHRTaWRlYmFyVGFiLkNhbGVuZGFyLAogICAgICAgICAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChoYW5kbGVkKSB7CiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5zdGF0ZSA9IHt9OwogICAgICAgIHJldHVybiBfdGhpczsKICAgIH0KICAgIE1lbnRpb25zLnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB0aGlzLmdldFBhdGhBbmRMb2dFdmVudCgpOwogICAgfTsKICAgIE1lbnRpb25zLnByb3RvdHlwZS5jb21wb25lbnREaWRVcGRhdGUgPSBmdW5jdGlvbiAob2xkUHJvcHMpIHsKICAgICAgICB2YXIgb2xkQWN0aW9ucyA9IG9sZFByb3BzLmhvdGtleUFjdGlvbnMgfHwge307CiAgICAgICAgdmFyIG5ld0FjdGlvbnMgPSB0aGlzLnByb3BzLmhvdGtleUFjdGlvbnMgfHwge307CiAgICAgICAgdGhpcy5oYW5kbGVIb3RrZXlBY3Rpb25zQ2hhbmdlKG9sZEFjdGlvbnMsIG5ld0FjdGlvbnMpOwogICAgICAgIHRoaXMuZ2V0UGF0aEFuZExvZ0V2ZW50KCk7CiAgICAgICAgaWYgKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgJiYgZG9jdW1lbnQuYWN0aXZlRWxlbWVudC50YWdOYW1lID09PSAnQk9EWScpIHsKICAgICAgICAgICAgdGhpcy5oYW5kbGVGb2N1cygpOwogICAgICAgIH0KICAgICAgICBpZiAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCAmJiBkb2N1bWVudC5hY3RpdmVFbGVtZW50LnRhZ05hbWUgPT09ICdCT0RZJykgewogICAgICAgICAgICB0aGlzLmhhbmRsZUZvY3VzKCk7CiAgICAgICAgfQogICAgfTsKICAgIE1lbnRpb25zLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIF9hID0gdGhpcy5wcm9wcywgaGlkZUFjdGlvbnMgPSBfYS5oaWRlQWN0aW9ucywgdXNlclNoYXJlZFRocmVhZHMgPSBfYS51c2VyU2hhcmVkVGhyZWFkcywgc2hvd1NoYXJlZFRocmVhZHNPbmJvYXJkaW5nID0gX2Euc2hvd1NoYXJlZFRocmVhZHNPbmJvYXJkaW5nLCBzaGFyZWRUaHJlYWRzTG9hZGVkID0gX2Euc2hhcmVkVGhyZWFkc0xvYWRlZDsKICAgICAgICB2YXIgX2IgPSB0aGlzLnN0YXRlLCBjb25maXJtUHJvcHMgPSBfYi5jb25maXJtUHJvcHMsIGJsb2NrQ29uZmlybVByb3BzID0gX2IuYmxvY2tDb25maXJtUHJvcHM7CiAgICAgICAgdmFyIExlZnRTaWRlYmFyQ29ubmVjdCA9IExlZnRTaWRlYmFyOwogICAgICAgIHZhciBUaHJlYWREZXRhaWxDb25uZWN0ID0gVGhyZWFkRGV0YWlsOwogICAgICAgIC8vIERldGVybWluZSB3aGV0aGVyIHRvIHNob3cgU2hhcmVkIFRocmVhZHMgT25ib2FyZGluZwogICAgICAgIHZhciBtb2RlID0gdXNlclNoYXJlZFRocmVhZHMgPT09IHRydWUKICAgICAgICAgICAgPyBTaGFyZWRUaHJlYWRzTW9kZS5Vc2VyIDogU2hhcmVkVGhyZWFkc01vZGUuTWVudGlvbnM7CiAgICAgICAgdmFyIHNob3dPbmJvYXJkaW5nID0gbW9kZSA9PT0gU2hhcmVkVGhyZWFkc01vZGUuVXNlciAmJiBzaG93U2hhcmVkVGhyZWFkc09uYm9hcmRpbmcKICAgICAgICAgICAgJiYgISFzaGFyZWRUaHJlYWRzTG9hZGVkOwogICAgICAgIHJldHVybiAoUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJtZW50aW9ucy1wYWdlIiwgb25LZXlEb3duOiB0aGlzLmhhbmRsZUtleURvd24gfSwKICAgICAgICAgICAgYmxvY2tDb25maXJtUHJvcHMgJiYKICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoQmxvY2tDb25maXJtLCBfX2Fzc2lnbih7fSwgYmxvY2tDb25maXJtUHJvcHMpKSwKICAgICAgICAgICAgY29uZmlybVByb3BzICYmCiAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KENvbmZpcm0sIF9fYXNzaWduKHt9LCBjb25maXJtUHJvcHMpKSwKICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJtYWluLWFwcCIgfSwKICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoQ29udGFjdFN1cHBvcnQsIG51bGwpLAogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChMZWZ0U2lkZWJhckNvbm5lY3QsIHsgYWNjb3VudHM6IFtdLCBzZWxlY3RlZFRhYjogTmF2YmFyVGFiLk1lbnRpb25zIH0pLAogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChTaGFyZWRUaHJlYWRMaXN0LCB7IG1vZGU6IG1vZGUgfSksCiAgICAgICAgICAgICAgICBzaG93T25ib2FyZGluZyAmJgogICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoU2hhcmVkVGhyZWFkc09uYm9hcmRpbmcsIHsgaWQ6IDAgfSksCiAgICAgICAgICAgICAgICAhc2hvd09uYm9hcmRpbmcgJiYKICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KFRocmVhZERldGFpbENvbm5lY3QsIHsgaGlkZUFjdGlvbnM6IGhpZGVBY3Rpb25zIH0pLAogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChSaWdodFNpZGViYXIsIHsgcGFnZTogUGFnZS5UaHJlYWRzIH0pLAogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChDb21tYW5kQ29udHJvbCwgeyBkZWZhdWx0OiBDb21tYW5kQ29udHJvbFR5cGUuVGhyZWFkIH0pLAogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChUb2FzdCwgbnVsbCkpKSk7CiAgICB9OwogICAgcmV0dXJuIE1lbnRpb25zOwp9KFJlYWN0LlB1cmVDb21wb25lbnQpKTsKZXhwb3J0IGRlZmF1bHQgTWVudGlvbnM7Cg=="},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Mentions/Mentions.tsx","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Mentions/Mentions.tsx"],"names":[],"mappings":"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","sourcesContent":["import React from 'react';\nimport LeftSidebar from '@src/components/LeftSidebar';\nimport { Page, RightSidebarTab } from '@src/types/rightSidebar';\nimport RightSidebar from '@src/components/RightSidebar';\nimport './Mentions.scss';\nimport SharedThreadList from './components/SharedThreadList';\nimport ThreadDetail from '@src/components/ThreadDetail';\nimport { NavbarTab } from '@src/types/leftSidebar';\nimport SharedThreadsOnboarding from './components/SharedThreadsOnboarding/SharedThreadsOnboarding';\nimport {\n  Thread,\n  Action,\n  ThreadCommitMeta,\n  ThreadBox,\n  KeyCode,\n  Draft,\n  CommandControlType,\n  MailboxType,\n  Preferences,\n  UnsubscribeBehavior,\n  BlockContactActionType,\n} from '@src/types';\nimport {\n  HotkeyAction,\n  getHotkey,\n  checkNextHotkeyChange,\n} from '@src/lib/hotkeys';\nimport CommandControl from '@src/components/CommandControl';\nimport browserHistory from '@src/lib/browserHistory';\nimport { recordEvent, UserEvents } from '@src/lib/analytics';\nimport { hotkeyUpdate } from '@src/ducks/hotkeys';\nimport Toast from '@src/components/Base/Toast';\nimport { SharedThreadsMode } from '@src/types/sharedThreads';\nimport { filterDelete, filterSet, filterBlockCreate } from '@src/ducks/filters';\nimport { last, startCase } from 'lodash';\nimport { addressToEmail } from '@src/lib/address';\nimport Confirm, { Props as ConfirmProps } from '@src/components/Base/Confirm';\nimport { Filter } from '@src/types/filters';\nimport BlockConfirm, {\n  Props as BlockConfirmProps,\n} from '@src/components/Base/BlockConfirm/BlockConfirm';\nimport { commandControlShow } from '@src/ducks/commandControl';\nimport { leftSidebarToggle } from '@src/ducks/leftSidebar';\nimport { rightSidebarTabSelect } from '@src/ducks/rightSidebar';\nimport ContactSupport from '@src/components/ContactSupport';\nimport { AmplitudeEvents, logAmplitudeEvent } from '@src/lib/amplitude-analytics';\n\nexport interface Props {\n  preferences?: Preferences;\n  selectedThread?: Thread;\n  draft?: Draft;\n  hideActions?: boolean;\n  rightSidebarCollapsed: boolean;\n  rightSidebarTab?: RightSidebarTab;\n  unsubscribeLink?: string;\n  commandControlType?: CommandControlType;\n  schedulingUrl?: string;\n  userSharedThreads?: boolean;\n  showSharedThreadsOnboarding?: boolean;\n  sharedThreadsLoaded?: boolean;\n  hotkeyActions?: { [key: string]: number };\n  blockFilter?: Filter;\n}\n\nexport interface DispatchProps {\n  dispatchAction: (action: Action<any, any>) => void;\n  selectContact: (email: string) => void;\n  submitCommitMeta: (commitMeta: ThreadCommitMeta) => void;\n  collapseRightSidebar: (collapse: boolean) => void;\n  updateHotkey: (hotkey: HotkeyAction) => void;\n}\n\nexport interface State {\n  confirmProps?: ConfirmProps;\n  blockConfirmProps?: BlockConfirmProps;\n}\n\nclass Mentions extends React.PureComponent<Props & DispatchProps, State> {\n\n  constructor() {\n    super();\n    this.state = {};\n  }\n\n  getPathAndLogEvent = () => {\n    // otherwise this gets called twice when navigating to shared by me\n    if (window.location.pathname === '/mentions') {\n      logAmplitudeEvent(AmplitudeEvents.ViewTeamMentions);\n    }\n    if (window.location.pathname === '/sharedThreads') {\n      logAmplitudeEvent(AmplitudeEvents.ViewSharedByMe);\n    }\n  }\n\n  componentDidMount () {\n    this.getPathAndLogEvent();\n  }\n\n  componentDidUpdate(oldProps: Props & DispatchProps) {\n    const oldActions = oldProps.hotkeyActions || {};\n    const newActions = this.props.hotkeyActions || {};\n    this.handleHotkeyActionsChange(oldActions, newActions);\n    this.getPathAndLogEvent();\n\n    if (document.activeElement && document.activeElement.tagName === 'BODY') {\n      this.handleFocus();\n    }\n\n    if (document.activeElement && document.activeElement.tagName === 'BODY') {\n      this.handleFocus();\n    }\n  }\n\n  handleUnsubscribe = () => {\n    const { selectedThread, unsubscribeLink, preferences, submitCommitMeta } = this.props;\n    if (selectedThread && unsubscribeLink && preferences) {\n      window.open(unsubscribeLink, '_blank');\n      recordEvent(UserEvents.Unsubscribed);\n      switch (preferences.unsubscribeBehavior) {\n        case UnsubscribeBehavior.Archive:\n          submitCommitMeta({\n            singleResource: selectedThread.id,\n            box: ThreadBox.Archive,\n          });\n          break;\n        case UnsubscribeBehavior.Trash:\n          submitCommitMeta({\n            singleResource: selectedThread.id,\n            box: ThreadBox.Trash,\n          });\n          break;\n        default:\n          break;\n      }\n    }\n  }\n\n  handleHotkeyActionsChange = (\n    oldActions: { [action: string]: number },\n    newActions: { [action: string]: number },\n  ) => {\n    const {\n      dispatchAction,\n      selectedThread,\n      preferences,\n      submitCommitMeta,\n      blockFilter,\n      unsubscribeLink,\n    } = this.props;\n    // Handle Unblock toggle\n    if (checkNextHotkeyChange(HotkeyAction.UnblockSender, newActions, oldActions)) {\n      if (blockFilter) {\n        dispatchAction(filterDelete(blockFilter.id));\n        return;\n      }\n    }\n\n    // Handle Block toggle\n    if (checkNextHotkeyChange(HotkeyAction.BlockSender, newActions, oldActions)) {\n      if (selectedThread) {\n        const senderLastMessage = last(selectedThread.messages);\n        if (!senderLastMessage) {\n          return;\n        }\n\n        if (!preferences) {\n          return;\n        }\n        // Handle setting block\n        const sender = addressToEmail(senderLastMessage.from).toLowerCase();\n        const blockConfirmProps: BlockConfirmProps = {\n          title: `Block ${sender}`,\n          // tslint:disable-next-line:max-line-length\n          message: `Messages received from this sender will be blocked and automatically moved to ${startCase(preferences.blockContactAction)}.`,\n          hasUnsubscribe: !!unsubscribeLink,\n          onUnsubscribeClick: () => {\n            // Handle unsubscribe\n            this.setState(\n              { blockConfirmProps: undefined },\n              () => this.handleUnsubscribe(),\n            );\n          },\n          onConfirm: () => {\n            // Block filter\n            dispatchAction(filterSet(filterBlockCreate(sender)));\n\n            // Handle sending to proper destination box\n            switch (preferences.blockContactAction) {\n              case BlockContactActionType.Archive:\n                const blockArchiveCommit: ThreadCommitMeta = {\n                  singleResource: selectedThread.id,\n                  box: ThreadBox.Archive,\n                };\n                submitCommitMeta(blockArchiveCommit);\n                break;\n              case BlockContactActionType.Trash:\n                const blockTrashCommit: ThreadCommitMeta = {\n                  singleResource: selectedThread.id,\n                  box: ThreadBox.Trash,\n                };\n                submitCommitMeta(blockTrashCommit);\n                break;\n              default: break;\n            }\n\n            // Remove confirmProps\n            this.setState({ blockConfirmProps: undefined });\n          },\n          onCancel: () => {\n            this.setState({ blockConfirmProps: undefined });\n          },\n        };\n\n        // Set ConfirmProps to confirm block\n        this.setState({ blockConfirmProps });\n      }\n    }\n  }\n\n  handleFocus = () => {\n    if (document.activeElement && document.activeElement.tagName.toLowerCase() !== 'body') {\n      return;\n    }\n\n    const { selectedThread } = this.props;\n    const container = document.getElementsByClassName('shared-thread-list-main');\n    const element = selectedThread && document.getElementById(selectedThread.id);\n\n    if (element) {\n      element.focus();\n    } else if (container && container.length) {\n      (container[0] as HTMLElement).focus();\n    }\n  }\n\n  handleKeyDown = (e: React.KeyboardEvent<HTMLDivElement>) => {\n    const {\n      selectedThread,\n      dispatchAction,\n      submitCommitMeta,\n      draft,\n      hideActions,\n      rightSidebarCollapsed,\n      rightSidebarTab,\n      collapseRightSidebar,\n      preferences,\n      unsubscribeLink,\n      schedulingUrl,\n      blockFilter,\n    } = this.props;\n    let handled = false;\n\n    if (document.activeElement && (document.activeElement.tagName === 'INPUT' ||\n      document.activeElement.tagName === 'TEXTAREA')) {\n      return;\n    }\n\n    const hotkey = getHotkey(e);\n    switch (hotkey && hotkey.name) {\n      case HotkeyAction.NavigationCenter:\n        e.preventDefault();\n        e.stopPropagation();\n        this.props.dispatchAction(commandControlShow(CommandControlType.Navigation));\n        handled = true;\n        break;\n      case HotkeyAction.ToggleCommandControl:\n        if (hotkey && hotkey.action) {\n          const type = this.props.draft\n            ? CommandControlType.Draft\n            : CommandControlType.Thread;\n          dispatchAction(hotkey.action(type));\n          handled = true;\n        }\n        break;\n      case HotkeyAction.CopySchedulingUrl:\n        if (!schedulingUrl) {\n          browserHistory.push('/settings/calendar');\n        } else {\n          dispatchAction(hotkeyUpdate(HotkeyAction.CopySchedulingUrl));\n        }\n        handled = true;\n        break;\n      case HotkeyAction.Comment:\n        if (selectedThread) {\n          this.props.updateHotkey(HotkeyAction.Comment);\n          handled = true;\n        }\n        break;\n      case HotkeyAction.Search:\n        handled = true;\n        e.stopPropagation();\n        e.preventDefault();\n        dispatchAction(hotkeyUpdate(HotkeyAction.Search));\n        break;\n      default:\n        break;\n    }\n\n    if (!selectedThread || hideActions) {\n      return;\n    }\n\n    switch (hotkey && hotkey.name || e.keyCode) {\n      case HotkeyAction.KeyboardShortcutGuide:\n        if (hotkey && hotkey.action && rightSidebarTab) {\n          dispatchAction(hotkey.action(rightSidebarTab));\n          handled = true;\n        }\n        break;\n      case HotkeyAction.NewDraft:\n        if (hotkey && hotkey.action) {\n          dispatchAction(hotkey.action);\n          handled = true;\n        }\n        break;\n      // UI Toggle\n      case HotkeyAction.ToggleLSB:\n        handled = true;\n        dispatchAction(leftSidebarToggle(true));\n        break;\n      case HotkeyAction.ToggleRSB:\n        handled = true;\n        collapseRightSidebar(!rightSidebarCollapsed);\n        break;\n\n      // Drafts\n      case HotkeyAction.Reply:\n      case HotkeyAction.ReplyAll:\n      case HotkeyAction.Forward:\n      case HotkeyAction.ReadLater:\n      case HotkeyAction.Label:\n        if (hotkey && hotkey.action && selectedThread) {\n          dispatchAction(hotkey.action);\n          handled = true;\n        }\n        break;\n\n      // Navigation\n      case HotkeyAction.NavigateInbox:\n      case HotkeyAction.NavigateStarred:\n      case HotkeyAction.NavigateReadLater:\n      case HotkeyAction.NavigateArchive:\n      case HotkeyAction.NavigateTrash:\n      case HotkeyAction.NavigateFollowUp:\n      case HotkeyAction.NavigateSent:\n      case HotkeyAction.NavigateSendLater:\n      case HotkeyAction.NavigateDraft:\n        if (hotkey && hotkey.route) {\n          const newMailbox = { type: MailboxType.Any };\n          browserHistory.push(hotkey.route(newMailbox));\n          handled = true;\n        }\n        break;\n      case HotkeyAction.UnblockSender:\n      case HotkeyAction.BlockSender:\n        if (blockFilter) {\n          dispatchAction(hotkeyUpdate(HotkeyAction.UnblockSender));\n        } else {\n          dispatchAction(hotkeyUpdate(HotkeyAction.BlockSender));\n        }\n        return;\n\n      case HotkeyAction.MuteConversation:\n      case HotkeyAction.UnmuteConversation:\n        if (selectedThread) {\n          const muteCommitMeta = {\n            singleResource: selectedThread.id,\n            muted: !selectedThread.muted,\n          };\n          submitCommitMeta(muteCommitMeta);\n        }\n        return;\n\n      case HotkeyAction.MessageTemplates:\n      case HotkeyAction.CalendarInvite:\n        handled = true;\n        if (hotkey && hotkey.action && draft) {\n          dispatchAction(hotkey.action);\n          handled = true;\n        }\n        break;\n      case HotkeyAction.Inbox:\n        if (selectedThread) {\n          submitCommitMeta({\n            singleResource: selectedThread.id,\n            box: ThreadBox.Inbox,\n          });\n          handled = true;\n        }\n        break;\n      case HotkeyAction.Archive:\n        if (selectedThread) {\n          submitCommitMeta({\n            singleResource: selectedThread.id,\n            box: ThreadBox.Archive,\n          });\n        }\n        break;\n      case HotkeyAction.Trash:\n      case KeyCode.ExtendedDelete:\n      case KeyCode.Delete:\n        if (selectedThread) {\n          submitCommitMeta({\n            singleResource: selectedThread.id,\n            box: ThreadBox.Inbox,\n          });\n        }\n        break;\n      case HotkeyAction.Discard:\n        if (draft && hotkey) {\n          this.props.updateHotkey(HotkeyAction.Discard);\n          handled = true;\n        }\n        break;\n      case HotkeyAction.ToggleUnread:\n        if (selectedThread) {\n          submitCommitMeta({ read: !selectedThread.read });\n        }\n        handled = true;\n        break;\n      case HotkeyAction.ToggleStar:\n        if (selectedThread) {\n          submitCommitMeta({ starred: !selectedThread.starred });\n        }\n        handled = true;\n        break;\n      case HotkeyAction.Unsubscribe:\n        // Handle removing from list by dispatching action\n        if (selectedThread && unsubscribeLink && preferences) {\n          window.open(unsubscribeLink, '_blank');\n          recordEvent(UserEvents.Unsubscribed);\n          switch (preferences.unsubscribeBehavior) {\n            case UnsubscribeBehavior.Archive:\n              submitCommitMeta({ singleResource: selectedThread.id, box: ThreadBox.Archive });\n              break;\n            case UnsubscribeBehavior.Trash:\n              submitCommitMeta({ singleResource: selectedThread.id, box: ThreadBox.Trash });\n              break;\n            default:\n              break;\n          }\n\n          // Open unsubscribe window\n          handled = true;\n        }\n        break;\n\n      case HotkeyAction.OpenCalendar:\n        this.props.dispatchAction(commandControlShow(CommandControlType.Calendar));\n        return;\n      case HotkeyAction.OpenCalendarRsb:\n        this.props.dispatchAction(rightSidebarTabSelect({\n          rsbTab: RightSidebarTab.Calendar,\n        }));\n        return;\n      default:\n        break;\n    }\n\n    if (handled) {\n      e.preventDefault();\n      e.stopPropagation();\n    }\n  }\n\n  render() {\n    const {\n      hideActions,\n      userSharedThreads,\n      showSharedThreadsOnboarding,\n      sharedThreadsLoaded,\n    } = this.props;\n\n    const { confirmProps, blockConfirmProps } = this.state;\n    const LeftSidebarConnect = LeftSidebar as any;\n    const ThreadDetailConnect = ThreadDetail as any;\n\n    // Determine whether to show Shared Threads Onboarding\n    const mode: SharedThreadsMode = userSharedThreads === true\n      ? SharedThreadsMode.User : SharedThreadsMode.Mentions;\n    const showOnboarding = mode === SharedThreadsMode.User && showSharedThreadsOnboarding\n     && !!sharedThreadsLoaded;\n\n    return (\n      <div\n        className=\"mentions-page\"\n        onKeyDown={this.handleKeyDown}\n      >\n        {blockConfirmProps &&\n          <BlockConfirm\n            {...blockConfirmProps}\n          />\n        }\n        {confirmProps &&\n          <Confirm\n            {...confirmProps}\n          />\n        }\n        <div className=\"main-app\">\n          <ContactSupport />\n          <LeftSidebarConnect accounts={[]} selectedTab={NavbarTab.Mentions} />\n          <SharedThreadList mode={mode}/>\n          {showOnboarding &&\n            <SharedThreadsOnboarding id={0} />\n          }\n          {!showOnboarding &&\n            <ThreadDetailConnect hideActions={hideActions} />\n          }\n          <RightSidebar page={Page.Threads} />\n          <CommandControl default={CommandControlType.Thread}/>\n          <Toast />\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Mentions;\n"]}]}