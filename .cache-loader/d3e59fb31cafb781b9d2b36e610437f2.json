{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Settings/routes/Billing/UpgradePlan/index.ts","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Settings/routes/Billing/UpgradePlan/index.ts","mtime":1675280254098},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgY29ubmVjdCB9IGZyb20gJ3JlYWN0LXJlZHV4JzsKaW1wb3J0IHsgd2l0aFJvdXRlciB9IGZyb20gJ3JlYWN0LXJvdXRlcic7CmltcG9ydCBVcGdyYWRlUGxhbiBmcm9tICcuL1VwZ3JhZGVQbGFuJzsKaW1wb3J0IHsgQmlsbGluZ1RpZXIsIEJpbGxpbmdDeWNsZSB9IGZyb20gJ0BzcmMvdHlwZXMvYmlsbGluZyc7CmltcG9ydCB7IGJpbGxpbmdDcmVhdGUsIGJpbGxpbmdVcGRhdGUsIHNlbGVjdEJpbGxpbmdMb2FkaW5nLCBzZWxlY3RCaWxsaW5nTG9hZGluZ0Vycm9yLCBzZWxlY3RCaWxsaW5nSGF2ZUFjdGl2ZVN1YnNjcmlwdGlvbiwgYmlsbGluZ1VwZ3JhZGVDb3Vwb25TZXQsIHNlbGVjdEJpbGxpbmdDb3Vwb24sIGJpbGxpbmdVcGdyYWRlQ291cG9uVW5zZXQsIHNlbGVjdEJpbGxpbmdQbGFuRXhwaXJlcywgfSBmcm9tICdAc3JjL2R1Y2tzL2JpbGxpbmcnOwppbXBvcnQgeyBzZWxlY3RVc2VySXNBZG1pbiB9IGZyb20gJ0BzcmMvZHVja3MvbWUnOwovLyB0byBkbzogY3JlYXRlIHNlbGVjdG9yIGZvciB0aGlzCmV4cG9ydCB2YXIgc2VsZWN0Q291cG9uTG9hZGluZyA9IGZ1bmN0aW9uIChzdGF0ZSkgewogICAgcmV0dXJuIE9iamVjdC52YWx1ZXMoc3RhdGUuYmlsbGluZy5jb3Vwb25zKS5zb21lKGZ1bmN0aW9uIChjb3Vwb24pIHsgcmV0dXJuIGNvdXBvbi5zdGF0dXMgPT09ICdsb2FkaW5nJzsgfSk7Cn07CnZhciBtYXBTdGF0ZVRvUHJvcHMgPSBmdW5jdGlvbiAoc3RhdGUsIG93blByb3BzKSB7CiAgICB2YXIgX2E7CiAgICB2YXIgdGllciA9IG93blByb3BzLm1hdGNoLnBhcmFtcy50aWVyIHx8IEJpbGxpbmdUaWVyLlRlYW07CiAgICB2YXIgY3ljbGUgPSBvd25Qcm9wcy5tYXRjaC5wYXJhbXMuY3ljbGUgfHwgQmlsbGluZ0N5Y2xlLkFubnVhbDsKICAgIC8vIFZhbGlkYXRlIGFuZCBzZXQgZGVmYXVsdHMgaWYgaGF2ZSBpbmNvcnJlY3QgVVJMIHBhcmFtcwogICAgaWYgKE9iamVjdC5rZXlzKEJpbGxpbmdUaWVyKS5maWx0ZXIoZnVuY3Rpb24gKGspIHsgcmV0dXJuIEJpbGxpbmdUaWVyW2tdID09PSB0aWVyOyB9KS5sZW5ndGggPT09IDApIHsKICAgICAgICB0aWVyID0gQmlsbGluZ1RpZXIuVGVhbTsKICAgIH0KICAgIGlmIChPYmplY3Qua2V5cyhCaWxsaW5nQ3ljbGUpLmZpbHRlcihmdW5jdGlvbiAoaykgeyByZXR1cm4gQmlsbGluZ0N5Y2xlW2tdID09PSBjeWNsZTsgfSkubGVuZ3RoID09PSAwKSB7CiAgICAgICAgY3ljbGUgPSBCaWxsaW5nQ3ljbGUuQW5udWFsOwogICAgfQogICAgdmFyIGJpbGxpbmcgPSBzdGF0ZS5iaWxsaW5nLnJlc291cmNlLmRhdGE7CiAgICB2YXIgc3Vic2NyaXB0aW9uID0gYmlsbGluZyAmJiBiaWxsaW5nLnN1YnNjcmlwdGlvbjsKICAgIHZhciBzdWJzY3JpcHRpb25TZWF0cyA9IHN1YnNjcmlwdGlvbiAmJiBzdWJzY3JpcHRpb24uc2VhdHM7CiAgICB2YXIgdGVhbVNlYXRzID0gc3RhdGUudGVhbS5kYXRhICYmIHN0YXRlLnRlYW0uZGF0YS5zZWF0c1VzZWQ7CiAgICB2YXIgdXBncmFkZUNvdXBvbiA9IHN0YXRlLmJpbGxpbmcudXBncmFkZUNvdXBvbiAmJgogICAgICAgIHNlbGVjdEJpbGxpbmdDb3Vwb24oc3RhdGUsIHN0YXRlLmJpbGxpbmcudXBncmFkZUNvdXBvbik7CiAgICByZXR1cm4gewogICAgICAgIGxvYWRpbmc6IHNlbGVjdEJpbGxpbmdMb2FkaW5nKHN0YXRlKSwKICAgICAgICBsb2FkaW5nRXJyb3I6IHNlbGVjdEJpbGxpbmdMb2FkaW5nRXJyb3Ioc3RhdGUpLAogICAgICAgIGlzQWRtaW46IHNlbGVjdFVzZXJJc0FkbWluKHN0YXRlKSwKICAgICAgICB1cGRhdGluZzogc3RhdGUuYmlsbGluZy51cGRhdGluZywKICAgICAgICBlcnJvcjogc3RhdGUuYmlsbGluZy51cGdyYWRpbmdFcnJvciwKICAgICAgICBzZWF0czogc3Vic2NyaXB0aW9uU2VhdHMgfHwgdGVhbVNlYXRzIHx8IDEsCiAgICAgICAgc3Vic2NyaXB0aW9uOiBzdWJzY3JpcHRpb24sCiAgICAgICAgYWN0aXZlU3Vic2NyaXB0aW9uOiBzZWxlY3RCaWxsaW5nSGF2ZUFjdGl2ZVN1YnNjcmlwdGlvbihzdGF0ZSksCiAgICAgICAgYmFsYW5jZTogYmlsbGluZyAmJiBiaWxsaW5nLmJhbGFuY2UgfHwgMCwKICAgICAgICBzZWxlY3RlZFRpZXI6IHRpZXIsCiAgICAgICAgc2VsZWN0ZWRDeWNsZTogY3ljbGUsCiAgICAgICAgdHJpYWxFeHBpcmVzOiBzdGF0ZS50ZWFtLmRhdGEgJiYgc3RhdGUudGVhbS5kYXRhLnRyaWFsRXhwaXJlcywKICAgICAgICBwbGFuRXhwaXJlczogc2VsZWN0QmlsbGluZ1BsYW5FeHBpcmVzKHN0YXRlKSwKICAgICAgICB0cmlhbFBsYW46IHN0YXRlLnRlYW0uZGF0YSAmJiBzdGF0ZS50ZWFtLmRhdGEudHJpYWxQbGFuLAogICAgICAgIC8vIGZyb20gcGFyYW1zIGFuZCBub3QgeWV0IHZhbGlkYXRlZCB3aXRoIHRoZSBhcGkKICAgICAgICBwYXJhbXNDb3Vwb246IChfYSA9IHN0YXRlLm1lLmRhdGEpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5jb3Vwb24sCiAgICAgICAgdXBncmFkZUNvdXBvbjogc3RhdGUuYmlsbGluZy51cGdyYWRlQ291cG9uICYmIHN0YXRlLmJpbGxpbmcudXBncmFkZUNvdXBvbi5jb3Vwb24gfHwgJycsCiAgICAgICAgdXBncmFkZUNvdXBvblBlcmNlbnQ6IHVwZ3JhZGVDb3Vwb24gJiYgdXBncmFkZUNvdXBvbi5kYXRhICYmIHVwZ3JhZGVDb3Vwb24uZGF0YS5jb3Vwb25QZXJjZW50LAogICAgICAgIGlzTG9hZGluZ0NvdXBvbjogc2VsZWN0Q291cG9uTG9hZGluZyhzdGF0ZSksCiAgICAgICAgaXNNb2JpbGU6IHN0YXRlLmlzTW9iaWxlLAogICAgICAgIHN0YXR1c05ldzogc3RhdGUubWUuZGF0YSAmJiBzdGF0ZS5tZS5kYXRhLnN0YXR1c05ldywKICAgIH07Cn07CnZhciBtYXBEaXNwYXRjaFRvUHJvcHMgPSBmdW5jdGlvbiAoZGlzcGF0Y2gpIHsgcmV0dXJuICh7CiAgICBjcmVhdGVCaWxsaW5nOiBmdW5jdGlvbiAoYm9keSkgeyByZXR1cm4gZGlzcGF0Y2goYmlsbGluZ0NyZWF0ZShib2R5KSk7IH0sCiAgICB1cGRhdGVCaWxsaW5nOiBmdW5jdGlvbiAoYm9keSkgeyByZXR1cm4gZGlzcGF0Y2goYmlsbGluZ1VwZGF0ZShib2R5KSk7IH0sCiAgICBzZXRVcGdyYWRlQ291cG9uOiBmdW5jdGlvbiAoY291cG9uKSB7IHJldHVybiBkaXNwYXRjaChiaWxsaW5nVXBncmFkZUNvdXBvblNldChjb3Vwb24pKTsgfSwKICAgIHVuc2V0VXBncmFkZUNvdXBvbjogZnVuY3Rpb24gKCkgeyByZXR1cm4gZGlzcGF0Y2goYmlsbGluZ1VwZ3JhZGVDb3Vwb25VbnNldChudWxsKSk7IH0sCn0pOyB9OwpleHBvcnQgZGVmYXVsdCB3aXRoUm91dGVyKGNvbm5lY3QobWFwU3RhdGVUb1Byb3BzLCBtYXBEaXNwYXRjaFRvUHJvcHMpKFVwZ3JhZGVQbGFuKSk7Cg=="},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Settings/routes/Billing/UpgradePlan/index.ts","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/routes/Settings/routes/Billing/UpgradePlan/index.ts"],"names":[],"mappings":"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","sourcesContent":["import { connect } from 'react-redux';\nimport { RouteComponentProps, withRouter } from 'react-router';\n\nimport { StoreState } from '@src/types';\nimport UpgradePlan, { Props, DispatchProps } from './UpgradePlan';\nimport { BillingTier, BillingCycle } from '@src/types/billing';\nimport { Dispatch } from 'redux';\n\nimport {\n  billingCreate, billingUpdate, selectBillingLoading,\n  selectBillingLoadingError, selectBillingHaveActiveSubscription,\n  billingUpgradeCouponSet, selectBillingCoupon, billingUpgradeCouponUnset,\n  selectBillingPlanExpires,\n} from '@src/ducks/billing';\nimport { selectUserIsAdmin } from '@src/ducks/me';\n\n// to do: create selector for this\nexport const selectCouponLoading = (state: StoreState) => {\n  return Object.values(state.billing.coupons).some(coupon => coupon.status === 'loading');\n};\n\nconst mapStateToProps = (state: StoreState, ownProps: RouteComponentProps<any>): Props => {\n  let tier = ownProps.match.params.tier || BillingTier.Team;\n  let cycle = ownProps.match.params.cycle || BillingCycle.Annual;\n\n  // Validate and set defaults if have incorrect URL params\n  if (Object.keys(BillingTier).filter(k => BillingTier[k] === tier).length === 0) {\n    tier = BillingTier.Team;\n  }\n\n  if (Object.keys(BillingCycle).filter(k => BillingCycle[k] === cycle).length === 0) {\n    cycle = BillingCycle.Annual;\n  }\n\n  const billing = state.billing.resource.data;\n  const subscription = billing && billing.subscription;\n  const subscriptionSeats = subscription && subscription.seats;\n  const teamSeats = state.team.data && state.team.data.seatsUsed;\n  const upgradeCoupon = state.billing.upgradeCoupon &&\n    selectBillingCoupon(state, state.billing.upgradeCoupon);\n\n  return {\n    loading: selectBillingLoading(state),\n    loadingError: selectBillingLoadingError(state),\n    isAdmin: selectUserIsAdmin(state),\n    updating: state.billing.updating,\n    error: state.billing.upgradingError,\n\n    seats: subscriptionSeats || teamSeats || 1,\n    subscription,\n    activeSubscription: selectBillingHaveActiveSubscription(state),\n    balance: billing && billing.balance || 0,\n    selectedTier: tier,\n    selectedCycle: cycle,\n    trialExpires: state.team.data && state.team.data.trialExpires,\n    planExpires: selectBillingPlanExpires(state),\n    trialPlan: state.team.data && state.team.data.trialPlan,\n    // from params and not yet validated with the api\n    paramsCoupon: state.me.data?.coupon,\n    upgradeCoupon: state.billing.upgradeCoupon && state.billing.upgradeCoupon.coupon || '',\n    upgradeCouponPercent: upgradeCoupon && upgradeCoupon.data && upgradeCoupon.data.couponPercent,\n    isLoadingCoupon: selectCouponLoading(state),\n    isMobile: state.isMobile,\n    statusNew: state.me.data && state.me.data.statusNew,\n  };\n};\n\nconst mapDispatchToProps = (dispatch: Dispatch<StoreState>): DispatchProps => ({\n  createBilling: body => dispatch(billingCreate(body)),\n  updateBilling: body => dispatch(billingUpdate(body)),\n  setUpgradeCoupon: coupon => dispatch(billingUpgradeCouponSet(coupon)),\n  unsetUpgradeCoupon: () => dispatch(billingUpgradeCouponUnset(null)),\n});\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(UpgradePlan));\n"]}]}