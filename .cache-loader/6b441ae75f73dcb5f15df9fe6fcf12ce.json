{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/ducks/scheduling.ts","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/ducks/scheduling.ts","mtime":1675280254051},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF9hLCBfYiwgX2MsIF9kLCBfZSwgX2YsIF9nLCBfaDsKaW1wb3J0IHsgY3JlYXRlIH0gZnJvbSAnQHNyYy9saWIvcmVkdXgnOwppbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7CmltcG9ydCB7IGtleUJ5LCB2YWx1ZXMgfSBmcm9tICdsb2Rhc2gnOwppbXBvcnQgdXBkYXRlIGZyb20gJ2ltbXV0YWJpbGl0eS1oZWxwZXInOwppbXBvcnQgeyBjcmVhdGVTZWxlY3RvciB9IGZyb20gJ0BzcmMvbGliL3NlbGVjdG9yJzsKaW1wb3J0IHsgcmVzb3VyY2VPaywgcmVzb3VyY2VGYWlsZWQsIHJlc291cmNlUGVuZGluZyB9IGZyb20gJ0BzcmMvbGliL3Jlc291cmNlJzsKaW1wb3J0IHsgZ2V0U2Vjb25kc1NpbmNlTWlkbmlnaHQgfSBmcm9tICdAc3JjL2xpYi9kYXRldGltZSc7CmV4cG9ydCB2YXIgU0NIRURVTElOR19VUkxfQ09QWSA9IChfYSA9IGNyZWF0ZSgnU0NIRURVTElOR19VUkxfQ09QWScsIHsKICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChzdGF0ZSwgbWV0YSwgcGF5bG9hZCkgeyByZXR1cm4gdXBkYXRlKHN0YXRlLCB7fSk7IH0sCn0pLCBfYS50eXBlKSwgc2NoZWR1bGluZ1VybENvcHkgPSBfYS5hY3Rpb24sIHNjaGVkdWxpbmdVcmxDb3B5UmVkdWNlciA9IF9hLnJlZHVjZXI7CmV4cG9ydCB2YXIgU0NIRURVTElOR19MSVNUID0gKF9iID0gY3JlYXRlKCdTQ0hFRFVMSU5HX0xJU1QnLCB7CiAgICBzdWNjZXNzOiBmdW5jdGlvbiAoc3RhdGUsIG1ldGEsIHBheWxvYWQpIHsgcmV0dXJuIHVwZGF0ZShzdGF0ZSwgewogICAgICAgIHNjaGVkdWxpbmc6IHsKICAgICAgICAgICAgc2NoZWR1bGluZ3M6IHsKICAgICAgICAgICAgICAgICRzZXQ6IGtleUJ5KHBheWxvYWQsICdpZCcpLAogICAgICAgICAgICB9LAogICAgICAgIH0sCiAgICB9KTsgfSwKfSksIF9iLnR5cGUpLCBzY2hlZHVsaW5nTGlzdCA9IF9iLmFjdGlvbiwgc2NoZWR1bGluZ0xpc3RSZWR1Y2VyID0gX2IucmVkdWNlcjsKZXhwb3J0IHZhciBTQ0hFRFVMSU5HX0NSRUFURSA9IChfYyA9IGNyZWF0ZSgnU0NIRURVTElOR19DUkVBVEUnLCB7CiAgICBzdWNjZXNzOiBmdW5jdGlvbiAoc3RhdGUsIG1ldGEsIHBheWxvYWQpIHsKICAgICAgICB2YXIgX2E7CiAgICAgICAgcmV0dXJuIHVwZGF0ZShzdGF0ZSwgewogICAgICAgICAgICBzY2hlZHVsaW5nOiB7CiAgICAgICAgICAgICAgICBzY2hlZHVsaW5nczogKF9hID0ge30sCiAgICAgICAgICAgICAgICAgICAgX2FbcGF5bG9hZC5pZF0gPSB7ICRzZXQ6IHBheWxvYWQgfSwKICAgICAgICAgICAgICAgICAgICBfYSksCiAgICAgICAgICAgIH0sCiAgICAgICAgfSk7CiAgICB9LAp9KSwgX2MudHlwZSksIHNjaGVkdWxpbmdDcmVhdGUgPSBfYy5hY3Rpb24sIHNjaGVkdWxpbmdDcmVhdGVSZWR1Y2VyID0gX2MucmVkdWNlcjsKZXhwb3J0IHZhciBTQ0hFRFVMSU5HX1VQREFURSA9IChfZCA9IGNyZWF0ZSgnU0NIRURVTElOR19VUERBVEUnLCB7CiAgICBzdWNjZXNzOiBmdW5jdGlvbiAoc3RhdGUsIG1ldGEsIHBheWxvYWQpIHsKICAgICAgICB2YXIgX2E7CiAgICAgICAgcmV0dXJuIHVwZGF0ZShzdGF0ZSwgewogICAgICAgICAgICBzY2hlZHVsaW5nOiB7CiAgICAgICAgICAgICAgICBzY2hlZHVsaW5nczogKF9hID0ge30sCiAgICAgICAgICAgICAgICAgICAgX2FbbWV0YS5pZF0gPSB7ICRzZXQ6IHBheWxvYWQgfSwKICAgICAgICAgICAgICAgICAgICBfYSksCiAgICAgICAgICAgIH0sCiAgICAgICAgfSk7CiAgICB9LAp9KSwgX2QudHlwZSksIHNjaGVkdWxpbmdVcGRhdGUgPSBfZC5hY3Rpb24sIHNjaGVkdWxpbmdVcGRhdGVSZWR1Y2VyID0gX2QucmVkdWNlcjsKZXhwb3J0IHZhciBTQ0hFRFVMSU5HX0RFTEVURSA9IChfZSA9IGNyZWF0ZSgnU0NIRURVTElOR19ERUxFVEUnLCB7CiAgICBzdWNjZXNzOiBmdW5jdGlvbiAoc3RhdGUsIG1ldGEsIHBheWxvYWQpIHsgcmV0dXJuIHVwZGF0ZShzdGF0ZSwgewogICAgICAgIHNjaGVkdWxpbmc6IHsKICAgICAgICAgICAgc2NoZWR1bGluZ3M6IHsKICAgICAgICAgICAgICAgICR1bnNldDogW21ldGEuaWRdLAogICAgICAgICAgICB9LAogICAgICAgIH0sCiAgICB9KTsgfSwKfSksIF9lLnR5cGUpLCBzY2hlZHVsaW5nRGVsZXRlID0gX2UuYWN0aW9uLCBzY2hlZHVsaW5nRGVsZXRlUmVkdWNlciA9IF9lLnJlZHVjZXI7CmV4cG9ydCB2YXIgU0NIRURVTElOR19QVUJMSUNfR0VUID0gKF9mID0gY3JlYXRlKCdTQ0hFRFVMSU5HX1BVQkxJQ19HRVQnLCB7CiAgICBzdWNjZXNzOiBmdW5jdGlvbiAoc3RhdGUsIG1ldGEsIHBheWxvYWQpIHsKICAgICAgICB2YXIgX2E7CiAgICAgICAgcmV0dXJuIHVwZGF0ZShzdGF0ZSwgewogICAgICAgICAgICBzY2hlZHVsaW5nOiB7CiAgICAgICAgICAgICAgICBzY2hlZHVsaW5nUHVibGljczogKF9hID0ge30sCiAgICAgICAgICAgICAgICAgICAgX2FbbWV0YS51c2VyU2x1ZyArIG1ldGEuc2x1Z10gPSB7ICRzZXQ6IHJlc291cmNlT2socGF5bG9hZCkgfSwKICAgICAgICAgICAgICAgICAgICBfYSksCiAgICAgICAgICAgIH0sCiAgICAgICAgfSk7CiAgICB9LAogICAgZmFpbHVyZTogZnVuY3Rpb24gKHN0YXRlLCBtZXRhLCBlcnJvcikgewogICAgICAgIHZhciBfYTsKICAgICAgICByZXR1cm4gdXBkYXRlKHN0YXRlLCB7CiAgICAgICAgICAgIHNjaGVkdWxpbmc6IHsKICAgICAgICAgICAgICAgIHNjaGVkdWxpbmdQdWJsaWNzOiAoX2EgPSB7fSwKICAgICAgICAgICAgICAgICAgICBfYVttZXRhLnVzZXJTbHVnICsgbWV0YS5zbHVnXSA9IHsgJHNldDogcmVzb3VyY2VGYWlsZWQoZXJyb3IpIH0sCiAgICAgICAgICAgICAgICAgICAgX2EpLAogICAgICAgICAgICB9LAogICAgICAgIH0pOwogICAgfSwKfSksIF9mLnR5cGUpLCBzY2hlZHVsaW5nUHVibGljR2V0ID0gX2YuYWN0aW9uLCBzY2hlZHVsaW5nUHVibGljR2V0UmVkdWNlciA9IF9mLnJlZHVjZXI7Ci8vIFRPRE8oU0hJTik6IE1ha2Ugc3VyZSB0aGF0IHRpbWUgd2luZG93cyBjb3JyZWxhdGUgd2l0aCBjb3JyZWN0IHRpbWV6b25lCi8vIFRPRE8oU0hJTik6IE1vdmUgaW50byBvd24gZnVuY3Rpb24gbWV0aG9kLCBlYXNpZXIgdG8gdGVzdApleHBvcnQgdmFyIFRJTUVfU0xPVFNfTElTVCA9IChfZyA9IGNyZWF0ZSgnVElNRV9TTE9UU19MSVNUJywgewogICAgc3RhcnQ6IGZ1bmN0aW9uIChzdGF0ZSwgbWV0YSkgewogICAgICAgIHZhciBkYXlTZXBhcmF0ZWRUaW1lU2xvdHMgPSB7fTsKICAgICAgICB2YXIgZGF5SXRlcmF0b3IgPSBtb21lbnQobWV0YS5zdGFydCk7CiAgICAgICAgdmFyIGVuZCA9IG1vbWVudChtZXRhLmVuZCk7CiAgICAgICAgd2hpbGUgKGRheUl0ZXJhdG9yIDwgZW5kKSB7CiAgICAgICAgICAgIHZhciBrZXkgPSBkYXlJdGVyYXRvci5zdGFydE9mKCdkYXknKTsKICAgICAgICAgICAgZGF5U2VwYXJhdGVkVGltZVNsb3RzW2tleS50b1N0cmluZygpXSA9IFtdOwogICAgICAgICAgICBkYXlJdGVyYXRvciA9IGRheUl0ZXJhdG9yLmFkZCgxLCAnZGF5Jyk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB1cGRhdGUoc3RhdGUsIHsKICAgICAgICAgICAgc2NoZWR1bGluZzogewogICAgICAgICAgICAgICAgdGltZVNsb3RzOiB7CiAgICAgICAgICAgICAgICAgICAgJHNldDogZGF5U2VwYXJhdGVkVGltZVNsb3RzLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHRpbWVTbG90c0xvYWRpbmc6IHsgJHNldDogdHJ1ZSB9LAogICAgICAgICAgICAgICAgdGltZVNsb3RzRXJyb3I6IHsgJHNldDogdW5kZWZpbmVkIH0sCiAgICAgICAgICAgIH0sCiAgICAgICAgfSk7CiAgICB9LAogICAgc3VjY2VzczogZnVuY3Rpb24gKHN0YXRlLCBtZXRhLCBwYXlsb2FkKSB7CiAgICAgICAgLy8gQ2FsY3VsYXRlIHRpbWVzbG90cyBmb3IgZWFjaCBpbmRpdmlkdWFsIGRheQogICAgICAgIHZhciB0aW1lc2xvdHMgPSBwYXlsb2FkOwogICAgICAgIHZhciBkYXlTZXBhcmF0ZWRUaW1lU2xvdHMgPSB7fTsKICAgICAgICB2YXIgc3RhcnQgPSBtb21lbnQodGltZXNsb3RzWzBdLnN0YXJ0VGltZSk7CiAgICAgICAgdmFyIGVuZCA9IG1vbWVudChtZXRhLmVuZCk7CiAgICAgICAgLy8gSWRlbnRpZnkgYm91bmRzIG9mIHVuYmxvY2tlZCB0aW1lcwogICAgICAgIHZhciB1bmJsb2NrZWRUaW1lU2xvdHMgPSB0aW1lc2xvdHMKICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoc2xvdCkgeyByZXR1cm4gIXNsb3QuYmxvY2tpbmc7IH0pOwogICAgICAgIHZhciBzdGFydEJvdW5kID0gdW5ibG9ja2VkVGltZVNsb3RzCiAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKHNsb3QpIHsgcmV0dXJuIGdldFNlY29uZHNTaW5jZU1pZG5pZ2h0KG1vbWVudChzbG90LnN0YXJ0VGltZSkpOyB9KQogICAgICAgICAgICAuc29ydChmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gYSAtIGI7IH0pWzBdOwogICAgICAgIHZhciBlbmRCb3VuZCA9IHVuYmxvY2tlZFRpbWVTbG90cwogICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChzbG90KSB7IHJldHVybiBnZXRTZWNvbmRzU2luY2VNaWRuaWdodChtb21lbnQoc2xvdC5lbmRUaW1lKSk7IH0pCiAgICAgICAgICAgIC5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBiIC0gYTsgfSlbMF07CiAgICAgICAgLy8gU2VwYXJhdGUgb3V0IGludG8gZGF5cwogICAgICAgIHZhciBkYXlJdGVyYXRvciA9IHN0YXJ0OwogICAgICAgIHdoaWxlIChkYXlJdGVyYXRvciA8IGVuZCkgewogICAgICAgICAgICB2YXIgZmlsdGVyZWRUaW1lc2xvdHMgPSB0aW1lc2xvdHMKICAgICAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKHNsb3QpIHsKICAgICAgICAgICAgICAgIHZhciBzdGFydE1vbWVudCA9IG1vbWVudChzbG90LnN0YXJ0VGltZSk7CiAgICAgICAgICAgICAgICB2YXIgZW5kTW9tZW50ID0gbW9tZW50KHNsb3QuZW5kVGltZSk7CiAgICAgICAgICAgICAgICAvLyBSZXR1cm4gdmFsdWUgaWYgc3RhcnRUaW1lIGlzIG9mIHNhbWUgZGF5IGFuZCBzbG90IGlzIHdpdGhpbiB0aW1lIGJvdW5kcwogICAgICAgICAgICAgICAgLy8gYW5kIHNsb3QgaXMgaW4gdGhlIGZ1dHVyZQogICAgICAgICAgICAgICAgdmFyIHNsb3RTdGFydCA9IGdldFNlY29uZHNTaW5jZU1pZG5pZ2h0KHN0YXJ0TW9tZW50KTsKICAgICAgICAgICAgICAgIHZhciBzbG90RW5kID0gZ2V0U2Vjb25kc1NpbmNlTWlkbmlnaHQoZW5kTW9tZW50KTsKICAgICAgICAgICAgICAgIC8vIElmIHByb3BlciBlbmQgYW5kIHN0YXJ0IGJvdW5kcywgYm91bmQgYmV0d2VlbiB0aW1lIHdpbmRvd3MKICAgICAgICAgICAgICAgIGlmIChlbmRCb3VuZCA+IHN0YXJ0Qm91bmQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbW9tZW50KHNsb3Quc3RhcnRUaW1lKS5pc1NhbWUoZGF5SXRlcmF0b3IsICdkYXknKSAmJgogICAgICAgICAgICAgICAgICAgICAgICBzbG90U3RhcnQgPj0gc3RhcnRCb3VuZCAmJiBzbG90RW5kIDw9IGVuZEJvdW5kOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gT3RoZXJ3aXNlIGp1c3QgY2hlY2sgZGF5IHNsb3RzCiAgICAgICAgICAgICAgICByZXR1cm4gbW9tZW50KHNsb3Quc3RhcnRUaW1lKS5pc1NhbWUoZGF5SXRlcmF0b3IsICdkYXknKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIC8vIFB1c2ggdGltZXNsb3RzIGZvciB0aGF0IHBhcnRpZmN1bGFyIGRheQogICAgICAgICAgICBkYXlTZXBhcmF0ZWRUaW1lU2xvdHNbZGF5SXRlcmF0b3Iuc3RhcnRPZignZGF5JykudG9TdHJpbmcoKV0gPSBmaWx0ZXJlZFRpbWVzbG90czsKICAgICAgICAgICAgZGF5SXRlcmF0b3IgPSBkYXlJdGVyYXRvci5hZGQoMSwgJ2RheXMnKTsKICAgICAgICB9CiAgICAgICAgLy8gVXBkYXRlIHRpbWVzbG90cwogICAgICAgIHJldHVybiB1cGRhdGUoc3RhdGUsIHsKICAgICAgICAgICAgc2NoZWR1bGluZzogewogICAgICAgICAgICAgICAgdGltZVNsb3RzOiB7CiAgICAgICAgICAgICAgICAgICAgJG1lcmdlOiBkYXlTZXBhcmF0ZWRUaW1lU2xvdHMsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgdGltZVNsb3RzTG9hZGluZzogeyAkc2V0OiBmYWxzZSB9LAogICAgICAgICAgICB9LAogICAgICAgIH0pOwogICAgfSwKICAgIGZhaWx1cmU6IGZ1bmN0aW9uIChzdGF0ZSwgbWV0YSwgZXJyb3IpIHsKICAgICAgICByZXR1cm4gdXBkYXRlKHN0YXRlLCB7CiAgICAgICAgICAgIHNjaGVkdWxpbmc6IHsKICAgICAgICAgICAgICAgIHRpbWVTbG90c0Vycm9yOiB7ICRzZXQ6IGVycm9yIH0sCiAgICAgICAgICAgIH0sCiAgICAgICAgfSk7CiAgICB9LAp9KSwgX2cudHlwZSksIHRpbWVzbG90c0xpc3QgPSBfZy5hY3Rpb24sIHRpbWVTbG90c0xpc3RSZWR1Y2VyID0gX2cucmVkdWNlcjsKZXhwb3J0IHZhciBDQUxFTkRBUl9FVkVOVF9DUkVBVEUgPSAoX2ggPSBjcmVhdGUoJ0NBTEVOREFSX0VWRU5UX0NSRUFURScsIHsKICAgIHN0YXJ0OiBmdW5jdGlvbiAoc3RhdGUsIG1ldGEpIHsKICAgICAgICByZXR1cm4gdXBkYXRlKHN0YXRlLCB7CiAgICAgICAgICAgIHNjaGVkdWxpbmc6IHsKICAgICAgICAgICAgICAgIGNyZWF0ZWRFdmVudDogeyAkc2V0OiByZXNvdXJjZVBlbmRpbmcoKSB9LAogICAgICAgICAgICB9LAogICAgICAgIH0pOwogICAgfSwKICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChzdGF0ZSwgbWV0YSwgcGF5bG9hZCkgewogICAgICAgIHJldHVybiB1cGRhdGUoc3RhdGUsIHsKICAgICAgICAgICAgc2NoZWR1bGluZzogewogICAgICAgICAgICAgICAgY3JlYXRlZEV2ZW50OiB7ICRzZXQ6IHJlc291cmNlT2socGF5bG9hZCkgfSwKICAgICAgICAgICAgfSwKICAgICAgICB9KTsKICAgIH0sCiAgICBmYWlsdXJlOiBmdW5jdGlvbiAoc3RhdGUsIG1ldGEsIGVycm9yKSB7CiAgICAgICAgcmV0dXJuIHVwZGF0ZShzdGF0ZSwgewogICAgICAgICAgICBzY2hlZHVsaW5nOiB7CiAgICAgICAgICAgICAgICBjcmVhdGVkRXZlbnQ6IHsgJHNldDogcmVzb3VyY2VGYWlsZWQoZXJyb3IpIH0sCiAgICAgICAgICAgIH0sCiAgICAgICAgfSk7CiAgICB9LAp9KSwgX2gudHlwZSksIGNhbGVuZGFyRXZlbnRDcmVhdGUgPSBfaC5hY3Rpb24sIGNhbGVuZGFyRXZlbnRDcmVhdGVSZWR1Y2VyID0gX2gucmVkdWNlcjsKLy8gU2VsZWN0cyBjYWxlbmRhciBzY2hlZHVsaW5nIHVybApleHBvcnQgdmFyIHNlbGVjdENhbGVuZGFyU2NoZWR1bGluZ1VybCA9IGNyZWF0ZVNlbGVjdG9yKFsKICAgIGZ1bmN0aW9uIChzdGF0ZSkgewogICAgICAgIHJldHVybiBzdGF0ZS5zY2hlZHVsaW5nICYmIHN0YXRlLnNjaGVkdWxpbmcuc2NoZWR1bGluZ3MgJiYKICAgICAgICAgICAgdmFsdWVzKHN0YXRlLnNjaGVkdWxpbmcuc2NoZWR1bGluZ3MpICYmIHZhbHVlcyhzdGF0ZS5zY2hlZHVsaW5nLnNjaGVkdWxpbmdzKVswXSAmJgogICAgICAgICAgICAhdmFsdWVzKHN0YXRlLnNjaGVkdWxpbmcuc2NoZWR1bGluZ3MpWzBdLmRpc2FibGVkICYmCiAgICAgICAgICAgIHZhbHVlcyhzdGF0ZS5zY2hlZHVsaW5nLnNjaGVkdWxpbmdzKVswXS5zbHVnIHx8IHVuZGVmaW5lZDsKICAgIH0sCiAgICBmdW5jdGlvbiAoc3RhdGUpIHsgcmV0dXJuIHN0YXRlLm1lICYmIHN0YXRlLm1lLmRhdGEgJiYgc3RhdGUubWUuZGF0YS5zbHVnOyB9LApdLCBmdW5jdGlvbiAoc2x1ZywgdXNlclNsdWcpIHsKICAgIGlmICghIXNsdWcgJiYgISF1c2VyU2x1ZykgewogICAgICAgIHJldHVybiBwcm9jZXNzLmVudi5TQ0hFRFVMSU5HX1VSTCArICIvIiArIHVzZXJTbHVnICsgIi8iICsgc2x1ZzsKICAgIH0KICAgIHJldHVybiB1bmRlZmluZWQ7Cn0sIGZ1bmN0aW9uIChzbHVnLCB1c2VyU2x1ZykgeyByZXR1cm4gIiIgKyB1c2VyU2x1ZyArIHNsdWc7IH0sIFsnc2NoZWR1bGluZycsICdtZSddKTsKZXhwb3J0IGRlZmF1bHQgWwogICAgc2NoZWR1bGluZ0xpc3RSZWR1Y2VyLAogICAgc2NoZWR1bGluZ0NyZWF0ZVJlZHVjZXIsCiAgICBzY2hlZHVsaW5nVXBkYXRlUmVkdWNlciwKICAgIHNjaGVkdWxpbmdEZWxldGVSZWR1Y2VyLAogICAgdGltZVNsb3RzTGlzdFJlZHVjZXIsCiAgICBjYWxlbmRhckV2ZW50Q3JlYXRlUmVkdWNlciwKICAgIHNjaGVkdWxpbmdQdWJsaWNHZXRSZWR1Y2VyLApdOwo="},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/ducks/scheduling.ts","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/ducks/scheduling.ts"],"names":[],"mappings":";AAAA,OAAO,EAAE,MAAM,EAAE,MAAM,gBAAgB,CAAC;AACxC,OAAO,MAAM,MAAM,QAAQ,CAAC;AAC5B,OAAO,EAAE,KAAK,EAAE,MAAM,EAAE,MAAM,QAAQ,CAAC;AACvC,OAAO,MAAM,MAAM,qBAAqB,CAAC;AAGzC,OAAO,EAAE,cAAc,EAAE,MAAM,mBAAmB,CAAC;AACnD,OAAO,EAAE,UAAU,EAAE,cAAc,EAAE,eAAe,EAAE,MAAM,mBAAmB,CAAC;AAChF,OAAO,EAAE,uBAAuB,EAAE,MAAM,mBAAmB,CAAC;AAE5D,MAAM,CACJ,IAAA;;YAAyB,EACzB,6BAAyB,EACzB,qCAAiC,CAGhC;AAEH,MAAM,CACJ,IAAA;;;;;;;;YAAqB,EACrB,0BAAsB,EACtB,kCAA8B,CAS7B;AAOH,MAAM,CACJ,IAAA;;;;;;;;;;;YAAuB,EACvB,4BAAwB,EACxB,oCAAgC,CAS/B;AAEH,MAAM,CACJ,IAAA;;;;;;;;;;;YAAuB,EACvB,4BAAwB,EACxB,oCAAgC,CAS/B;AAEH,MAAM,CACJ,IAAA;;;;;;;;YAAuB,EACvB,4BAAwB,EACxB,oCAAgC,CAS/B;AAOH,MAAM,CACJ,IAAA;;;;;;;;;;;;;;;;;;;;;YAA2B,EAC3B,+BAA2B,EAC3B,uCAAmC,CAoBlC;AAOH,0EAA0E;AAC1E,4DAA4D;AAC5D,MAAM,CACJ,IAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;YAAqB,EACrB,yBAAqB,EACrB,iCAA6B,CAoF5B;AAQH,MAAM,CACJ,IAAA;;;;;;;;;;;;;;;;;;;;;;YAA2B,EAC3B,+BAA2B,EAC3B,uCAAmC,CAuBlC;AAEH,kCAAkC;AAClC,MAAM,CAAC,IAAM,2BAA2B,GAAG,cAAc,CAKvD;IACE,UAAC,KAAK;QACJ,OAAO,KAAK,CAAC,UAAU,IAAI,KAAK,CAAC,UAAU,CAAC,WAAW;YACrD,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;YAC/E,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ;YACjD,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,IAAI,SAAS,CAAC;IAC9D,CAAC;IACD,UAAA,KAAK,IAAI,OAAA,KAAK,CAAC,EAAE,IAAI,KAAK,CAAC,EAAE,CAAC,IAAI,IAAI,KAAK,CAAC,EAAE,CAAC,IAAI,CAAC,IAAI,EAA/C,CAA+C;CACzD,EACD,UAAC,IAAI,EAAE,QAAQ;IACb,IAAI,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,QAAQ,EAAE;QACxB,OAAU,OAAO,CAAC,GAAG,CAAC,cAAc,SAAI,QAAQ,SAAI,IAAM,CAAC;KAC5D;IAED,OAAO,SAAS,CAAC;AACnB,CAAC,EACD,UAAC,IAAI,EAAE,QAAQ,IAAK,OAAA,KAAG,QAAQ,GAAG,IAAM,EAApB,CAAoB,EACxC,CAAC,YAAY,EAAE,IAAI,CAAC,CACrB,CAAC;AAEF,eAAe;IACb,qBAAqB;IACrB,uBAAuB;IACvB,uBAAuB;IACvB,uBAAuB;IACvB,oBAAoB;IACpB,0BAA0B;IAC1B,0BAA0B;CAC3B,CAAC","sourcesContent":["import { create } from '@src/lib/redux';\nimport moment from 'moment';\nimport { keyBy, values } from 'lodash';\nimport update from 'immutability-helper';\nimport { RequiredPartial, CalendarEvent, Attendee } from '@src/types';\nimport { Scheduling, SchedulingPublic, TimeSlot } from '@src/types/scheduling';\nimport { createSelector } from '@src/lib/selector';\nimport { resourceOk, resourceFailed, resourcePending } from '@src/lib/resource';\nimport { getSecondsSinceMidnight } from '@src/lib/datetime';\n\nexport const {\n  type: SCHEDULING_URL_COPY,\n  action: schedulingUrlCopy,\n  reducer: schedulingUrlCopyReducer,\n} = create<Scheduling, string>('SCHEDULING_URL_COPY', {\n  success: (state, meta, payload) => update(state, {}),\n});\n\nexport const {\n  type: SCHEDULING_LIST,\n  action: schedulingList,\n  reducer: schedulingListReducer,\n} = create<null, Scheduling[]>('SCHEDULING_LIST', {\n  success: (state, meta, payload) => update(state, {\n    scheduling: {\n      schedulings: {\n        $set: keyBy(payload, 'id'),\n      },\n    },\n  }),\n});\n\nexport type SchedulingCreateMeta = RequiredPartial<\n  Scheduling,\n  'calendar' | 'blockingCalendars' | 'timeZone'\n  >;\n\nexport const {\n  type: SCHEDULING_CREATE,\n  action: schedulingCreate,\n  reducer: schedulingCreateReducer,\n} = create<SchedulingCreateMeta, Scheduling>('SCHEDULING_CREATE', {\n  success: (state, meta, payload) => update(state, {\n    scheduling: {\n      schedulings: {\n        [payload.id]: { $set: payload },\n      },\n    },\n  }),\n});\n\nexport const {\n  type: SCHEDULING_UPDATE,\n  action: schedulingUpdate,\n  reducer: schedulingUpdateReducer,\n} = create<Scheduling, Scheduling>('SCHEDULING_UPDATE', {\n  success: (state, meta, payload) => update(state, {\n    scheduling: {\n      schedulings: {\n        [meta.id]: { $set: payload },\n      },\n    },\n  }),\n});\n\nexport const {\n  type: SCHEDULING_DELETE,\n  action: schedulingDelete,\n  reducer: schedulingDeleteReducer,\n} = create<Scheduling, null>('SCHEDULING_DELETE', {\n  success: (state, meta, payload) => update(state, {\n    scheduling: {\n      schedulings: {\n        $unset: [meta.id],\n      },\n    },\n  }),\n});\n\nexport interface SchedulingPublicMeta {\n  userSlug: string;\n  slug: string;\n}\n\nexport const {\n  type: SCHEDULING_PUBLIC_GET,\n  action: schedulingPublicGet,\n  reducer: schedulingPublicGetReducer,\n} = create<SchedulingPublicMeta, SchedulingPublic>('SCHEDULING_PUBLIC_GET', {\n  success: (state, meta, payload) => {\n    return update(state, {\n      scheduling: {\n        schedulingPublics: {\n          [meta.userSlug + meta.slug]: { $set: resourceOk(payload) },\n        },\n      },\n    });\n  },\n  failure: (state, meta, error) => {\n    return update(state, {\n      scheduling: {\n        schedulingPublics: {\n          [meta.userSlug + meta.slug]: { $set: resourceFailed(error) },\n        },\n      },\n    });\n  },\n});\n\nexport interface TimeSlotMeta extends SchedulingPublicMeta {\n  start: Date;\n  end: Date;\n}\n\n// TODO(SHIN): Make sure that time windows correlate with correct timezone\n// TODO(SHIN): Move into own function method, easier to test\nexport const {\n  type: TIME_SLOTS_LIST,\n  action: timeslotsList,\n  reducer: timeSlotsListReducer,\n} = create<TimeSlotMeta, TimeSlot[]>('TIME_SLOTS_LIST', {\n  start: (state, meta) => {\n    const daySeparatedTimeSlots = {};\n    let dayIterator = moment(meta.start);\n    const end = moment(meta.end);\n\n    while (dayIterator < end) {\n      const key = dayIterator.startOf('day');\n      daySeparatedTimeSlots[key.toString()] = [];\n      dayIterator = dayIterator.add(1, 'day');\n    }\n\n    return update(state, {\n      scheduling: {\n        timeSlots: {\n          $set: daySeparatedTimeSlots,\n        },\n        timeSlotsLoading: { $set: true },\n        timeSlotsError: { $set: undefined },\n      },\n    });\n  },\n  success: (state, meta, payload) => {\n    // Calculate timeslots for each individual day\n    const timeslots = payload;\n    const daySeparatedTimeSlots = {};\n    const start = moment(timeslots[0].startTime);\n    const end = moment(meta.end);\n\n    // Identify bounds of unblocked times\n    const unblockedTimeSlots = timeslots\n      .filter(slot => !slot.blocking);\n    const startBound = unblockedTimeSlots\n      .map(slot => getSecondsSinceMidnight(moment(slot.startTime)))\n      .sort((a, b) => a - b)[0];\n    const endBound = unblockedTimeSlots\n      .map(slot => getSecondsSinceMidnight(moment(slot.endTime)))\n      .sort((a, b) => b - a)[0];\n\n    // Separate out into days\n    let dayIterator = start;\n    while (dayIterator < end) {\n      const filteredTimeslots = timeslots\n        .filter((slot) => {\n          const startMoment = moment(slot.startTime);\n          const endMoment = moment(slot.endTime);\n          // Return value if startTime is of same day and slot is within time bounds\n          // and slot is in the future\n          const slotStart = getSecondsSinceMidnight(startMoment);\n          const slotEnd = getSecondsSinceMidnight(endMoment);\n\n          // If proper end and start bounds, bound between time windows\n          if (endBound > startBound) {\n            return moment(slot.startTime).isSame(dayIterator, 'day') &&\n              slotStart >= startBound && slotEnd <= endBound;\n          }\n\n          // Otherwise just check day slots\n          return moment(slot.startTime).isSame(dayIterator, 'day');\n        });\n\n      // Push timeslots for that partifcular day\n      daySeparatedTimeSlots[dayIterator.startOf('day').toString()] = filteredTimeslots;\n      dayIterator = dayIterator.add(1, 'days');\n    }\n\n    // Update timeslots\n    return update(state, {\n      scheduling: {\n        timeSlots: {\n          $merge: daySeparatedTimeSlots,\n        },\n        timeSlotsLoading: { $set: false },\n      },\n    });\n  },\n  failure: (state, meta, error) => {\n    return update(state, {\n      scheduling: {\n        timeSlotsError: { $set: error },\n      },\n    });\n  },\n});\n\nexport interface CalendarEventCreateMeta extends SchedulingPublicMeta {\n  attendees: Attendee[];\n  start: Date;\n  end: Date;\n}\n\nexport const {\n  type: CALENDAR_EVENT_CREATE,\n  action: calendarEventCreate,\n  reducer: calendarEventCreateReducer,\n} = create < CalendarEventCreateMeta, CalendarEvent>('CALENDAR_EVENT_CREATE', {\n  start: (state, meta) => {\n    return update(state, {\n      scheduling: {\n        createdEvent: { $set: resourcePending() },\n      },\n    });\n  },\n  success: (state, meta, payload) => {\n    return update(state, {\n      scheduling: {\n        createdEvent: { $set: resourceOk(payload) },\n      },\n    });\n  },\n  failure: (state, meta, error) => {\n    return update(state, {\n      scheduling: {\n        createdEvent: { $set: resourceFailed(error) },\n      },\n    });\n  },\n});\n\n// Selects calendar scheduling url\nexport const selectCalendarSchedulingUrl = createSelector<\n  null,\n  string | undefined,\n  string | undefined\n>(\n  [\n    (state) => {\n      return state.scheduling && state.scheduling.schedulings &&\n        values(state.scheduling.schedulings) && values(state.scheduling.schedulings)[0] &&\n        !values(state.scheduling.schedulings)[0].disabled &&\n        values(state.scheduling.schedulings)[0].slug || undefined;\n    },\n    state => state.me && state.me.data && state.me.data.slug,\n  ],\n  (slug, userSlug) => {\n    if (!!slug && !!userSlug) {\n      return `${process.env.SCHEDULING_URL}/${userSlug}/${slug}`;\n    }\n\n    return undefined;\n  },\n  (slug, userSlug) => `${userSlug}${slug}`,\n  ['scheduling', 'me'],\n);\n\nexport default [\n  schedulingListReducer,\n  schedulingCreateReducer,\n  schedulingUpdateReducer,\n  schedulingDeleteReducer,\n  timeSlotsListReducer,\n  calendarEventCreateReducer,\n  schedulingPublicGetReducer,\n];\n"]}]}