{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/RightSidebar/components/LinkExtractor/LinkExtractor.tsx","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/RightSidebar/components/LinkExtractor/LinkExtractor.tsx","mtime":1675280254031},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewogICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewogICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAogICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKICAgIH07CiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwogICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQogICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKICAgIH07Cn0pKCk7CmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7CmltcG9ydCAnLi9MaW5rRXh0cmFjdG9yLnNjc3MnOwppbXBvcnQgeyBzb3J0TWF0Y2hlcyB9IGZyb20gJ0BzcmMvbGliL21hdGNoZXInOwppbXBvcnQgeyBLZXlDb2RlIH0gZnJvbSAnQHNyYy90eXBlcyc7CmltcG9ydCBjbGFzc05hbWVzIGZyb20gJ2NsYXNzbmFtZXMnOwppbXBvcnQgeyByZWNvcmRFdmVudCwgVXNlckV2ZW50cyB9IGZyb20gJ0BzcmMvbGliL2FuYWx5dGljcyc7CmltcG9ydCBicm93c2VySGlzdG9yeSBmcm9tICdAc3JjL2xpYi9icm93c2VySGlzdG9yeSc7Ci8vIFRPRE8oU0hJTik6IE5lZWQgdG8gaWRlbnRpZnkgd2hlbiBib2RpZXMgYXJlIGF2YWlsYWJsZQp2YXIgTGlua0V4dHJhY3RvciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhMaW5rRXh0cmFjdG9yLCBfc3VwZXIpOwogICAgZnVuY3Rpb24gTGlua0V4dHJhY3RvcigpIHsKICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzOwogICAgICAgIF90aGlzLmhhbmRsZUlucHV0UmVmID0gZnVuY3Rpb24gKHJlZikgewogICAgICAgICAgICBfdGhpcy5pbnB1dCA9IHJlZjsKICAgICAgICB9OwogICAgICAgIF90aGlzLmhhbmRsZUNvbnRhaW5lclJlZiA9IGZ1bmN0aW9uIChyZWYpIHsKICAgICAgICAgICAgX3RoaXMubGlua3NDb250YWluZXIgPSByZWY7CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5oYW5kbGVLZXlEb3duID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgdmFyIF9hID0gX3RoaXMuc3RhdGUsIHNlbGVjdGVkSW5kZXggPSBfYS5zZWxlY3RlZEluZGV4LCBmaWx0ZXJlZExpbmtzID0gX2EuZmlsdGVyZWRMaW5rczsKICAgICAgICAgICAgdmFyIGhhbmRsZWQgPSBmYWxzZTsKICAgICAgICAgICAgc3dpdGNoIChlLmtleUNvZGUpIHsKICAgICAgICAgICAgICAgIGNhc2UgS2V5Q29kZS5VcDogewogICAgICAgICAgICAgICAgICAgIGhhbmRsZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIHZhciBuZXdJbmRleF8xID0gc2VsZWN0ZWRJbmRleCAtIDE7CiAgICAgICAgICAgICAgICAgICAgaWYgKG5ld0luZGV4XzEgPCAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IHNlbGVjdGVkSW5kZXg6IG5ld0luZGV4XzEgfSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsaW5rLWV4dHJhY3Rvci1jZWxsLSIgKyBuZXdJbmRleF8xKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSBfdGhpcy5saW5rc0NvbnRhaW5lcjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvdmVyVG9wID0gaXRlbS5vZmZzZXRUb3AgLSBwYXJlbnQub2Zmc2V0VG9wIDwgcGFyZW50LnNjcm9sbFRvcDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvdmVyVG9wKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5zY3JvbGxJbnRvVmlldyh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlaGF2aW9yOiAnc21vb3RoJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2s6ICdzdGFydCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlubGluZTogJ25lYXJlc3QnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjYXNlIEtleUNvZGUuRG93bjogewogICAgICAgICAgICAgICAgICAgIGhhbmRsZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIHZhciBuZXdJbmRleF8yID0gc2VsZWN0ZWRJbmRleCArIDE7CiAgICAgICAgICAgICAgICAgICAgaWYgKG5ld0luZGV4XzIgPj0gZmlsdGVyZWRMaW5rcy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IHNlbGVjdGVkSW5kZXg6IG5ld0luZGV4XzIgfSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsaW5rLWV4dHJhY3Rvci1jZWxsLSIgKyBuZXdJbmRleF8yKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSBfdGhpcy5saW5rc0NvbnRhaW5lcjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvdmVyQm90dG9tID0gKGl0ZW0ub2Zmc2V0VG9wIC0gcGFyZW50Lm9mZnNldFRvcCArIGl0ZW0uY2xpZW50SGVpZ2h0KSA+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHBhcmVudC5zY3JvbGxUb3AgKyBwYXJlbnQuY2xpZW50SGVpZ2h0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvdmVyQm90dG9tKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5zY3JvbGxJbnRvVmlldyh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlaGF2aW9yOiAnc21vb3RoJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2s6ICdlbmQnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmxpbmU6ICduZWFyZXN0JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY2FzZSBLZXlDb2RlLkVzYzoKICAgICAgICAgICAgICAgICAgICBoYW5kbGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBfdGhpcy5pbnB1dC5ibHVyKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIEtleUNvZGUuRW50ZXI6CiAgICAgICAgICAgICAgICAgICAgaGFuZGxlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgaWYgKGZpbHRlcmVkTGlua3MubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBocmVmID0gZmlsdGVyZWRMaW5rc1tzZWxlY3RlZEluZGV4XS5ocmVmOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaHJlZiA9PT0gbnVsbCB8fCBocmVmID09PSB2b2lkIDAgPyB2b2lkIDAgOiBocmVmLnN0YXJ0c1dpdGgoJ21haWx0bycpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJvd3Nlckhpc3RvcnkucHVzaCgiL21haWwvYWxsL2NvbXBvc2U/bWFpbHRvPSIgKyBlbmNvZGVVUklDb21wb25lbnQoaHJlZikpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5vcGVuKGhyZWYsICdfYmxhbmsnKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGhhbmRsZWQpIHsKICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIF90aGlzLmhhbmRsZUZvY3VzID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICBpbnB1dEZvY3VzZWQ6IHRydWUsCiAgICAgICAgICAgICAgICBzZWxlY3RlZEluZGV4OiAwLAogICAgICAgICAgICB9KTsKICAgICAgICB9OwogICAgICAgIF90aGlzLmhhbmRsZUJsdXIgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsgaW5wdXRGb2N1c2VkOiBmYWxzZSB9LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB2YXIgdGhyZWFkTGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2luZmluaXRlLXRocmVhZC1saXN0Jyk7CiAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IHRocmVhZExpc3RbMF07CiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudCAmJiBlbGVtZW50IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIHsKICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmZvY3VzKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlSW5wdXRDaGFuZ2UgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICB2YXIgbGlua3MgPSBfdGhpcy5wcm9wcy5saW5rczsKICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gZS5jdXJyZW50VGFyZ2V0LnZhbHVlLnRyaW0oKS50b0xvd2VyQ2FzZSgpOwogICAgICAgICAgICB2YXIgbmV3RmlsdGVyZWRMaW5rcyA9IGxpbmtzLmZpbHRlcihmdW5jdGlvbiAobCkgewogICAgICAgICAgICAgICAgcmV0dXJuICEhKGwudmFsdWUudG9Mb3dlckNhc2UoKSArIGwuaHJlZi50b0xvd2VyQ2FzZSgpKS5pbmNsdWRlcyhxdWVyeSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBpZiAocXVlcnkgIT09ICcnKSB7CiAgICAgICAgICAgICAgICBuZXdGaWx0ZXJlZExpbmtzID0gc29ydE1hdGNoZXMobmV3RmlsdGVyZWRMaW5rcywgcXVlcnksICd2YWx1ZScpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgIHF1ZXJ5OiBlLmN1cnJlbnRUYXJnZXQudmFsdWUsCiAgICAgICAgICAgICAgICBzZWxlY3RlZEluZGV4OiAwLAogICAgICAgICAgICAgICAgZmlsdGVyZWRMaW5rczogbmV3RmlsdGVyZWRMaW5rcywKICAgICAgICAgICAgfSk7CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5yZW5kZXJFbXB0eSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIHNlbGVjdGVkVGhyZWFkID0gX3RoaXMucHJvcHMuc2VsZWN0ZWRUaHJlYWQ7CiAgICAgICAgICAgIHZhciBlbXB0eUNvcHkgPSAhIXNlbGVjdGVkVGhyZWFkCiAgICAgICAgICAgICAgICA/ICdObyBsaW5rcyBmb3VuZCBpbiB0aGlzIGNvbnZlcnNhdGlvbicKICAgICAgICAgICAgICAgIDogJ05vIGNvbnZlcnNhdGlvbiBzZWxlY3RlZCc7CiAgICAgICAgICAgIHJldHVybiAoUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJsaW5rLWV4dHJhY3Rvci1zaWRlYmFyIiB9LAogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0aXRsZS1zZWN0aW9uIiB9LAogICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAidGl0bGUiIH0sICJMaW5rIEV4dHJhY3RvciIpLAogICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAiZGVzY3JpcHRpb24iIH0sIGVtcHR5Q29weSkpKSk7CiAgICAgICAgfTsKICAgICAgICBfdGhpcy5zdGF0ZSA9IHsKICAgICAgICAgICAgZmlsdGVyZWRMaW5rczogW10sCiAgICAgICAgICAgIHF1ZXJ5OiAnJywKICAgICAgICAgICAgc2VsZWN0ZWRJbmRleDogMCwKICAgICAgICB9OwogICAgICAgIHJldHVybiBfdGhpczsKICAgIH0KICAgIExpbmtFeHRyYWN0b3IucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50ID0gZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgICAgdmFyIF9hID0gdGhpcy5wcm9wcywgc2VsZWN0ZWRUaHJlYWQgPSBfYS5zZWxlY3RlZFRocmVhZCwgbGlua3MgPSBfYS5saW5rcywgZXh0cmFjdExpbmtzID0gX2EuZXh0cmFjdExpbmtzOwogICAgICAgIC8vIFRyYWNrIHdoZW4gdXNlciBvcGVucyBsaW5rIGV4dHJhY3RvcgogICAgICAgIHJlY29yZEV2ZW50KFVzZXJFdmVudHMuTGlua0V4dHJhY3Rvck9wZW5lZCk7CiAgICAgICAgLy8gSGFuZGxlIGluaXRpYWwgZmV0Y2ggaWYgbmVlZGVkCiAgICAgICAgaWYgKCFsaW5rcy5sZW5ndGggJiYgc2VsZWN0ZWRUaHJlYWQpIHsKICAgICAgICAgICAgZXh0cmFjdExpbmtzKCk7CiAgICAgICAgfQogICAgICAgIC8vIFNldCBpbml0aWFsIGxpbmsgdmFsdWVzCiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgIGZpbHRlcmVkTGlua3M6IHRoaXMucHJvcHMubGlua3MsCiAgICAgICAgfSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgX2E7CiAgICAgICAgICAgIChfYSA9IF90aGlzLmlucHV0KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZm9jdXMoKTsKICAgICAgICB9KTsKICAgIH07CiAgICBMaW5rRXh0cmFjdG9yLnByb3RvdHlwZS5jb21wb25lbnREaWRVcGRhdGUgPSBmdW5jdGlvbiAob2xkUHJvcHMpIHsKICAgICAgICB2YXIgX2EgPSB0aGlzLnByb3BzLCBzZWxlY3RlZFRocmVhZCA9IF9hLnNlbGVjdGVkVGhyZWFkLCBleHRyYWN0TGlua3MgPSBfYS5leHRyYWN0TGlua3MsIGxpbmtzID0gX2EubGlua3MsIGhhc0JvZGllcyA9IF9hLmhhc0JvZGllczsKICAgICAgICB2YXIgb2xkVGhyZWFkID0gb2xkUHJvcHMuc2VsZWN0ZWRUaHJlYWQ7CiAgICAgICAgdmFyIGZldGNoQWZ0ZXJCb2RpZXMgPSB0aGlzLnN0YXRlLmZldGNoQWZ0ZXJCb2RpZXM7CiAgICAgICAgLy8gSGFuZGxlIGluaXRpYWwgZmV0Y2ggaWYgbmVlZGVkCiAgICAgICAgaWYgKCEhc2VsZWN0ZWRUaHJlYWQgJiYgc2VsZWN0ZWRUaHJlYWQuaWQgIT09IChvbGRUaHJlYWQgPT09IG51bGwgfHwgb2xkVGhyZWFkID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvbGRUaHJlYWQuaWQpKSB7CiAgICAgICAgICAgIGlmIChoYXNCb2RpZXMpIHsKICAgICAgICAgICAgICAgIGV4dHJhY3RMaW5rcygpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGZldGNoQWZ0ZXJCb2RpZXM6IHRydWUgfSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgLy8gSGFuZGxlIGRlbGF5ZWQgZmV0Y2ggd2hlbiBuZWNlc3NhcnkKICAgICAgICBpZiAoZmV0Y2hBZnRlckJvZGllcyAmJiBoYXNCb2RpZXMpIHsKICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGZldGNoQWZ0ZXJCb2RpZXM6IGZhbHNlIH0sIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGV4dHJhY3RMaW5rcygpOyB9KTsKICAgICAgICB9CiAgICAgICAgLy8gU2V0IGluaXRpYWwgbGluayB2YWx1ZXMKICAgICAgICBpZiAobGlua3MgIT09IG9sZFByb3BzLmxpbmtzKSB7CiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBmaWx0ZXJlZExpbmtzOiB0aGlzLnByb3BzLmxpbmtzIH0pOwogICAgICAgIH0KICAgIH07CiAgICBMaW5rRXh0cmFjdG9yLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgICB2YXIgbGlua3MgPSB0aGlzLnByb3BzLmxpbmtzOwogICAgICAgIHZhciBfYSA9IHRoaXMuc3RhdGUsIHF1ZXJ5ID0gX2EucXVlcnksIGZpbHRlcmVkTGlua3MgPSBfYS5maWx0ZXJlZExpbmtzLCBzZWxlY3RlZEluZGV4ID0gX2Euc2VsZWN0ZWRJbmRleDsKICAgICAgICB2YXIgcGxhY2Vob2xkZXIgPSAnU2VhcmNoIExpbmtzJzsKICAgICAgICBpZiAoIWxpbmtzLmxlbmd0aCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXJFbXB0eSgpOwogICAgICAgIH0KICAgICAgICB2YXIgbGlua0NvcHkgPSBsaW5rcy5sZW5ndGggPiAxID8gJ2xpbmtzJyA6ICdsaW5rJzsKICAgICAgICB2YXIgZGVzY3JpcHRpb25Db3B5ID0gISFxdWVyeQogICAgICAgICAgICA/IChSZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgbnVsbCwKICAgICAgICAgICAgICAgIGZpbHRlcmVkTGlua3MubGVuZ3RoLAogICAgICAgICAgICAgICAgIiBtYXRjaGluZzogIiwKICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImIiLCBudWxsLCBxdWVyeSkpKQogICAgICAgICAgICA6IChSZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgbnVsbCwKICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImIiLCBudWxsLAogICAgICAgICAgICAgICAgICAgIGxpbmtzLmxlbmd0aCwKICAgICAgICAgICAgICAgICAgICAiICIsCiAgICAgICAgICAgICAgICAgICAgbGlua0NvcHkpLAogICAgICAgICAgICAgICAgIiBmb3VuZCBpbiB0aGlzIGNvbnZlcnNhdGlvbiIpKTsKICAgICAgICByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAibGluay1leHRyYWN0b3Itc2lkZWJhciIgfSwKICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0aXRsZS1zZWN0aW9uIiB9LAogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0aXRsZSIgfSwgIkxpbmsgRXh0cmFjdG9yIiksCiAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImRlc2NyaXB0aW9uIiB9LCBkZXNjcmlwdGlvbkNvcHkpKSwKICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJpbnB1dC1jb250YWluZXIiIH0sCiAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJpbnB1dCIsIHsgZGlyOiAiYXV0byIsIGNsYXNzTmFtZTogImNvbnRyb2wtaW5wdXQiLCBwbGFjZWhvbGRlcjogcGxhY2Vob2xkZXIsIHJlZjogdGhpcy5oYW5kbGVJbnB1dFJlZiwgb25LZXlEb3duOiB0aGlzLmhhbmRsZUtleURvd24sIG9uQ2hhbmdlOiB0aGlzLmhhbmRsZUlucHV0Q2hhbmdlLCB2YWx1ZTogcXVlcnksIHNwZWxsQ2hlY2s6IGZhbHNlLCBvbkZvY3VzOiB0aGlzLmhhbmRsZUZvY3VzLCBvbkJsdXI6IHRoaXMuaGFuZGxlQmx1ciB9KSksCiAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgcmVmOiB0aGlzLmhhbmRsZUNvbnRhaW5lclJlZiwgY2xhc3NOYW1lOiAibGlua3MiIH0sCiAgICAgICAgICAgICAgICAhZmlsdGVyZWRMaW5rcy5sZW5ndGggJiYgKFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAiZW1wdHktc3RhdGUiIH0sICJObyBsaW5rcyBmb3VuZCBmb3I6ICIgKyBxdWVyeSkpLAogICAgICAgICAgICAgICAgISFmaWx0ZXJlZExpbmtzLmxlbmd0aCAmJiBmaWx0ZXJlZExpbmtzLm1hcChmdW5jdGlvbiAobCwgaSkgeyByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoTGlua0V4dHJhY3RvckNlbGwsIHsgaW5kZXg6IGksIGtleTogbC52YWx1ZSArIGwuaHJlZiArICdpJywgbGluazogbCwgc2VsZWN0ZWQ6IHNlbGVjdGVkSW5kZXggPT09IGksIGZvY3VzZWQ6IF90aGlzLnN0YXRlLmlucHV0Rm9jdXNlZCB9KSk7IH0pKSkpOwogICAgfTsKICAgIHJldHVybiBMaW5rRXh0cmFjdG9yOwp9KFJlYWN0LlB1cmVDb21wb25lbnQpKTsKZXhwb3J0IHsgTGlua0V4dHJhY3RvciB9Owp2YXIgTGlua0V4dHJhY3RvckNlbGwgPSBmdW5jdGlvbiAocHJvcHMpIHsKICAgIHZhciBsaW5rID0gcHJvcHMubGluaywgaW5kZXggPSBwcm9wcy5pbmRleCwgc2VsZWN0ZWQgPSBwcm9wcy5zZWxlY3RlZCwgZm9jdXNlZCA9IHByb3BzLmZvY3VzZWQ7CiAgICB2YXIgaGFuZGxlQ2xpY2sgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIHZhciBocmVmID0gbGluay5ocmVmOwogICAgICAgIC8vIEN1c3RvbSBoYW5kbGluZyBmb3IgbWFpbHRvCiAgICAgICAgaWYgKGhyZWYgPT09IG51bGwgfHwgaHJlZiA9PT0gdm9pZCAwID8gdm9pZCAwIDogaHJlZi5zdGFydHNXaXRoKCdtYWlsdG8nKSkgewogICAgICAgICAgICBicm93c2VySGlzdG9yeS5wdXNoKCIvbWFpbC9hbGwvY29tcG9zZT9tYWlsdG89IiArIGVuY29kZVVSSUNvbXBvbmVudChocmVmKSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgd2luZG93Lm9wZW4oaHJlZiwgJ19ibGFuaycpOwogICAgfTsKICAgIHJldHVybiAoUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6IGNsYXNzTmFtZXMoJ2xpbmstZXh0cmFjdG9yLWNlbGwnLCB7CiAgICAgICAgICAgIHNlbGVjdGVkOiAhIXNlbGVjdGVkICYmICEhZm9jdXNlZCwKICAgICAgICB9KSwgaWQ6ICJsaW5rLWV4dHJhY3Rvci1jZWxsLSIgKyBpbmRleCwgb25DbGljazogaGFuZGxlQ2xpY2sgfSwKICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogInRpdGxlIiB9LCBsaW5rLnZhbHVlKSwKICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImhyZWYiIH0sIGxpbmsuaHJlZikpKTsKfTsKZXhwb3J0IGRlZmF1bHQgTGlua0V4dHJhY3RvcjsK"},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/RightSidebar/components/LinkExtractor/LinkExtractor.tsx","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/RightSidebar/components/LinkExtractor/LinkExtractor.tsx"],"names":[],"mappings":"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","sourcesContent":["\nimport React from 'react';\nimport { AnchorElement } from '@src/lib/html';\n\nimport './LinkExtractor.scss';\nimport { sortMatches } from '@src/lib/matcher';\nimport { KeyCode, Thread } from '@src/types';\nimport classNames from 'classnames';\nimport { recordEvent, UserEvents } from '@src/lib/analytics';\nimport browserHistory from '@src/lib/browserHistory';\n\nexport interface Props {\n  links: AnchorElement[];\n  selectedThread?: Thread;\n  hasBodies?: boolean;\n}\n\nexport interface DispatchProps {\n  extractLinks: () => void;\n}\n\nexport interface State {\n  filteredLinks: AnchorElement[];\n  query: string;\n  selectedIndex: number;\n  fetchAfterBodies?: boolean;\n  inputFocused?: boolean;\n}\n\n// TODO(SHIN): Need to identify when bodies are available\nexport class LinkExtractor extends React.PureComponent<Props & DispatchProps, State> {\n  input: HTMLInputElement;\n  linksContainer: HTMLElement;\n\n  constructor() {\n    super();\n    this.state = {\n      filteredLinks: [],\n      query: '',\n      selectedIndex: 0,\n    };\n  }\n\n  componentDidMount() {\n    const { selectedThread, links, extractLinks } = this.props;\n    // Track when user opens link extractor\n    recordEvent(UserEvents.LinkExtractorOpened);\n\n    // Handle initial fetch if needed\n    if (!links.length && selectedThread) {\n      extractLinks();\n    }\n\n    // Set initial link values\n    this.setState(\n      {\n        filteredLinks: this.props.links,\n      },\n      () => {\n        this.input?.focus();\n      },\n    );\n  }\n\n  componentDidUpdate(oldProps: Props) {\n    const { selectedThread, extractLinks, links, hasBodies } = this.props;\n    const oldThread = oldProps.selectedThread;\n    const { fetchAfterBodies } = this.state;\n\n    // Handle initial fetch if needed\n    if (!!selectedThread && selectedThread.id !== oldThread?.id) {\n      if (hasBodies) {\n        extractLinks();\n      } else {\n        this.setState({ fetchAfterBodies: true });\n      }\n    }\n\n    // Handle delayed fetch when necessary\n    if (fetchAfterBodies && hasBodies) {\n      this.setState(\n        { fetchAfterBodies: false },\n        () => extractLinks(),\n      );\n    }\n\n    // Set initial link values\n    if (links !== oldProps.links) {\n      this.setState({ filteredLinks: this.props.links });\n    }\n  }\n\n  handleInputRef = (ref: HTMLInputElement) => {\n    this.input = ref;\n  }\n\n  handleContainerRef = (ref: HTMLDivElement) => {\n    this.linksContainer = ref;\n  }\n\n  handleKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n    const { selectedIndex, filteredLinks } = this.state;\n\n    let handled = false;\n    switch (e.keyCode) {\n      case KeyCode.Up: {\n        handled = true;\n        const newIndex = selectedIndex - 1;\n        if (newIndex < 0) {\n          break;\n        }\n        this.setState(\n          { selectedIndex: newIndex },\n          () => {\n            const item = document.getElementById(`link-extractor-cell-${newIndex}`);\n            if (item) {\n              const parent = this.linksContainer;\n              const overTop = item.offsetTop - parent.offsetTop < parent.scrollTop;\n              if (overTop) {\n                item.scrollIntoView({\n                  behavior: 'smooth',\n                  block: 'start',\n                  inline: 'nearest',\n                });\n              }\n            }\n          },\n        );\n        break;\n      }\n      case KeyCode.Down: {\n        handled = true;\n        const newIndex = selectedIndex + 1;\n        if (newIndex >= filteredLinks.length) {\n          handled = true;\n          break;\n        }\n\n        this.setState(\n          { selectedIndex: newIndex },\n          () => {\n            const item = document.getElementById(`link-extractor-cell-${newIndex}`);\n            if (item) {\n              const parent = this.linksContainer;\n              const overBottom = (item.offsetTop - parent.offsetTop + item.clientHeight) >\n                (parent.scrollTop + parent.clientHeight);\n              if (overBottom) {\n                item.scrollIntoView({\n                  behavior: 'smooth',\n                  block: 'end',\n                  inline: 'nearest',\n                });\n              }\n            }\n          },\n        );\n        break;\n      }\n      case KeyCode.Esc:\n        handled = true;\n        this.input.blur();\n        break;\n      case KeyCode.Enter:\n        handled = true;\n        if (filteredLinks.length) {\n          const href = filteredLinks[selectedIndex].href;\n          if (href?.startsWith('mailto')) {\n            e.stopPropagation();\n            e.preventDefault();\n            browserHistory.push(`/mail/all/compose?mailto=${encodeURIComponent(href)}`);\n            return;\n          }\n          window.open(href, '_blank');\n          return;\n        }\n        break;\n      default:\n        break;\n    }\n\n    if (handled) {\n      e.stopPropagation();\n      e.preventDefault();\n      return;\n    }\n  }\n\n  handleFocus = () => {\n    this.setState({\n      inputFocused: true,\n      selectedIndex: 0,\n    });\n  }\n\n  handleBlur = () => {\n    this.setState(\n      { inputFocused: false },\n      () => {\n        const threadList = document.getElementsByClassName('infinite-thread-list');\n        const element = threadList[0];\n        if (element && element instanceof HTMLElement) {\n          element.focus();\n        }\n      },\n    );\n  }\n\n  handleInputChange = (e: React.FormEvent<HTMLInputElement>) => {\n    const { links } = this.props;\n    const query = e.currentTarget.value.trim().toLowerCase();\n\n    let newFilteredLinks = links.filter(l =>\n      !!(l.value.toLowerCase() + l.href.toLowerCase()).includes(query),\n    );\n    if (query !== '')  {\n      newFilteredLinks = sortMatches(newFilteredLinks, query, 'value');\n    }\n\n    this.setState(\n      {\n        query: e.currentTarget.value,\n        selectedIndex: 0,\n        filteredLinks: newFilteredLinks,\n      },\n    );\n  }\n\n  renderEmpty = () => {\n    const { selectedThread } = this.props;\n    const emptyCopy = !!selectedThread\n     ? 'No links found in this conversation'\n     : 'No conversation selected';\n    return (\n      <div className=\"link-extractor-sidebar\">\n        <div className=\"title-section\">\n          <div className=\"title\">\n            Link Extractor\n          </div>\n          <div className=\"description\">\n            {emptyCopy}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  render() {\n    const { links } = this.props;\n    const { query, filteredLinks, selectedIndex } = this.state;\n    const placeholder = 'Search Links';\n\n    if (!links.length) {\n      return this.renderEmpty();\n    }\n\n    const linkCopy = links.length > 1 ? 'links' : 'link';\n    const descriptionCopy = !!query\n      ? (<span>{filteredLinks.length} matching: <b>{query}</b></span>)\n      : (<span><b>{links.length} {linkCopy}</b> found in this conversation</span>);\n\n    return (\n      <div className=\"link-extractor-sidebar\">\n        <div className=\"title-section\">\n          <div className=\"title\">\n            Link Extractor\n          </div>\n          <div className=\"description\">\n            {descriptionCopy}\n          </div>\n        </div>\n        <div className=\"input-container\">\n          <input\n            dir=\"auto\"\n            className=\"control-input\"\n            placeholder={placeholder}\n            ref={this.handleInputRef}\n            onKeyDown={this.handleKeyDown}\n            onChange={this.handleInputChange}\n            value={query}\n            spellCheck={false}\n            onFocus={this.handleFocus}\n            onBlur={this.handleBlur}\n          />\n        </div>\n        <div\n          ref={this.handleContainerRef}\n          className=\"links\"\n        >\n          {!filteredLinks.length && (\n            <div className=\"empty-state\">\n              {`No links found for: ${query}`}\n            </div>\n          )}\n          {!!filteredLinks.length && filteredLinks.map((l, i) => (\n            <LinkExtractorCell\n              index={i}\n              key={l.value + l.href + 'i'}\n              link={l}\n              selected={selectedIndex === i}\n              focused={this.state.inputFocused}\n            />\n          ))}\n        </div>\n      </div>\n    );\n  }\n}\n\ninterface LinkExtractorCellProps {\n  link: AnchorElement;\n  index: number;\n  selected?: boolean;\n  focused?: boolean;\n}\nconst LinkExtractorCell = (props: LinkExtractorCellProps) => {\n  const { link, index, selected, focused } = props;\n\n  const handleClick = (e: React.MouseEvent<HTMLElement>) => {\n    e.stopPropagation();\n    e.preventDefault();\n    const href = link.href;\n\n    // Custom handling for mailto\n    if (href?.startsWith('mailto')) {\n      browserHistory.push(`/mail/all/compose?mailto=${encodeURIComponent(href)}`);\n      return;\n    }\n    window.open(href, '_blank');\n  };\n\n  return (\n    <div\n      className={\n        classNames('link-extractor-cell', {\n          selected: !!selected && !!focused,\n        })\n      }\n      id={`link-extractor-cell-${index}`}\n      onClick={handleClick}\n    >\n      <div className=\"title\">\n        {link.value}\n      </div>\n      <div\n        className=\"href\"\n      >\n        {link.href}\n      </div>\n    </div>\n  );\n};\n\nexport default LinkExtractor;\n"]}]}