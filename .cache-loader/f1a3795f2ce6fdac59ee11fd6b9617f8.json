{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/lib/models/calendarEvents.ts","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/lib/models/calendarEvents.ts","mtime":1675280254066},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF9fYXNzaWduID0gKHRoaXMgJiYgdGhpcy5fX2Fzc2lnbikgfHwgZnVuY3Rpb24gKCkgewogICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uKHQpIHsKICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHsKICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTsKICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKQogICAgICAgICAgICAgICAgdFtwXSA9IHNbcF07CiAgICAgICAgfQogICAgICAgIHJldHVybiB0OwogICAgfTsKICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9OwpleHBvcnQgdmFyIGFwcGx5Q2FsZW5kYXJFdmVudERlZmF1bHRzID0gZnVuY3Rpb24gKGV2ZW50KSB7CiAgICB2YXIgY29tcHV0ZWQgPSBfX2Fzc2lnbih7fSwgZXZlbnQpOwogICAgaWYgKCEoY29tcHV0ZWQuc3RhcnRUaW1lIGluc3RhbmNlb2YgRGF0ZSkpIHsKICAgICAgICBjb21wdXRlZC5zdGFydFRpbWUgPSBuZXcgRGF0ZShjb21wdXRlZC5zdGFydFRpbWUpOwogICAgfQogICAgaWYgKCEoY29tcHV0ZWQuZW5kVGltZSBpbnN0YW5jZW9mIERhdGUpKSB7CiAgICAgICAgY29tcHV0ZWQuZW5kVGltZSA9IG5ldyBEYXRlKGNvbXB1dGVkLmVuZFRpbWUpOwogICAgfQogICAgcmV0dXJuIGNvbXB1dGVkOwp9OwpleHBvcnQgdmFyIGRhdGVPdmVybGFwcyA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgICByZXR1cm4gYS5lbmRUaW1lID4gYi5zdGFydFRpbWUgJiYgYS5zdGFydFRpbWUgPCBiLmVuZFRpbWU7Cn07CmV4cG9ydCB2YXIgY2FsY3VsYXRlRXZlbnREaXNwbGF5ID0gZnVuY3Rpb24gKHJhd0V2ZW50cykgewogICAgdmFyIGNvbXBhcmlzb25FdmVudDsKICAgIHZhciBldmVudHNEaWN0ID0gcmF3RXZlbnRzCiAgICAgICAgLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGEuc3RhcnRUaW1lLmdldFRpbWUoKSAtIGIuc3RhcnRUaW1lLmdldFRpbWUoKTsgfSkKICAgICAgICAucmVkdWNlKGZ1bmN0aW9uIChldmVudHMsIGEpIHsKICAgICAgICBpZiAoIWNvbXBhcmlzb25FdmVudCkgewogICAgICAgICAgICBldmVudHNbYS5pZF0gPSB7IGV2ZW50OiBhLCBvdmVybGFwczogMCwgcG9zaXRpb25JbmRleDogMCB9OwogICAgICAgICAgICBjb21wYXJpc29uRXZlbnQgPSBhOwogICAgICAgICAgICByZXR1cm4gZXZlbnRzOwogICAgICAgIH0KICAgICAgICB2YXIgb3ZlcmxhcCA9IGRhdGVPdmVybGFwcyhjb21wYXJpc29uRXZlbnQsIGEpOwogICAgICAgIGlmIChvdmVybGFwKSB7CiAgICAgICAgICAgIHZhciBmb3VuZCA9IGV2ZW50c1tjb21wYXJpc29uRXZlbnQuaWRdOwogICAgICAgICAgICBldmVudHNbZm91bmQuZXZlbnQuaWRdID0gX19hc3NpZ24oX19hc3NpZ24oe30sIGZvdW5kKSwgeyBvdmVybGFwczogZm91bmQub3ZlcmxhcHMgKyAxIH0pOwogICAgICAgICAgICBldmVudHNbYS5pZF0gPSB7IGV2ZW50OiBhLCBvdmVybGFwczogMSwgcG9zaXRpb25JbmRleDogZm91bmQucG9zaXRpb25JbmRleCArIDEgfTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGV2ZW50c1thLmlkXSA9IHsgZXZlbnQ6IGEsIG92ZXJsYXBzOiAwLCBwb3NpdGlvbkluZGV4OiAwIH07CiAgICAgICAgfQogICAgICAgIGNvbXBhcmlzb25FdmVudCA9IGE7CiAgICAgICAgcmV0dXJuIGV2ZW50czsKICAgIH0sIHt9KTsKICAgIHJldHVybiBPYmplY3QudmFsdWVzKGV2ZW50c0RpY3QpOwp9Owo="},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/lib/models/calendarEvents.ts","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/lib/models/calendarEvents.ts"],"names":[],"mappings":";;;;;;;;;;;AAEA,MAAM,CAAC,IAAM,0BAA0B,GAAG,UAAC,KAAoB;IAC7D,IAAM,QAAQ,gBACT,KAAK,CACT,CAAC;IAEF,IAAI,CAAC,CAAC,QAAQ,CAAC,SAAS,YAAY,IAAI,CAAC,EAAE;QACzC,QAAQ,CAAC,SAAS,GAAG,IAAI,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;KACnD;IAED,IAAI,CAAC,CAAC,QAAQ,CAAC,OAAO,YAAY,IAAI,CAAC,EAAE;QACvC,QAAQ,CAAC,OAAO,GAAG,IAAI,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;KAC/C;IAED,OAAO,QAAQ,CAAC;AAClB,CAAC,CAAC;AAEF,MAAM,CAAC,IAAM,YAAY,GAAG,UAAC,CAAgB,EAAE,CAAgB;IAC7D,OAAO,CAAC,CAAC,OAAO,GAAG,CAAC,CAAC,SAAS,IAAI,CAAC,CAAC,SAAS,GAAG,CAAC,CAAC,OAAO,CAAC;AAC5D,CAAC,CAAC;AAQF,MAAM,CAAC,IAAM,qBAAqB,GAAG,UAAC,SAA0B;IAC9D,IAAI,eAA0C,CAAC;IAC/C,IAAM,UAAU,GAA4C,SAAS;SAClE,IAAI,CAAC,UAAC,CAAC,EAAE,CAAC,IAAK,OAAA,CAAC,CAAC,SAAS,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC,SAAS,CAAC,OAAO,EAAE,EAA7C,CAA6C,CAAC;SAC7D,MAAM,CACL,UAAC,MAA+C,EAAE,CAAgB;QAChE,IAAI,CAAC,eAAe,EAAE;YACpB,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,KAAK,EAAE,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,aAAa,EAAE,CAAC,EAAE,CAAC;YAC3D,eAAe,GAAG,CAAC,CAAC;YACpB,OAAO,MAAM,CAAC;SACf;QAED,IAAM,OAAO,GAAG,YAAY,CAAC,eAAe,EAAE,CAAC,CAAC,CAAC;QACjD,IAAI,OAAO,EAAE;YACX,IAAM,KAAK,GAAG,MAAM,CAAC,eAAe,CAAC,EAAE,CAAC,CAAC;YACzC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,EAAE,CAAC,yBACjB,KAAK,KACR,QAAQ,EAAE,KAAK,CAAC,QAAQ,GAAG,CAAC,GAC7B,CAAC;YACF,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,KAAK,EAAE,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,aAAa,EAAE,KAAK,CAAC,aAAa,GAAG,CAAC,EAAE,CAAC;SAClF;aAAM;YACL,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,KAAK,EAAE,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,aAAa,EAAE,CAAC,EAAE,CAAC;SAC5D;QAED,eAAe,GAAG,CAAC,CAAC;QACpB,OAAO,MAAM,CAAC;IAChB,CAAC,EACD,EAAE,CACH,CAAC;IAEJ,OAAO,MAAM,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;AACnC,CAAC,CAAC","sourcesContent":["import { CalendarEvent } from '@src/types';\n\nexport const applyCalendarEventDefaults = (event: CalendarEvent): CalendarEvent => {\n  const computed = {\n    ...event,\n  };\n\n  if (!(computed.startTime instanceof Date)) {\n    computed.startTime = new Date(computed.startTime);\n  }\n\n  if (!(computed.endTime instanceof Date)) {\n    computed.endTime = new Date(computed.endTime);\n  }\n\n  return computed;\n};\n\nexport const dateOverlaps = (a: CalendarEvent, b: CalendarEvent) => {\n  return a.endTime > b.startTime && a.startTime < b.endTime;\n};\n\nexport interface CalendarEventDisplay {\n  event: CalendarEvent;\n  positionIndex: number;\n  overlaps: number;\n}\n\nexport const calculateEventDisplay = (rawEvents: CalendarEvent[]): CalendarEventDisplay[] => {\n  let comparisonEvent: CalendarEvent | undefined;\n  const eventsDict: { [key: string]: CalendarEventDisplay } = rawEvents\n    .sort((a, b) => a.startTime.getTime() - b.startTime.getTime())\n    .reduce(\n      (events: { [key: string]: CalendarEventDisplay }, a: CalendarEvent) => {\n        if (!comparisonEvent) {\n          events[a.id] = { event: a, overlaps: 0, positionIndex: 0 };\n          comparisonEvent = a;\n          return events;\n        }\n\n        const overlap = dateOverlaps(comparisonEvent, a);\n        if (overlap) {\n          const found = events[comparisonEvent.id];\n          events[found.event.id] = {\n            ...found,\n            overlaps: found.overlaps + 1,\n          };\n          events[a.id] = { event: a, overlaps: 1, positionIndex: found.positionIndex + 1 };\n        } else {\n          events[a.id] = { event: a, overlaps: 0, positionIndex: 0 };\n        }\n\n        comparisonEvent = a;\n        return events;\n      },\n      {},\n    );\n\n  return Object.values(eventsDict);\n};\n"]}]}