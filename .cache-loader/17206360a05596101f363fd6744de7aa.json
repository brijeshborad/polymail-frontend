{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/ducks/sequenceStages.ts","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/ducks/sequenceStages.ts","mtime":1675280254052},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF9fYXNzaWduID0gKHRoaXMgJiYgdGhpcy5fX2Fzc2lnbikgfHwgZnVuY3Rpb24gKCkgewogICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uKHQpIHsKICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHsKICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTsKICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKQogICAgICAgICAgICAgICAgdFtwXSA9IHNbcF07CiAgICAgICAgfQogICAgICAgIHJldHVybiB0OwogICAgfTsKICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9Owp2YXIgX2EsIF9iLCBfYywgX2QsIF9lLCBfZjsKaW1wb3J0IHVwZGF0ZSBmcm9tICdpbW11dGFiaWxpdHktaGVscGVyJzsKaW1wb3J0IHsga2V5QnkgfSBmcm9tICdsb2Rhc2gnOwppbXBvcnQgeyBjcmVhdGUgfSBmcm9tICdAc3JjL2xpYi9yZWR1eCc7CmltcG9ydCB7IFJlc291cmNlU3RhdHVzIH0gZnJvbSAnQHNyYy90eXBlcyc7CmltcG9ydCB7IHJlc291cmNlT2ssIHJlc291cmNlUmVmcmVzaGluZywgcmVzb3VyY2VQZW5kaW5nIH0gZnJvbSAnQHNyYy9saWIvcmVzb3VyY2UnOwpleHBvcnQgdmFyIFNFUVVFTkNFX1NUQUdFX0xJU1QgPSAoX2EgPSBjcmVhdGUoJ1NFUVVFTkNFX1NUQUdFX0xJU1QnLCB7CiAgICBzZXR1cDogZnVuY3Rpb24gKHN0YXRlLCBtZXRhKSB7CiAgICAgICAgdmFyIF9hOwogICAgICAgIGlmIChzdGF0ZS5zZXF1ZW5jZVN0YWdlc1ttZXRhXSkgewogICAgICAgICAgICByZXR1cm4gc3RhdGU7CiAgICAgICAgfQogICAgICAgIHJldHVybiB1cGRhdGUoc3RhdGUsIHsKICAgICAgICAgICAgc2VxdWVuY2VTdGFnZXM6IChfYSA9IHt9LAogICAgICAgICAgICAgICAgX2FbbWV0YV0gPSB7ICRzZXQ6IHt9IH0sCiAgICAgICAgICAgICAgICBfYSksCiAgICAgICAgfSk7CiAgICB9LAogICAgc3VjY2VzczogZnVuY3Rpb24gKHN0YXRlLCBtZXRhLCBwYXlsb2FkKSB7CiAgICAgICAgdmFyIF9hOwogICAgICAgIHJldHVybiB1cGRhdGUoc3RhdGUsIHsKICAgICAgICAgICAgc2VxdWVuY2VTdGFnZXM6IChfYSA9IHt9LAogICAgICAgICAgICAgICAgX2FbbWV0YV0gPSB7CiAgICAgICAgICAgICAgICAgICAgJG1lcmdlOiBrZXlCeShwYXlsb2FkLm1hcChmdW5jdGlvbiAodmFsKSB7IHJldHVybiByZXNvdXJjZU9rKHZhbCk7IH0pLCBmdW5jdGlvbiAoc3RhZ2UpIHsgcmV0dXJuIHN0YWdlLmRhdGEgJiYgc3RhZ2UuZGF0YS5pZDsgfSksCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgX2EpLAogICAgICAgIH0pOwogICAgfSwKfSksIF9hLnR5cGUpLCBzZXF1ZW5jZVN0YWdlTGlzdCA9IF9hLmFjdGlvbiwgc2VxdWVuY2VTdGFnZUxpc3RSZWR1Y2VyID0gX2EucmVkdWNlcjsKLy8gVE9ETyhTSElOKTogRGlzY3VzcyBzdGFydCBjYXNlIGZvciBpbnZpZGl2dWFsIHN0YWdlIGRlbGV0ZSBlcnJvcnMuIERvIHdlIGV4cGVjdCBvcHRpbWlzdGljcz8KLy8gVE9ETyhTSElOKTogSGFuZGxlIGZhaWx1cmUgbm90aWZpY2F0aW9ucyBmb3IgaW52aWRpdnVhbCBzdGFnZSBkZWxldGUgZXJyb3JzCmV4cG9ydCB2YXIgU0VRVUVOQ0VfU1RBR0VfQ1JFQVRFID0gKF9iID0gY3JlYXRlKCdTRVFVRU5DRV9TVEFHRV9DUkVBVEUnLCB7CiAgICBzZXR1cDogZnVuY3Rpb24gKHN0YXRlLCBtZXRhKSB7CiAgICAgICAgdmFyIF9hOwogICAgICAgIGlmIChzdGF0ZS5zZXF1ZW5jZVN0YWdlc1ttZXRhLnN0YWdlLnNlcXVlbmNlXSkgewogICAgICAgICAgICByZXR1cm4gc3RhdGU7CiAgICAgICAgfQogICAgICAgIHJldHVybiB1cGRhdGUoc3RhdGUsIHsKICAgICAgICAgICAgc2VxdWVuY2VTdGFnZXM6IChfYSA9IHt9LAogICAgICAgICAgICAgICAgX2FbbWV0YS5zdGFnZS5zZXF1ZW5jZV0gPSB7ICRzZXQ6IHt9IH0sCiAgICAgICAgICAgICAgICBfYSksCiAgICAgICAgfSk7CiAgICB9LAogICAgc3VjY2VzczogZnVuY3Rpb24gKHN0YXRlLCBtZXRhLCBwYXlsb2FkKSB7CiAgICAgICAgdmFyIF9hLCBfYjsKICAgICAgICByZXR1cm4gdXBkYXRlKHN0YXRlLCB7CiAgICAgICAgICAgIHNlcXVlbmNlU3RhZ2VzOiAoX2EgPSB7fSwKICAgICAgICAgICAgICAgIF9hW3BheWxvYWQuc2VxdWVuY2VdID0gKF9iID0ge30sCiAgICAgICAgICAgICAgICAgICAgX2JbcGF5bG9hZC5pZF0gPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRzZXQ6IHJlc291cmNlT2socGF5bG9hZCksCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBfYiksCiAgICAgICAgICAgICAgICBfYSksCiAgICAgICAgfSk7CiAgICB9LAogICAgZmFpbHVyZTogZnVuY3Rpb24gKHN0YXRlLCBtZXRhLCBlcnJvcikgewogICAgICAgIHZhciBfYTsKICAgICAgICByZXR1cm4gdXBkYXRlKHN0YXRlLCB7CiAgICAgICAgICAgIHNlcXVlbmNlU3RhZ2VzOiAoX2EgPSB7fSwKICAgICAgICAgICAgICAgIF9hW21ldGEuc3RhZ2Uuc2VxdWVuY2VdID0gewogICAgICAgICAgICAgICAgICAgICR1bnNldDogW21ldGEuc3RhZ2UuaWRdLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIF9hKSwKICAgICAgICB9KTsKICAgIH0sCn0pLCBfYi50eXBlKSwgc2VxdWVuY2VTdGFnZUNyZWF0ZSA9IF9iLmFjdGlvbiwgc2VxdWVuY2VTdGFnZUNyZWF0ZVJlZHVjZXIgPSBfYi5yZWR1Y2VyOwovLyBUT0RPKFNISU4pOiBEaXNjdXNzIHN0YXJ0IGNhc2UgZm9yIGludmlkaXZ1YWwgc3RhZ2UgZGVsZXRlIGVycm9ycy4gRG8gd2UgZXhwZWN0IG9wdGltaXN0aWNzPwovLyBUT0RPKFNISU4pOiBIYW5kbGUgZmFpbHVyZSBub3RpZmljYXRpb25zIGZvciBpbnZpZGl2dWFsIHN0YWdlIGRlbGV0ZSBlcnJvcnMKZXhwb3J0IHZhciBTRVFVRU5DRV9TVEFHRV9VUERBVEUgPSAoX2MgPSBjcmVhdGUoJ1NFUVVFTkNFX1NUQUdFX1VQREFURScsIHsKICAgIHNldHVwOiBmdW5jdGlvbiAoc3RhdGUsIG1ldGEpIHsKICAgICAgICB2YXIgX2EsIF9iLCBfYywgX2Q7CiAgICAgICAgaWYgKHN0YXRlLnNlcXVlbmNlU3RhZ2VzW21ldGEuc2VxdWVuY2VdKSB7CiAgICAgICAgICAgIGlmIChzdGF0ZS5zZXF1ZW5jZVN0YWdlc1ttZXRhLnNlcXVlbmNlXVttZXRhLmlkXSkgewogICAgICAgICAgICAgICAgcmV0dXJuIHN0YXRlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiB1cGRhdGUoc3RhdGUsIHsKICAgICAgICAgICAgICAgIHNlcXVlbmNlU3RhZ2VzOiAoX2EgPSB7fSwKICAgICAgICAgICAgICAgICAgICBfYVttZXRhLnNlcXVlbmNlXSA9IChfYiA9IHt9LCBfYlttZXRhLmlkXSA9IHsgJHNldDogcmVzb3VyY2VQZW5kaW5nKCkgfSwgX2IpLAogICAgICAgICAgICAgICAgICAgIF9hKSwKICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB1cGRhdGUoc3RhdGUsIHsKICAgICAgICAgICAgc2VxdWVuY2VTdGFnZXM6IChfYyA9IHt9LAogICAgICAgICAgICAgICAgX2NbbWV0YS5zZXF1ZW5jZV0gPSB7ICRzZXQ6IChfZCA9IHt9LCBfZFttZXRhLmlkXSA9IHJlc291cmNlUGVuZGluZygpLCBfZCkgfSwKICAgICAgICAgICAgICAgIF9jKSwKICAgICAgICB9KTsKICAgIH0sCiAgICBzdGFydDogZnVuY3Rpb24gKHN0YXRlLCBtZXRhKSB7CiAgICAgICAgdmFyIF9hLCBfYjsKICAgICAgICByZXR1cm4gdXBkYXRlKHN0YXRlLCB7CiAgICAgICAgICAgIHNlcXVlbmNlU3RhZ2VzOiAoX2EgPSB7fSwKICAgICAgICAgICAgICAgIF9hW21ldGEuc2VxdWVuY2VdID0gKF9iID0ge30sCiAgICAgICAgICAgICAgICAgICAgX2JbbWV0YS5pZF0gPSB7ICRzZXQ6IHJlc291cmNlUmVmcmVzaGluZyhtZXRhKSB9LAogICAgICAgICAgICAgICAgICAgIF9iKSwKICAgICAgICAgICAgICAgIF9hKSwKICAgICAgICB9KTsKICAgIH0sCiAgICBzdWNjZXNzOiBmdW5jdGlvbiAoc3RhdGUsIG1ldGEsIHBheWxvYWQpIHsKICAgICAgICB2YXIgX2EsIF9iOwogICAgICAgIHJldHVybiB1cGRhdGUoc3RhdGUsIHsKICAgICAgICAgICAgc2VxdWVuY2VTdGFnZXM6IChfYSA9IHt9LAogICAgICAgICAgICAgICAgX2FbbWV0YS5zZXF1ZW5jZV0gPSAoX2IgPSB7fSwKICAgICAgICAgICAgICAgICAgICBfYlttZXRhLmlkXSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgJHNldDogcmVzb3VyY2VPayhwYXlsb2FkKSwKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIF9iKSwKICAgICAgICAgICAgICAgIF9hKSwKICAgICAgICB9KTsKICAgIH0sCiAgICBmYWlsdXJlOiBmdW5jdGlvbiAoc3RhdGUsIG1ldGEsIGVycm9yKSB7CiAgICAgICAgdmFyIF9hLCBfYjsKICAgICAgICByZXR1cm4gdXBkYXRlKHN0YXRlLCB7CiAgICAgICAgICAgIHNlcXVlbmNlU3RhZ2VzOiAoX2EgPSB7fSwKICAgICAgICAgICAgICAgIF9hW21ldGEuc2VxdWVuY2VdID0gKF9iID0ge30sCiAgICAgICAgICAgICAgICAgICAgX2JbbWV0YS5pZF0gPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNldDogUmVzb3VyY2VTdGF0dXMuT2ssCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBfYiksCiAgICAgICAgICAgICAgICBfYSksCiAgICAgICAgfSk7CiAgICB9LAp9KSwgX2MudHlwZSksIHNlcXVlbmNlU3RhZ2VVcGRhdGUgPSBfYy5hY3Rpb24sIHNlcXVlbmNlU3RhZ2VVcGRhdGVSZWR1Y2VyID0gX2MucmVkdWNlcjsKLy8gVE9ETyhTSElOKTogRGlzY3VzcyBFcnJvciBzdGF0ZXMgZm9yIHNlcXVlbmNlIHN0YWdlcyBkZWxldGlvbnMKLy8gVE9ETyhTSElOKTogSGFuZGxlIGZhaWx1cmUgbm90aWZpY2F0aW9ucyBmb3IgaW52aWRpdnVhbCBzdGFnZSBkZWxldGUgZXJyb3JzCmV4cG9ydCB2YXIgU0VRVUVOQ0VfU1RBR0VfREVMRVRFID0gKF9kID0gY3JlYXRlKCdTRVFVRU5DRV9TVEFHRV9ERUxFVEUnLCB7CiAgICBzZXR1cDogZnVuY3Rpb24gKHN0YXRlLCBtZXRhKSB7CiAgICAgICAgdmFyIF9hLCBfYiwgX2MsIF9kOwogICAgICAgIGlmIChzdGF0ZS5zZXF1ZW5jZVN0YWdlc1ttZXRhLnNlcXVlbmNlXSkgewogICAgICAgICAgICBpZiAoc3RhdGUuc2VxdWVuY2VTdGFnZXNbbWV0YS5zZXF1ZW5jZV1bbWV0YS5pZF0pIHsKICAgICAgICAgICAgICAgIHJldHVybiBzdGF0ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gdXBkYXRlKHN0YXRlLCB7CiAgICAgICAgICAgICAgICBzZXF1ZW5jZVN0YWdlczogKF9hID0ge30sCiAgICAgICAgICAgICAgICAgICAgX2FbbWV0YS5zZXF1ZW5jZV0gPSAoX2IgPSB7fSwgX2JbbWV0YS5pZF0gPSB7ICRzZXQ6IHJlc291cmNlUGVuZGluZygpIH0sIF9iKSwKICAgICAgICAgICAgICAgICAgICBfYSksCiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdXBkYXRlKHN0YXRlLCB7CiAgICAgICAgICAgIHNlcXVlbmNlU3RhZ2VzOiAoX2MgPSB7fSwKICAgICAgICAgICAgICAgIF9jW21ldGEuc2VxdWVuY2VdID0geyAkc2V0OiAoX2QgPSB7fSwgX2RbbWV0YS5pZF0gPSByZXNvdXJjZVBlbmRpbmcoKSwgX2QpIH0sCiAgICAgICAgICAgICAgICBfYyksCiAgICAgICAgfSk7CiAgICB9LAogICAgc3VjY2VzczogZnVuY3Rpb24gKHN0YXRlLCBtZXRhLCBwYXlsb2FkKSB7CiAgICAgICAgdmFyIF9hOwogICAgICAgIHJldHVybiB1cGRhdGUoc3RhdGUsIHsKICAgICAgICAgICAgc2VxdWVuY2VTdGFnZXM6IChfYSA9IHt9LAogICAgICAgICAgICAgICAgX2FbbWV0YS5zZXF1ZW5jZV0gPSB7CiAgICAgICAgICAgICAgICAgICAgJHVuc2V0OiBbbWV0YS5pZF0sCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgX2EpLAogICAgICAgIH0pOwogICAgfSwKICAgIGZhaWx1cmU6IGZ1bmN0aW9uIChzdGF0ZSwgbWV0YSwgZXJyb3IpIHsKICAgICAgICB2YXIgX2EsIF9iOwogICAgICAgIHJldHVybiB1cGRhdGUoc3RhdGUsIHsKICAgICAgICAgICAgc2VxdWVuY2VTdGFnZXM6IChfYSA9IHt9LAogICAgICAgICAgICAgICAgX2FbbWV0YS5zZXF1ZW5jZV0gPSAoX2IgPSB7fSwKICAgICAgICAgICAgICAgICAgICBfYlttZXRhLmlkXSA9IHsgJHNldDogcmVzb3VyY2VPayhtZXRhKSB9LAogICAgICAgICAgICAgICAgICAgIF9iKSwKICAgICAgICAgICAgICAgIF9hKSwKICAgICAgICB9KTsKICAgIH0sCn0pLCBfZC50eXBlKSwgc2VxdWVuY2VTdGFnZURlbGV0ZSA9IF9kLmFjdGlvbiwgc2VxdWVuY2VTdGFnZURlbGV0ZVJlZHVjZXIgPSBfZC5yZWR1Y2VyOwpleHBvcnQgdmFyIFNFUVVFTkNFX1NUQUdFX1NFTEVDVCA9IChfZSA9IGNyZWF0ZSgnU0VRVUVOQ0VfU1RBR0VfU0VMRUNUJywgewogICAgc3RhcnQ6IGZ1bmN0aW9uIChzdGF0ZSwgbWV0YSkgeyByZXR1cm4gKF9fYXNzaWduKF9fYXNzaWduKHt9LCBzdGF0ZSksIHsgc2VsZWN0ZWRTZXF1ZW5jZVN0YWdlOiBtZXRhIH0pKTsgfSwKfSksIF9lLnR5cGUpLCBzZXF1ZW5jZVN0YWdlU2VsZWN0ID0gX2UuYWN0aW9uLCBzZXF1ZW5jZVN0YWdlU2VsZWN0UmVkdWNlciA9IF9lLnJlZHVjZXI7CmV4cG9ydCB2YXIgU0VRVUVOQ0VfU1RBR0VfRFVQTElDQVRFID0gKF9mID0gY3JlYXRlKCdTRVFVRU5DRV9TVEFHRV9EVVBMSUNBVEUnLCB7CiAgICBzdWNjZXNzOiBmdW5jdGlvbiAoc3RhdGUsIG1ldGEsIHBheWxvYWQpIHsKICAgICAgICB2YXIgX2EsIF9iOwogICAgICAgIHJldHVybiB1cGRhdGUoc3RhdGUsIHsKICAgICAgICAgICAgc2VxdWVuY2VTdGFnZXM6IChfYSA9IHt9LAogICAgICAgICAgICAgICAgX2FbcGF5bG9hZC5zZXF1ZW5jZV0gPSAoX2IgPSB7fSwKICAgICAgICAgICAgICAgICAgICBfYltwYXlsb2FkLmlkXSA9IHsgJHNldDogcmVzb3VyY2VPayhwYXlsb2FkKSB9LAogICAgICAgICAgICAgICAgICAgIF9iKSwKICAgICAgICAgICAgICAgIF9hKSwKICAgICAgICB9KTsKICAgIH0sCn0pLCBfZi50eXBlKSwgc2VxdWVuY2VTdGFnZUR1cGxpY2F0ZSA9IF9mLmFjdGlvbiwgc2VxdWVuY2VTdGFnZUR1cGxpY2F0ZVJlZHVjZXIgPSBfZi5yZWR1Y2VyOwpleHBvcnQgZGVmYXVsdCBbCiAgICBzZXF1ZW5jZVN0YWdlRGVsZXRlUmVkdWNlciwKICAgIHNlcXVlbmNlU3RhZ2VVcGRhdGVSZWR1Y2VyLAogICAgc2VxdWVuY2VTdGFnZUNyZWF0ZVJlZHVjZXIsCiAgICBzZXF1ZW5jZVN0YWdlTGlzdFJlZHVjZXIsCiAgICBzZXF1ZW5jZVN0YWdlU2VsZWN0UmVkdWNlciwKICAgIHNlcXVlbmNlU3RhZ2VEdXBsaWNhdGVSZWR1Y2VyLApdOwo="},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/ducks/sequenceStages.ts","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/ducks/sequenceStages.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA,OAAO,MAAM,MAAM,qBAAqB,CAAC;AACzC,OAAO,EAAE,KAAK,EAAE,MAAM,QAAQ,CAAC;AAC/B,OAAO,EAAE,MAAM,EAAE,MAAM,gBAAgB,CAAC;AACxC,OAAO,EAAE,cAAc,EAAmB,MAAM,YAAY,CAAC;AAE7D,OAAO,EAAE,UAAU,EAAE,kBAAkB,EAAE,eAAe,EAAE,MAAM,mBAAmB,CAAC;AAEpF,MAAM,CACJ,IAAA;;;;;;;;;;;;;;;;;;;;;;YAAyB,EACzB,6BAAyB,EACzB,qCAAiC,CAwBhC;AAUH,+FAA+F;AAC/F,8EAA8E;AAC9E,MAAM,CACJ,IAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;YAA2B,EAC3B,+BAA2B,EAC3B,uCAAmC,CA8BlC;AAOH,+FAA+F;AAC/F,8EAA8E;AAC9E,MAAM,CACJ,IAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;YAA2B,EAC3B,+BAA2B,EAC3B,uCAAmC,CAiDlC;AAEH,iEAAiE;AACjE,8EAA8E;AAC9E,MAAM,CACJ,IAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;YAA2B,EAC3B,+BAA2B,EAC3B,uCAAmC,CAmClC;AAEH,MAAM,CACJ,IAAA;;YAA2B,EAC3B,+BAA2B,EAC3B,uCAAmC,CAGlC;AAEH,MAAM,CACJ,IAAA;;;;;;;;;;;YAA8B,EAC9B,kCAA8B,EAC9B,0CAAsC,CAUrC;AAEH,eAAe;IACb,0BAA0B;IAC1B,0BAA0B;IAC1B,0BAA0B;IAC1B,wBAAwB;IACxB,0BAA0B;IAC1B,6BAA6B;CAC9B,CAAC","sourcesContent":["import update from 'immutability-helper';\nimport { keyBy } from 'lodash';\nimport { create } from '@src/lib/redux';\nimport { ResourceStatus, RequiredPartial } from '@src/types';\nimport { SequenceStage } from '@src/types/sequences';\nimport { resourceOk, resourceRefreshing, resourcePending } from '@src/lib/resource';\n\nexport const {\n  type: SEQUENCE_STAGE_LIST,\n  action: sequenceStageList,\n  reducer: sequenceStageListReducer,\n} = create<string, SequenceStage[]>('SEQUENCE_STAGE_LIST', {\n  setup: (state, meta) => {\n    if (state.sequenceStages[meta]) {\n      return state;\n    }\n\n    return update(state, {\n      sequenceStages: {\n        [meta]: { $set: {} },\n      },\n    });\n  },\n  success: (state, meta, payload) =>\n    update(state, {\n      sequenceStages: {\n        [meta]: {\n          $merge: keyBy(\n            payload.map(val => resourceOk(val)),\n            stage => stage.data && stage.data.id,\n          ),\n        },\n      },\n    }),\n});\n\nexport interface SequenceStageCreateMeta {\n  stage: RequiredPartial<\n    SequenceStage,\n    'newThread'| 'intervalDays' | 'sequence'\n  >;\n  navigateTo?: boolean;\n}\n\n// TODO(SHIN): Discuss start case for invidivual stage delete errors. Do we expect optimistics?\n// TODO(SHIN): Handle failure notifications for invidivual stage delete errors\nexport const {\n  type: SEQUENCE_STAGE_CREATE,\n  action: sequenceStageCreate,\n  reducer: sequenceStageCreateReducer,\n} = create<SequenceStageCreateMeta, SequenceStage>('SEQUENCE_STAGE_CREATE', {\n  setup: (state, meta) => {\n    if (state.sequenceStages[meta.stage.sequence]) {\n      return state;\n    }\n\n    return update(state, {\n      sequenceStages: {\n        [meta.stage.sequence]: { $set: {} },\n      },\n    });\n  },\n  success: (state, meta, payload) => update(state, {\n    sequenceStages: {\n      [payload.sequence]: {\n        [payload.id]: {\n          $set: resourceOk(payload),\n        },\n      },\n    },\n  }),\n  failure: (state, meta, error) =>\n    update(state, {\n      sequenceStages: {\n        [meta.stage.sequence]: {\n          $unset: [meta.stage.id],\n        },\n      },\n    }),\n});\n\nexport type SequenceStageUpdateMeta = RequiredPartial<\n  SequenceStage,\n  'id' | 'sequence' | 'sequence'\n  >;\n\n// TODO(SHIN): Discuss start case for invidivual stage delete errors. Do we expect optimistics?\n// TODO(SHIN): Handle failure notifications for invidivual stage delete errors\nexport const {\n  type: SEQUENCE_STAGE_UPDATE,\n  action: sequenceStageUpdate,\n  reducer: sequenceStageUpdateReducer,\n} = create<SequenceStageUpdateMeta, SequenceStage>('SEQUENCE_STAGE_UPDATE', {\n  setup: (state, meta) => {\n    if (state.sequenceStages[meta.sequence]) {\n      if (state.sequenceStages[meta.sequence][meta.id]) {\n        return state;\n      }\n\n      return update(state, {\n        sequenceStages: {\n          [meta.sequence]: { [meta.id]: { $set: resourcePending() } },\n        },\n      });\n    }\n\n    return update(state, {\n      sequenceStages: {\n        [meta.sequence]: { $set: { [meta.id]: resourcePending() } },\n      },\n    });\n  },\n  start: (state, meta) => update(state, {\n    sequenceStages: {\n      [meta.sequence]: {\n        [meta.id]: { $set: resourceRefreshing(meta) },\n      },\n    },\n  }),\n  success: (state, meta, payload) => update(state, {\n    sequenceStages: {\n      [meta.sequence]: {\n        [meta.id]: {\n          $set: resourceOk(payload),\n        },\n      },\n    },\n  }),\n  failure: (state, meta, error) =>\n    update(state, {\n      sequenceStages: {\n        [meta.sequence]: {\n          [meta.id]: {\n            status: {\n              $set: ResourceStatus.Ok,\n            },\n          },\n        },\n      },\n    }),\n});\n\n// TODO(SHIN): Discuss Error states for sequence stages deletions\n// TODO(SHIN): Handle failure notifications for invidivual stage delete errors\nexport const {\n  type: SEQUENCE_STAGE_DELETE,\n  action: sequenceStageDelete,\n  reducer: sequenceStageDeleteReducer,\n} = create<SequenceStage, null>('SEQUENCE_STAGE_DELETE', {\n  setup: (state, meta) => {\n    if (state.sequenceStages[meta.sequence]) {\n      if (state.sequenceStages[meta.sequence][meta.id]) {\n        return state;\n      }\n\n      return update(state, {\n        sequenceStages: {\n          [meta.sequence]: { [meta.id]: { $set: resourcePending() } },\n        },\n      });\n    }\n\n    return update(state, {\n      sequenceStages: {\n        [meta.sequence]: { $set: { [meta.id]: resourcePending() } },\n      },\n    });\n  },\n  success: (state, meta, payload) => update(state, {\n    sequenceStages: {\n      [meta.sequence]: {\n        $unset: [meta.id],\n      },\n    },\n  }),\n  failure: (state, meta, error) => update(state, {\n    sequenceStages: {\n      [meta.sequence]: {\n        [meta.id]: { $set: resourceOk(meta) },\n      },\n    },\n  }),\n});\n\nexport const {\n  type: SEQUENCE_STAGE_SELECT,\n  action: sequenceStageSelect,\n  reducer: sequenceStageSelectReducer,\n} = create<string, null>('SEQUENCE_STAGE_SELECT', {\n  start: (state, meta) => ({ ...state, selectedSequenceStage: meta }),\n});\n\nexport const {\n  type: SEQUENCE_STAGE_DUPLICATE,\n  action: sequenceStageDuplicate,\n  reducer: sequenceStageDuplicateReducer,\n} = create<SequenceStage, SequenceStage>('SEQUENCE_STAGE_DUPLICATE', {\n  success: (state, meta, payload) =>\n    update(state, {\n      sequenceStages: {\n        [payload.sequence]: {\n          [payload.id]: { $set: resourceOk(payload) },\n        },\n      },\n    }),\n});\n\nexport default [\n  sequenceStageDeleteReducer,\n  sequenceStageUpdateReducer,\n  sequenceStageCreateReducer,\n  sequenceStageListReducer,\n  sequenceStageSelectReducer,\n  sequenceStageDuplicateReducer,\n];\n"]}]}