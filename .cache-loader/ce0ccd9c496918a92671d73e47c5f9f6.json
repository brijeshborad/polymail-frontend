{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/CommandControl/components/Templates/Templates.tsx","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/CommandControl/components/Templates/Templates.tsx","mtime":1675280253999},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewogICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewogICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAogICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKICAgIH07CiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwogICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQogICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKICAgIH07Cn0pKCk7CmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7CmltcG9ydCBDb250cm9sUG9wb3ZlciBmcm9tICcuLi9jb21wb25lbnRzL0NvbnRyb2xQb3BvdmVyJzsKaW1wb3J0IFRlbXBsYXRlIGZyb20gJ0BzcmMvY29tcG9uZW50cy9JY29ucy9UZW1wbGF0ZS5zdmcnOwppbXBvcnQgJy4vVGVtcGxhdGVzLnNjc3MnOwppbXBvcnQgeyBDb21tYW5kQ29udHJvbFR5cGUsIE9uYm9hcmRpbmdUeXBlIH0gZnJvbSAnQHNyYy90eXBlcyc7CmltcG9ydCB7IHNhbml0aXplIH0gZnJvbSAnQHNyYy9saWIvaHRtbCc7CmltcG9ydCB7IHNvcnRNYXRjaGVzIH0gZnJvbSAnQHNyYy9saWIvbWF0Y2hlcic7CmltcG9ydCB7IHR5cGVhaGVhZFJlZ2V4IH0gZnJvbSAnQHNyYy9saWIvdHlwZWFoZWFkJzsKaW1wb3J0IHsgZ2V0T25ib2FyZGluZ0FjdGlvbnMgfSBmcm9tICdAc3JjL2xpYi9PbmJvYXJkaW5nRGlzcGF0Y2hlcic7CmltcG9ydCB7IHBhcnNlQWRkcmVzcywgcGFydGljaXBhbnRzVG9TdHJpbmcgfSBmcm9tICdAc3JjL2xpYi9hZGRyZXNzJzsKaW1wb3J0IHsgQW1wbGl0dWRlRXZlbnRzLCBsb2dBbXBsaXR1ZGVFdmVudCB9IGZyb20gJ0BzcmMvbGliL2FtcGxpdHVkZS1hbmFseXRpY3MnOwp2YXIgVGVtcGxhdGVzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewogICAgX19leHRlbmRzKFRlbXBsYXRlcywgX3N1cGVyKTsKICAgIGZ1bmN0aW9uIFRlbXBsYXRlcyhwcm9wcykgewogICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7CiAgICAgICAgX3RoaXMudGVtcGxhdGVUeXBlYWhlYWQgPSBmdW5jdGlvbiAocGFydGlhbCkgewogICAgICAgICAgICB2YXIgdGVtcGxhdGVzID0gX3RoaXMucHJvcHMudGVtcGxhdGVzOwogICAgICAgICAgICAvLyBSZXR1cm4gc29ydGVkIGJ5IGNyZWF0ZWQgZGF0ZSBpZiBubyBxdWVyeQogICAgICAgICAgICBpZiAocGFydGlhbCA9PT0gJycpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0ZW1wbGF0ZXMKICAgICAgICAgICAgICAgICAgICAuc29ydChmdW5jdGlvbiAoYSwgYikgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBiLnVwZGF0ZWQuZ2V0VGltZSgpIC0gYS51cGRhdGVkLmdldFRpbWUoKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIFJldHVybiBzb3J0ZWQgYnkgbWF0Y2ggaWYgcXVlcnkKICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gcGFydGlhbC50cmltKCkudG9Mb3dlckNhc2UoKTsKICAgICAgICAgICAgdmFyIHJlZ2V4ID0gdHlwZWFoZWFkUmVnZXgocXVlcnkpOwogICAgICAgICAgICB2YXIgbWF0Y2hlcyA9IF90aGlzLnByb3BzLnRlbXBsYXRlcy5maWx0ZXIoZnVuY3Rpb24gKHRlbXBsYXRlKSB7CiAgICAgICAgICAgICAgICBpZiAodGVtcGxhdGUubmFtZS50b0xvd2VyQ2FzZSgpLm1hdGNoKHJlZ2V4KSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuIHNvcnRNYXRjaGVzKG1hdGNoZXMsIHF1ZXJ5LCAnbmFtZScpOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlSW5wdXRDaGFuZ2UgPSBmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICAgICAgdmFyIHRlbXBsYXRlcyA9IF90aGlzLnByb3BzLnRlbXBsYXRlczsKICAgICAgICAgICAgdmFyIG5ld09wdGlvbnMgPSBfdGhpcy50ZW1wbGF0ZVR5cGVhaGVhZCh2YWx1ZSkKICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKHRlbXBsYXRlKSB7IHJldHVybiAoeyB0aXRsZTogdGVtcGxhdGUubmFtZSB9KTsgfSk7CiAgICAgICAgICAgIHZhciBzZWxlY3RlZFRlbXBsYXRlID0gISF0ZW1wbGF0ZXMubGVuZ3RoICYmICEhbmV3T3B0aW9ucy5sZW5ndGggJiYKICAgICAgICAgICAgICAgIHRlbXBsYXRlcy5maWx0ZXIoZnVuY3Rpb24gKHRlbXBsYXRlKSB7IHJldHVybiB0ZW1wbGF0ZS5uYW1lID09PSBuZXdPcHRpb25zWzBdLnRpdGxlOyB9KVswXTsKICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgb3B0aW9uczogbmV3T3B0aW9ucywKICAgICAgICAgICAgICAgIHNlbGVjdGVkVGVtcGxhdGU6IHNlbGVjdGVkVGVtcGxhdGUgfHwgdW5kZWZpbmVkLAogICAgICAgICAgICB9KTsKICAgICAgICB9OwogICAgICAgIF90aGlzLmhhbmRsZVNlbGVjdGVkSW5kZXhDaGFuZ2UgPSBmdW5jdGlvbiAoaW5kZXgpIHsKICAgICAgICAgICAgdmFyIHRlbXBsYXRlcyA9IF90aGlzLnByb3BzLnRlbXBsYXRlczsKICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBzZWxlY3RlZFRlbXBsYXRlOiB0ZW1wbGF0ZXMuZmlsdGVyKGZ1bmN0aW9uICh0ZW1wbGF0ZSkgeyByZXR1cm4gdGVtcGxhdGUubmFtZSA9PT0gX3RoaXMuc3RhdGUub3B0aW9uc1tpbmRleF0udGl0bGU7IH0pWzBdIH0pOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuaGFuZGxlU2VsZWN0ID0gZnVuY3Rpb24gKG9wdGlvbiwgaW5kZXgpIHsKICAgICAgICAgICAgdmFyIF9hOwogICAgICAgICAgICBsb2dBbXBsaXR1ZGVFdmVudChBbXBsaXR1ZGVFdmVudHMuQXBwbHlNZXNzYWdlVGVtcGxhdGUpOwogICAgICAgICAgICB2YXIgb3B0aW9ucyA9IF90aGlzLnN0YXRlLm9wdGlvbnM7CiAgICAgICAgICAgIHZhciBfYiA9IF90aGlzLnByb3BzLCBhcHBseVRlbXBsYXRlVG9EcmFmdCA9IF9iLmFwcGx5VGVtcGxhdGVUb0RyYWZ0LCBkcmFmdCA9IF9iLmRyYWZ0LCB0ZW1wbGF0ZXMgPSBfYi50ZW1wbGF0ZXMsIHN0YWdlSW5zdGFuY2UgPSBfYi5zdGFnZUluc3RhbmNlLCBhcHBseVRlbXBsYXRlVG9TdGFnZUluc3RhbmNlID0gX2IuYXBwbHlUZW1wbGF0ZVRvU3RhZ2VJbnN0YW5jZSwgcnNiT25ib2FyZGluZyA9IF9iLnJzYk9uYm9hcmRpbmcsIHVwZGF0ZU9uYm9hcmRpbmcgPSBfYi51cGRhdGVPbmJvYXJkaW5nOwogICAgICAgICAgICB2YXIgc2VsZWN0ZWRUZW1wbGF0ZSA9IHRlbXBsYXRlcy5maWx0ZXIoZnVuY3Rpb24gKHRlbXBsYXRlKSB7IHJldHVybiB0ZW1wbGF0ZS5uYW1lID09PSBvcHRpb25zW2luZGV4XS50aXRsZTsgfSlbMF07CiAgICAgICAgICAgIGlmIChkcmFmdCAmJiBzZWxlY3RlZFRlbXBsYXRlKSB7CiAgICAgICAgICAgICAgICAvLyBIYW5kbGUgUlNCIE9uYm9hcmRpbmcKICAgICAgICAgICAgICAgIGlmIChyc2JPbmJvYXJkaW5nID09PSBPbmJvYXJkaW5nVHlwZS5NZXNzYWdlVGVtcGxhdGVzKSB7CiAgICAgICAgICAgICAgICAgICAgbG9nQW1wbGl0dWRlRXZlbnQoQW1wbGl0dWRlRXZlbnRzLlRvdXJTdGVwRm91ciwgeyBza2lwcGVkOiBmYWxzZSB9KTsKICAgICAgICAgICAgICAgICAgICB1cGRhdGVPbmJvYXJkaW5nKHsKICAgICAgICAgICAgICAgICAgICAgICAgc2tpcHBlZDogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IHsgc3RlcHM6IChfYSA9IHt9LCBfYVtPbmJvYXJkaW5nVHlwZS5NZXNzYWdlVGVtcGxhdGVzXSA9IHRydWUsIF9hKSB9LAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZ2V0T25ib2FyZGluZ0FjdGlvbnMoKS5uZXh0KE9uYm9hcmRpbmdUeXBlLk1lc3NhZ2VUZW1wbGF0ZXMpOwogICAgICAgICAgICAgICAgYXBwbHlUZW1wbGF0ZVRvRHJhZnQoc2VsZWN0ZWRUZW1wbGF0ZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHN0YWdlSW5zdGFuY2UgJiYgc2VsZWN0ZWRUZW1wbGF0ZSkgewogICAgICAgICAgICAgICAgYXBwbHlUZW1wbGF0ZVRvU3RhZ2VJbnN0YW5jZShzZWxlY3RlZFRlbXBsYXRlKTsKICAgICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgX3RoaXMucmVuZGVyUHJldmlldyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIF9hLCBfYiwgX2M7CiAgICAgICAgICAgIHZhciBzZWxlY3RlZFRlbXBsYXRlID0gX3RoaXMuc3RhdGUuc2VsZWN0ZWRUZW1wbGF0ZTsKICAgICAgICAgICAgdmFyIHRvUGFydGljaXBhbnRzID0gKF9hID0gc2VsZWN0ZWRUZW1wbGF0ZSA9PT0gbnVsbCB8fCBzZWxlY3RlZFRlbXBsYXRlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzZWxlY3RlZFRlbXBsYXRlLnRvKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiBbXTsKICAgICAgICAgICAgdmFyIGNjUGFydGljaXBhbnRzID0gKF9iID0gc2VsZWN0ZWRUZW1wbGF0ZSA9PT0gbnVsbCB8fCBzZWxlY3RlZFRlbXBsYXRlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzZWxlY3RlZFRlbXBsYXRlLmNjKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiBbXTsKICAgICAgICAgICAgdmFyIGJjY1BhcnRpY2lwYW50cyA9IChfYyA9IHNlbGVjdGVkVGVtcGxhdGUgPT09IG51bGwgfHwgc2VsZWN0ZWRUZW1wbGF0ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogc2VsZWN0ZWRUZW1wbGF0ZS5iY2MpICE9PSBudWxsICYmIF9jICE9PSB2b2lkIDAgPyBfYyA6IFtdOwogICAgICAgICAgICB2YXIgYWxsUGFydGljaXBhbnRzID0gdG9QYXJ0aWNpcGFudHMuY29uY2F0KGNjUGFydGljaXBhbnRzKS5jb25jYXQoYmNjUGFydGljaXBhbnRzKQogICAgICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAocCkgeyByZXR1cm4gcGFyc2VBZGRyZXNzKHApOyB9KTsKICAgICAgICAgICAgaWYgKHNlbGVjdGVkVGVtcGxhdGUpIHsKICAgICAgICAgICAgICAgIHJldHVybiAoUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZW1wbGF0ZS1wcmV2aWV3IiB9LAogICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImg1IiwgeyBjbGFzc05hbWU6ICJzdWJqZWN0IiB9LCBzZWxlY3RlZFRlbXBsYXRlLnN1YmplY3QgfHwgJyhObyBzdWJqZWN0KScpLAogICAgICAgICAgICAgICAgICAgICEhYWxsUGFydGljaXBhbnRzLmxlbmd0aCAmJiAoUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJwYXJ0aWNpcGFudHMtc2VjdGlvbiIgfSwKICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJpbmZvIiB9LCAiUmVjaXBpZW50czoiKSwKICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJyZWNpcGllbnRzIiB9LCBwYXJ0aWNpcGFudHNUb1N0cmluZyhhbGxQYXJ0aWNpcGFudHMpKSkpLAogICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAiYm9keSIsIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MOiB7IF9faHRtbDogc2FuaXRpemUoc2VsZWN0ZWRUZW1wbGF0ZS5ib2R5KSB9IH0pKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIG51bGwpOwogICAgICAgIH07CiAgICAgICAgX3RoaXMuc3RhdGUgPSB7CiAgICAgICAgICAgIG9wdGlvbnM6IFtdLAogICAgICAgICAgICBzZWxlY3RlZFRlbXBsYXRlOiBwcm9wcy50ZW1wbGF0ZXMubGVuZ3RoID8gcHJvcHMudGVtcGxhdGVzWzBdIDogdW5kZWZpbmVkLAogICAgICAgIH07CiAgICAgICAgcmV0dXJuIF90aGlzOwogICAgfQogICAgVGVtcGxhdGVzLnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB0aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgb3B0aW9uczogdGhpcy50ZW1wbGF0ZVR5cGVhaGVhZCgnJykubWFwKGZ1bmN0aW9uICh0ZW1wbGF0ZSkgeyByZXR1cm4gKHsKICAgICAgICAgICAgICAgIHRpdGxlOiB0ZW1wbGF0ZS5uYW1lLAogICAgICAgICAgICB9KTsgfSksCiAgICAgICAgICAgIHNlbGVjdGVkVGVtcGxhdGU6IHRoaXMudGVtcGxhdGVUeXBlYWhlYWQoJycpWzBdLAogICAgICAgIH0pOwogICAgfTsKICAgIFRlbXBsYXRlcy5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5zdGF0ZS5vcHRpb25zOwogICAgICAgIHJldHVybiAoUmVhY3QuY3JlYXRlRWxlbWVudChDb250cm9sUG9wb3ZlciwgeyBjbGFzc05hbWU6ICJ0ZW1wbGF0ZXMtcG9wb3ZlciIsIHR5cGU6IENvbW1hbmRDb250cm9sVHlwZS5UZW1wbGF0ZXMsIGljb246IFJlYWN0LmNyZWF0ZUVsZW1lbnQoVGVtcGxhdGUsIHsgd2lkdGg6ICIyMXB4IiwgaGVpZ2h0OiAiMThweCIgfSksIGhlYWRpbmc6ICJNZXNzYWdlIFRlbXBsYXRlcyIsIG9wdGlvbnM6IG9wdGlvbnMsIHBsYWNlaG9sZGVyOiAic2VhcmNoICIgKyBvcHRpb25zLmxlbmd0aCArICIgdGVtcGxhdGVzLi4uIiwgb25IaWRlOiB0aGlzLnByb3BzLm9uSGlkZSwgb25JbnB1dENoYW5nZTogdGhpcy5oYW5kbGVJbnB1dENoYW5nZSwgb25TZWxlY3RlZEluZGV4Q2hhbmdlOiB0aGlzLmhhbmRsZVNlbGVjdGVkSW5kZXhDaGFuZ2UsIG9uU2VsZWN0OiB0aGlzLmhhbmRsZVNlbGVjdCwgcmVuZGVyUHJldmlldzogdGhpcy5yZW5kZXJQcmV2aWV3LCBhbGxvd01hbmFnZTogdHJ1ZSwgc2hvd09uTW91bnQ6IHRydWUgfSkpOwogICAgfTsKICAgIHJldHVybiBUZW1wbGF0ZXM7Cn0oUmVhY3QuUHVyZUNvbXBvbmVudCkpOwpleHBvcnQgZGVmYXVsdCBUZW1wbGF0ZXM7Cg=="},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/CommandControl/components/Templates/Templates.tsx","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/CommandControl/components/Templates/Templates.tsx"],"names":[],"mappings":"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","sourcesContent":["import React from 'react';\n\nimport ControlPopover, { Option } from '../components/ControlPopover';\n\nimport Template from '@src/components/Icons/Template.svg';\n\nimport './Templates.scss';\nimport { CommandControlType, Template as TemplateType, Draft, OnboardingType } from '@src/types';\nimport { sanitize } from '@src/lib/html';\nimport { sortMatches } from '@src/lib/matcher';\nimport { SequenceStageInstance } from '@src/types/sequences';\nimport { typeaheadRegex } from '@src/lib/typeahead';\nimport { OnboardingPatchMeta } from '@src/ducks/me';\nimport { getOnboardingActions } from '@src/lib/OnboardingDispatcher';\nimport { parseAddress, participantsToString } from '@src/lib/address';\nimport { AmplitudeEvents, logAmplitudeEvent } from '@src/lib/amplitude-analytics';\n\nexport interface Props {\n  isDefault?: boolean;\n  templates: TemplateType[];\n  draft?: Draft;\n  stageInstance?: SequenceStageInstance;\n  rsbOnboarding?: OnboardingType;\n  onHide: () => void;\n}\n\n// TODO(SHIN): Create epic for updating draft with template that takes care of attachments\nexport interface DispatchProps {\n  applyTemplateToDraft: (template: TemplateType) => void;\n  applyTemplateToStageInstance: (template: TemplateType) => void;\n  updateOnboarding?: (meta: OnboardingPatchMeta) => void;\n}\n\ninterface State {\n  options: Option[];\n  selectedTemplate?: TemplateType;\n}\n\nclass Templates extends React.PureComponent<Props & DispatchProps, State> {\n  constructor(props: Props & DispatchProps) {\n    super();\n\n    this.state = {\n      options: [],\n      selectedTemplate: props.templates.length ? props.templates[0] : undefined,\n    };\n  }\n\n  componentDidMount() {\n    this.setState({\n      options: this.templateTypeahead('').map(template => ({\n        title: template.name,\n      })),\n      selectedTemplate: this.templateTypeahead('')[0],\n    });\n  }\n\n  templateTypeahead = (partial: string) => {\n    const { templates } = this.props;\n\n    // Return sorted by created date if no query\n    if (partial === '') {\n      return templates\n        .sort((a: TemplateType, b: TemplateType) =>\n          b.updated.getTime() - a.updated.getTime(),\n        );\n    }\n\n    // Return sorted by match if query\n    const query = partial.trim().toLowerCase();\n    const regex = typeaheadRegex(query);\n\n    const matches = this.props.templates.filter((template) => {\n      if (template.name.toLowerCase().match(regex)) {\n        return true;\n      }\n\n      return false;\n    });\n\n    return sortMatches(matches, query, 'name');\n  }\n\n  handleInputChange = (value: string) => {\n    const { templates } = this.props;\n    const newOptions = this.templateTypeahead(value)\n      .map(template => ({ title: template.name }));\n    const selectedTemplate = !!templates.length && !!newOptions.length &&\n      templates.filter(\n        template => template.name === newOptions[0].title,\n      )[0];\n    this.setState({\n      options: newOptions,\n      selectedTemplate: selectedTemplate || undefined,\n    });\n  }\n\n  handleSelectedIndexChange = (index: number) => {\n    const { templates } = this.props;\n\n    this.setState({ selectedTemplate: templates.filter(\n      template => template.name === this.state.options[index].title,\n    )[0] });\n  }\n\n  handleSelect = (option: any, index: number) => {\n    logAmplitudeEvent(AmplitudeEvents.ApplyMessageTemplate);\n    const { options } = this.state;\n    const {\n      applyTemplateToDraft,\n      draft,\n      templates,\n      stageInstance,\n      applyTemplateToStageInstance,\n      rsbOnboarding,\n      updateOnboarding,\n    } = this.props;\n    const selectedTemplate = templates.filter(\n      template => template.name === options[index].title,\n    )[0];\n\n    if (draft && selectedTemplate) {\n      // Handle RSB Onboarding\n      if (rsbOnboarding === OnboardingType.MessageTemplates) {\n        logAmplitudeEvent(AmplitudeEvents.TourStepFour, { skipped: false });\n        updateOnboarding!({\n          skipped: false,\n          type: { steps: { [OnboardingType.MessageTemplates]: true } },\n        });\n      }\n      getOnboardingActions().next(OnboardingType.MessageTemplates);\n      applyTemplateToDraft(selectedTemplate);\n    }\n\n    if (stageInstance && selectedTemplate) {\n      applyTemplateToStageInstance(selectedTemplate);\n    }\n  }\n\n  renderPreview = () => {\n    const { selectedTemplate } = this.state;\n    const toParticipants = selectedTemplate?.to ?? [];\n    const ccParticipants = selectedTemplate?.cc ?? [];\n    const bccParticipants = selectedTemplate?.bcc ?? [];\n    const allParticipants = toParticipants.concat(ccParticipants).concat(bccParticipants)\n      .map(p => parseAddress(p));\n\n    if (selectedTemplate) {\n      return (\n        <div className=\"template-preview\">\n          <h5 className=\"subject\">{selectedTemplate.subject || '(No subject)'}</h5>\n          {!!allParticipants.length && (\n            <div className=\"participants-section\">\n              <div className=\"info\">\n                Recipients:\n              </div>\n              <div className=\"recipients\">\n                {participantsToString(allParticipants)}\n              </div>\n            </div>\n          )}\n          <div\n            className=\"body\"\n            dangerouslySetInnerHTML={{ __html: sanitize(selectedTemplate.body) }}\n          />\n        </div>\n      );\n    }\n\n    return <div />;\n  }\n\n  render() {\n    const { options } = this.state;\n\n    return (\n      <ControlPopover\n        className=\"templates-popover\"\n        type={CommandControlType.Templates}\n        icon={<Template width=\"21px\" height=\"18px\" />}\n        heading=\"Message Templates\"\n        options={options}\n        placeholder={`search ${options.length} templates...`}\n        onHide={this.props.onHide}\n        onInputChange={this.handleInputChange}\n        onSelectedIndexChange={this.handleSelectedIndexChange}\n        onSelect={this.handleSelect}\n        renderPreview={this.renderPreview}\n        allowManage\n        showOnMount\n      />\n    );\n  }\n}\n\nexport default Templates;\n"]}]}