{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/lib/event.ts","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/lib/event.ts","mtime":1675280254064},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF9fYXNzaWduID0gKHRoaXMgJiYgdGhpcy5fX2Fzc2lnbikgfHwgZnVuY3Rpb24gKCkgewogICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uKHQpIHsKICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHsKICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTsKICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKQogICAgICAgICAgICAgICAgdFtwXSA9IHNbcF07CiAgICAgICAgfQogICAgICAgIHJldHVybiB0OwogICAgfTsKICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9OwppbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudC10aW1lem9uZSc7CmltcG9ydCB7IFJyZWN1ciB9IGZyb20gJ3JyZWN1cic7CmV4cG9ydCB2YXIgYXBwbHlUaW1lQmxvY2tEZWZhdWx0cyA9IGZ1bmN0aW9uICh0YikgewogICAgdmFyIGV2ZW50ID0gdGIuZXZlbnQgfHwge307CiAgICByZXR1cm4gewogICAgICAgIGV2ZW50OiBfX2Fzc2lnbih7IG5hbWU6ICcnLCBub3RlczogJycsIHJlY2lwaWVudHM6IFtdLCBsb2NhdGlvbjogJycgfSwgZXZlbnQpLAogICAgICAgIHN0YXJ0VGltZTogdGIuc3RhcnRUaW1lIHx8IG1vbWVudCgpLAogICAgICAgIGVuZFRpbWU6IHRiLmVuZFRpbWUgfHwgbW9tZW50KCkuYWRkKDEsICdob3VycycpLAogICAgfTsKfTsKZXhwb3J0IHZhciBjcmVhdGVGYWxsYmFja0NhbGVuZGFyID0gZnVuY3Rpb24gKHBhcnRpYWwpIHsgcmV0dXJuIChfX2Fzc2lnbih7IGlkOiAnZmFsbGJhY2snLCBhY2NvdW50OiAnJywgYXBpSWQ6ICcnLCBuYW1lOiAnZmFsbGJhY2snLCBkZXNjcmlwdGlvbjogJ2ZhbGxiYWNrJywgYmFja2dyb3VuZENvbG9yOiAnI2YyZjVmOCcsIGZvcmVncm91bmRDb2xvcjogJyM3ZThmOWYnLCBoaWRkZW46IGZhbHNlIH0sIHBhcnRpYWwpKTsgfTsKZXhwb3J0IHZhciBjb21wdXRlZENhbGVuZGFyRXZlbnQgPSBmdW5jdGlvbiAoZXZlbnQsIGNhbGVuZGFycywgYWxsRXZlbnRzKSB7CiAgICB2YXIgZGF5TVMgPSAyNCAqIDYwICogNjAgKiAxMDAwOwogICAgdmFyIHN0YXJ0VGltZSA9IG5ldyBEYXRlKGV2ZW50LnN0YXJ0VGltZSk7CiAgICB2YXIgZW5kVGltZSA9IG5ldyBEYXRlKGV2ZW50LmVuZFRpbWUpOwogICAgdmFyIGlzQWxsRGF5ID0gKHN0YXJ0VGltZS5nZXRUaW1lKCkgLSBlbmRUaW1lLmdldFRpbWUoKSkgJSBkYXlNUyA9PT0gMDsKICAgIHZhciBjYWxlbmRhciA9IChjYWxlbmRhcnNbZXZlbnQuYWNjb3VudF0gfHwgW10pCiAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoYykgeyByZXR1cm4gYy5hcGlJZCA9PT0gZXZlbnQuY2FsZW5kYXJBcGlJZDsgfSlbMF0gfHwKICAgICAgICBjcmVhdGVGYWxsYmFja0NhbGVuZGFyKHsgYXBpSWQ6IGV2ZW50LmNhbGVuZGFyQXBpSWQgfSk7CiAgICByZXR1cm4gX19hc3NpZ24oX19hc3NpZ24oe30sIGV2ZW50KSwgeyBzdGFydFRpbWU6IHN0YXJ0VGltZSwKICAgICAgICBlbmRUaW1lOiBlbmRUaW1lLAogICAgICAgIGlzQWxsRGF5OiBpc0FsbERheSwKICAgICAgICBjYWxlbmRhcjogY2FsZW5kYXIsIGF0dGVuZGVlczogW10sIGF0dGFjaG1lbnRzOiBbXSB9KTsKfTsKZXhwb3J0IHZhciBpc0V2ZW50SW5ScnVsZSA9IGZ1bmN0aW9uIChyZWN1cnJlbmNlLCBldmVudFN0YXJ0LCBldmVudEVuZCwgZGF0ZVN0YXJ0LCBkYXRlRW5kKSB7CiAgICB2YXIgcnJ1bGUgPSBScmVjdXIucGFyc2UocmVjdXJyZW5jZSk7CiAgICBpZiAoKHJydWxlLnVudGlsICYmIG1vbWVudChycnVsZS51bnRpbCkuaXNBZnRlcihkYXRlRW5kKSkgfHwKICAgICAgICAocnJ1bGUudW50aWwgJiYgbW9tZW50KHJydWxlLnVudGlsKS5pc0JlZm9yZShkYXRlU3RhcnQpKSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIHZhciBpbnRlcnZhbCA9IHJydWxlLmludGVydmFsIHx8IDE7CiAgICB2YXIgY291bnQgPSBycnVsZS5jb3VudCB8fCBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUjsKICAgIHZhciBjb3VudGVyID0gMDsKICAgIHN3aXRjaCAocnJ1bGUuZnJlcSkgewogICAgICAgIGNhc2UgJ3llYXJseSc6CiAgICAgICAgICAgIHdoaWxlIChjb3VudCA+IGNvdW50ZXIgJiYKICAgICAgICAgICAgICAgIChkYXRlU3RhcnQuaXNBZnRlcihldmVudFN0YXJ0KSB8fCBkYXRlU3RhcnQuaXNBZnRlcihldmVudEVuZCkpKSB7CiAgICAgICAgICAgICAgICBldmVudFN0YXJ0LmFkZChpbnRlcnZhbCwgJ3llYXJzJyk7CiAgICAgICAgICAgICAgICBldmVudEVuZC5hZGQoaW50ZXJ2YWwsICd5ZWFycycpOwogICAgICAgICAgICAgICAgY291bnRlciArPSAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgJ21vbnRobHknOgogICAgICAgICAgICB3aGlsZSAoY291bnQgPiBjb3VudGVyICYmCiAgICAgICAgICAgICAgICAoZGF0ZVN0YXJ0LmlzQWZ0ZXIoZXZlbnRTdGFydCkgfHwgZGF0ZVN0YXJ0LmlzQWZ0ZXIoZXZlbnRFbmQpKSkgewogICAgICAgICAgICAgICAgZXZlbnRTdGFydC5hZGQoaW50ZXJ2YWwsICdtb250aHMnKTsKICAgICAgICAgICAgICAgIGV2ZW50RW5kLmFkZChpbnRlcnZhbCwgJ21vbnRocycpOwogICAgICAgICAgICAgICAgY291bnRlciArPSAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgJ3dlZWtseSc6CiAgICAgICAgICAgIHZhciBub0J5RGF5U3BlY2lmaWVkID0gZmFsc2U7CiAgICAgICAgICAgIHZhciBpc1NhbWVXZWVrRGF5ID0gZmFsc2U7CiAgICAgICAgICAgIHdoaWxlIChjb3VudCA+IGNvdW50ZXIgJiYKICAgICAgICAgICAgICAgIChkYXRlU3RhcnQuaXNBZnRlcihldmVudFN0YXJ0KSB8fCBkYXRlU3RhcnQuaXNBZnRlcihldmVudEVuZCkpKSB7CiAgICAgICAgICAgICAgICBldmVudFN0YXJ0LmFkZChpbnRlcnZhbCwgJ3dlZWtzJyk7CiAgICAgICAgICAgICAgICBldmVudEVuZC5hZGQoaW50ZXJ2YWwsICd3ZWVrcycpOwogICAgICAgICAgICAgICAgY291bnRlciArPSAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIG5vQnlEYXlTcGVjaWZpZWQgPQogICAgICAgICAgICAgICAgZGF0ZVN0YXJ0LmZvcm1hdCgnTU0tREQtWVlZWScpID09PSBldmVudFN0YXJ0LmZvcm1hdCgnTU0tREQtWVlZWScpIHx8CiAgICAgICAgICAgICAgICAgICAgZGF0ZVN0YXJ0LmZvcm1hdCgnTU0tREQtWVlZWScpID09PSBldmVudEVuZC5mb3JtYXQoJ01NLURELVlZWVknKTsKICAgICAgICAgICAgaWYgKHJydWxlLmJ5ZGF5KSB7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gcnJ1bGUuYnlkYXk7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGRheSA9IF9hW19pXTsKICAgICAgICAgICAgICAgICAgICBpZiAoIWlzU2FtZVdlZWtEYXkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRTdGFydC5kYXkoZGF5KS5zdGFydE9mKCdkYXknKTsKICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRFbmQuZGF5KGRheSkuc3RhcnRPZignZGF5Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudFN0YXJ0LmlzQWZ0ZXIoZGF0ZVN0YXJ0LmNsb25lKCkuc3RhcnRPZignZGF5JykpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudFN0YXJ0LmFkZCgtMSwgJ3dlZWsnKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnRFbmQuaXNBZnRlcihkYXRlU3RhcnQuY2xvbmUoKS5zdGFydE9mKCdkYXknKSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50RW5kLmFkZCgtMSwgJ3dlZWsnKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpc1NhbWVXZWVrRGF5ID0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50U3RhcnQuZm9ybWF0KCdNTS1ERC1ZWVlZJykgPT09IGRhdGVTdGFydC5mb3JtYXQoJ01NLURELVlZWVknKSB8fAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50RW5kLmZvcm1hdCgnTU0tREQtWVlZWScpID09PSBkYXRlU3RhcnQuZm9ybWF0KCdNTS1ERC1ZWVlZJyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChpc1NhbWVXZWVrRGF5IHx8IG5vQnlEYXlTcGVjaWZpZWQpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBjYXNlICdkYWlseSc6CiAgICAgICAgICAgIHdoaWxlIChjb3VudCA+IGNvdW50ZXIgJiYKICAgICAgICAgICAgICAgIChkYXRlU3RhcnQuaXNBZnRlcihldmVudFN0YXJ0KSB8fCBkYXRlU3RhcnQuaXNBZnRlcihldmVudEVuZCkpKSB7CiAgICAgICAgICAgICAgICBldmVudFN0YXJ0LmFkZChpbnRlcnZhbCwgJ2RheXMnKTsKICAgICAgICAgICAgICAgIGV2ZW50RW5kLmFkZChpbnRlcnZhbCwgJ2RheXMnKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBicmVhazsKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICBicmVhazsKICAgIH0KICAgIGlmIChkYXRlU3RhcnQuZm9ybWF0KCdNTS1ERC1ZWVlZJykgPT09IGV2ZW50U3RhcnQuZm9ybWF0KCdNTS1ERC1ZWVlZJykgfHwKICAgICAgICBkYXRlU3RhcnQuZm9ybWF0KCdNTS1ERC1ZWVlZJykgPT09IGV2ZW50RW5kLmZvcm1hdCgnTU0tREQtWVlZWScpIHx8CiAgICAgICAgZGF0ZUVuZC5mb3JtYXQoJ01NLURELVlZWVknKSA9PT0gZXZlbnRTdGFydC5mb3JtYXQoJ01NLURELVlZWVknKSB8fAogICAgICAgIGRhdGVFbmQuZm9ybWF0KCdNTS1ERC1ZWVlZJykgPT09IGV2ZW50RW5kLmZvcm1hdCgnTU0tREQtWVlZWScpKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICByZXR1cm4gZmFsc2U7Cn07CmV4cG9ydCB2YXIgY29udmVydFBvc2l0aW9uVG9UaW1lQmxvY2sgPSBmdW5jdGlvbiAocG9zaXRpb24sIHN0YXJ0SG91ciwgY29sdW1uV2lkdGgsIHJvd0hlaWdodCwgZGF0ZVJhbmdlKSB7CiAgICB2YXIgbGVmdCA9IHBvc2l0aW9uLmxlZnQsIHRvcCA9IHBvc2l0aW9uLnRvcCwgaGVpZ2h0ID0gcG9zaXRpb24uaGVpZ2h0OwogICAgdmFyIGhvdXJJbnRlcnZhbHMgPSB0b3AgLyAocm93SGVpZ2h0ICogMik7CiAgICB2YXIgZGF0ZUluZGV4ID0gTWF0aC5mbG9vcihsZWZ0IC8gY29sdW1uV2lkdGgpOwogICAgdmFyIGRhdGUgPSBkYXRlUmFuZ2VbZGF0ZUluZGV4XTsKICAgIGlmIChkYXRlKSB7CiAgICAgICAgdmFyIHN0YXJ0ID0gZGF0ZS5jbG9uZSgpLmhvdXJzKHN0YXJ0SG91ciArIGhvdXJJbnRlcnZhbHMpOwogICAgICAgIHZhciBmaWZ0ZWVuTWludXRlSW50ZXJ2YWxzID0gTWF0aC5mbG9vcih0b3AgLyAocm93SGVpZ2h0IC8gMikpOwogICAgICAgIGlmIChmaWZ0ZWVuTWludXRlSW50ZXJ2YWxzICUgNCAhPT0gMCkgewogICAgICAgICAgICBzdGFydC5taW51dGVzKChmaWZ0ZWVuTWludXRlSW50ZXJ2YWxzICUgNCkgKiAxNSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHN0YXJ0VGltZTogc3RhcnQsCiAgICAgICAgICAgIGVuZFRpbWU6IHN0YXJ0LmNsb25lKCkuYWRkKGhlaWdodCAvIChyb3dIZWlnaHQgKiAyKSwgJ2hvdXInKSwKICAgICAgICB9OwogICAgfQogICAgcmV0dXJuIHVuZGVmaW5lZDsKfTsKZXhwb3J0IHZhciBnZXRFdmVudHNGb3JEYXRlID0gZnVuY3Rpb24gKGRhdGUsIGV2ZW50cywgc3RhcnRIb3VyLCBlbmRIb3VyLCBoaWRkZW5DYWxlbmRhcnMpIHsKICAgIGlmIChoaWRkZW5DYWxlbmRhcnMgPT09IHZvaWQgMCkgeyBoaWRkZW5DYWxlbmRhcnMgPSBbXTsgfQogICAgdmFyIGV2ZW50U3RhcnQ7CiAgICB2YXIgZXZlbnRFbmQ7CiAgICB2YXIgc3RhcnQ7CiAgICB2YXIgZW5kOwogICAgaWYgKCFldmVudHMgfHwgIWV2ZW50cy5sZW5ndGgpIHsKICAgICAgICByZXR1cm4gW107CiAgICB9CiAgICByZXR1cm4gZXZlbnRzCiAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoZSkgewogICAgICAgIGV2ZW50U3RhcnQgPSBtb21lbnQoZS5zdGFydFRpbWUpOwogICAgICAgIGV2ZW50RW5kID0gbW9tZW50KGUuZW5kVGltZSk7CiAgICAgICAgc3RhcnQgPSBkYXRlLmNsb25lKCkuaG91cihzdGFydEhvdXIpOwogICAgICAgIGVuZCA9IGRhdGUuY2xvbmUoKS5ob3VyKGVuZEhvdXIpOwogICAgICAgIGlmIChlLmNhbGVuZGFyICYmIGUuY2FsZW5kYXIuaWQgJiYgaGlkZGVuQ2FsZW5kYXJzLmluZGV4T2YoZS5jYWxlbmRhci5pZCkgIT09IC0xKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgaWYgKGV2ZW50U3RhcnQuaXNTYW1lT3JBZnRlcihzdGFydCkgJiYgZXZlbnRTdGFydC5pc1NhbWVPckJlZm9yZShlbmQpKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICBpZiAoZXZlbnRFbmQuaXNTYW1lT3JBZnRlcihzdGFydCkgJiYgZXZlbnRFbmQuaXNTYW1lT3JCZWZvcmUoZW5kKSkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgaWYgKGUucmVjdXJyZW5jZSAmJiBlLnJlY3VycmVuY2UubGVuZ3RoKSB7CiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBlLnJlY3VycmVuY2U7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7CiAgICAgICAgICAgICAgICB2YXIgcmVjdXJyZW5jZSA9IF9hW19pXTsKICAgICAgICAgICAgICAgIGlmIChpc0V2ZW50SW5ScnVsZShyZWN1cnJlbmNlLCBldmVudFN0YXJ0LCBldmVudEVuZCwgc3RhcnQsIGVuZCkpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9KQogICAgICAgIC5zb3J0KGZ1bmN0aW9uIChlKSB7IHJldHVybiBlLnN0YXJ0VGltZS5nZXRUaW1lKCk7IH0pOwp9Owo="},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/lib/event.ts","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/lib/event.ts"],"names":[],"mappings":"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","sourcesContent":["import moment, { Moment } from 'moment-timezone';\nimport { TimeBlock, EventRecipient, CalendarEvent, Calendar } from '@src/types';\nimport { Rrecur } from 'rrecur';\n\nexport const applyTimeBlockDefaults = (tb: Partial<TimeBlock>) => {\n  const event = tb.event || {};\n\n  return {\n    event: {\n      name: '',\n      notes: '',\n      recipients: [] as EventRecipient[],\n      location: '',\n      ...event,\n    },\n    startTime: tb.startTime || moment(),\n    endTime: tb.endTime || moment().add(1, 'hours'),\n  };\n};\n\nexport const createFallbackCalendar = (partial: Partial<Calendar>): Calendar => ({\n  id: 'fallback',\n  account: '',\n  apiId: '',\n  name: 'fallback',\n  description: 'fallback',\n  backgroundColor: '#f2f5f8',\n  foregroundColor: '#7e8f9f',\n  hidden: false,\n\n  ...partial,\n});\n\nexport const computedCalendarEvent = (\n  event: Partial<CalendarEvent>,\n  calendars: {\n    [account: string]: Calendar[];\n  },\n  allEvents: Array<Partial<CalendarEvent>>,\n) => {\n  const dayMS = 24 * 60 * 60 * 1000;\n  const startTime = new Date(event.startTime!);\n  const endTime = new Date(event.endTime!);\n  const isAllDay = (startTime.getTime() - endTime.getTime()) % dayMS === 0;\n  const calendar = (calendars[event.account!] || [])\n    .filter(c => c.apiId === event.calendarApiId)[0] ||\n    createFallbackCalendar({ apiId: event.calendarApiId });\n\n  return {\n    ...(event as any),\n    startTime,\n    endTime,\n    isAllDay,\n    calendar,\n    attendees: [],\n    attachments: [],\n  };\n};\n\nexport const isEventInRrule = (\n  recurrence: string,\n  eventStart: Moment,\n  eventEnd: Moment,\n  dateStart: Moment,\n  dateEnd: Moment,\n) => {\n  const rrule = Rrecur.parse(recurrence);\n  if (\n    (rrule.until && moment(rrule.until).isAfter(dateEnd)) ||\n    (rrule.until && moment(rrule.until).isBefore(dateStart))\n  ) {\n    return false;\n  }\n\n  const interval = rrule.interval || 1;\n  const count = rrule.count || Number.MAX_SAFE_INTEGER;\n  let counter = 0;\n\n  switch (rrule.freq) {\n    case 'yearly':\n      while (count > counter &&\n        (dateStart.isAfter(eventStart) || dateStart.isAfter(eventEnd))) {\n        eventStart.add(interval, 'years');\n        eventEnd.add(interval, 'years');\n        counter += 1;\n      }\n      break;\n    case 'monthly':\n      while (count > counter &&\n        (dateStart.isAfter(eventStart) || dateStart.isAfter(eventEnd))) {\n        eventStart.add(interval, 'months');\n        eventEnd.add(interval, 'months');\n        counter += 1;\n      }\n      break;\n    case 'weekly':\n      let noByDaySpecified = false;\n      let isSameWeekDay = false;\n      while (count > counter &&\n        (dateStart.isAfter(eventStart) || dateStart.isAfter(eventEnd))) {\n        eventStart.add(interval, 'weeks');\n        eventEnd.add(interval, 'weeks');\n        counter += 1;\n      }\n\n      noByDaySpecified =\n        dateStart.format('MM-DD-YYYY') === eventStart.format('MM-DD-YYYY') ||\n        dateStart.format('MM-DD-YYYY') === eventEnd.format('MM-DD-YYYY');\n\n      if (rrule.byday) {\n        for (const day of rrule.byday) {\n          if (!isSameWeekDay) {\n            eventStart.day(day).startOf('day');\n            eventEnd.day(day).startOf('day');\n            if (eventStart.isAfter(dateStart.clone().startOf('day'))) {\n              eventStart.add(-1, 'week');\n            }\n            if (eventEnd.isAfter(dateStart.clone().startOf('day'))) {\n              eventEnd.add(-1, 'week');\n            }\n            isSameWeekDay =\n              eventStart.format('MM-DD-YYYY') === dateStart.format('MM-DD-YYYY') ||\n              eventEnd.format('MM-DD-YYYY') === dateStart.format('MM-DD-YYYY');\n          }\n        }\n      }\n\n      if (isSameWeekDay || noByDaySpecified) {\n        return true;\n      }\n      return false;\n    case 'daily':\n      while (count > counter &&\n        (dateStart.isAfter(eventStart) || dateStart.isAfter(eventEnd))) {\n        eventStart.add(interval, 'days');\n        eventEnd.add(interval, 'days');\n      }\n      break;\n    default:\n      break;\n  }\n\n  if (\n    dateStart.format('MM-DD-YYYY') === eventStart.format('MM-DD-YYYY') ||\n    dateStart.format('MM-DD-YYYY') === eventEnd.format('MM-DD-YYYY') ||\n    dateEnd.format('MM-DD-YYYY') === eventStart.format('MM-DD-YYYY') ||\n    dateEnd.format('MM-DD-YYYY') === eventEnd.format('MM-DD-YYYY')\n  ) {\n    return true;\n  }\n\n  return false;\n};\n\nexport const convertPositionToTimeBlock = (\n    position: {\n      left: number;\n      top: number;\n      height: number;\n    },\n    startHour: number,\n    columnWidth: number,\n    rowHeight: number,\n    dateRange: Moment[],\n  ) => {\n  const { left, top, height } = position;\n  const hourIntervals = top / (rowHeight * 2);\n  const dateIndex = Math.floor(left / columnWidth);\n  const date = dateRange[dateIndex];\n  if (date) {\n    const start = date.clone().hours(startHour + hourIntervals);\n    const fifteenMinuteIntervals = Math.floor(top / (rowHeight / 2));\n\n    if (fifteenMinuteIntervals % 4 !== 0) {\n      start.minutes((fifteenMinuteIntervals % 4) * 15);\n    }\n\n    return {\n      startTime: start,\n      endTime: start.clone().add(height / (rowHeight * 2), 'hour'),\n    };\n  }\n  return undefined;\n};\n\nexport const getEventsForDate = (\n  date: Moment,\n  events: CalendarEvent[],\n  startHour: number,\n  endHour: number,\n  hiddenCalendars: string[] = [],\n) => {\n  let eventStart;\n  let eventEnd;\n  let start;\n  let end;\n\n  if (!events || !events.length) {\n    return [];\n  }\n\n  return events\n    .filter((e) => {\n      eventStart = moment(e.startTime);\n      eventEnd = moment(e.endTime);\n      start = date.clone().hour(startHour);\n      end = date.clone().hour(endHour);\n\n      if (e.calendar && e.calendar.id && hiddenCalendars.indexOf(e.calendar.id) !== -1) {\n        return false;\n      }\n\n      if (eventStart.isSameOrAfter(start) && eventStart.isSameOrBefore(end)) {\n        return true;\n      }\n\n      if (eventEnd.isSameOrAfter(start) && eventEnd.isSameOrBefore(end)) {\n        return true;\n      }\n\n      if (e.recurrence && e.recurrence.length) {\n        for (const recurrence of e.recurrence) {\n          if (isEventInRrule(recurrence, eventStart, eventEnd, start, end)) {\n            return true;\n          }\n        }\n      }\n\n      return false;\n    })\n    .sort(e => e.startTime.getTime());\n};\n"]}]}