{"remainingRequest":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js??ref--6-1!/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/ThreadDetail/components/Attachment/AttachmentsPane.tsx","dependencies":[{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/ThreadDetail/components/Attachment/AttachmentsPane.tsx","mtime":1675280254036},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1675365393858},{"path":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/node_modules/ts-loader/index.js","mtime":1675365391714}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JzsKaW1wb3J0IHsgZmlyc3QgfSBmcm9tICdsb2Rhc2gnOwppbXBvcnQgQXR0YWNobWVudENlbGwgZnJvbSAnQHNyYy9jb21wb25lbnRzL0NlbGxzL0F0dGFjaG1lbnRDZWxsJzsKaW1wb3J0ICcuL0F0dGFjaG1lbnRzUGFuZS5zY3NzJzsKdmFyIEF0dGFjaG1lbnRzUGFuZSA9IGZ1bmN0aW9uIChwcm9wcykgewogICAgdmFyIGhhbmRsZURvd25sb2FkQWxsID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICB2YXIgZmlsdGVyZWQgPSBwcm9wcy5hdHRhY2htZW50cy5maWx0ZXIoZnVuY3Rpb24gKGF0dGFjaG1lbnQpIHsgcmV0dXJuIGF0dGFjaG1lbnQudGhyZWFkOyB9KTsKICAgICAgICBpZiAoZmlsdGVyZWQubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdmFyIHNoYXJlZFRocmVhZEF0dGFjaG1lbnQgPSBmaXJzdChwcm9wcy5hdHRhY2htZW50cy5maWx0ZXIoZnVuY3Rpb24gKGF0dGFjaG1lbnQpIHsgcmV0dXJuICEhYXR0YWNobWVudC5zaGFyZWRUaHJlYWQ7IH0pKTsKICAgICAgICB2YXIgc2hhcmVkVGhyZWFkSWQgPSBzaGFyZWRUaHJlYWRBdHRhY2htZW50ICYmIHNoYXJlZFRocmVhZEF0dGFjaG1lbnQuc2hhcmVkVGhyZWFkOwogICAgICAgIHZhciB0aHJlYWRJZCA9IGZpbHRlcmVkWzBdLnRocmVhZDsKICAgICAgICB2YXIgbWVzc2FnZUlkID0gZmlsdGVyZWRbMF0ubWVzc2FnZTsKICAgICAgICBpZiAoIXRocmVhZElkKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgLy8gSWRlbnRpZnkgY29ycmVjdCBwYXRoIGZvciBkb3dubG9hZCBhbGwgYXR0YWNobWVudHMKICAgICAgICB2YXIgdGhyZWFkUGF0aCA9ICEhc2hhcmVkVGhyZWFkSWQKICAgICAgICAgICAgPyAnL3YxL3NoYXJlZFRocmVhZHMvJyArIGVuY29kZVVSSUNvbXBvbmVudChzaGFyZWRUaHJlYWRJZCkKICAgICAgICAgICAgOiAnL3YyL3RocmVhZHMvJyArIGVuY29kZVVSSUNvbXBvbmVudCh0aHJlYWRJZCk7CiAgICAgICAgdmFyIHVybCA9ICIiICsgcHJvY2Vzcy5lbnYuQVBJX1VSTCArCiAgICAgICAgICAgIHRocmVhZFBhdGggKwogICAgICAgICAgICAoIi9tZXNzYWdlcy8iICsgZW5jb2RlVVJJQ29tcG9uZW50KG1lc3NhZ2VJZCkgKyAiL2F0dGFjaG1lbnRzIik7CiAgICAgICAgd2luZG93Lm9wZW4odXJsLCAnX2JsYW5rJyk7CiAgICB9OwogICAgcmV0dXJuIChSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImF0dGFjaG1lbnRzLXBhbmUiIH0sCiAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0b3AiIH0sCiAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAiYXR0YWNobWVudHMtY291bnQiIH0sIHByb3BzLmF0dGFjaG1lbnRzLmxlbmd0aCA+IDEKICAgICAgICAgICAgICAgID8gcHJvcHMuYXR0YWNobWVudHMubGVuZ3RoICsgIiBhdHRhY2htZW50cyBcdTIwMjIgIgogICAgICAgICAgICAgICAgOiBwcm9wcy5hdHRhY2htZW50cy5sZW5ndGggKyAiIGF0dGFjaG1lbnQiKSwKICAgICAgICAgICAgcHJvcHMuYXR0YWNobWVudHMubGVuZ3RoID4gMSAmJgogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiYnV0dG9uIiwgeyBvbkNsaWNrOiBoYW5kbGVEb3dubG9hZEFsbCwgY2xhc3NOYW1lOiAiZG93bmxvYWQtYWxsIiB9LCAiRG93bmxvYWQgQWxsIikpLAogICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsgY2xhc3NOYW1lOiAiYm90dG9tIiB9LAogICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7IGNsYXNzTmFtZTogImF0dGFjaG1lbnQtc2VwYXJhdG9yIiB9KSwKICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgeyBjbGFzc05hbWU6ICJhdHRhY2htZW50cy1jb250YWluZXIiIH0sIHByb3BzLmF0dGFjaG1lbnRzLm1hcChmdW5jdGlvbiAoYXR0YWNobWVudCkgewogICAgICAgICAgICAgICAgcmV0dXJuIFJlYWN0LmNyZWF0ZUVsZW1lbnQoQXR0YWNobWVudENlbGwsIHsga2V5OiBhdHRhY2htZW50LmlkLCBhdHRhY2htZW50OiBhdHRhY2htZW50LCBpc01ldGE6IGF0dGFjaG1lbnQudXJsLnN0YXJ0c1dpdGgoJ2Jsb2I6JykgfSk7CiAgICAgICAgICAgIH0pKSkpKTsKfTsKZXhwb3J0IGRlZmF1bHQgQXR0YWNobWVudHNQYW5lOwo="},{"version":3,"file":"/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/ThreadDetail/components/Attachment/AttachmentsPane.tsx","sourceRoot":"","sources":["/Users/andrewsamboy/Desktop/Git/polymail/webapp/src/components/ThreadDetail/components/Attachment/AttachmentsPane.tsx"],"names":[],"mappings":"AAAA,OAAO,KAAK,MAAM,OAAO,CAAC;AAC1B,OAAO,EAAE,KAAK,EAAE,MAAM,QAAQ,CAAC;AAG/B,OAAO,cAAc,MAAM,sCAAsC,CAAC;AAElE,OAAO,wBAAwB,CAAC;AAMhC,IAAM,eAAe,GAAG,UAAC,KAAY;IACnC,IAAM,iBAAiB,GAAG,UAAC,CAAsC;QAC/D,IAAM,QAAQ,GAAG,KAAK,CAAC,WAAW,CAAC,MAAM,CAAC,UAAA,UAAU,IAAI,OAAA,UAAU,CAAC,MAAM,EAAjB,CAAiB,CAAC,CAAC;QAC3E,IAAI,QAAQ,CAAC,MAAM,KAAK,CAAC,EAAE;YACzB,OAAO;SACR;QAED,IAAM,sBAAsB,GAAG,KAAK,CAClC,KAAK,CAAC,WAAW,CAAC,MAAM,CAAC,UAAA,UAAU,IAAI,OAAA,CAAC,CAAC,UAAU,CAAC,YAAY,EAAzB,CAAyB,CAAC,CAClE,CAAC;QACF,IAAM,cAAc,GAAG,sBAAsB,IAAI,sBAAsB,CAAC,YAAY,CAAC;QACrF,IAAM,QAAQ,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC;QACpC,IAAM,SAAS,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC;QACtC,IAAI,CAAC,QAAQ,EAAE;YACb,OAAO;SACR;QAED,qDAAqD;QACrD,IAAM,UAAU,GAAG,CAAC,CAAC,cAAc;YACjC,CAAC,CAAC,oBAAoB,GAAG,kBAAkB,CAAC,cAAc,CAAC;YAC3D,CAAC,CAAC,cAAc,GAAG,kBAAkB,CAAC,QAAQ,CAAC,CAAC;QAClD,IAAM,GAAG,GAAG,KAAG,OAAO,CAAC,GAAG,CAAC,OAAU;YACnC,UAAU;aACV,eAAa,kBAAkB,CAAC,SAAS,CAAC,iBAAc,CAAA,CAAC;QAE3D,MAAM,CAAC,IAAI,CAAC,GAAG,EAAE,QAAQ,CAAC,CAAC;IAC7B,CAAC,CAAC;IAEF,OAAO,CACL,6BAAK,SAAS,EAAC,kBAAkB;QAC/B,6BAAK,SAAS,EAAC,KAAK;YAClB,6BAAK,SAAS,EAAC,mBAAmB,IAC/B,KAAK,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC;gBAC3B,CAAC,CAAI,KAAK,CAAC,WAAW,CAAC,MAAM,yBAAiB;gBAC9C,CAAC,CAAI,KAAK,CAAC,WAAW,CAAC,MAAM,gBAAa,CAExC;YACL,KAAK,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC;gBAC3B,gCACE,OAAO,EAAE,iBAAiB,EAC1B,SAAS,EAAC,cAAc,IAEvB,cAAc,CACR,CAEP;QACN,6BAAK,SAAS,EAAC,QAAQ;YACrB,6BAAK,SAAS,EAAC,sBAAsB,GAAG;YACxC,6BAAK,SAAS,EAAC,uBAAuB,IACnC,KAAK,CAAC,WAAW,CAAC,GAAG,CAAC,UAAA,UAAU;gBAC/B,OAAA,oBAAC,cAAc,IACb,GAAG,EAAE,UAAU,CAAC,EAAE,EAClB,UAAU,EAAE,UAAU,EACtB,MAAM,EAAE,UAAU,CAAC,GAAG,CAAC,UAAU,CAAC,OAAO,CAAC,GAC1C;YAJF,CAIE,CACH,CACG,CACF,CACF,CACP,CAAC;AACJ,CAAC,CAAC;AAEF,eAAe,eAAe,CAAC","sourcesContent":["import React from 'react';\nimport { first } from 'lodash';\n\nimport { MessageAttachment } from '@src/types';\nimport AttachmentCell from '@src/components/Cells/AttachmentCell';\n\nimport './AttachmentsPane.scss';\n\ninterface Props {\n  attachments: MessageAttachment[];\n}\n\nconst AttachmentsPane = (props: Props) => {\n  const handleDownloadAll = (e: React.MouseEvent<HTMLButtonElement>) => {\n    const filtered = props.attachments.filter(attachment => attachment.thread);\n    if (filtered.length === 0) {\n      return;\n    }\n\n    const sharedThreadAttachment = first(\n      props.attachments.filter(attachment => !!attachment.sharedThread),\n    );\n    const sharedThreadId = sharedThreadAttachment && sharedThreadAttachment.sharedThread;\n    const threadId = filtered[0].thread;\n    const messageId = filtered[0].message;\n    if (!threadId) {\n      return;\n    }\n\n    // Identify correct path for download all attachments\n    const threadPath = !!sharedThreadId\n      ? '/v1/sharedThreads/' + encodeURIComponent(sharedThreadId)\n      : '/v2/threads/' + encodeURIComponent(threadId);\n    const url = `${process.env.API_URL!}` +\n      threadPath +\n      `/messages/${encodeURIComponent(messageId)}/attachments`;\n\n    window.open(url, '_blank');\n  };\n\n  return (\n    <div className=\"attachments-pane\">\n      <div className=\"top\">\n        <div className=\"attachments-count\">\n          {props.attachments.length > 1\n            ? `${props.attachments.length} attachments â€¢ `\n            : `${props.attachments.length} attachment`\n          }\n        </div>\n        {props.attachments.length > 1 &&\n          <button\n            onClick={handleDownloadAll}\n            className=\"download-all\"\n          >\n            {`Download All`}\n          </button>\n        }\n      </div>\n      <div className=\"bottom\">\n        <div className=\"attachment-separator\" />\n        <div className=\"attachments-container\">\n          {props.attachments.map(attachment =>\n            <AttachmentCell\n              key={attachment.id}\n              attachment={attachment}\n              isMeta={attachment.url.startsWith('blob:')}\n            />,\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default AttachmentsPane;\n"]}]}